!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function detach(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))}function completed(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())}function dataAttr(elem,key,data){if(void 0===data&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=void 0}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||void 0!==data||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),("object"==typeof name||"function"==typeof name)&&(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),void 0!==data&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):void 0;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(null!=condition)return condition?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(support.inlineBlockNeedsLayout&&"inline"!==defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",support.shrinkWrapBlocks()||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType.charAt(0)?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var deletedIds=[],slice=deletedIds.slice,concat=deletedIds.concat,push=deletedIds.push,indexOf=deletedIds.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},version="1.11.3",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice},jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(support.ownLast)for(key in obj)return hasOwn.call(obj,key);for(key in obj);return void 0===key||hasOwn.call(obj,key)},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf)return indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:function(){return+new Date},support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],nodeType=context.nodeType,"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=1!==nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);
break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;len>i;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,parent=doc.defaultView,parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(void 0===until||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}}),jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready")))}}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),
window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)};var i,strundefined="undefined";for(i in jQuery(support))break;support.ownLast="0"!==i,support.inlineBlockNeedsLayout=!1,jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",support.inlineBlockNeedsLayout=val=3===div.offsetWidth,val&&(body.style.zoom=1)),body.removeChild(container))}),function(){var div=document.createElement("div");if(null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}div=null}(),jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return 1!==nodeType&&9!==nodeType?!1:!noData||noData!==!0&&elem.getAttribute("classid")===noData};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):void 0},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();if(div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,input.type="checkbox",input.checked=!0,fragment.appendChild(input),support.appendChecked=input.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,fragment.appendChild(div),div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,support.noCloneEvent=!0,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click()),null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}}(),function(){var i,eventName,div=document.createElement("div");for(i in{submit:!0,change:!0,focusin:!0})eventName="on"+i,(support[i+"Bubbles"]=eventName in window)||(div.setAttribute(eventName,"t"),support[i+"Bubbles"]=div.attributes[eventName].expando===!1);div=null}();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===strundefined||e&&jQuery.event.triggered===e.type?void 0:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:void 0;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.remove(this,"._submit")}}),support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);attaches||doc.addEventListener(orig,handler,!0),jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;attaches?jQuery._data(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),jQuery._removeData(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(support.noCloneEvent&&support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,deletedIds.push(id))}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):void 0;if("string"==typeof value&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={};!function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(null!=shrinkWrapBlocksVal)return shrinkWrapBlocksVal;shrinkWrapBlocksVal=!1;var div,body,container;return body=document.getElementsByTagName("body")[0],body&&body.style?(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",div.appendChild(document.createElement("div")).style.width="5px",shrinkWrapBlocksVal=3!==div.offsetWidth),body.removeChild(container),shrinkWrapBlocksVal):void 0}}();var getStyles,curCSS,rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),rposition=/^(top|right|bottom|left)$/;window.getComputedStyle?(getStyles=function(elem){return elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null);
},curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:void 0,computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0===ret?ret:ret+""}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed[name]:void 0,null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),void 0===ret?ret:ret+""||"auto"}),function(){function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",pixelPositionVal=boxSizingReliableVal=!1,reliableMarginRightVal=!0,window.getComputedStyle&&(pixelPositionVal="1%"!==(window.getComputedStyle(div,null)||{}).top,boxSizingReliableVal="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,contents=div.appendChild(document.createElement("div")),contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",contents.style.marginRight=contents.style.width="0",div.style.width="1px",reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight),div.removeChild(contents)),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",contents=div.getElementsByTagName("td"),contents[0].style.cssText="margin:0;border:0;padding:0;display:none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight,reliableHiddenOffsetsVal&&(contents[0].style.display="",contents[1].style.display="none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight),body.removeChild(container))}var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],style=a&&a.style,style&&(style.cssText="float:left;opacity:.5",support.opacity="0.5"===style.opacity,support.cssFloat=!!style.cssFloat,div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,support.boxSizing=""===style.boxSizing||""===style.MozBoxSizing||""===style.WebkitBoxSizing,jQuery.extend(support,{reliableHiddenOffsets:function(){return null==reliableHiddenOffsetsVal&&computeStyleTests(),reliableHiddenOffsetsVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computeStyleTests(),boxSizingReliableVal},pixelPosition:function(){return null==pixelPositionVal&&computeStyleTests(),pixelPositionVal},reliableMarginRight:function(){return null==reliableMarginRightVal&&computeStyleTests(),reliableMarginRightVal}}))}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),!(hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra)))))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input,div,select,a,opt;div=document.createElement("div"),div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px",support.getSetAttribute="t"!==div.className,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value}();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],(option.selected||i===index)&&(support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)if(option=options[i],jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0)try{option.selected=optionSet=!0}catch(_){option.scrollHeight}else option.selected=!1;return optionSet||(elem.selectedIndex=-1),options}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}:function(elem,name,isXML){return isXML?void 0:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:void 0}},attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;return isXML?void 0:(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:void 0},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}}})),support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||void 0},set:function(elem,value){return elem.style.cssText=value+""}});var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=void 0,delete this[name]}catch(e){}})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),support.enctype||(jQuery.propFix.enctype="encoding");var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/,rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data+"");var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){return requireNonComma&&comma&&(depth=0),0===depth?token:(requireNonComma=open||comma,depth+=!close-!open,"")}))?Function("return "+str)():jQuery.error("Invalid JSON: "+data)},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=void 0}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],
null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!support.reliableHiddenOffsets()&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var key in xhrCallbacks)xhrCallbacks[key](void 0,!0)}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)void 0!==headers[i]&&xhr.setRequestHeader(i,headers[i]+"");xhr.send(options.hasContent&&options.data||null),callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||4===xhr.readyState))if(delete xhrCallbacks[id],callback=void 0,xhr.onreadystatechange=jQuery.noop,isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!options.isLocal||options.crossDomain?1223===status&&(status=204):status=responses.text?200:404}responses&&complete(status,statusText,responses,xhr.getAllResponseHeaders())},options.async?4===xhr.readyState?setTimeout(callback):xhr.onreadystatechange=xhrCallbacks[id]=callback:callback()},abort:function(){callback&&callback(void 0,!0)}}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(void 0,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off,url.length)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery});
(function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function hasOwnProp(a,b){return hasOwnProperty.call(a,b)}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function printMsg(msg){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(printMsg(msg),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){deprecations[name]||(printMsg(msg),deprecations[name]=!0)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}function monthDiff(a,b){var anchor2,adjust,wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return 0>b-anchor?(anchor2=a.clone().add(wholeMonthDiff-1,"months"),adjust=(b-anchor)/(anchor-anchor2)):(anchor2=a.clone().add(wholeMonthDiff+1,"months"),adjust=(b-anchor)/(anchor2-anchor)),-(wholeMonthDiff+adjust)}function meridiemFixWrap(locale,hour,meridiem){var isPm;return null==meridiem?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?(isPm=locale.isPM(meridiem),isPm&&12>hour&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}function Locale(){}function Moment(config,skipOverflow){skipOverflow!==!1&&checkOverflow(config),copyConfig(this,config),this._d=new Date(+config._d),updateInProgress===!1&&(updateInProgress=!0,moment.updateOffset(this),updateInProgress=!1)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=moment.localeData(),this._bubble()}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function copyConfig(to,from){var i,prop,val;if("undefined"!=typeof from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),"undefined"!=typeof from._i&&(to._i=from._i),"undefined"!=typeof from._f&&(to._f=from._f),"undefined"!=typeof from._l&&(to._l=from._l),"undefined"!=typeof from._strict&&(to._strict=from._strict),"undefined"!=typeof from._tzm&&(to._tzm=from._tzm),"undefined"!=typeof from._isUTC&&(to._isUTC=from._isUTC),"undefined"!=typeof from._offset&&(to._offset=from._offset),"undefined"!=typeof from._pf&&(to._pf=from._pf),"undefined"!=typeof from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)prop=momentProperties[i],val=from[prop],"undefined"!=typeof val&&(to[prop]=val);return to}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return other=makeAs(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):(res=positiveMomentsDifference(other,base),res.milliseconds=-res.milliseconds,res.months=-res.months),res}function createAdder(direction,name){return function(val,period){var dur,tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,dur=moment.duration(val,period),addOrSubtractDurationFromMoment(this,dur,direction),this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")},null!=index)return getter(index);for(i=0;count>i;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>24||24===m._a[HOUR]&&(0!==m._a[MINUTE]||0!==m._a[SECOND]||0!==m._a[MILLISECOND])?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length&&m._pf.bigHour===undefined)),m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=normalizeLocale(names[i+1]),next=next?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule)try{oldLocale=moment.locale(),require("./locale/"+name),moment.locale(oldLocale)}catch(e){}return locales[name]}function makeAs(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(moment.isMoment(input)||isDate(input)?+input:+moment(input))-+res,res._d.setTime(+res._d+diff),moment.updateOffset(res,!1),res):moment(input).local()}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"x":return parseTokenOffsetMs;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return strict?config._locale._ordinalParse:config._locale._ordinalParseLenient;default:return a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function utcOffsetFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?minutes:-minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=config._locale.monthsParse(input,token,config._strict),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._meridiem=input;break;case"h":case"hh":config._pf.bigHour=!0;case"H":case"HH":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"x":config._d=new Date(toInt(input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=utcOffsetFromString(input);break;case"dd":case"ddd":case"dddd":a=config._locale.weekdaysParse(input),null!=a?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d,dow>weekday&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day||normalizedInput.date,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601)return void parseISO(config);config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._pf.bigHour===!0&&config._a[HOUR]<=12&&(config._pf.bigHour=undefined),config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),config._isValid===!1&&(delete config._isValid,moment.createFromInputFallback(config))}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function makeDateFromInput(config){var matched,input=config._i;input===undefined?config._d=new Date:isDate(input)?config._d=new Date(+input):null!==(matched=aspNetJsonRegex.exec(input))?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),dateFromConfig(config)):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function parseWeekday(input,locale){if("string"==typeof input)if(isNaN(input)){if(input=locale.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||1===months&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=+posNegDuration>0,args[4]=locale,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var daysToAdd,dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return d=0===d?7:d,weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(firstDayOfWeek>d?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var res,input=config._i,format=config._f;return config._locale=config._locale||moment.localeData(config._l),null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),moment.isMoment(input)?new Moment(input,!0):(format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),res=new Moment(config),res._nextDay&&(res.add(1,"d"),res._nextDay=undefined),res))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.localeData().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function daysToYears(days){return 400*days/146097}function yearsToDays(years){return 146097*years/400}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,shouldDeprecate?globalScope.moment=deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):globalScope.moment=moment)}for(var moment,oldGlobalMoment,i,VERSION="2.9.0",globalScope="undefined"==typeof global||"undefined"!=typeof window&&window!==global.window?this:global,round=Math.round,hasOwnProperty=Object.prototype.hasOwnProperty,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule="undefined"!=typeof module&&module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenOffsetMs=/[\+\-]?\d+/,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=this.utcOffset(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=this.utcOffset(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],updateInProgress=!1;ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Locale.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName,format,strict){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(mom=moment.utc([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom,now){var output=this._calendar[key];return"function"==typeof output?output.apply(mom,[now]):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=locale,c._strict=strict,c._isUTC=!1,
c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)},moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)},moment.utc=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=locale,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,diffRes,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))?(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(moment(duration.from),moment(duration.to)),duration={},duration.ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),moment.isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]===undefined?!1:limit===undefined?relativeTimeThresholds[threshold]:(relativeTimeThresholds[threshold]=limit,!0)},moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)}),moment.locale=function(key,values){var data;return key&&(data="undefined"!=typeof values?moment.defineLocale(key,values):moment.localeData(key),data&&(moment.duration._locale=moment._locale=data)),moment._locale._abbr},moment.defineLocale=function(name,values){return null!==values?(values.abbr=name,locales[name]||(locales[name]=new Locale),locales[name].set(values),moment.locale(name),locales[name]):(delete locales[name],null)},moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)}),moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return moment._locale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&hasOwnProp(obj,"_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(NaN);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},moment.isDate=isDate,extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toISODate:function(){return formatMoment(this,"YYYY-MM-DD")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return this._a?this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0:!1},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},local:function(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(that.utcOffset()-this.utcOffset());return units=normalizeUnits(units),"year"===units||"month"===units||"quarter"===units?(output=monthDiff(this,that),"quarter"===units?output/=3:"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this,moment(now)))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),units===undefined||"millisecond"===units?this:this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")},isAfter:function(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this>+input):(inputMs=moment.isMoment(input)?+input:+moment(input),inputMs<+this.clone().startOf(units))},isBefore:function(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+input>+this):(inputMs=moment.isMoment(input)?+input:+moment(input),+this.clone().endOf(units)<inputMs)},isBetween:function(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)},isSame:function(input,units){var inputMs;return units=normalizeUnits(units||"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this===+input):(inputMs=+moment(input),+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units))},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),this>other?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other>this?this:other}),zone:deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}),utcOffset:function(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null!=input?("string"==typeof input&&(input=utcOffsetFromString(input)),Math.abs(input)<16&&(input=60*input),!this._isUTC&&keepLocalTime&&(localAdjust=this._dateUtcOffset()),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?offset:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(utcOffsetFromString(this._i)),this},hasAlignedHourOffset:function(input){return input=input?moment(input).utcOffset():0,(this.utcOffset()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){var unit;if("object"==typeof units)for(unit in units)this.set(unit,units[unit]);else units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value);return this},locale:function(key){var newLocaleData;return key===undefined?this._locale._abbr:(newLocaleData=moment.localeData(key),null!=newLocaleData&&(this._locale=newLocaleData),this)},lang:deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return key===undefined?this.localeData():this.locale(key)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,moment.fn.isUTC=moment.fn.isUtc,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,years=0;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),years=absRound(daysToYears(days)),days-=absRound(yearsToDays(years)),months+=absRound(days/30),days%=30,years+=absRound(months/12),months%=12,data.days=days,data.months=months,data.years=years},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());return withSuffix&&(output=this.localeData().pastFuture(+this,output)),this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){var days,months;if(units=normalizeUnits(units),"month"===units||"year"===units)return days=this._days+this._milliseconds/864e5,months=this._months+12*daysToYears(days),"month"===units?months:months/12;switch(days=this._days+Math.round(yearsToDays(this._months/12)),units){case"week":return days/7+this._milliseconds/6048e5;case"day":return days+this._milliseconds/864e5;case"hour":return 24*days+this._milliseconds/36e5;case"minute":return 24*days*60+this._milliseconds/6e4;case"second":return 24*days*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*days*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+units)}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),moment.duration.fn.toString=moment.duration.fn.toISOString;for(i in unitMillisecondFactors)hasOwnProp(unitMillisecondFactors,i)&&makeDurationGetter(i.toLowerCase());moment.duration.fn.asMilliseconds=function(){return this.as("ms")},moment.duration.fn.asSeconds=function(){return this.as("s")},moment.duration.fn.asMinutes=function(){return this.as("m")},moment.duration.fn.asHours=function(){return this.as("h")},moment.duration.fn.asDays=function(){return this.as("d")},moment.duration.fn.asWeeks=function(){return this.as("weeks")},moment.duration.fn.asMonths=function(){return this.as("M")},moment.duration.fn.asYears=function(){return this.as("y")},moment.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define(function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}).call(this);
!function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["moment"],factory):"object"==typeof exports?module.exports=factory(require("moment")):factory(root.moment)}(this,function(moment){"use strict";function charCodeToInt(charCode){return charCode>96?charCode-87:charCode>64?charCode-29:charCode-48}function unpackBase60(string){var num,i=0,parts=string.split("."),whole=parts[0],fractional=parts[1]||"",multiplier=1,out=0,sign=1;for(45===string.charCodeAt(0)&&(i=1,sign=-1),i;i<whole.length;i++)num=charCodeToInt(whole.charCodeAt(i)),out=60*out+num;for(i=0;i<fractional.length;i++)multiplier/=60,num=charCodeToInt(fractional.charCodeAt(i)),out+=num*multiplier;return out*sign}function arrayToInt(array){for(var i=0;i<array.length;i++)array[i]=unpackBase60(array[i])}function intToUntil(array,length){for(var i=0;length>i;i++)array[i]=Math.round((array[i-1]||0)+6e4*array[i]);array[length-1]=1/0}function mapIndices(source,indices){var i,out=[];for(i=0;i<indices.length;i++)out[i]=source[indices[i]];return out}function unpack(string){var data=string.split("|"),offsets=data[2].split(" "),indices=data[3].split(""),untils=data[4].split(" ");return arrayToInt(offsets),arrayToInt(indices),arrayToInt(untils),intToUntil(untils,indices.length),{name:data[0],abbrs:mapIndices(data[1].split(" "),indices),offsets:mapIndices(offsets,indices),untils:untils}}function Zone(packedString){packedString&&this._set(unpack(packedString))}function normalizeName(name){return(name||"").toLowerCase().replace(/\//g,"_")}function addZone(packed){var i,zone,zoneName;for("string"==typeof packed&&(packed=[packed]),i=0;i<packed.length;i++)zone=new Zone(packed[i]),zoneName=normalizeName(zone.name),zones[zoneName]=zone,upgradeLinksToZones(zoneName)}function getZone(name){return zones[normalizeName(name)]||null}function getNames(){var i,out=[];for(i in zones)zones.hasOwnProperty(i)&&zones[i]&&out.push(zones[i].name);return out.sort()}function addLink(aliases){var i,alias;for("string"==typeof aliases&&(aliases=[aliases]),i=0;i<aliases.length;i++)alias=aliases[i].split("|"),pushLink(alias[0],alias[1]),pushLink(alias[1],alias[0])}function upgradeLinksToZones(zoneName){if(links[zoneName]){var i,zone=zones[zoneName],linkNames=links[zoneName];for(i=0;i<linkNames.length;i++)copyZoneWithName(zone,linkNames[i]);links[zoneName]=null}}function copyZoneWithName(zone,name){var linkZone=zones[normalizeName(name)]=new Zone;linkZone._set(zone),linkZone.name=name}function pushLink(zoneName,linkName){zoneName=normalizeName(zoneName),zones[zoneName]?copyZoneWithName(zones[zoneName],linkName):(links[zoneName]=links[zoneName]||[],links[zoneName].push(linkName))}function loadData(data){addZone(data.zones),addLink(data.links),tz.dataVersion=data.version}function zoneExists(name){return zoneExists.didShowError||(zoneExists.didShowError=!0,logError("moment.tz.zoneExists('"+name+"') has been deprecated in favor of !moment.tz.zone('"+name+"')")),!!getZone(name)}function needsOffset(m){return!(!m._a||void 0!==m._tzm)}function logError(message){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message)}function tz(){var args=Array.prototype.slice.call(arguments,0,-1),name=arguments[arguments.length-1],zone=getZone(name),out=moment.utc.apply(null,args);return zone&&needsOffset(out)&&out.add(zone.parse(out),"minutes"),out.tz(name),out}function abbrWrap(old){return function(){return this._z?this._z.abbr(this):old.call(this)}}function resetZoneWrap(old){return function(){return this._z=null,old.apply(this,arguments)}}if(void 0!==moment.tz)return moment;var VERSION="0.2.5",zones={},links={},momentVersion=moment.version.split("."),major=+momentVersion[0],minor=+momentVersion[1];(2>major||2===major&&6>minor)&&logError("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+moment.version+". See momentjs.com"),Zone.prototype={_set:function(unpacked){this.name=unpacked.name,this.abbrs=unpacked.abbrs,this.untils=unpacked.untils,this.offsets=unpacked.offsets},_index:function(timestamp){var i,target=+timestamp,untils=this.untils;for(i=0;i<untils.length;i++)if(target<untils[i])return i},parse:function(timestamp){var offset,offsetNext,offsetPrev,i,target=+timestamp,offsets=this.offsets,untils=this.untils,max=untils.length-1;for(i=0;max>i;i++)if(offset=offsets[i],offsetNext=offsets[i+1],offsetPrev=offsets[i?i-1:i],offsetNext>offset&&tz.moveAmbiguousForward?offset=offsetNext:offset>offsetPrev&&tz.moveInvalidForward&&(offset=offsetPrev),target<untils[i]-6e4*offset)return offsets[i];return offsets[max]},abbr:function(mom){return this.abbrs[this._index(mom)]},offset:function(mom){return this.offsets[this._index(mom)]}},tz.version=VERSION,tz.dataVersion="",tz._zones=zones,tz._links=links,tz.add=addZone,tz.link=addLink,tz.load=loadData,tz.zone=getZone,tz.zoneExists=zoneExists,tz.names=getNames,tz.Zone=Zone,tz.unpack=unpack,tz.unpackBase60=unpackBase60,tz.needsOffset=needsOffset,tz.moveInvalidForward=!0,tz.moveAmbiguousForward=!1;var fn=moment.fn;moment.tz=tz,moment.updateOffset=function(mom,keepTime){var offset;mom._z&&(offset=mom._z.offset(mom),Math.abs(offset)<16&&(offset/=60),mom.zone(offset,keepTime))},fn.tz=function(name){return name?(this._z=getZone(name),this._z?moment.updateOffset(this):logError("Moment Timezone has no data for "+name+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},fn.zoneName=abbrWrap(fn.zoneName),fn.zoneAbbr=abbrWrap(fn.zoneAbbr),fn.utc=resetZoneWrap(fn.utc);var momentProperties=moment.momentProperties;return"[object Array]"===Object.prototype.toString.call(momentProperties)?(momentProperties.push("_z"),momentProperties.push("_a")):momentProperties&&(momentProperties._z=null),loadData({version:"2014j",zones:["Africa/Abidjan|GMT|0|0|","Africa/Addis_Ababa|EAT|-30|0|","Africa/Algiers|CET|-10|0|","Africa/Bangui|WAT|-10|0|","Africa/Blantyre|CAT|-20|0|","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010|1Cby0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0 1o10 jz0 gN0 pb0 1qN0 dX0 e10 xz0 1o10 bb0 e10 An0 1o10 5z0 e10 FX0 1o10 2L0 e10 IL0 1C10 Lz0","Africa/Casablanca|WET WEST|0 -10|01010101010101010101010101010101010101010|1Cco0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uo0 e00 DA0 11A0 rA0 e00 Jc0 WM0 m00 gM0 M00 WM0 jc0 e00 RA0 11A0 dA0 e00 Uo0 11A0 800 gM0 Xc0","Africa/Ceuta|CET CEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Africa/Johannesburg|SAST|-20|0|","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00","Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1C1c0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0","America/Adak|HAST HADT|a0 90|01010101010101010101010|1BR00 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1BQX0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anguilla|AST|40|0|","America/Araguaina|BRT BRST|30 20|010|1IdD0 Lz0","America/Argentina/Buenos_Aires|ART|30|0|","America/Asuncion|PYST PYT|30 40|01010101010101010101010|1C430 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0","America/Atikokan|EST|50|0|","America/Bahia|BRT BRST|30 20|010|1FJf0 Rb0","America/Bahia_Banderas|MST CDT CST|70 50 60|01212121212121212121212|1C1l0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Belem|BRT|30|0|","America/Belize|CST|60|0|","America/Boa_Vista|AMT|40|0|","America/Bogota|COT|50|0|","America/Boise|MST MDT|70 60|01010101010101010101010|1BQV0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Campo_Grande|AMST AMT|30 40|01010101010101010101010|1BIr0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10","America/Cancun|CST CDT|60 50|01010101010101010101010|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Caracas|VET|4u|0|","America/Cayenne|GFT|30|0|","America/Chicago|CST CDT|60 50|01010101010101010101010|1BQU0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1C1l0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Creston|MST|70|0|","America/Dawson|PST PDT|80 70|01010101010101010101010|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Detroit|EST EDT|50 40|01010101010101010101010|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Eirunepe|AMT ACT|40 50|01|1KLE0","America/Glace_Bay|AST ADT|40 30|01010101010101010101010|1BQS0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Godthab|WGT WGST|30 20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/Goose_Bay|AST ADT|40 30|01010101010101010101010|1BQQ1 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Grand_Turk|EST EDT AST|50 40 40|0101010101012|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Guayaquil|ECT|50|0|","America/Guyana|GYT|40|0|","America/Havana|CST CDT|50 40|01010101010101010101010|1BQR0 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0","America/La_Paz|BOT|40|0|","America/Lima|PET|50|0|","America/Metlakatla|PST|80|0|","America/Miquelon|PMST PMDT|30 20|01010101010101010101010|1BQR0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Montevideo|UYST UYT|20 30|01010101010101010101010|1BQQ0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10","America/Noronha|FNT|20|0|","America/North_Dakota/Beulah|MST MDT CST CDT|70 60 60 50|01232323232323232323232|1BQV0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Paramaribo|SRT|30|0|","America/Port-au-Prince|EST EDT|50 40|0101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Santa_Isabel|PST PDT|80 70|01010101010101010101010|1C1m0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Santiago|CLST CLT|30 40|01010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","America/Sao_Paulo|BRST BRT|20 30|01010101010101010101010|1BIq0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10","America/Scoresbysund|EGT EGST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1BQPv 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Antarctica/Casey|CAST AWST|-b0 -80|0101|1BN30 40P0 KL0","Antarctica/Davis|DAVT DAVT|-50 -70|0101|1BPw0 3Wn0 KN0","Antarctica/DumontDUrville|DDUT|-a0|0|","Antarctica/Macquarie|AEDT MIST|-b0 -b0|01|1C140","Antarctica/Mawson|MAWT|-50|0|","Antarctica/McMurdo|NZDT NZST|-d0 -c0|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Antarctica/Rothera|ROTT|30|0|","Antarctica/Syowa|SYOT|-30|0|","Antarctica/Troll|UTC CEST|0 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Antarctica/Vostok|VOST|-60|0|","Asia/Aden|AST|-30|0|","Asia/Almaty|ALMT|-60|0|","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1BVy0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0","Asia/Anadyr|ANAT ANAST ANAT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0","Asia/Aqtau|AQTT|-50|0|","Asia/Ashgabat|TMT|-50|0|","Asia/Baku|AZT AZST|-40 -50|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Bangkok|ICT|-70|0|","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1BWm0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0","Asia/Bishkek|KGT|-60|0|","Asia/Brunei|BNT|-80|0|","Asia/Calcutta|IST|-5u|0|","Asia/Chita|YAKT YAKST YAKT IRKT|-90 -a0 -a0 -80|01023|1BWh0 1qM0 WM0 8Hz0","Asia/Choibalsan|CHOT|-80|0|","Asia/Chongqing|CST|-80|0|","Asia/Dacca|BDT|-60|0|","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1C0m0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0","Asia/Dili|TLT|-90|0|","Asia/Dubai|GST|-40|0|","Asia/Dushanbe|TJT|-50|0|","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1BVW1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hebron|EET EEST|-20 -30|0101010101010101010101010|1BVy0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hong_Kong|HKT|-80|0|","Asia/Hovd|HOVT|-70|0|","Asia/Irkutsk|IRKT IRKST IRKT|-80 -90 -90|01020|1BWi0 1qM0 WM0 8Hz0","Asia/Istanbul|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Jakarta|WIB|-70|0|","Asia/Jayapura|WIT|-90|0|","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1BVA0 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0","Asia/Kabul|AFT|-4u|0|","Asia/Kamchatka|PETT PETST PETT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0","Asia/Karachi|PKT|-50|0|","Asia/Kashgar|XJT|-60|0|","Asia/Kathmandu|NPT|-5J|0|","Asia/Khandyga|VLAT VLAST VLAT YAKT YAKT|-a0 -b0 -b0 -a0 -90|010234|1BWg0 1qM0 WM0 17V0 7zD0","Asia/Krasnoyarsk|KRAT KRAST KRAT|-70 -80 -80|01020|1BWj0 1qM0 WM0 8Hz0","Asia/Kuala_Lumpur|MYT|-80|0|","Asia/Magadan|MAGT MAGST MAGT MAGT|-b0 -c0 -c0 -a0|01023|1BWf0 1qM0 WM0 8Hz0","Asia/Makassar|WITA|-80|0|","Asia/Manila|PHT|-80|0|","Asia/Nicosia|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Novokuznetsk|KRAT NOVST NOVT NOVT|-70 -70 -60 -70|01230|1BWj0 1qN0 WM0 8Hz0","Asia/Novosibirsk|NOVT NOVST NOVT|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0","Asia/Omsk|OMST OMSST OMST|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0","Asia/Oral|ORAT|-50|0|","Asia/Pyongyang|KST|-90|0|","Asia/Qyzylorda|QYZT|-60|0|","Asia/Rangoon|MMT|-6u|0|","Asia/Sakhalin|SAKT SAKST SAKT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0","Asia/Samarkand|UZT|-50|0|","Asia/Singapore|SGT|-80|0|","Asia/Srednekolymsk|MAGT MAGST MAGT SRET|-b0 -c0 -c0 -b0|01023|1BWf0 1qM0 WM0 8Hz0","Asia/Tbilisi|GET|-40|0|","Asia/Tehran|IRST IRDT|-3u -4u|01010101010101010101010|1BTUu 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0","Asia/Thimbu|BTT|-60|0|","Asia/Tokyo|JST|-90|0|","Asia/Ulaanbaatar|ULAT|-80|0|","Asia/Ust-Nera|MAGT MAGST MAGT VLAT VLAT|-b0 -c0 -c0 -b0 -a0|010234|1BWf0 1qM0 WM0 17V0 7zD0","Asia/Vladivostok|VLAT VLAST VLAT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0","Asia/Yakutsk|YAKT YAKST YAKT|-90 -a0 -a0|01020|1BWh0 1qM0 WM0 8Hz0","Asia/Yekaterinburg|YEKT YEKST YEKT|-50 -60 -60|01020|1BWl0 1qM0 WM0 8Hz0","Asia/Yerevan|AMT AMST|-40 -50|01010|1BWm0 1qM0 WM0 1qM0","Atlantic/Azores|AZOT AZOST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Canary|WET WEST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Cape_Verde|CVT|10|0|","Atlantic/South_Georgia|GST|20|0|","Atlantic/Stanley|FKST FKT|30 40|010|1C6R0 U10","Australia/ACT|AEDT AEST|-b0 -a0|01010101010101010101010|1C140 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1C14u 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Brisbane|AEST|-a0|0|","Australia/Darwin|ACST|-9u|0|","Australia/Eucla|ACWST|-8J|0|","Australia/LHI|LHDT LHST|-b0 -au|01010101010101010101010|1C130 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu","Australia/Perth|AWST|-80|0|","Chile/EasterIsland|EASST EAST|50 60|01010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","Eire|GMT IST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Belfast|GMT BST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Kaliningrad|EET EEST FET|-20 -30 -30|01020|1BWo0 1qM0 WM0 8Hz0","Europe/Minsk|EET EEST FET MSK|-20 -30 -30 -30|01023|1BWo0 1qM0 WM0 8Hy0","Europe/Moscow|MSK MSD MSK|-30 -40 -40|01020|1BWn0 1qM0 WM0 8Hz0","Europe/Samara|SAMT SAMST SAMT|-40 -40 -30|0120|1BWm0 1qN0 WM0","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|01010101023|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0","Europe/Volgograd|MSK MSK|-30 -40|01010|1BWn0 1qM0 WM0 8Hz0","HST|HST|a0|0|","Indian/Chagos|IOT|-60|0|","Indian/Christmas|CXT|-70|0|","Indian/Cocos|CCT|-6u|0|","Indian/Kerguelen|TFT|-50|0|","Indian/Mahe|SCT|-40|0|","Indian/Maldives|MVT|-50|0|","Indian/Mauritius|MUT|-40|0|","Indian/Reunion|RET|-40|0|","Kwajalein|MHT|-c0|0|","MET|MET MEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","NZ-CHAT|CHADT CHAST|-dJ -cJ|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Apia|SST SDT WSDT WSST|b0 a0 -e0 -d0|01012323232323232323232|1Dbn0 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Bougainville|PGT BST|-a0 -b0|01|1NwE0","Pacific/Chuuk|CHUT|-a0|0|","Pacific/Efate|VUT|-b0|0|","Pacific/Enderbury|PHOT|-d0|0|","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0","Pacific/Fiji|FJST FJT|-d0 -c0|01010101010101010101010|1BWe0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 xA0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0","Pacific/Funafuti|TVT|-c0|0|","Pacific/Galapagos|GALT|60|0|","Pacific/Gambier|GAMT|90|0|","Pacific/Guadalcanal|SBT|-b0|0|","Pacific/Guam|ChST|-a0|0|","Pacific/Kiritimati|LINT|-e0|0|","Pacific/Kosrae|KOST|-b0|0|","Pacific/Marquesas|MART|9u|0|","Pacific/Midway|SST|b0|0|","Pacific/Nauru|NRT|-c0|0|","Pacific/Niue|NUT|b0|0|","Pacific/Norfolk|NFT|-bu|0|","Pacific/Noumea|NCT|-b0|0|","Pacific/Palau|PWT|-90|0|","Pacific/Pohnpei|PONT|-b0|0|","Pacific/Port_Moresby|PGT|-a0|0|","Pacific/Rarotonga|CKT|a0|0|","Pacific/Tahiti|TAHT|a0|0|","Pacific/Tarawa|GILT|-c0|0|","Pacific/Tongatapu|TOT|-d0|0|","Pacific/Wake|WAKT|-c0|0|","Pacific/Wallis|WFT|-c0|0|"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Addis_Ababa|Africa/Asmara","Africa/Addis_Ababa|Africa/Asmera","Africa/Addis_Ababa|Africa/Dar_es_Salaam","Africa/Addis_Ababa|Africa/Djibouti","Africa/Addis_Ababa|Africa/Juba","Africa/Addis_Ababa|Africa/Kampala","Africa/Addis_Ababa|Africa/Khartoum","Africa/Addis_Ababa|Africa/Mogadishu","Africa/Addis_Ababa|Africa/Nairobi","Africa/Addis_Ababa|Indian/Antananarivo","Africa/Addis_Ababa|Indian/Comoro","Africa/Addis_Ababa|Indian/Mayotte","Africa/Algiers|Africa/Tunis","Africa/Bangui|Africa/Brazzaville","Africa/Bangui|Africa/Douala","Africa/Bangui|Africa/Kinshasa","Africa/Bangui|Africa/Lagos","Africa/Bangui|Africa/Libreville","Africa/Bangui|Africa/Luanda","Africa/Bangui|Africa/Malabo","Africa/Bangui|Africa/Ndjamena","Africa/Bangui|Africa/Niamey","Africa/Bangui|Africa/Porto-Novo","Africa/Blantyre|Africa/Bujumbura","Africa/Blantyre|Africa/Gaborone","Africa/Blantyre|Africa/Harare","Africa/Blantyre|Africa/Kigali","Africa/Blantyre|Africa/Lubumbashi","Africa/Blantyre|Africa/Lusaka","Africa/Blantyre|Africa/Maputo","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Ceuta|Arctic/Longyearbyen","Africa/Ceuta|Atlantic/Jan_Mayen","Africa/Ceuta|CET","Africa/Ceuta|Europe/Amsterdam","Africa/Ceuta|Europe/Andorra","Africa/Ceuta|Europe/Belgrade","Africa/Ceuta|Europe/Berlin","Africa/Ceuta|Europe/Bratislava","Africa/Ceuta|Europe/Brussels","Africa/Ceuta|Europe/Budapest","Africa/Ceuta|Europe/Busingen","Africa/Ceuta|Europe/Copenhagen","Africa/Ceuta|Europe/Gibraltar","Africa/Ceuta|Europe/Ljubljana","Africa/Ceuta|Europe/Luxembourg","Africa/Ceuta|Europe/Madrid","Africa/Ceuta|Europe/Malta","Africa/Ceuta|Europe/Monaco","Africa/Ceuta|Europe/Oslo","Africa/Ceuta|Europe/Paris","Africa/Ceuta|Europe/Podgorica","Africa/Ceuta|Europe/Prague","Africa/Ceuta|Europe/Rome","Africa/Ceuta|Europe/San_Marino","Africa/Ceuta|Europe/Sarajevo","Africa/Ceuta|Europe/Skopje","Africa/Ceuta|Europe/Stockholm","Africa/Ceuta|Europe/Tirane","Africa/Ceuta|Europe/Vaduz","Africa/Ceuta|Europe/Vatican","Africa/Ceuta|Europe/Vienna","Africa/Ceuta|Europe/Warsaw","Africa/Ceuta|Europe/Zagreb","Africa/Ceuta|Europe/Zurich","Africa/Ceuta|Poland","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Anguilla|America/Antigua","America/Anguilla|America/Aruba","America/Anguilla|America/Barbados","America/Anguilla|America/Blanc-Sablon","America/Anguilla|America/Curacao","America/Anguilla|America/Dominica","America/Anguilla|America/Grenada","America/Anguilla|America/Guadeloupe","America/Anguilla|America/Kralendijk","America/Anguilla|America/Lower_Princes","America/Anguilla|America/Marigot","America/Anguilla|America/Martinique","America/Anguilla|America/Montserrat","America/Anguilla|America/Port_of_Spain","America/Anguilla|America/Puerto_Rico","America/Anguilla|America/Santo_Domingo","America/Anguilla|America/St_Barthelemy","America/Anguilla|America/St_Kitts","America/Anguilla|America/St_Lucia","America/Anguilla|America/St_Thomas","America/Anguilla|America/St_Vincent","America/Anguilla|America/Tortola","America/Anguilla|America/Virgin","America/Argentina/Buenos_Aires|America/Argentina/Catamarca","America/Argentina/Buenos_Aires|America/Argentina/ComodRivadavia","America/Argentina/Buenos_Aires|America/Argentina/Cordoba","America/Argentina/Buenos_Aires|America/Argentina/Jujuy","America/Argentina/Buenos_Aires|America/Argentina/La_Rioja","America/Argentina/Buenos_Aires|America/Argentina/Mendoza","America/Argentina/Buenos_Aires|America/Argentina/Rio_Gallegos","America/Argentina/Buenos_Aires|America/Argentina/Salta","America/Argentina/Buenos_Aires|America/Argentina/San_Juan","America/Argentina/Buenos_Aires|America/Argentina/San_Luis","America/Argentina/Buenos_Aires|America/Argentina/Tucuman","America/Argentina/Buenos_Aires|America/Argentina/Ushuaia","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Buenos_Aires|America/Catamarca","America/Argentina/Buenos_Aires|America/Cordoba","America/Argentina/Buenos_Aires|America/Jujuy","America/Argentina/Buenos_Aires|America/Mendoza","America/Argentina/Buenos_Aires|America/Rosario","America/Atikokan|America/Cayman","America/Atikokan|America/Coral_Harbour","America/Atikokan|America/Jamaica","America/Atikokan|America/Panama","America/Atikokan|EST","America/Atikokan|Jamaica","America/Belem|America/Fortaleza","America/Belem|America/Maceio","America/Belem|America/Recife","America/Belem|America/Santarem","America/Belize|America/Costa_Rica","America/Belize|America/El_Salvador","America/Belize|America/Guatemala","America/Belize|America/Managua","America/Belize|America/Regina","America/Belize|America/Swift_Current","America/Belize|America/Tegucigalpa","America/Belize|Canada/East-Saskatchewan","America/Belize|Canada/Saskatchewan","America/Boa_Vista|America/Manaus","America/Boa_Vista|America/Porto_Velho","America/Boa_Vista|Brazil/West","America/Boise|America/Cambridge_Bay","America/Boise|America/Denver","America/Boise|America/Edmonton","America/Boise|America/Inuvik","America/Boise|America/Ojinaga","America/Boise|America/Shiprock","America/Boise|America/Yellowknife","America/Boise|Canada/Mountain","America/Boise|MST7MDT","America/Boise|Navajo","America/Boise|US/Mountain","America/Campo_Grande|America/Cuiaba","America/Cancun|America/Merida","America/Cancun|America/Mexico_City","America/Cancun|America/Monterrey","America/Cancun|Mexico/General","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Creston|America/Dawson_Creek","America/Creston|America/Hermosillo","America/Creston|America/Phoenix","America/Creston|MST","America/Creston|US/Arizona","America/Dawson|America/Ensenada","America/Dawson|America/Los_Angeles","America/Dawson|America/Tijuana","America/Dawson|America/Vancouver","America/Dawson|America/Whitehorse","America/Dawson|Canada/Pacific","America/Dawson|Canada/Yukon","America/Dawson|Mexico/BajaNorte","America/Dawson|PST8PDT","America/Dawson|US/Pacific","America/Dawson|US/Pacific-New","America/Detroit|America/Fort_Wayne","America/Detroit|America/Indiana/Indianapolis","America/Detroit|America/Indiana/Marengo","America/Detroit|America/Indiana/Petersburg","America/Detroit|America/Indiana/Vevay","America/Detroit|America/Indiana/Vincennes","America/Detroit|America/Indiana/Winamac","America/Detroit|America/Indianapolis","America/Detroit|America/Iqaluit","America/Detroit|America/Kentucky/Louisville","America/Detroit|America/Kentucky/Monticello","America/Detroit|America/Louisville","America/Detroit|America/Montreal","America/Detroit|America/Nassau","America/Detroit|America/New_York","America/Detroit|America/Nipigon","America/Detroit|America/Pangnirtung","America/Detroit|America/Thunder_Bay","America/Detroit|America/Toronto","America/Detroit|Canada/Eastern","America/Detroit|EST5EDT","America/Detroit|US/East-Indiana","America/Detroit|US/Eastern","America/Detroit|US/Michigan","America/Eirunepe|America/Porto_Acre","America/Eirunepe|America/Rio_Branco","America/Eirunepe|Brazil/Acre","America/Glace_Bay|America/Halifax","America/Glace_Bay|America/Moncton","America/Glace_Bay|America/Thule","America/Glace_Bay|Atlantic/Bermuda","America/Glace_Bay|Canada/Atlantic","America/Havana|Cuba","America/Metlakatla|Pacific/Pitcairn","America/Noronha|Brazil/DeNoronha","America/Santiago|Antarctica/Palmer","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/McMurdo|Antarctica/South_Pole","Antarctica/McMurdo|NZ","Antarctica/McMurdo|Pacific/Auckland","Asia/Aden|Asia/Baghdad","Asia/Aden|Asia/Bahrain","Asia/Aden|Asia/Kuwait","Asia/Aden|Asia/Qatar","Asia/Aden|Asia/Riyadh","Asia/Aqtau|Asia/Aqtobe","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Calcutta|Asia/Colombo","Asia/Calcutta|Asia/Kolkata","Asia/Chongqing|Asia/Chungking","Asia/Chongqing|Asia/Harbin","Asia/Chongqing|Asia/Macao","Asia/Chongqing|Asia/Macau","Asia/Chongqing|Asia/Shanghai","Asia/Chongqing|Asia/Taipei","Asia/Chongqing|PRC","Asia/Chongqing|ROC","Asia/Dacca|Asia/Dhaka","Asia/Dubai|Asia/Muscat","Asia/Hong_Kong|Hongkong","Asia/Istanbul|Europe/Istanbul","Asia/Istanbul|Turkey","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kashgar|Asia/Urumqi","Asia/Kathmandu|Asia/Katmandu","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|EET","Asia/Nicosia|Europe/Athens","Asia/Nicosia|Europe/Bucharest","Asia/Nicosia|Europe/Chisinau","Asia/Nicosia|Europe/Helsinki","Asia/Nicosia|Europe/Kiev","Asia/Nicosia|Europe/Mariehamn","Asia/Nicosia|Europe/Nicosia","Asia/Nicosia|Europe/Riga","Asia/Nicosia|Europe/Sofia","Asia/Nicosia|Europe/Tallinn","Asia/Nicosia|Europe/Tiraspol","Asia/Nicosia|Europe/Uzhgorod","Asia/Nicosia|Europe/Vilnius","Asia/Nicosia|Europe/Zaporozhye","Asia/Pyongyang|Asia/Seoul","Asia/Pyongyang|ROK","Asia/Samarkand|Asia/Tashkent","Asia/Singapore|Singapore","Asia/Tehran|Iran","Asia/Thimbu|Asia/Thimphu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Atlantic/Canary|Atlantic/Faeroe","Atlantic/Canary|Atlantic/Faroe","Atlantic/Canary|Atlantic/Madeira","Atlantic/Canary|Europe/Lisbon","Atlantic/Canary|Portugal","Atlantic/Canary|WET","Australia/ACT|Australia/Canberra","Australia/ACT|Australia/Currie","Australia/ACT|Australia/Hobart","Australia/ACT|Australia/Melbourne","Australia/ACT|Australia/NSW","Australia/ACT|Australia/Sydney","Australia/ACT|Australia/Tasmania","Australia/ACT|Australia/Victoria","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/LHI|Australia/Lord_Howe","Australia/Perth|Australia/West","Chile/EasterIsland|Pacific/Easter","Eire|Europe/Dublin","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belfast|Europe/Guernsey","Europe/Belfast|Europe/Isle_of_Man","Europe/Belfast|Europe/Jersey","Europe/Belfast|Europe/London","Europe/Belfast|GB","Europe/Belfast|GB-Eire","Europe/Moscow|W-SU","HST|Pacific/Honolulu","HST|Pacific/Johnston","HST|US/Hawaii","Kwajalein|Pacific/Kwajalein","Kwajalein|Pacific/Majuro","NZ-CHAT|Pacific/Chatham","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Guam|Pacific/Saipan","Pacific/Midway|Pacific/Pago_Pago","Pacific/Midway|Pacific/Samoa","Pacific/Midway|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]
}),moment});
!function(root,undefined){function isString(obj){return!!(""===obj||obj&&obj.charCodeAt&&obj.substr)}function isArray(obj){return nativeIsArray?nativeIsArray(obj):"[object Array]"===toString.call(obj)}function isObject(obj){return"[object Object]"===toString.call(obj)}function defaults(object,defs){var key;object=object||{},defs=defs||{};for(key in defs)defs.hasOwnProperty(key)&&null==object[key]&&(object[key]=defs[key]);return object}function map(obj,iterator,context){var i,j,results=[];if(!obj)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);for(i=0,j=obj.length;j>i;i++)results[i]=iterator.call(context,obj[i],i,obj);return results}function checkPrecision(val,base){return val=Math.round(Math.abs(val)),isNaN(val)?base:val}function checkCurrencyFormat(format){var defaults=lib.settings.currency.format;return"function"==typeof format&&(format=format()),isString(format)&&format.match("%v")?{pos:format,neg:format.replace("-","").replace("%v","-%v"),zero:format}:format&&format.pos&&format.pos.match("%v")?format:isString(defaults)?lib.settings.currency.format={pos:defaults,neg:defaults.replace("%v","-%v"),zero:defaults}:defaults}var lib={};lib.version="0.3.2",lib.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var nativeMap=Array.prototype.map,nativeIsArray=Array.isArray,toString=Object.prototype.toString,unformat=lib.unformat=lib.parse=function(value,decimal){if(isArray(value))return map(value,function(val){return unformat(val,decimal)});if(value=value||0,"number"==typeof value)return value;decimal=decimal||".";var regex=new RegExp("[^0-9-"+decimal+"]",["g"]),unformatted=parseFloat((""+value).replace(/\((.*)\)/,"-$1").replace(regex,"").replace(decimal,"."));return isNaN(unformatted)?0:unformatted},toFixed=lib.toFixed=function(value,precision){precision=checkPrecision(precision,lib.settings.number.precision);var power=Math.pow(10,precision);return(Math.round(lib.unformat(value)*power)/power).toFixed(precision)},formatNumber=lib.formatNumber=function(number,precision,thousand,decimal){if(isArray(number))return map(number,function(val){return formatNumber(val,precision,thousand,decimal)});number=unformat(number);var opts=defaults(isObject(precision)?precision:{precision:precision,thousand:thousand,decimal:decimal},lib.settings.number),usePrecision=checkPrecision(opts.precision),negative=0>number?"-":"",base=parseInt(toFixed(Math.abs(number||0),usePrecision),10)+"",mod=base.length>3?base.length%3:0;return negative+(mod?base.substr(0,mod)+opts.thousand:"")+base.substr(mod).replace(/(\d{3})(?=\d)/g,"$1"+opts.thousand)+(usePrecision?opts.decimal+toFixed(Math.abs(number),usePrecision).split(".")[1]:"")},formatMoney=lib.formatMoney=function(number,symbol,precision,thousand,decimal,format){if(isArray(number))return map(number,function(val){return formatMoney(val,symbol,precision,thousand,decimal,format)});number=unformat(number);var opts=defaults(isObject(symbol)?symbol:{symbol:symbol,precision:precision,thousand:thousand,decimal:decimal,format:format},lib.settings.currency),formats=checkCurrencyFormat(opts.format),useFormat=number>0?formats.pos:0>number?formats.neg:formats.zero;return useFormat.replace("%s",opts.symbol).replace("%v",formatNumber(Math.abs(number),checkPrecision(opts.precision),opts.thousand,opts.decimal))};lib.formatColumn=function(list,symbol,precision,thousand,decimal,format){if(!list)return[];var opts=defaults(isObject(symbol)?symbol:{symbol:symbol,precision:precision,thousand:thousand,decimal:decimal,format:format},lib.settings.currency),formats=checkCurrencyFormat(opts.format),padAfterSymbol=formats.pos.indexOf("%s")<formats.pos.indexOf("%v")?!0:!1,maxLength=0,formatted=map(list,function(val,i){if(isArray(val))return lib.formatColumn(val,opts);val=unformat(val);var useFormat=val>0?formats.pos:0>val?formats.neg:formats.zero,fVal=useFormat.replace("%s",opts.symbol).replace("%v",formatNumber(Math.abs(val),checkPrecision(opts.precision),opts.thousand,opts.decimal));return fVal.length>maxLength&&(maxLength=fVal.length),fVal});return map(formatted,function(val,i){return isString(val)&&val.length<maxLength?padAfterSymbol?val.replace(opts.symbol,opts.symbol+new Array(maxLength-val.length+1).join(" ")):new Array(maxLength-val.length+1).join(" ")+val:val})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=lib),exports.accounting=lib):"function"==typeof define&&define.amd?define([],function(){return lib}):(lib.noConflict=function(oldAccounting){return function(){return root.accounting=oldAccounting,lib.noConflict=undefined,lib}}(root.accounting),root.accounting=lib)}(this);
!function(window,document,undefined){"use strict";function minErr(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/1.2.28/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return 1===obj.nodeType&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key);else if(isArray(obj)||isArrayLike(obj))for(key=0;key<obj.length;key++)iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)){var index=indexOf(stackSource,source);if(-1!==index)return stackDest[index];stackSource.push(source),stackDest.push(destination)}var result;if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)result=copy(source[i],null,stackSource,stackDest),isObject(source[i])&&(stackSource.push(source[i]),stackDest.push(result)),destination.push(result)}else{var h=destination.$$hashKey;isArray(destination)?destination.length=0:forEach(destination,function(value,key){delete destination[key]});for(var key in source)result=copy(source[key],null,stackSource,stackDest),isObject(source[key])&&(stackSource.push(source[key]),stackDest.push(result)),destination[key]=result;setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[],stackSource,stackDest):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?(destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex):isObject(source)&&(destination=copy(source,{},stackSource,stackDest)));return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0;i<src.length;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)!hasOwnProperty.call(src,key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?isNaN(o1.getTime())&&isNaN(o2.getTime())||o1.getTime()===o2.getTime():!1;if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if("function"==typeof value)value=!0;else if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.replace(/\+/g,"%20").split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var appElement,module,elements=[element],names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(scope,element,compile,injector,animate){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),void(angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()}))}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),jqLitePatchJQueryRemove("remove",!0,!0,!1),jqLitePatchJQueryRemove("empty",!1,!1,!1),jqLitePatchJQueryRemove("html",!1,!1,!0)):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockElements(nodes){var startNode=nodes[0],endNode=nodes[nodes.length-1];if(startNode===endNode)return jqLite(startNode);var element=startNode,elements=[element];do{if(element=element.nextSibling,!element)break;elements.push(element)}while(element!==endNode);return jqLite(elements)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},$$minErr:minErr,$$csp:csp}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLitePatchJQueryRemove(name,dispatchThis,filterElems,getterIfNoArguments){function removePatch(param){var set,setIndex,setLength,element,childIndex,childLength,children,list=filterElems&&param?[this.filter(param)]:[this],fireEvent=dispatchThis;if(!getterIfNoArguments||null!=param)for(;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,j,jj,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML="<div>&#160;</div>"+wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],tmp.removeChild(tmp.firstChild),i=wrap[0];i--;)tmp=tmp.lastChild;for(j=0,jj=tmp.childNodes.length;jj>j;++j)nodes.push(tmp.childNodes[j]);tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",nodes}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:jqLiteBuildFragment(html,context)}function JQLite(element){if(element instanceof JQLite)return element;if(isString(element)&&(element=trim(element)),!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}if(isString(element)){jqLiteAddNodes(this,jqLiteParseHTML(element));var fragment=jqLite(document.createDocumentFragment());fragment.append(this)}else jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element){jqLiteRemoveData(element);for(var i=0,children=element.childNodes||[];i<children.length;i++)jqLiteDealoc(children[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):forEach(type.split(" "),function(type){isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type]||[],fn)}))}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=jqCache[expandoId];if(expandoStore){if(name)return void delete jqCache[expandoId].data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,key,value){var expandoId=element.ng339,expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),void(expandoStore[key]=value)):expandoStore&&expandoStore[key]}function jqLiteData(element,key,value){var data=jqLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||jqLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;i<elements.length;i++)root.push(elements[i])}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){9==element.nodeType&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if((value=jqLite.data(element,names[i]))!==undefined)return value;element=element.parentNode||11===element.nodeType&&element.host}}function jqLiteEmpty(element){for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);for(;element.firstChild;)element.removeChild(element.firstChild)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented||event.returnValue===!1};var eventHandlersCopy=shallowCopy(events[type||event.type]||[]);forEach(eventHandlersCopy,function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj,nextUidFn){var key,objType=typeof obj;return"function"==objType||"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=(nextUidFn||nextUid)()):key=obj,objType+":"+key}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fn.length&&(fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val))}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var moduleFn,invokeQueue,i,ii,runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.put(module,!0);try{if(isString(module))for(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}else isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals){var length,i,key,args=[],$inject=annotate(fn);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals){var instance,returnedValue,Constructor=function(){};return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(){$rootScope.$evalAsync(scroll)}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function fireUrlChange(){lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var lastBrowserUrl=location.href,baseElement=document.find("base"),reloadLocation=null;self.url=function(url,replace){if(location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){if(lastBrowserUrl==url)return;
var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,!sameBase&&$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):(sameBase||(reloadLocation=url),replace?location.replace(url):location.href=url),self}return reloadLocation||location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).on("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=unescape(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=node=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);return safeAddClass($compileNodes,"ng-scope"),function(scope,cloneConnectFn,transcludeControllers,parentBoundTranscludeFn){assertArg(scope,"scope");var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes;forEach(transcludeControllers,function(instance,name){$linkNode.data("$"+name+"Controller",instance)});for(var i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i],nodeType=node.nodeType;(1===nodeType||9===nodeType)&&$linkNode.eq(i).data("$scope",scope)}return cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,n,childBoundTranscludeFn,nodeListLength=nodeList.length,stableNodeList=new Array(nodeListLength);for(i=0;nodeListLength>i;i++)stableNodeList[i]=nodeList[i];for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),jqLite.data(node,"$scope",childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&safeAddClass(attrs.$$element,"ng-scope"),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn,childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn,previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers){var scopeCreated=!1;transcludedScope||(transcludedScope=scope.$new(),transcludedScope.$$transcluded=!0,scopeCreated=!0);var clone=transcludeFn(transcludedScope,cloneFn,controllers,previousBoundTranscludeFn);return scopeCreated&&clone.on("$destroy",function(){transcludedScope.$destroy()}),clone};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;if(attr=nAttrs[j],!msie||msie>=8||attr.specified){name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=snake_case(ngAttrName.substr(6),"-"));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);1==node.nodeType&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require]),value=value||$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(directiveName,require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn){var transcludeControllers;return arguments.length<2&&(cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers)}var attrs,$element,i,ii,linkFn,controller,isolateScope,transcludeFn,elementControllers={};if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])(\??)\s*(\w*)\s*$/;isolateScope=scope.$new(!0),!templateDirective||templateDirective!==newIsolateScopeDirective&&templateDirective!==newIsolateScopeDirective.$$originalDirective?$element.data("$isolateScopeNoTemplate",isolateScope):$element.data("$isolateScope",isolateScope),safeAddClass($element,"ng-isolate-scope"),forEach(newIsolateScopeDirective.scope,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,match=definition.match(LOCAL_REGEXP)||[],attrName=match[3]||scopeName,optional="?"==match[2],mode=match[1];switch(isolateScope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){isolateScope[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateScope[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=isolateScope[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateScope[scopeName]=parentGet(scope),isolateScope.$watch(function(){var parentValue=parentGet(scope);return compare(parentValue,isolateScope[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateScope[scopeName]):isolateScope[scopeName]=parentValue),lastValue=parentValue},null,parentGet.literal);break;case"&":parentGet=$parse(attrs[attrName]),isolateScope[scopeName]=function(locals){return parentGet(scope,locals)};break;default:throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",newIsolateScopeDirective.name,scopeName,definition)}})}for(transcludeFn=boundTranscludeFn&&controllersBoundTransclude,controllerDirectives&&forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance),directive.controllerAs&&(locals.$scope[directive.controllerAs]=controllerInstance)}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)try{linkFn=postLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}previousCompileContext=previousCompileContext||{};for(var newScopeDirective,directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(newScopeDirective=newScopeDirective||directive,directive.templateUrl||(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(newIsolateScopeDirective=directive))),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:jqLite(trim(directiveValue)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl;return $compileNode.empty(),$http.get($sce.getTrustedResourceUrl(templateUrl),{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:jqLite(trim(content)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}linkQueue=null}).error(function(response,code,headers,config){throw $compileMinErr("tpload","Failed to load template: {0}",config.url)}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(childBoundTranscludeFn)):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var parent=templateNode.parent(),hasCompileParent=parent.length;return hasCompileParent&&safeAddClass(templateNode.parent(),"ng-binding"),function(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),parent.data("$binding",bindings),hasCompileParent||safeAddClass(parent,"ng-binding"),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"FORM"==tag&&"action"==attrNormalizedName||"IMG"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"SELECT"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name)),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1;break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),newNode[jqLite.expando]=firstElementToRemove[jqLite.expando];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses),toRemove=tokenDifference(oldClasses,newClasses);0===toAdd.length?$animate.removeClass(this.$$element,toRemove):0===toRemove.length?$animate.addClass(this.$$element,toAdd):$animate.setClass(this.$$element,toAdd,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,booleanKey=getBooleanAttrName(this.$$element[0],key);booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),("A"===nodeName&&"href"===key||"IMG"===nodeName&&"src"===key)&&(this[key]=value=$$sanitizeUri(value,"src"===key)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[key],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){
return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function $ControllerProvider(){var controllers={},CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(expression,locals){var instance,match,constructor,identifier;if(isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||getter($window,constructor,!0),assertArgFn(expression,constructor,!0)),instance=$injector.instantiate(expression,locals),identifier){if(!locals||"object"!=typeof locals.$scope)throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",constructor||expression.name,identifier);locals.$scope[identifier]=instance}return instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function parseHeaders(headers){var key,val,i,parsed={};return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,CONTENT_TYPE_APPLICATION_JSON={"Content-Type":"application/json;charset=utf-8"},defaults=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data))),data}],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},interceptorFactories=this.interceptors=[],responseInterceptorFactories=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,config.transformResponse)});return isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return execHeaders(reqHeaders),reqHeaders}var config={method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString,statusText){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),resolvePromise(response,status,headersString,statusText),$rootScope.$$phase||$rootScope.$apply()}function resolvePromise(response,status,headers,statusText){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url),isDefined(cachedResp)){if(isPromiseLike(cachedResp))return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK")}else cache.put(url,promise);if(isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=isDate(v)?v.toISOString():toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),forEach(responseInterceptorFactories,function(interceptorFactory,index){var responseFn=isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory);reversedInterceptors.splice(index,0,{response:function(response){return responseFn($q.when(response))},responseError:function(response){return responseFn($q.reject(response))}})}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function createXhr(method){if(8>=msie&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),8>=msie&&(script.onreadystatechange=function(){isString(script.readyState)&&/loaded|complete/.test(script.readyState)&&(script.onreadystatechange=null,callback({type:"load"}))}),rawDocument.body.appendChild(script),callback}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),status=1223===status?204:status,statusText=statusText||"",callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null,statusText="";status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),status===ABORTED&&10>msie||(statusText=xhr.statusText),completeRequest(callback,status||xhr.status,response,responseHeaders,statusText)}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function $interpolate(text,mustHaveExpression,trustedContext){for(var startIndex,endIndex,fn,exp,index=0,parts=[],length=text.length,hasInterpolation=!1,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);if((length=parts.length)||(parts.push(""),length=1),trustedContext&&parts.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);return!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){try{for(var part,i=0,ii=length;ii>i;i++){if("function"==typeof(part=parts[i]))if(part=part(context),part=trustedContext?$sce.getTrusted(trustedContext,part):$sce.valueOf(part),null==part)part="";else switch(typeof part){case"string":break;case"number":part=""+part;break;default:part=toJson(part)}concat[i]=part}return concat.join("")}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},fn.exp=text,fn.parts=parts,fn):void 0}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q",function($rootScope,$window,$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"",posSuf:"",negPre:"(",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj,appBase){var parsedUrl=urlResolve(absoluteUrl,appBase);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj,appBase){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl,appBase);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this,appBase),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){var appUrl,prevAppUrl,rewrittenUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,rewrittenUrl=(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);parseAppUrl(withoutHashUrl,this,appBase),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$parseLinkUrl=function(url,relHref){var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();html5Mode?(appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url):(appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl),$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl);var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){$location.absUrl()!=newUrl&&($rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl).defaultPrevented?($location.$$parse(oldUrl),$browser.url(oldUrl)):afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest())});var changeCounter=0;return $rootScope.$watch(function(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.document&&obj.location&&obj.alert&&obj.setInterval)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||BIND&&obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function setter(obj,path,setValue,fullExp,options){ensureSafeObject(obj,fullExp),options=options||{};for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=ensureSafeObject(obj[key],fullExp);propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj,obj.then&&options.unwrapPromises&&(promiseWarning(fullExp),"$$v"in obj||!function(promise){promise.then(function(val){promise.$$v=val})}(obj),obj.$$v===undefined&&(obj.$$v={}),obj=obj.$$v)}return key=ensureSafeMemberName(element.shift(),fullExp),ensureSafeObject(obj[key],fullExp),obj[key]=setValue,setValue}function isPossiblyDangerousMemberName(name){return"constructor"==name}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,options){ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp);var eso=function(o){return ensureSafeObject(o,fullExp)},expensiveChecks=options.expensiveChecks,eso0=expensiveChecks||isPossiblyDangerousMemberName(key0)?eso:identity,eso1=expensiveChecks||isPossiblyDangerousMemberName(key1)?eso:identity,eso2=expensiveChecks||isPossiblyDangerousMemberName(key2)?eso:identity,eso3=expensiveChecks||isPossiblyDangerousMemberName(key3)?eso:identity,eso4=expensiveChecks||isPossiblyDangerousMemberName(key4)?eso:identity;return options.unwrapPromises?function(scope,locals){var promise,pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso0(val)})),pathVal=eso0(pathVal.$$v)),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso1(val)})),pathVal=eso1(pathVal.$$v)),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso2(val)})),pathVal=eso2(pathVal.$$v)),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso3(val)})),pathVal=eso3(pathVal.$$v)),key4?null==pathVal?undefined:(pathVal=eso4(pathVal[key4]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso4(val)})),pathVal=eso4(pathVal.$$v)),pathVal):pathVal):pathVal):pathVal):pathVal)}:function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),key4?null==pathVal?undefined:pathVal=eso4(pathVal[key4]):pathVal):pathVal):pathVal):pathVal)}}function getterFnWithExtraArgs(fn,fullExpression){return function(s,l){return fn(s,l,promiseWarning,ensureSafeObject,fullExpression)}}function getterFn(path,options,fullExp){var expensiveChecks=options.expensiveChecks,getterFnCache=expensiveChecks?getterFnCacheExpensive:getterFnCacheDefault;if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var fn,pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,options):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,options)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="var p;\n";expensiveChecks&&(code+="s = eso(s, fe);\nl = eso(l, fe);\n");var needsEnsureSafeObject=expensiveChecks;forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp);var lookupJs=(index?"s":'((l&&l.hasOwnProperty("'+key+'"))?l:s)')+'["'+key+'"]',wrapWithEso=expensiveChecks||isPossiblyDangerousMemberName(key);wrapWithEso&&(lookupJs="eso("+lookupJs+", fe)",needsEnsureSafeObject=!0),code+="if(s == null) return undefined;\ns="+lookupJs+";\n",options.unwrapPromises&&(code+='if (s && s.then) {\n pw("'+fullExp.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v='+(wrapWithEso?"eso(v)":"v")+";});\n}\n s="+(wrapWithEso?"eso(s.$$v)":"s.$$v")+"\n}\n")}),code+="return s;";var evaledFnGetter=new Function("s","l","pw","eso","fe",code);evaledFnGetter.toString=valueFn(code),(needsEnsureSafeObject||options.unwrapPromises)&&(evaledFnGetter=getterFnWithExtraArgs(evaledFnGetter,fullExp)),fn=evaledFnGetter}return"hasOwnProperty"!==path&&(getterFnCache[path]=fn),fn}function $ParseProvider(){var cacheDefault={},cacheExpensive={},$parseOptions={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0,expensiveChecks:!1};this.unwrapPromises=function(value){return isDefined(value)?($parseOptions.unwrapPromises=!!value,this):$parseOptions.unwrapPromises},this.logPromiseWarnings=function(value){return isDefined(value)?($parseOptions.logPromiseWarnings=value,this):$parseOptions.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function($filter,$sniffer,$log){$parseOptions.csp=$sniffer.csp;var $parseOptionsExpensive={csp:$parseOptions.csp,unwrapPromises:$parseOptions.unwrapPromises,logPromiseWarnings:$parseOptions.logPromiseWarnings,expensiveChecks:!0};return promiseWarning=function(fullExp){$parseOptions.logPromiseWarnings&&!promiseWarningCache.hasOwnProperty(fullExp)&&(promiseWarningCache[fullExp]=!0,$log.warn("[$parse] Promise found in the expression `"+fullExp+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(exp,expensiveChecks){var parsedExpression;switch(typeof exp){case"string":var cache=expensiveChecks?cacheExpensive:cacheDefault;if(cache.hasOwnProperty(exp))return cache[exp];var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);return parsedExpression=parser.parse(exp),"hasOwnProperty"!==exp&&(cache[exp]=parsedExpression),
parsedExpression;case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,ref(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var defer=function(){var value,deferred,pending=[];return deferred={resolve:function(val){if(pending){var callbacks=pending;pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1],callback[2])})}},reject:function(reason){deferred.resolve(createInternalRejectedPromise(reason))},notify:function(progress){if(pending){var callbacks=pending;pending.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],callback[2](progress)})}},promise:{then:function(callback,errback,progressback){var result=defer(),wrappedCallback=function(value){try{result.resolve((isFunction(callback)?callback:defaultCallback)(value))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedErrback=function(reason){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedProgressback=function(progress){try{result.notify((isFunction(progressback)?progressback:defaultCallback)(progress))}catch(e){exceptionHandler(e)}};return pending?pending.push([wrappedCallback,wrappedErrback,wrappedProgressback]):value.then(wrappedCallback,wrappedErrback,wrappedProgressback),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback){function makePromise(value,resolved){var result=defer();return resolved?result.resolve(value):result.reject(value),result.promise}function handleCallback(value,isResolved){var callbackOutput=null;try{callbackOutput=(callback||defaultCallback)()}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)}return this.then(function(value){return handleCallback(value,!0)},function(error){return handleCallback(error,!1)})}}}},ref=function(value){return isPromiseLike(value)?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){var result=defer();return result.reject(reason),result.promise},createInternalRejectedPromise=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}}),result.promise}}},when=function(value,callback,errback,progressback){var done,result=defer(),wrappedCallback=function(value){try{return(isFunction(callback)?callback:defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(isFunction(errback)?errback:defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}},wrappedProgressback=function(progress){try{return(isFunction(progressback)?progressback:defaultCallback)(progress)}catch(e){exceptionHandler(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback,wrappedProgressback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))},function(progress){done||result.notify(wrappedProgressback(progress))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.mozCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}Scope.prototype={constructor:Scope,$new:function(isolate){var child;return isolate?(child=new Scope,child.$root=this.$root,child.$$asyncQueue=this.$$asyncQueue,child.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=nextUid(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),child=new this.$$childScopeClass),child["this"]=child,child.$parent=this,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(lastDirtyWatch=null,!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}if("string"==typeof watchExp&&get.constant){var originalFn=watcher.fn;watcher.fn=function(newVal,oldVal,scope){originalFn.call(this,newVal,oldVal,scope),arrayRemove(array,watcher)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchCollection:function(obj,listener){function $watchCollectionWatch(){newValue=objGetter(self);var newLength,key,bothNaN;if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)bothNaN=oldValue[i]!==oldValue[i]&&newValue[i]!==newValue[i],bothNaN||oldValue[i]===newValue[i]||(changeDetected++,oldValue[i]=newValue[i])}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,oldValue.hasOwnProperty(key)?(bothNaN=oldValue[key]!==oldValue[key]&&newValue[key]!==newValue[key],bothNaN||oldValue[key]===newValue[key]||(changeDetected++,oldValue[key]=newValue[key])):(oldLength++,oldValue[key]=newValue[key],changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)oldValue.hasOwnProperty(key)&&!newValue.hasOwnProperty(key)&&(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,objGetter=$parse(obj),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch($watchCollectionWatch,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,logMsg,asyncTask,asyncQueue=this.$$asyncQueue,postDigestQueue=this.$$postDigestQueue,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression)}catch(e){clearPhase(),$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg))}catch(e){clearPhase(),$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,toJson(watchLog))}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope&&(forEach(this.$$listenerCount,bind(null,decrementListenerCount,this)),parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=noop,this.$on=this.$watch=function(){return noop})}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){$rootScope.$$phase||$rootScope.$$asyncQueue.length||$browser.defer(function(){$rootScope.$$asyncQueue.length&&$rootScope.$digest()}),this.$$asyncQueue.push({scope:this,expression:expr})},$$postDigest:function(fn){this.$$postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=indexOf(namedListeners,listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event;scope=scope.$parent}while(scope);return event},$broadcast:function(name,args){for(var listeners,i,length,target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event}};var $rootScope=new Scope;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return msie&&!(msie>=8)||(normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex))?uri:"unsafe:"+normalizedVal}}}function escapeForRegexp(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sniffer","$sceDelegate",function($parse,$sniffer,$sceDelegate){if(enabled&&$sniffer.msie&&$sniffer.msieDocumentMode<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:function(self,locals){return sce.getTrusted(type,parsed(self,locals))}};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},documentMode=document.documentMode,vendorRegex=/^(Moz|webkit|O|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hashchange:"onhashchange"in $window&&(!documentMode||documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android,msie:msie,msieDocumentMode:documentMode}}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url,base){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var comparatorType=typeof comparator,predicates=[];predicates.check=function(value){for(var j=0;j<predicates.length;j++)if(!predicates[j](value))return!1;return!0},"function"!==comparatorType&&(comparator="boolean"===comparatorType&&comparator?function(obj,text){return angular.equals(obj,text)}:function(obj,text){if(obj&&text&&"object"==typeof obj&&"object"==typeof text){for(var objKey in obj)if("$"!==objKey.charAt(0)&&hasOwnProperty.call(obj,objKey)&&comparator(obj[objKey],text[objKey]))return!0;return!1}return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1});var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comparator(obj,text);case"object":switch(typeof text){case"object":return comparator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)!function(path){"undefined"!=typeof expression[path]&&predicates.push(function(value){return search("$"==path?value:value&&value[path],expression[path])})}(key);break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,2).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(null==number||!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?(numStr="0",number=0):(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac)),number=+(Math.round(+(number.toString()+"e"+fractionSize)).toString()+"e"+-fractionSize),0===number&&(isNegative=!1);var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(!isArray(input)&&!isString(input))return input;if(limit=Math.abs(Number(limit))===1/0?Number(limit):int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var i,n,out=[];for(limit>input.length?limit=input.length:limit<-input.length&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?(isDate(v1)&&isDate(v2)&&(v1=v1.valueOf(),v2=v2.valueOf()),"string"==t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}return isArrayLike(array)?(sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],0===sortPredicate.length&&(sortPredicate=["+"]),sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;if(isString(predicate)){if(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),""===predicate)return reverseComparator(function(a,b){return compare(a,b)},descending);if(get=$parse(predicate),get.constant){var key=get();return reverseComparator(function(a,b){return compare(a[key],b[key])},descending)}}return reverseComparator(function(a,b){return compare(get(a),get(b))},descending)}),slice.call(array).sort(reverseComparator(comparator,reverseOrder))):array}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs,$scope,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.setClass(element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey);
}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={},controls=[];form.$name=attrs.name||attrs.ngForm,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)}),arrayRemove(controls,control)},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.removeClass(element,DIRTY_CLASS),$animate.addClass(element,PRISTINE_CLASS),form.$dirty=!1,form.$pristine=!0,forEach(controls,function(control){control.$setPristine()})}}function validate(ctrl,validatorName,validity,value){return ctrl.$setValidity(validatorName,validity),validity?value:undefined}function testFlags(validity,flags){var i,flag;if(flags)for(i=0;i<flags.length;++i)if(flag=flags[i],validity[flag])return!0;return!1}function addNativeHtml5Validators(ctrl,validatorName,badFlags,ignoreFlags,validity){if(isObject(validity)){ctrl.$$hasNativeValidators=!0;var validator=function(value){return ctrl.$error[validatorName]||testFlags(validity,ignoreFlags)||!testFlags(validity,badFlags)?value:void ctrl.$setValidity(validatorName,!1)};ctrl.$parsers.push(validator)}}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var validity=element.prop(VALIDITY_STATE_PROPERTY),placeholder=element[0].placeholder,noevent={},type=lowercase(element[0].type);if(ctrl.$$validityState=validity,!$sniffer.android){var composing=!1;element.on("compositionstart",function(data){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(!composing){var value=element.val();if(msie&&"input"===(ev||noevent).type&&element[0].placeholder!==placeholder)return void(placeholder=element[0].placeholder);"password"!==type&&toBoolean(attr.ngTrim||"T")&&(value=trim(value));var revalidate=validity&&ctrl.$$hasNativeValidators;(ctrl.$viewValue!==value||""===value&&revalidate)&&(scope.$root.$$phase?ctrl.$setViewValue(value):scope.$apply(function(){ctrl.$setViewValue(value)}))}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var patternValidator,match,pattern=attr.ngPattern;if(pattern){var validateRegex=function(regexp,value){return validate(ctrl,"pattern",ctrl.$isEmpty(value)||regexp.test(value),value)};match=pattern.match(/^\/(.*)\/([gim]*)$/),match?(pattern=new RegExp(match[1],match[2]),patternValidator=function(value){return validateRegex(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",pattern,patternObj,startingTag(element));return validateRegex(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)}if(attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return validate(ctrl,"minlength",ctrl.$isEmpty(value)||value.length>=minlength,value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return validate(ctrl,"maxlength",ctrl.$isEmpty(value)||value.length<=maxlength,value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=ctrl.$isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),addNativeHtml5Validators(ctrl,"number",numberBadFlags,null,ctrl.$$validityState),ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?"":""+value}),attr.min){var minValidator=function(value){var min=parseFloat(attr.min);return validate(ctrl,"min",ctrl.$isEmpty(value)||value>=min,value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var maxValidator=function(value){var max=parseFloat(attr.max);return validate(ctrl,"max",ctrl.$isEmpty(value)||max>=value,value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return validate(ctrl,"number",ctrl.$isEmpty(value)||isNumber(value),value)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return validate(ctrl,"url",ctrl.$isEmpty(value)||URL_REGEXP.test(value),value)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return validate(ctrl,"email",ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value),value)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.on("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.on("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value!==trueValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){if(isArray(classVal))return classVal;if(isString(classVal))return classVal.split(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes}return classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||{},classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toRemove=digestClassCounts(toRemove,-1),toAdd=digestClassCounts(toAdd,1),0===toAdd.length?$animate.removeClass(element,toRemove):0===toRemove.length?$animate.addClass(element,toAdd):$animate.setClass(element,toAdd,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}var VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,nodeName_,slice=[].slice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=["0","0","0"];msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),noop.$inject=[],identity.$inject=[];var isArray=function(){return isFunction(Array.isArray)?Array.isArray:function(value){return"[object Array]"===toString.call(value)}}(),trim=function(){return String.prototype.trim?function(value){return isString(value)?value.trim():value}:function(value){return isString(value)?value.replace(/^\s\s*/,"").replace(/\s\s*$/,""):value}}();nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var csp=function(){if(isDefined(csp.isActive_))return csp.isActive_;var active=!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"));if(!active)try{new Function("")}catch(e){active=!0}return csp.isActive_=active},SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.2.28",major:1,minor:2,dot:28,codeName:"finnish-disembarkation"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},SPECIAL_CHARS_REGEXP=(JQLite._data=function(node){return this.cache[node[this.expando]]||{}},/([\:\-\_]+(.))/g),MOZ_HACK_REGEXP=/^moz([A-Z])/,jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:jqLiteData,removeData:jqLiteRemoveData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){var textProp=NODE_TYPE_TEXT_PROPERTY[element.nodeType];return isUndefined(value)?textProp?element[textProp]:"":void(element[textProp]=value)}var NODE_TYPE_TEXT_PROPERTY=[];return 9>msie?(NODE_TYPE_TEXT_PROPERTY[1]="innerText",NODE_TYPE_TEXT_PROPERTY[3]="nodeValue"):NODE_TYPE_TEXT_PROPERTY[1]=NODE_TYPE_TEXT_PROPERTY[3]="textContent",getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if("SELECT"===nodeName_(element)&&element.multiple){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);element.innerHTML=value},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,dealoc:jqLiteDealoc,on:function onFn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");events||jqLiteExpandoStore(element,"events",events={}),handle||jqLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};onFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){(1===element.nodeType||11===element.nodeType)&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,eventFns=(jqLiteExpandoStore(element,"events")||{})[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0;i<this.length;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector"),$animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function($timeout,$$asyncCallback){function async(fn){fn&&$$asyncCallback(fn)}return{enter:function(element,parent,after,done){after?after.after(element):(parent&&parent[0]||(parent=after.parent()),parent.append(element)),async(done)},leave:function(element,done){element.remove(),async(done)},move:function(element,parent,after,done){this.enter(element,parent,after,done)},addClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),async(done)},removeClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),async(done)},setClass:function(element,add,remove,done){forEach(element,function(element){jqLiteAddClass(element,add),jqLiteRemoveClass(element,remove)}),async(done)},enabled:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");LocationHashbangInHtml5Url.prototype=LocationHashbangUrl.prototype=LocationHtml5Url.prototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};var promiseWarning,$parseMinErr=minErr("$parse"),promiseWarningCache={},CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.ch=undefined,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var ch2=this.ch+this.peek(),ch3=ch2+this.peek(2),fn=OPERATORS[this.ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(this.tokens.push({index:this.index,text:ch3,fn:fn3}),this.index+=3):fn2?(this.tokens.push({index:this.index,text:ch2,fn:fn2}),this.index+=2):fn?(this.tokens.push({index:this.index,text:this.ch,fn:fn}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(chars){return-1!==chars.indexOf(this.ch)},was:function(chars){return-1!==chars.indexOf(this.lastCh)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||""===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}number=1*number,this.tokens.push({index:start,text:number,literal:!0,constant:!0,fn:function(){return number}})},readIdent:function(){for(var lastDot,peekIndex,methodName,ch,parser=this,ident="",start=this.index;this.index<this.text.length&&(ch=this.text.charAt(this.index),"."===ch||this.isIdent(ch)||this.isNumber(ch));)"."===ch&&(lastDot=this.index),ident+=ch,this.index++;if(lastDot)for(peekIndex=this.index;peekIndex<this.text.length;){if(ch=this.text.charAt(peekIndex),"("===ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),this.index=peekIndex;break}if(!this.isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=OPERATORS[ident],token.literal=!0,token.constant=!0;else{var getter=getterFn(ident,this.options,this.text);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value,parser.text,parser.options)}})}this.tokens.push(token),methodName&&(this.tokens.push({index:lastDot,text:"."}),this.tokens.push({index:lastDot+1,text:methodName}))},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,string:string,literal:!0,constant:!0,fn:function(){return string}});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;if(this.expect("("))primary=this.filterChain(),this.consume(")");else if(this.expect("["))primary=this.arrayDeclaration();else if(this.expect("{"))primary=this.object();else{var token=this.expect();primary=token.fn,primary||this.throwError("not a primary expression",token),primary.literal=!!token.literal,primary.constant=!!token.constant}for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){if(this.tokens.length>0){var token=this.tokens[0],t=token.text;
if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},consume:function(e1){this.expect(e1)||this.throwError("is unexpected, expecting ["+e1+"]",this.peek())},unaryFn:function(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant})},ternaryFn:function(left,middle,right){return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})},binaryFn:function(left,fn,right){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0;i<statements.length;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}},filterChain:function(){for(var token,left=this.expression();;){if(!(token=this.expect("|")))return left;left=this.binaryFn(left,token.fn,this.filter())}},filter:function(){for(var token=this.expect(),fn=this.$filter(token.text),argsFn=[];;){if(!(token=this.expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;i<argsFn.length;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left},ternary:function(){var middle,token,left=this.logicalOR();return(token=this.expect("?"))?(middle=this.assignment(),(token=this.expect(":"))?this.ternaryFn(left,middle,this.assignment()):void this.throwError("expected :",token)):left},logicalOR:function(){for(var token,left=this.logicalAND();;){if(!(token=this.expect("||")))return left;left=this.binaryFn(left,token.fn,this.logicalAND())}},logicalAND:function(){var token,left=this.equality();return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.fn,this.logicalAND())),left},equality:function(){var token,left=this.relational();return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.fn,this.equality())),left},relational:function(){var token,left=this.additive();return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.fn,this.relational())),left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.fn,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.fn,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.fn,this.unary()):(token=this.expect("!"))?this.unaryFn(token.fn,this.unary()):this.primary()},fieldAccess:function(object){var parser=this,field=this.expect().text,getter=getterFn(field,this.options,this.text);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){var o=object(scope,locals);return o||object.assign(scope,o={}),setter(o,field,value,parser.text,parser.options)}})},objectIndex:function(obj){var parser=this,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,p,o=obj(self,locals),i=indexFn(self,locals);return ensureSafeMemberName(i,parser.text),o?(v=ensureSafeObject(o[i],parser.text),v&&v.then&&parser.options.unwrapPromises&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){var key=ensureSafeMemberName(indexFn(self,locals),parser.text),o=ensureSafeObject(obj(self,locals),parser.text);return o||obj.assign(self,o={}),o[key]=value}})},functionCall:function(fn,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var parser=this;return function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;i<argsFn.length;i++)args.push(ensureSafeObject(argsFn[i](scope,locals),parser.text));var fnPtr=fn(scope,locals,context)||noop;ensureSafeObject(context,parser.text),ensureSafeFunction(fnPtr,parser.text);var v=fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,parser.text)}},arrayDeclaration:function(){var elementFns=[],allConstant=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var elementFn=this.expression();elementFns.push(elementFn),elementFn.constant||(allConstant=!1)}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0;i<elementFns.length;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:allConstant})},object:function(){var keyValues=[],allConstant=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.expect(),key=token.string||token.text;this.consume(":");var value=this.expression();keyValues.push({key:key,value:value}),value.constant||(allConstant=!1)}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0;i<keyValues.length;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object},{literal:!0,constant:allConstant})}};var getterFnCacheDefault={},getterFnCacheExpensive={},$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href,!0);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),attr.href||attr.xlinkHref||attr.name?void 0:function(scope,element){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop};FormController.$inject=["$element","$attrs","$scope","$animate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&setter(scope,alias,controller,alias),parentFormCtrl&&formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},numberBadFlags=["badInput"],inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass($element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass($element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw minErr("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element));this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}return value})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&ctrl.$isEmpty(value)?void ctrl.$setValidity("required",!1):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&new RegExp(match[1])||attr.ngList||",",parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=ngDirective({compile:function(templateElement){return templateElement.addClass("ng-binding"),function(scope,element,attr){element.data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function(value){element.text(value==undefined?"":value)})}}}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlDirective=["$sce","$parse",function($sce,$parse){return{compile:function(tElement){return tElement.addClass("ng-binding"),function(scope,element,attr){function getStringValue(){return(parsed(scope)||"").toString()}element.data("$binding",attr.ngBindHtml);var parsed=$parse(attr.ngBindHtml);scope.$watch(getStringValue,function(value){element.html($sce.getTrustedHtml(parsed(scope))||"")})}}}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{compile:function($element,attr){var fn=$parse(attr[directiveName],!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){toBoolean(value)?childScope||(childScope=$scope.$new(),$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)})):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockElements(block.clone),$animate.leave(previousElements,function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$http","$templateCache","$anchorScroll","$animate","$sce",function($http,$templateCache,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement,function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element,afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&cleanupLastIncludeContent()}),scope.$emit("$includeContentRequested")):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){$element.html(ctrl.template),$compile($element.contents())(scope)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),isWhen=/^when(Minus)?(.+)$/;forEach(attr,function(expression,attributeName){isWhen.test(attributeName)&&(whens[lowercase(attributeName.replace("when","").replace("Minus","-"))]=element.attr(attr.$attr[attributeName]))}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))}),scope.$watch(function(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function(newVal){element.text(newVal)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){function getBlockStart(block){return block.clone[0]}function getBlockEnd(block){return block.clone[block.clone.length-1]}var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var trackByExp,trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,lhs,rhs,valueIdentifier,keyIdentifier,expression=$attr.ngRepeat,match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),hashFnLocals={$id:hashKey};if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(lhs=match[1],rhs=match[2],trackByExp=match[3],trackByExp?(trackByExpGetter=$parse(trackByExp),trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);valueIdentifier=match[3]||match[1],keyIdentifier=match[2];var lastBlockMap={};$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,arrayLength,childScope,key,value,trackById,trackByIdFn,collectionKeys,block,elementsToRemove,previousNode=$element[0],nextBlockMap={},nextBlockOrder=[];if(isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&collectionKeys.push(key);collectionKeys.sort()}for(arrayLength=collectionKeys.length,length=nextBlockOrder.length=collectionKeys.length,index=0;length>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),assertNotHasOwnProperty(trackById,"`track by` id"),lastBlockMap.hasOwnProperty(trackById))block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap.hasOwnProperty(trackById))throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,toJson(value));nextBlockOrder[index]={id:trackById},nextBlockMap[trackById]=!1}for(key in lastBlockMap)lastBlockMap.hasOwnProperty(key)&&(block=lastBlockMap[key],elementsToRemove=getBlockElements(block.clone),$animate.leave(elementsToRemove),forEach(elementsToRemove,function(element){element[NG_REMOVED]=!0}),block.scope.$destroy());for(index=0,length=collectionKeys.length;length>index;index++){if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],nextBlockOrder[index-1]&&(previousNode=getBlockEnd(nextBlockOrder[index-1])),block.scope){childScope=block.scope,nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockElements(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block)}else childScope=$scope.$new();childScope[valueIdentifier]=value,keyIdentifier&&(childScope[keyIdentifier]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayLength-1,childScope.$middle=!(childScope.$first||childScope.$last),childScope.$odd=!(childScope.$even=0===(1&index)),block.scope||$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngRepeat: "+expression+" "),$animate.enter(clone,null,jqLite(previousNode)),previousNode=clone,block.scope=childScope,block.clone=clone,nextBlockMap[block.id]=block})}lastBlockMap=nextBlockMap})}}}],ngShowDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[toBoolean(value)?"removeClass":"addClass"](element,"ng-hide")})}}],ngHideDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[toBoolean(value)?"addClass":"removeClass"](element,"ng-hide")})}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousElements=[],selectedScopes=[];scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousElements.length;ii>i;++i)previousElements[i].remove();for(previousElements.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=selectedElements[i];selectedScopes[i].$destroy(),previousElements[i]=selected,$animate.leave(selected,function(){previousElements.splice(i,1)})}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&(scope.$eval(attr.change),forEach(selectedTranscludes,function(selectedTransclude){var selectedScope=scope.$new();selectedScopes.push(selectedScope),selectedTransclude.transclude(selectedScope,function(caseElement){var anchor=selectedTransclude.element;selectedElements.push(caseElement),$animate.enter(caseElement,anchor.parent(),anchor)})}))})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=shallowCopy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function getSelectedSet(){var selectedSet=!1;if(multiple){var modelValue=ctrl.$modelValue;if(trackFn&&isArray(modelValue)){selectedSet=new HashMap([]);for(var locals={},trackIndex=0;trackIndex<modelValue.length;trackIndex++)locals[valueName]=modelValue[trackIndex],selectedSet.put(trackFn(scope,locals),modelValue[trackIndex])}else selectedSet=new HashMap(modelValue)}return selectedSet}function render(){var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,key,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionGroups={"":[]},optionGroupNames=[""],modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,locals={},selectedSet=getSelectedSet();for(index=0;length=keys.length,length>index;index++){if(key=index,keyName){if(key=keys[index],"$"===key.charAt(0))continue;locals[keyName]=key}if(locals[valueName]=values[key],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple)selected=isDefined(selectedSet.remove(trackFn?trackFn(scope,locals):valueFn(scope,locals)));else{if(trackFn){var modelCast={};modelCast[valueName]=modelValue,selected=trackFn(scope,modelCast)===trackFn(scope,locals)}else selected=modelValue===valueFn(scope,locals);selectedSet=selectedSet||selected}label=displayFn(scope,locals),label=isDefined(label)?label:"",optionGroup.push({id:trackFn?trackFn(scope,locals):keyName?keys[index]:index,label:label,selected:selected})}for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],
optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&(lastElement.text(existingOption.label=option.label),lastElement.prop("label",existingOption.label)),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&(lastElement.prop("selected",existingOption.selected=option.selected),msie&&lastElement.prop("selected",existingOption.selected))):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).prop("selected",option.selected).attr("selected",option.selected).prop("label",option.label).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),selectCtrl.addOption(option.label,element),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)option=existingOptions.pop(),selectCtrl.removeOption(option.label),option.element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",function(){scope.$apply(function(){var optionGroup,key,value,optionElement,index,groupIndex,length,groupLength,trackIndex,collection=valuesFn(scope)||[],locals={};if(multiple){for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)if((optionElement=optionGroup[index].element)[0].selected){if(key=optionElement.val(),keyName&&(locals[keyName]=key),trackFn)for(trackIndex=0;trackIndex<collection.length&&(locals[valueName]=collection[trackIndex],trackFn(scope,locals)!=key);trackIndex++);else locals[valueName]=collection[key];value.push(valueFn(scope,locals))}}else if(key=selectElement.val(),"?"==key)value=undefined;else if(""===key)value=null;else if(trackFn){for(trackIndex=0;trackIndex<collection.length;trackIndex++)if(locals[valueName]=collection[trackIndex],trackFn(scope,locals)==key){value=valueFn(scope,locals);break}}else locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals);ctrl.$setViewValue(value),render()})}),ctrl.$render=render,scope.$watchCollection(valuesFn,render),scope.$watchCollection(function(){var locals={},values=valuesFn(scope);if(values){for(var toDisplay=new Array(values.length),i=0,ii=values.length;ii>i;i++)locals[valueName]=values[i],toDisplay[i]=displayFn(scope,locals);return toDisplay}},render),multiple&&scope.$watchCollection(function(){return ctrl.$modelValue},render)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});return window.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(bindJQuery(),publishExternalAPI(angular),void jqLite(document).ready(function(){angularInit(document,bootstrap)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>');
!function(window,angular,undefined){"use strict";function jsonStringToDate(string){var match;if(match=string.match(R_ISO8061_STR)){var date=new Date(0),tzHour=0,tzMin=0;return match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),date.setUTCFullYear(int(match[1]),int(match[2])-1,int(match[3])),date.setUTCHours(int(match[4]||0)-tzHour,int(match[5]||0)-tzMin,int(match[6]||0),int(match[7]||0)),date}return string}function int(str){return parseInt(str,10)}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function createHttpBackendMock($rootScope,$delegate,$browser){function createResponse(status,data,headers,statusText){return angular.isFunction(status)?status:function(){return angular.isNumber(status)?[status,data,headers,statusText]:[200,status,data]}}function $httpBackend(method,url,data,callback,headers,timeout,withCredentials){function prettyPrint(data){return angular.isString(data)||angular.isFunction(data)||data instanceof RegExp?data:angular.toJson(data)}function wrapResponse(wrapped){function handleResponse(){var response=wrapped.response(method,url,data,headers);xhr.$$respHeaders=response[2],callback(copy(response[0]),copy(response[1]),xhr.getAllResponseHeaders(),copy(response[3]||""))}function handleTimeout(){for(var i=0,ii=responses.length;ii>i;i++)if(responses[i]===handleResponse){responses.splice(i,1),callback(-1,undefined,"");break}}return!$browser&&timeout&&timeout.then&&timeout.then(handleTimeout),handleResponse}var xhr=new MockXhr,expectation=expectations[0],wasExpected=!1;if(expectation&&expectation.match(method,url)){if(!expectation.matchData(data))throw new Error("Expected "+expectation+" with different data\nEXPECTED: "+prettyPrint(expectation.data)+"\nGOT:      "+data);if(!expectation.matchHeaders(headers))throw new Error("Expected "+expectation+" with different headers\nEXPECTED: "+prettyPrint(expectation.headers)+"\nGOT:      "+prettyPrint(headers));if(expectations.shift(),expectation.response)return void responses.push(wrapResponse(expectation));wasExpected=!0}for(var definition,i=-1;definition=definitions[++i];)if(definition.match(method,url,data,headers||{})){if(definition.response)($browser?$browser.defer:responsesPush)(wrapResponse(definition));else{if(!definition.passThrough)throw new Error("No response defined !");$delegate(method,url,data,callback,headers,timeout,withCredentials)}return}throw wasExpected?new Error("No response defined !"):new Error("Unexpected request: "+method+" "+url+"\n"+(expectation?"Expected "+expectation:"No more request expected"))}function createShortMethods(prefix){angular.forEach(["GET","DELETE","JSONP","HEAD"],function(method){$httpBackend[prefix+method]=function(url,headers){return $httpBackend[prefix](method,url,undefined,headers)}}),angular.forEach(["PUT","POST","PATCH"],function(method){$httpBackend[prefix+method]=function(url,data,headers){return $httpBackend[prefix](method,url,data,headers)}})}var definitions=[],expectations=[],responses=[],responsesPush=angular.bind(responses,responses.push),copy=angular.copy;return $httpBackend.when=function(method,url,data,headers){var definition=new MockHttpExpectation(method,url,data,headers),chain={respond:function(status,data,headers,statusText){definition.response=createResponse(status,data,headers,statusText)}};return $browser&&(chain.passThrough=function(){definition.passThrough=!0}),definitions.push(definition),chain},createShortMethods("when"),$httpBackend.expect=function(method,url,data,headers){var expectation=new MockHttpExpectation(method,url,data,headers);return expectations.push(expectation),{respond:function(status,data,headers,statusText){expectation.response=createResponse(status,data,headers,statusText)}}},createShortMethods("expect"),$httpBackend.flush=function(count){if($rootScope.$digest(),!responses.length)throw new Error("No pending request to flush !");if(angular.isDefined(count))for(;count--;){if(!responses.length)throw new Error("No more pending request to flush !");responses.shift()()}else for(;responses.length;)responses.shift()();$httpBackend.verifyNoOutstandingExpectation()},$httpBackend.verifyNoOutstandingExpectation=function(){if($rootScope.$digest(),expectations.length)throw new Error("Unsatisfied requests: "+expectations.join(", "))},$httpBackend.verifyNoOutstandingRequest=function(){if(responses.length)throw new Error("Unflushed requests: "+responses.length)},$httpBackend.resetExpectations=function(){expectations.length=0,responses.length=0},$httpBackend}function MockHttpExpectation(method,url,data,headers){this.data=data,this.headers=headers,this.match=function(m,u,d,h){return method!=m?!1:this.matchUrl(u)?angular.isDefined(d)&&!this.matchData(d)?!1:angular.isDefined(h)&&!this.matchHeaders(h)?!1:!0:!1},this.matchUrl=function(u){return url?angular.isFunction(url.test)?url.test(u):url==u:!0},this.matchHeaders=function(h){return angular.isUndefined(headers)?!0:angular.isFunction(headers)?headers(h):angular.equals(headers,h)},this.matchData=function(d){return angular.isUndefined(data)?!0:data&&angular.isFunction(data.test)?data.test(d):data&&angular.isFunction(data)?data(d):data&&!angular.isString(data)?angular.equals(angular.fromJson(angular.toJson(data)),angular.fromJson(d)):data==d},this.toString=function(){return method+" "+url}}function MockXhr(){MockXhr.$$lastInstance=this,this.open=function(method,url,async){this.$$method=method,this.$$url=url,this.$$async=async,this.$$reqHeaders={},this.$$respHeaders={}},this.send=function(data){this.$$data=data},this.setRequestHeader=function(key,value){this.$$reqHeaders[key]=value},this.getResponseHeader=function(name){var header=this.$$respHeaders[name];return header?header:(name=angular.lowercase(name),(header=this.$$respHeaders[name])?header:(header=undefined,angular.forEach(this.$$respHeaders,function(headerVal,headerName){header||angular.lowercase(headerName)!=name||(header=headerVal)}),header))},this.getAllResponseHeaders=function(){var lines=[];return angular.forEach(this.$$respHeaders,function(value,key){lines.push(key+": "+value)}),lines.join("\n")},this.abort=angular.noop}angular.mock={},angular.mock.$BrowserProvider=function(){this.$get=function(){return new angular.mock.$Browser}},angular.mock.$Browser=function(){var self=this;this.isMock=!0,self.$$url="http://server/",self.$$lastUrl=self.$$url,self.pollFns=[],self.$$completeOutstandingRequest=angular.noop,self.$$incOutstandingRequestCount=angular.noop,self.onUrlChange=function(listener){return self.pollFns.push(function(){self.$$lastUrl!=self.$$url&&(self.$$lastUrl=self.$$url,listener(self.$$url))}),listener},self.$$checkUrlChange=angular.noop,self.cookieHash={},self.lastCookieHash={},self.deferredFns=[],self.deferredNextId=0,self.defer=function(fn,delay){return delay=delay||0,self.deferredFns.push({time:self.defer.now+delay,fn:fn,id:self.deferredNextId}),self.deferredFns.sort(function(a,b){return a.time-b.time}),self.deferredNextId++},self.defer.now=0,self.defer.cancel=function(deferId){var fnIndex;return angular.forEach(self.deferredFns,function(fn,index){fn.id===deferId&&(fnIndex=index)}),fnIndex!==undefined?(self.deferredFns.splice(fnIndex,1),!0):!1},self.defer.flush=function(delay){if(angular.isDefined(delay))self.defer.now+=delay;else{if(!self.deferredFns.length)throw new Error("No deferred tasks to be flushed");self.defer.now=self.deferredFns[self.deferredFns.length-1].time}for(;self.deferredFns.length&&self.deferredFns[0].time<=self.defer.now;)self.deferredFns.shift().fn()},self.$$baseHref="",self.baseHref=function(){return this.$$baseHref}},angular.mock.$Browser.prototype={poll:function(){angular.forEach(this.pollFns,function(pollFn){pollFn()})},addPollFn:function(pollFn){return this.pollFns.push(pollFn),pollFn},url:function(url,replace){return url?(this.$$url=url,this):this.$$url},cookies:function(name,value){return name?void(angular.isUndefined(value)?delete this.cookieHash[name]:angular.isString(value)&&value.length<=4096&&(this.cookieHash[name]=value)):(angular.equals(this.cookieHash,this.lastCookieHash)||(this.lastCookieHash=angular.copy(this.cookieHash),this.cookieHash=angular.copy(this.cookieHash)),this.cookieHash)},notifyWhenNoOutstandingRequests:function(fn){fn()}},angular.mock.$ExceptionHandlerProvider=function(){var handler;this.mode=function(mode){switch(mode){case"rethrow":handler=function(e){throw e};break;case"log":var errors=[];handler=function(e){1==arguments.length?errors.push(e):errors.push([].slice.call(arguments,0))},handler.errors=errors;break;default:throw new Error("Unknown mode '"+mode+"', only 'log'/'rethrow' modes are allowed!")}},this.$get=function(){return handler},this.mode("rethrow")},angular.mock.$LogProvider=function(){function concat(array1,array2,index){return array1.concat(Array.prototype.slice.call(array2,index))}var debug=!0;this.debugEnabled=function(flag){return angular.isDefined(flag)?(debug=flag,this):debug},this.$get=function(){var $log={log:function(){$log.log.logs.push(concat([],arguments,0))},warn:function(){$log.warn.logs.push(concat([],arguments,0))},info:function(){$log.info.logs.push(concat([],arguments,0))},error:function(){$log.error.logs.push(concat([],arguments,0))},debug:function(){debug&&$log.debug.logs.push(concat([],arguments,0))}};return $log.reset=function(){$log.log.logs=[],$log.info.logs=[],$log.warn.logs=[],$log.error.logs=[],$log.debug.logs=[]},$log.assertEmpty=function(){var errors=[];if(angular.forEach(["error","warn","info","log","debug"],function(logLevel){angular.forEach($log[logLevel].logs,function(log){angular.forEach(log,function(logItem){errors.push("MOCK $log ("+logLevel+"): "+String(logItem)+"\n"+(logItem.stack||""))})})}),errors.length)throw errors.unshift("Expected $log to be empty! Either a message was logged unexpectedly, or an expected log message was not checked and removed:"),errors.push(""),new Error(errors.join("\n---------\n"))},$log.reset(),$log}},angular.mock.$IntervalProvider=function(){this.$get=["$rootScope","$q",function($rootScope,$q){var repeatFns=[],nextRepeatId=0,now=0,$interval=function(fn,delay,count,invokeApply){function tick(){if(deferred.notify(iteration++),count>0&&iteration>=count){var fnIndex;deferred.resolve(iteration),angular.forEach(repeatFns,function(fn,index){fn.id===promise.$$intervalId&&(fnIndex=index)}),fnIndex!==undefined&&repeatFns.splice(fnIndex,1)}skipApply||$rootScope.$apply()}var deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=angular.isDefined(invokeApply)&&!invokeApply;return count=angular.isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=nextRepeatId,repeatFns.push({nextTime:now+delay,delay:delay,fn:tick,id:nextRepeatId,deferred:deferred}),repeatFns.sort(function(a,b){return a.nextTime-b.nextTime}),nextRepeatId++,promise};return $interval.cancel=function(promise){if(!promise)return!1;var fnIndex;return angular.forEach(repeatFns,function(fn,index){fn.id===promise.$$intervalId&&(fnIndex=index)}),fnIndex!==undefined?(repeatFns[fnIndex].deferred.reject("canceled"),repeatFns.splice(fnIndex,1),!0):!1},$interval.flush=function(millis){for(now+=millis;repeatFns.length&&repeatFns[0].nextTime<=now;){var task=repeatFns[0];task.fn(),task.nextTime+=task.delay,repeatFns.sort(function(a,b){return a.nextTime-b.nextTime})}return millis},$interval}]};var R_ISO8061_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?:\:?(\d\d)(?:\:?(\d\d)(?:\.(\d{3}))?)?)?(Z|([+-])(\d\d):?(\d\d)))?$/;if(angular.mock.TzDate=function(offset,timestamp){var self=new Date(0);if(angular.isString(timestamp)){var tsStr=timestamp;if(self.origDate=jsonStringToDate(timestamp),timestamp=self.origDate.getTime(),isNaN(timestamp))throw{name:"Illegal Argument",message:"Arg '"+tsStr+"' passed into TzDate constructor is not a valid date string"}}else self.origDate=new Date(timestamp);var localOffset=new Date(timestamp).getTimezoneOffset();self.offsetDiff=60*localOffset*1e3-1e3*offset*60*60,self.date=new Date(timestamp+self.offsetDiff),self.getTime=function(){return self.date.getTime()-self.offsetDiff},self.toLocaleDateString=function(){return self.date.toLocaleDateString()},self.getFullYear=function(){return self.date.getFullYear()},self.getMonth=function(){return self.date.getMonth()},self.getDate=function(){return self.date.getDate()},self.getHours=function(){return self.date.getHours()},self.getMinutes=function(){return self.date.getMinutes()},self.getSeconds=function(){return self.date.getSeconds()},self.getMilliseconds=function(){return self.date.getMilliseconds()},self.getTimezoneOffset=function(){return 60*offset},self.getUTCFullYear=function(){return self.origDate.getUTCFullYear()},self.getUTCMonth=function(){return self.origDate.getUTCMonth()},self.getUTCDate=function(){return self.origDate.getUTCDate()},self.getUTCHours=function(){return self.origDate.getUTCHours()},self.getUTCMinutes=function(){return self.origDate.getUTCMinutes()},self.getUTCSeconds=function(){return self.origDate.getUTCSeconds()},self.getUTCMilliseconds=function(){return self.origDate.getUTCMilliseconds()},self.getDay=function(){return self.date.getDay()},self.toISOString&&(self.toISOString=function(){return padNumber(self.origDate.getUTCFullYear(),4)+"-"+padNumber(self.origDate.getUTCMonth()+1,2)+"-"+padNumber(self.origDate.getUTCDate(),2)+"T"+padNumber(self.origDate.getUTCHours(),2)+":"+padNumber(self.origDate.getUTCMinutes(),2)+":"+padNumber(self.origDate.getUTCSeconds(),2)+"."+padNumber(self.origDate.getUTCMilliseconds(),3)+"Z"});var unimplementedMethods=["getUTCDay","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toGMTString","toJSON","toLocaleFormat","toLocaleString","toLocaleTimeString","toSource","toString","toTimeString","toUTCString","valueOf"];return angular.forEach(unimplementedMethods,function(methodName){self[methodName]=function(){throw new Error("Method '"+methodName+"' is not implemented in the TzDate mock")}}),self},angular.mock.TzDate.prototype=Date.prototype,angular.mock.animate=angular.module("ngAnimateMock",["ng"]).config(["$provide",function($provide){var reflowQueue=[];$provide.value("$$animateReflow",function(fn){var index=reflowQueue.length;return reflowQueue.push(fn),function(){reflowQueue.splice(index,1)}}),$provide.decorator("$animate",function($delegate,$$asyncCallback){var animate={queue:[],enabled:$delegate.enabled,triggerCallbacks:function(){$$asyncCallback.flush()},triggerReflow:function(){angular.forEach(reflowQueue,function(fn){fn()}),reflowQueue=[]}};return angular.forEach(["enter","leave","move","addClass","removeClass","setClass"],function(method){animate[method]=function(){animate.queue.push({event:method,element:arguments[0],args:arguments}),$delegate[method].apply($delegate,arguments)}}),animate})}]),angular.mock.dump=function(object){function serialize(object){var out;return angular.isElement(object)?(object=angular.element(object),out=angular.element("<div></div>"),angular.forEach(object,function(element){out.append(angular.element(element).clone())}),out=out.html()):angular.isArray(object)?(out=[],angular.forEach(object,function(o){out.push(serialize(o))}),out="[ "+out.join(", ")+" ]"):out=angular.isObject(object)?angular.isFunction(object.$eval)&&angular.isFunction(object.$apply)?serializeScope(object):object instanceof Error?object.stack||""+object.name+": "+object.message:angular.toJson(object,!0):String(object),out}function serializeScope(scope,offset){offset=offset||"  ";var log=[offset+"Scope("+scope.$id+"): {"];for(var key in scope)Object.prototype.hasOwnProperty.call(scope,key)&&!key.match(/^(\$|this)/)&&log.push("  "+key+": "+angular.toJson(scope[key]));for(var child=scope.$$childHead;child;)log.push(serializeScope(child,offset+"  ")),child=child.$$nextSibling;return log.push("}"),log.join("\n"+offset)}return serialize(object)},angular.mock.$HttpBackendProvider=function(){this.$get=["$rootScope",createHttpBackendMock]},angular.mock.$TimeoutDecorator=function($delegate,$browser){function formatPendingTasksAsString(tasks){var result=[];return angular.forEach(tasks,function(task){result.push("{id: "+task.id+", time: "+task.time+"}")}),result.join(", ")}return $delegate.flush=function(delay){$browser.defer.flush(delay)},$delegate.verifyNoPendingTasks=function(){if($browser.deferredFns.length)throw new Error("Deferred tasks to flush ("+$browser.deferredFns.length+"): "+formatPendingTasksAsString($browser.deferredFns))},$delegate},angular.mock.$RAFDecorator=function($delegate){var queue=[],rafFn=function(fn){var index=queue.length;return queue.push(fn),function(){queue.splice(index,1)}};return rafFn.supported=$delegate.supported,rafFn.flush=function(){if(0===queue.length)throw new Error("No rAF callbacks present");for(var length=queue.length,i=0;length>i;i++)queue[i]();queue=[]},rafFn},angular.mock.$AsyncCallbackDecorator=function($delegate){var callbacks=[],addFn=function(fn){callbacks.push(fn)};return addFn.flush=function(){angular.forEach(callbacks,function(fn){fn()}),callbacks=[]},addFn},angular.mock.$RootElementProvider=function(){this.$get=function(){return angular.element("<div ng-app></div>")}},angular.module("ngMock",["ng"]).provider({$browser:angular.mock.$BrowserProvider,$exceptionHandler:angular.mock.$ExceptionHandlerProvider,$log:angular.mock.$LogProvider,$interval:angular.mock.$IntervalProvider,$httpBackend:angular.mock.$HttpBackendProvider,$rootElement:angular.mock.$RootElementProvider}).config(["$provide",function($provide){$provide.decorator("$timeout",angular.mock.$TimeoutDecorator),$provide.decorator("$$rAF",angular.mock.$RAFDecorator),$provide.decorator("$$asyncCallback",angular.mock.$AsyncCallbackDecorator)}]),angular.module("ngMockE2E",["ng"]).config(["$provide",function($provide){$provide.decorator("$httpBackend",angular.mock.e2e.$httpBackendDecorator)}]),angular.mock.e2e={},angular.mock.e2e.$httpBackendDecorator=["$rootScope","$delegate","$browser",createHttpBackendMock],angular.mock.clearDataCache=function(){var key,cache=angular.element.cache;for(key in cache)if(Object.prototype.hasOwnProperty.call(cache,key)){var handle=cache[key].handle;handle&&angular.element(handle.elem).off(),delete cache[key]}},window.jasmine||window.mocha){var currentSpec=null,isSpecRunning=function(){return!!currentSpec};(window.beforeEach||window.setup)(function(){currentSpec=this}),(window.afterEach||window.teardown)(function(){var injector=currentSpec.$injector;angular.forEach(currentSpec.$modules,function(module){module&&module.$$hashKey&&(module.$$hashKey=undefined)}),currentSpec.$injector=null,currentSpec.$modules=null,currentSpec=null,injector&&(injector.get("$rootElement").off(),injector.get("$browser").pollFns.length=0),angular.mock.clearDataCache(),angular.forEach(angular.element.fragments,function(val,key){delete angular.element.fragments[key]}),MockXhr.$$lastInstance=null,angular.forEach(angular.callbacks,function(val,key){delete angular.callbacks[key]}),angular.callbacks.counter=0}),window.module=angular.mock.module=function(){function workFn(){if(currentSpec.$injector)throw new Error("Injector already created, can not register a module!");var modules=currentSpec.$modules||(currentSpec.$modules=[]);angular.forEach(moduleFns,function(module){angular.isObject(module)&&!angular.isArray(module)?modules.push(function($provide){angular.forEach(module,function(value,key){$provide.value(key,value)})}):modules.push(module)})}var moduleFns=Array.prototype.slice.call(arguments,0);return isSpecRunning()?workFn():workFn};var ErrorAddingDeclarationLocationStack=function(e,errorForStack){this.message=e.message,this.name=e.name,e.line&&(this.line=e.line),e.sourceId&&(this.sourceId=e.sourceId),e.stack&&errorForStack&&(this.stack=e.stack+"\n"+errorForStack.stack),e.stackArray&&(this.stackArray=e.stackArray)};ErrorAddingDeclarationLocationStack.prototype.toString=Error.prototype.toString,window.inject=angular.mock.inject=function(){function workFn(){var modules=currentSpec.$modules||[];modules.unshift("ngMock"),modules.unshift("ng");var injector=currentSpec.$injector;injector||(injector=currentSpec.$injector=angular.injector(modules));for(var i=0,ii=blockFns.length;ii>i;i++)try{injector.invoke(blockFns[i]||angular.noop,this)}catch(e){if(e.stack&&errorForStack)throw new ErrorAddingDeclarationLocationStack(e,errorForStack);throw e}finally{errorForStack=null}}var blockFns=Array.prototype.slice.call(arguments,0),errorForStack=new Error("Declaration Location");return isSpecRunning()?workFn.call(currentSpec):workFn}}}(window,window.angular);
"use strict";var TrNgGrid;!function(n){function ot(t){t.get(n.cellHeaderTemplateId)||t.put(n.cellHeaderTemplateId,'<div class="'+n.headerCellCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <div class="'+n.columnTitleCssClass+'">      {{columnTitle |'+n.translateFilter+":gridOptions.locale}}       <div "+n.columnSortDirectiveAttribute+'=""></div>    </div>    <div '+n.columnFilterDirectiveAttribute+'=""></div>  </div></div>'),t.get(n.cellBodyTemplateId)||t.put(n.cellBodyTemplateId,'<div ng-attr-class="'+n.bodyCellCssClass+' text-{{columnOptions.displayAlign}}" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>{{gridDisplayItem[columnOptions.displayFieldName]}}</div></div>'),t.get(n.columnFilterTemplateId)||t.put(n.columnFilterTemplateId,'<div ng-show="(gridOptions.enableFiltering&&columnOptions.enableFiltering!==false)||columnOptions.enableFiltering" class="'+n.columnFilterCssClass+'"> <div class="'+n.columnFilterInputWrapperCssClass+'">   <input class="form-control input-sm" type="text" ng-model="columnOptions.filter" ng-keypress="speedUpAsyncDataRetrieval($event)"></input> </div></div>'),t.get(n.columnSortTemplateId)||t.put(n.columnSortTemplateId,"<div ng-attr-title=\"{{'Sort'|"+n.translateFilter+':gridOptions.locale}}" ng-show="(gridOptions.enableSorting&&columnOptions.enableSorting!==false)||columnOptions.enableSorting" ng-click="toggleSorting(columnOptions.fieldName)" class="'+n.columnSortCssClass+'" >   <div ng-class="{\''+n.columnSortActiveCssClass+"':gridOptions.orderBy==columnOptions.fieldName,'"+n.columnSortInactiveCssClass+"':gridOptions.orderBy!=columnOptions.fieldName,'"+n.columnSortNormalOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&!gridOptions.orderByReverse,'"+n.columnSortReverseOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&gridOptions.orderByReverse}\" >  </div></div>"),t.put(n.cellFooterTemplateId)||t.put(n.cellFooterTemplateId,'<div class="'+n.footerCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <span '+n.globalFilterDirectiveAttribute+'=""></span>    <span '+n.pagerDirectiveAttribute+'=""></span>  </div></div>'),t.get(n.footerGlobalFilterTemplateId)||t.put(n.footerGlobalFilterTemplateId,'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" ng-keypress="speedUpAsyncDataRetrieval($event)" ng-attr-placeholder="{{\'Search\'|'+n.translateFilter+':gridOptions.locale}}"></input></span>'),t.get(n.footerPagerTemplateId)||t.put(n.footerPagerTemplateId,'<span class="pull-right form-group"> <ul class="pagination">   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(0)" ng-attr-title="{{\'First Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&laquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(gridOptions.currentPage - 1)" ng-attr-title="{{\'Previous Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&lsaquo;</span>     </a>   </li>   <li ng-if="pageSelectionActive" ng-repeat="pageIndex in pageIndexes track by $index" ng-class="{disabled:pageIndex===null, active:pageIndex===gridOptions.currentPage}">      <span ng-if="pageIndex===null">...</span>      <a href="" ng-click="navigateToPage(pageIndex)" ng-if="pageIndex!==null" ng-attr-title="{{\'Page\'|'+n.translateFilter+':gridOptions.locale}}">{{pageIndex+1}}</a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(gridOptions.currentPage + 1)" ng-attr-title="{{\'Next Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&rsaquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(lastPageIndex)" ng-attr-title="{{\'Last Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&raquo;</span>     </a>   </li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">{{\'No items to display\'|'+n.translateFilter+":gridOptions.locale}}</span>     <span ng-show=\"totalItemsCount\">       {{startItemIndex+1}} - {{endItemIndex+1}} {{'displayed'|"+n.translateFilter+":gridOptions.locale}}       <span>, {{totalItemsCount}} {{'in total'|"+n.translateFilter+":gridOptions.locale}}</span>     </span >    </li> </ul></span>")}var i,u,t,f,e,o,s;!function(n){n[n.None=0]="None",n[n.SingleRow=1]="SingleRow",n[n.MultiRow=2]="MultiRow",n[n.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers"}(n.SelectionMode||(n.SelectionMode={})),i=n.SelectionMode,n.defaultColumnOptions={cellWidth:null,cellHeight:null,displayAlign:null,displayFormat:null,displayName:null,filter:null,enableFiltering:null,enableSorting:null},n.translations={},n.debugMode=!1,u=!1,t="trNgGrid",n.sortFilter=t+"SortFilter",n.dataPagingFilter=t+"DataPagingFilter",n.translateFilter=t+"TranslateFilter",n.translationDateFormat=t+"DateFormat",n.dataFormattingFilter=t+"DataFormatFilter";var l="tr-ng-grid-body",a="field-name",d="is-customized",g="tr-ng-grid-footer-cell",v="trNgGridFooterCellTemplate",nt="tr-ng-grid-footer-cell-template";n.cellFooterTemplateId=v+".html",f="trNgGridGlobalFilter",n.globalFilterDirectiveAttribute="tr-ng-grid-global-filter",n.footerGlobalFilterTemplateId=f+".html",e="trNgGridPager",n.pagerDirectiveAttribute="tr-ng-grid-pager",n.footerPagerTemplateId=e+".html";var y="trNgGridHeaderCell",tt="tr-ng-grid-header-cell",p="trNgGridHeaderCellTemplate",it="tr-ng-grid-header-cell-template";n.cellHeaderTemplateId=p+".html";var w="trNgGridBodyCell",rt="tr-ng-grid-body-cell",b="trNgGridBodyCellTemplate",ut="tr-ng-grid-body-cell-template";n.cellBodyTemplateId=b+".html",o="trNgGridColumnSort",n.columnSortDirectiveAttribute="tr-ng-grid-column-sort",n.columnSortTemplateId=o+".html",s="trNgGridColumnFilter",n.columnFilterDirectiveAttribute="tr-ng-grid-column-filter",n.columnFilterTemplateId=s+".html";var k=function(n,t){var r,i,u;for(t=t.toUpperCase(),r=n.children(),i=0;i<r.length;i++)if(u=r[i],u.tagName==t)return angular.element(u);return null},r=function(n,t,i,r){var u=[],f=t.slice(0);return angular.forEach(n,function(n){for(var t=null,i=0;!t&&i<f.length;i++)t=f[i],t.fieldName===n.fieldName?f.splice(i,1):t=null;t?u.push(t):u.push(n)}),(i||r)&&angular.forEach(f,function(n){(i&&n.fieldName||r&&!n.fieldName)&&u.push(n)}),u},h=function(n,t,i,r){var u,e,f;i?(u=n.children(),e=angular.element(u[0]),1===u.length&&e.attr(r)||(n.empty(),f=angular.element("<div></div>").attr(r,""),n.append(f),angular.forEach(u,function(n){f.append(angular.element(n))}))):(n.empty(),n.append(angular.element("<div></div>").attr(r,"")))},ft=function(){function n(n,t){this.parent=n,this.cellElement=t,this.fieldName=t.attr(a);var i=t.children();this.isStandardColumn=0===i.length}return n}(),c=function(){function n(n,t,i,r,u){this.sectionTagName=n,this.sectionDirectiveAttribute=t,this.rowDirectiveAttribute=i,this.cellTagName=r,this.cellDirectiveAttribute=u,this.cellTagName=this.cellTagName.toUpperCase(),this.cells=null}return n.prototype.configureSection=function(n,t){var f,e,i=this,u=this.getSectionElement(n,!0);return u.empty(),u.removeAttr("ng-non-bindable"),f=r(t,this.cells,!1,!1),e=this.getTemplatedRowElement(u,!0),angular.forEach(f,function(n,t){var r,u=n;r=u.parent===i&&u.cellElement?u.cellElement.clone(!0):angular.element("<table><"+i.cellTagName+"></"+i.cellTagName+"></table>").find(i.cellTagName),i.cellDirectiveAttribute&&r.attr(i.cellDirectiveAttribute,t),n.isStandardColumn||r.attr(d,"true"),n.fieldName&&r.attr(a,n.fieldName),r.attr("ng-style","{'width':columnOptions.cellWidth,'height':columnOptions.cellHeight}"),e.append(r)}),u},n.prototype.extractPartialColumnDefinitions=function(){return this.cells},n.prototype.discoverCells=function(n){var i,t=this;this.cells=[],i=this.getTemplatedRowElement(this.getSectionElement(n,!1),!1),i&&angular.forEach(i.children(),function(n){if(n=angular.element(n),n[0].tagName===t.cellTagName.toUpperCase()){var i=n.clone(!0);t.cells.push(new ft(t,i))}})},n.prototype.getSectionElement=function(n,t){var i=null;return n&&(i=k(n,this.sectionTagName)),!i&&t&&(i=angular.element("<table><"+this.sectionTagName+"></"+this.sectionTagName+"></table>").find(this.sectionTagName),n&&n.append(i)),t&&this.sectionDirectiveAttribute&&i.attr(this.sectionDirectiveAttribute,""),i},n.prototype.getTemplatedRowElement=function(n,t){var i=null;return n&&(i=k(n,"tr")),!i&&t&&(i=angular.element("<table><tr></tr></table>").find("tr"),n&&n.append(i)),t&&this.rowDirectiveAttribute&&i.attr(this.rowDirectiveAttribute,""),i},n}(),et=function(){function f(n,t,i,r){this.$compile=n,this.$parse=t,this.$timeout=i,u||(ot(r),u=!0)}return f.prototype.setupScope=function(t,r,u){var o,s,f=this,e=angular.element(r).scope().$new();return this.gridOptions={immediateDataRetrieval:!0,items:[],fields:null,locale:"en",selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:!1,pageItems:null,currentPage:0,totalItems:null,enableFiltering:!0,enableSorting:!0,selectionMode:i[2],onDataRequiredDelay:1e3,onDataRequired:u.onDataRequired?t.onDataRequired:null,gridColumnDefs:[]},e.gridOptions=this.gridOptions,e.TrNgGrid=n,this.linkScope(e,t,"gridOptions",u),this.gridOptions.onDataRequired&&(o=function(){f.dataRequestPromise=null,f.gridOptions.immediateDataRetrieval=!1,f.gridOptions.onDataRequired(f.gridOptions)},s=function(){f.dataRequestPromise&&(f.$timeout.cancel(f.dataRequestPromise),f.dataRequestPromise=null),f.gridOptions.immediateDataRetrieval?o():f.dataRequestPromise=f.$timeout(function(){o()},f.gridOptions.onDataRequiredDelay,!0)},e.$watch("gridOptions.currentPage",function(n,t){n!==t&&s()}),e.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.pageItems, ]",function(){return 0!==f.gridOptions.currentPage?void(f.gridOptions.currentPage=0):void s()}),e.$watch("gridOptions.immediateDataRetrieval",function(n){n&&f.dataRequestPromise&&(f.$timeout.cancel(f.dataRequestPromise),o())})),e.$watch("gridOptions.selectionMode",function(n,t){if(n!==t)switch(n){case i[0]:f.gridOptions.selectedItems.splice(0);break;case i[1]:f.gridOptions.selectedItems.length>1&&f.gridOptions.selectedItems.splice(1)}}),e},f.prototype.speedUpAsyncDataRetrieval=function(n){n&&13!=n.keyCode||(this.gridOptions.immediateDataRetrieval=!0)},f.prototype.setColumnOptions=function(n,t){var i=this.gridOptions.gridColumnDefs[n];if(!i)throw"Invalid grid column options found for column index "+n+". Please report this error.";t=angular.extend(t,i),this.gridOptions.gridColumnDefs[n]=t},f.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse,this.speedUpAsyncDataRetrieval()},f.prototype.getFormattedFieldName=function(n){return n.replace(/[\.\[\]]/g,"_")},f.prototype.setFilter=function(n,t){t?this.gridOptions.filterByFields[n]=t:delete this.gridOptions.filterByFields[n],this.gridOptions.filterByFields=angular.extend({},this.gridOptions.filterByFields)},f.prototype.toggleItemSelection=function(n,t,r){var h,f,c,e,l,o,s,u;if(this.gridOptions.selectionMode!==i[0])switch(this.gridOptions.selectionMode){case i[3]:if(r.ctrlKey||r.shiftKey||r.metaKey){if(r.ctrlKey||r.metaKey)u=this.gridOptions.selectedItems.indexOf(t),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(t);else if(r.shiftKey){for(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(h=window.getSelection(),h.removeAllRanges()),c=this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1],f=0;f<n.length&&n[f].$$_gridItem!==c;f++);for(f>=n.length&&(f=0),e=0;e<n.length&&n[e].$$_gridItem!==t;e++);if(e>=n.length)throw"Invalid selection on a key modifier selection mode";for(f>e&&(l=f,f=e,e=l),o=f;e>=o;o++)s=n[o].$$_gridItem,this.gridOptions.selectedItems.indexOf(s)<0&&this.gridOptions.selectedItems.push(s)}}else u=this.gridOptions.selectedItems.indexOf(t),this.gridOptions.selectedItems.splice(0),0>u&&this.gridOptions.selectedItems.push(t);break;case i[1]:u=this.gridOptions.selectedItems.indexOf(t),this.gridOptions.selectedItems.splice(0),0>u&&this.gridOptions.selectedItems.push(t);break;case i[2]:u=this.gridOptions.selectedItems.indexOf(t),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(t)}},f.prototype.discoverTemplates=function(n){this.templatedHeader=new c("thead",null,null,"th",tt),this.templatedBody=new c("tbody",l,null,"td",rt),this.templatedFooter=new c("tfoot",null,null,"td",g),this.templatedHeader.discoverCells(n),this.templatedFooter.discoverCells(n),this.templatedBody.discoverCells(n)},f.prototype.configureTableStructure=function(t,i,u){var y,h=this,e=t.$new();i.empty(),this.columnDefsItemsWatcherDeregistration&&(this.columnDefsItemsWatcherDeregistration(),this.columnDefsItemsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration&&(this.columnDefsFieldsWatcherDeregistration(),this.columnDefsFieldsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration=e.$watch("gridOptions.fields",function(n,r){angular.equals(n,r)||h.configureTableStructure(t,i,e)},!0);var c=this.templatedHeader.extractPartialColumnDefinitions(),a=this.templatedBody.extractPartialColumnDefinitions(),v=this.templatedFooter.extractPartialColumnDefinitions(),f=[],b=this.gridOptions.fields;if(b)angular.forEach(this.gridOptions.fields,function(n){n&&f.push({isStandardColumn:!0,fieldName:n})}),f=r(f,c,!1,!0),f=r(f,a,!1,!0);else if(c.length>0)f=r(c,a,!0,!0);else{if(!this.gridOptions.items||0==this.gridOptions.items.length)return void(this.columnDefsItemsWatcherDeregistration=e.$watch("gridOptions.items.length",function(n){n&&h.configureTableStructure(t,i,e)}));for(y in this.gridOptions.items[0])y.match(/^[_\$]/g)||f.push({isStandardColumn:!0,fieldName:y});f=r(f,a,!0,!0)}0==v.length&&v.push({isStandardColumn:!0}),angular.forEach(f,function(n){n.fieldName&&(n.displayFieldName=h.getFormattedFieldName(n.fieldName))}),this.gridOptions.gridColumnDefs=f;var p=this.templatedHeader.configureSection(i,f),w=this.templatedFooter.configureSection(i,v),o=this.templatedBody.configureSection(i,f),s=this.templatedBody.getTemplatedRowElement(o);this.templatedHeader.getTemplatedRowElement(p);o.attr(l,""),s.attr("ng-click","toggleItemSelection(gridItem, $event)"),s.attr("ng-repeat","gridDisplayItem in filteredItems"),s.attr("ng-init","gridItem=gridDisplayItem.$$_gridItem"),s.attr("ng-class","{'"+n.rowSelectedCssClass+"':gridOptions.selectedItems.indexOf(gridItem)>=0}"),p.replaceWith(this.$compile(p)(e)),w.replaceWith(this.$compile(w)(e)),o.replaceWith(this.$compile(o)(e)),u&&this.$timeout(function(){return u.$destroy()})},f.prototype.computeFormattedItems=function(t){var i,l,r,o,u,a,c,s,h,e,f=t.gridOptions.items||[];for(n.debugMode&&this.log("formatting items of length "+f.length),i=t.formattedItems=t.formattedItems||[],t.gridOptions.onDataRequired?t.filteredItems=i:t.requiresReFilteringTrigger=!t.requiresReFilteringTrigger,l=t.gridOptions.gridColumnDefs,r=0;r<f.length;r++){for(o=f[r],a={gridItem:o};i.length>f.length&&(u=i[r]).$$_gridItem!==o;)i.splice(r,1);for(r<i.length?(u=i[r],u.$$_gridItem!==o&&(u={$$_gridItem:o},i[r]=u)):(u={$$_gridItem:o},i.push(u)),c=0;c<l.length;c++)try{s=l[c],h=s.fieldName,h&&(e=s.displayFormat,e?("."!=e[0]&&"|"!=e[0]&&(e=" | "+e),u[s.displayFieldName]=t.$eval("gridItem."+h+e,a)):u[s.displayFieldName]=t.$eval("gridItem."+h,a))}catch(v){n.debugMode&&this.log("Field evaluation failed for <"+h+"> with error "+v)}}i.length>f.length&&i.splice(f.length,i.length-f.length)},f.prototype.computeFilteredItems=function(t){if(t.filterByDisplayFields={},t.gridOptions.filterByFields)for(var i in t.gridOptions.filterByFields)t.filterByDisplayFields[this.getFormattedFieldName(i)]=t.gridOptions.filterByFields[i];n.debugMode&&this.log("filtering items of length "+(t.formattedItems?t.formattedItems.length:0)),t.filteredItems=t.$eval("formattedItems | filter:gridOptions.filterBy | filter:filterByDisplayFields | "+n.sortFilter+":gridOptions | "+n.dataPagingFilter+":gridOptions")},f.prototype.setupDisplayItemsArray=function(t){var r=this,i="[gridOptions.items,gridOptions.gridColumnDefs.length";angular.forEach(t.gridOptions.gridColumnDefs,function(n){if(n.displayFormat&&"."!=n.displayFormat[0]){var t=n.displayFormat.split("|");angular.forEach(t,function(n){var t=n.split(":");t.length>1&&angular.forEach(t.slice(1),function(n){n=n.trim(),n&&"gridItem"!==n&&"gridDisplayItem"!==n&&(i+=","+n)})})}}),i+="]",n.debugMode&&this.log("re-formatting is set to watch for changes in "+i),t.$watch(i,function(){return r.computeFormattedItems(t)},!0),t.gridOptions.onDataRequired||(i="[requiresReFilteringTrigger, gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.currentPage, gridOptions.pageItems]",t.$watch(i,function(){r.computeFilteredItems(t)},!0))},f.prototype.linkAttrs=function(n,t){var r=function(n,i){if("undefined"!=typeof i){switch(i){case"true":i=!0;break;case"false":i=!1}t[n]=i}};for(var i in t)r(i,n[i]),function(t){n.$observe(t,function(n){return r(t,n)})}(i)},f.prototype.linkScope=function(t,i,r,u){var f,s,h,o,c=this,e=t[r];for(f in e)if(s="undefined"!=typeof u[f]&&null!=u[f]){h=!1,"undefined"!=typeof i[f]&&null!=i[f]&&(e[f]=i[f],h=e[f]instanceof Array),o=null;try{o=this.$parse(u[f])}catch(l){}!function(u,f){f&&f.constant||i.$watch(u,function(n){e[u]=n});var o=f&&f.assign?f.assign:null;o&&t.$watch(r+"."+u,function(t){try{i[u]=t}catch(r){if(n.debugMode)throw c.log("Mirroring the property on the external scope failed with "+r),r}})}(f,o)}},f.prototype.log=function(n){console.log(t+"("+(new Date).getTime()+"): "+n)},f}();angular.module("trNgGrid",[]).directive(t,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",enableSelections:"=?",enableMultiRowSelections:"=?",selectionMode:"@",locale:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"},template:function(t){t.addClass(n.tableCssClass),angular.forEach(t.children(),function(n){n=angular.element(n),n.attr("ng-non-bindable","")})},controller:["$compile","$parse","$timeout","$templateCache",et],compile:function(){return{pre:function(n,t,i,r){r.discoverTemplates(t)},post:function(n,t,i,r){var u=r.setupScope(n,t,i);u.speedUpAsyncDataRetrieval=function(n){return r.speedUpAsyncDataRetrieval(n)},r.configureTableStructure(u,t),r.setupDisplayItemsArray(u)}}}}}]).directive(y,[function(){var i=function(n){if(n.columnOptions.displayName)n.columnTitle=n.columnOptions.displayName;else if(n.columnOptions.fieldName){var t=n.columnOptions.fieldName.match(/^[^\.\[\]]*/);t=t[0].split(/(?=[A-Z])/),t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),n.columnTitle=t.join(" ")}else n.columnTitle="[Invalid Field Name]"};return{restrict:"A",require:"^"+t,scope:!0,compile:function(t,r){var u="true"==r.isCustomized;return h(t,r,u,it),{pre:function(t,r,f,e){var s=parseInt(f[y]),o=angular.extend(t.gridOptions.gridColumnDefs[s],n.defaultColumnOptions);e.linkAttrs(f,o),t.columnOptions=o,t.isCustomized=u,t.toggleSorting=function(n){e.toggleSorting(n)},i(t),t.$watch("columnOptions.filter",function(n,t){n!==t&&e.setFilter(o.fieldName,n)})}}}}}]).directive(p,[function(){return{restrict:"A",templateUrl:n.cellHeaderTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridBody",[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(){return{pre:function(n,t,i,r){n.toggleItemSelection=function(t,i){r.toggleItemSelection(n.filteredItems,t,i)}}}}}}]).directive(w,[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(n,t){var i="true"==t.isCustomized;return h(n,t,i,ut),{pre:function(n,t,r){n.columnOptions=n.gridOptions.gridColumnDefs[parseInt(r[w])],n.gridItem=n.gridDisplayItem.$$_gridItem,n.isCustomized=i}}}}}]).directive(b,[function(){return{restrict:"A",templateUrl:n.cellBodyTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridFooterCell",[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(n,t){var i="true"==t.isCustomized;return h(n,t,i,nt),{pre:function(n,t){n.isCustomized=i,t.attr("colspan",n.gridOptions.gridColumnDefs.length)}}}}}]).directive(v,[function(){return{restrict:"A",templateUrl:n.cellFooterTemplateId,transclude:!0,replace:!0}}]).directive(o,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnSortTemplateId}}]).directive(s,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnFilterTemplateId}}]).directive(f,[function(){return{restrict:"A",scope:!1,templateUrl:n.footerGlobalFilterTemplateId}}]).directive(e,[function(){var i=function(t){var f,i;if(t.totalItemsCount="undefined"!=typeof t.gridOptions.totalItems&&null!=t.gridOptions.totalItems?t.gridOptions.totalItems:t.gridOptions.items?t.gridOptions.items.length:0,t.isPaged=!!t.gridOptions.pageItems&&t.gridOptions.pageItems<t.totalItemsCount,t.extendedControlsActive=!1,t.lastPageIndex=t.totalItemsCount&&t.isPaged?Math.floor(t.totalItemsCount/t.gridOptions.pageItems)+(t.totalItemsCount%t.gridOptions.pageItems?0:-1):0,t.gridOptions.currentPage>t.lastPageIndex&&(t.gridOptions.currentPage=t.lastPageIndex),t.startItemIndex=t.isPaged?t.gridOptions.pageItems*t.gridOptions.currentPage:0,t.endItemIndex=t.isPaged?t.startItemIndex+t.gridOptions.pageItems-1:t.totalItemsCount-1,t.endItemIndex>=t.totalItemsCount&&(t.endItemIndex=t.totalItemsCount-1),t.endItemIndex<t.startItemIndex&&(t.endItemIndex=t.startItemIndex),t.pageCanGoBack=t.isPaged&&t.gridOptions.currentPage>0,t.pageCanGoForward=t.isPaged&&t.gridOptions.currentPage<t.lastPageIndex,t.pageIndexes=t.pageIndexes||[],t.pageIndexes.splice(0),t.isPaged)if(t.lastPageIndex+1>n.defaultPagerMinifiedPageCountThreshold){t.extendedControlsActive=!0;var e=Math.floor(n.defaultPagerMinifiedPageCountThreshold/2),r=t.gridOptions.currentPage-e,u=t.gridOptions.currentPage+e;for(0>r?(u+=-r,r=0):u>t.lastPageIndex&&(r-=u-t.lastPageIndex,u=t.lastPageIndex),r>0&&(t.pageIndexes.push(null),r++),f=!1,u<t.lastPageIndex&&(f=!0,u--),i=r;u>=i;i++)t.pageIndexes.push(i);f&&t.pageIndexes.push(null)}else for(t.extendedControlsActive=!1,i=0;i<=t.lastPageIndex;i++)t.pageIndexes.push(i);t.pageSelectionActive=t.pageIndexes.length>1,t.navigateToPage=function(n){t.gridOptions.currentPage=n,t.speedUpAsyncDataRetrieval()},t.switchPageSelection=function(n,i){t.pageSelectionActive=i,n&&(n.preventDefault(),n.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+t,templateUrl:n.footerPagerTemplateId,replace:!0,compile:function(){return{pre:function(n,t,r,u){i(n,u)},post:function(n,t,r,u){n.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(){i(n,u)})}}}}}]).filter(n.sortFilter,["$filter","$parse",function(n,t){return function(i,r){var u,f;if(!r.orderBy||!r.gridColumnDefs)return i;for(u=null,f=0;f<r.gridColumnDefs.length&&(u=r.gridColumnDefs[f]).fieldName!==r.orderBy;u=null,f++);return u?n("orderBy")(i,function(n){var i=void 0;try{i=t("item.$$_gridItem."+u.fieldName)({item:n})}catch(r){}if(void 0===i)try{i=t("item."+u.displayFieldName)({item:n})}catch(r){}return i},r.orderByReverse):i}}]).filter(n.dataPagingFilter,function(){return function(n,t){var i,r;return n&&(t.totalItems=n.length),t.pageItems&&n&&0!=n.length?(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r)):n}}).filter(n.translateFilter,["$filter",function(t){return function(i,r){var u,f,o,e,c,s,h;if(i instanceof Date)return f=t(n.translateFilter)(n.translationDateFormat,r),f&&f!==n.translationDateFormat?t("date")(i,f):i;if(!u)for(o=r.split(/[-_]/),e=o.length;e>0&&!u;e--)c=o.slice(0,e).join("-"),s=n.translations[c],s&&(u=s[i]);if(!u)try{h=t("translate"),h&&(u=h(i))}catch(l){}return u||(u=i),u}}]).run(function(){n.tableCssClass="tr-ng-grid table table-bordered table-hover",n.cellCssClass="tr-ng-cell",n.headerCellCssClass="tr-ng-column-header "+n.cellCssClass,n.bodyCellCssClass=n.cellCssClass,n.columnTitleCssClass="tr-ng-title",n.columnSortCssClass="tr-ng-sort",n.columnFilterCssClass="tr-ng-column-filter",n.columnFilterInputWrapperCssClass="",n.columnSortActiveCssClass="tr-ng-sort-active text-info",n.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted glyphicon glyphicon-chevron-down",n.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-down",n.columnSortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-up",n.rowSelectedCssClass="active",n.footerCssClass="tr-ng-grid-footer form-inline"}).run(function(){n.defaultColumnOptions.displayAlign="left",n.defaultPagerMinifiedPageCountThreshold=3})}(TrNgGrid||(TrNgGrid={}));
!function(window,angular,undefined){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){return value?(hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.textContent):""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre");angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/i,MAILTO_REGEXP=/^mailto:/i;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular);
"use strict";angular.module("ui.alias",[]).config(["$compileProvider","uiAliasConfig",function($compileProvider,uiAliasConfig){uiAliasConfig=uiAliasConfig||{},angular.forEach(uiAliasConfig,function(config,alias){angular.isString(config)&&(config={replace:!0,template:config}),$compileProvider.directive(alias,function(){return config})})}]),angular.module("ui.event",[]).directive("uiEvent",["$parse",function($parse){return function($scope,elm,attrs){var events=$scope.$eval(attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),fn($scope,{$event:evt,$params:params}),$scope.$$phase||$scope.$apply()})})}}]),angular.module("ui.format",[]).filter("format",function(){return function(value,replace){var target=value;if(angular.isString(target)&&void 0!==replace)if(angular.isArray(replace)||angular.isObject(replace)||(replace=[replace]),angular.isArray(replace)){var rlen=replace.length,rfx=function(str,i){return i=parseInt(i,10),i>=0&&rlen>i?replace[i]:str};target=target.replace(/\$([0-9]+)/g,rfx)}else angular.forEach(replace,function(value,key){target=target.split(":"+key).join(value)});return target}}),angular.module("ui.highlight",[]).filter("highlight",function(){return function(text,search,caseSensitive){return search||angular.isNumber(search)?(text=text.toString(),search=search.toString(),caseSensitive?text.split(search).join('<span class="ui-match">'+search+"</span>"):text.replace(new RegExp(search,"gi"),'<span class="ui-match">$&</span>')):text}}),angular.module("ui.include",[]).directive("uiInclude",["$http","$templateCache","$anchorScroll","$compile",function($http,$templateCache,$anchorScroll,$compile){return{restrict:"ECA",terminal:!0,compile:function(element,attr){var srcExp=attr.uiInclude||attr.src,fragExp=attr.fragment||"",onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,element){function ngIncludeWatchAction(){var thisChangeId=++changeCounter,src=scope.$eval(srcExp),fragment=scope.$eval(fragExp);src?$http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){childScope&&childScope.$destroy(),childScope=scope.$new();var contents;contents=fragment?angular.element("<div/>").html(response).find(fragment):angular.element("<div/>").html(response).contents(),element.html(contents),$compile(contents)(childScope),!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll(),childScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&clearContent()}):clearContent()}var childScope,changeCounter=0,clearContent=function(){childScope&&(childScope.$destroy(),childScope=null),element.html("")};scope.$watch(fragExp,ngIncludeWatchAction),scope.$watch(srcExp,ngIncludeWatchAction)}}}}]),angular.module("ui.indeterminate",[]).directive("uiIndeterminate",[function(){return{compile:function(tElm,tAttrs){return tAttrs.type&&"checkbox"===tAttrs.type.toLowerCase()?function($scope,elm,attrs){$scope.$watch(attrs.uiIndeterminate,function(newVal){elm[0].indeterminate=!!newVal})}:angular.noop}}}]),angular.module("ui.inflector",[]).filter("inflector",function(){function ucwords(text){return text.replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase()})}function breakup(text,separator){return text.replace(/[A-Z]/g,function(match){return separator+match})}var inflectors={humanize:function(value){return ucwords(breakup(value," ").split("_").join(" "))},underscore:function(value){return value.substr(0,1).toLowerCase()+breakup(value.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(value){return value=value.substr(0,1).toLowerCase()+ucwords(value.split("_").join(" ")).substr(1).split(" ").join("")}};return function(text,inflector){return inflector!==!1&&angular.isString(text)?(inflector=inflector||"humanize",inflectors[inflector](text)):text}}),angular.module("ui.jq",[]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","$timeout",function(uiJqConfig,$timeout){return{restrict:"A",compile:function(tElm,tAttrs){if(!angular.isFunction(tElm[tAttrs.uiJq]))throw new Error('ui-jq: The "'+tAttrs.uiJq+'" function does not exist');var options=uiJqConfig&&uiJqConfig[tAttrs.uiJq];return function(scope,elm,attrs){function callPlugin(){$timeout(function(){elm[attrs.uiJq].apply(elm,linkOptions)},0,!1)}var linkOptions=[];attrs.uiOptions?(linkOptions=scope.$eval("["+attrs.uiOptions+"]"),angular.isObject(options)&&angular.isObject(linkOptions[0])&&(linkOptions[0]=angular.extend({},options,linkOptions[0]))):options&&(linkOptions=[options]),attrs.ngModel&&elm.is("select,input,textarea")&&elm.bind("change",function(){elm.trigger("input")}),attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(){callPlugin()}),callPlugin()}}}}]),angular.module("ui.keypress",[]).factory("keypressHelper",["$parse",function($parse){var keysByCode={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},capitaliseFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1)};return function(mode,scope,elm,attrs){var params,combinations=[];params=scope.$eval(attrs["ui"+capitaliseFirstLetter(mode)]),angular.forEach(params,function(v,k){var combination,expression;expression=$parse(v),angular.forEach(k.split(" "),function(variation){combination={expression:expression,keys:{}},angular.forEach(variation.split("-"),function(value){combination.keys[value]=!0}),combinations.push(combination)})}),elm.bind(mode,function(event){var metaPressed=!(!event.metaKey||event.ctrlKey),altPressed=!!event.altKey,ctrlPressed=!!event.ctrlKey,shiftPressed=!!event.shiftKey,keyCode=event.keyCode;"keypress"===mode&&!shiftPressed&&keyCode>=97&&122>=keyCode&&(keyCode-=32),angular.forEach(combinations,function(combination){var mainKeyPressed=combination.keys[keysByCode[keyCode]]||combination.keys[keyCode.toString()],metaRequired=!!combination.keys.meta,altRequired=!!combination.keys.alt,ctrlRequired=!!combination.keys.ctrl,shiftRequired=!!combination.keys.shift;mainKeyPressed&&metaRequired===metaPressed&&altRequired===altPressed&&ctrlRequired===ctrlPressed&&shiftRequired===shiftPressed&&scope.$apply(function(){combination.expression(scope,{$event:event})})})})}}]),angular.module("ui.keypress").directive("uiKeydown",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keydown",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeypress",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keypress",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeyup",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keyup",scope,elm,attrs)}}}]),angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/}}).directive("uiMask",["uiMaskConfig",function(maskConfig){return{priority:100,require:"ngModel",restrict:"A",compile:function(){var options=maskConfig;return function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),bindEventListeners(),!0):uninitialize()):uninitialize()}function initPlaceholder(placeholderAttr){angular.isDefined(placeholderAttr)&&(maskPlaceholder=placeholderAttr,maskProcessed&&eventHandler())}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),isValid&&value.length?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),controller.$viewValue=value.length?maskValue(value):"",controller.$setValidity("mask",isValid),""===value&&void 0!==controller.$error.required&&controller.$setValidity("required",!1),isValid?value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value);var viewValue=isValid&&value.length?valueMasked:"";iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),iElement.attr("placeholder",maskPlaceholder),iElement.val(viewValue),controller.$viewValue=viewValue}function bindEventListeners(){eventsBound||(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("input keyup click focus",eventHandler),eventsBound=!0)}function unbindEventListeners(){eventsBound&&(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),iElement.unbind("focus",eventHandler),eventsBound=!1)}function validateValue(value){return value.length?value.length>=minRequiredLength:!0}function unmaskValue(value){var valueUnmasked="",maskPatternsCopy=maskPatterns.slice();return value=value.toString(),angular.forEach(maskComponents,function(component){value=value.replace(component,"")}),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function getPlaceholderChar(i){var placeholder=iAttrs.placeholder;return"undefined"!=typeof placeholder&&placeholder[i]?placeholder[i]:"_"}function getMaskComponents(){return maskPlaceholder.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="","string"==typeof mask){minRequiredLength=0;var isOptional=!1,splitMask=mask.split("");angular.forEach(splitMask,function(chr,i){linkOptions.maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+=getPlaceholderChar(i),maskPatterns.push(linkOptions.maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++):"?"===chr?isOptional=!0:(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=getMaskComponents(),maskProcessed=maskCaretMap.length>1?!0:!1}function blurHandler(){oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$setViewValue("")}))}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16!==eventWhich&&91!==eventWhich){var valMasked,val=iElement.val(),valOld=oldValue,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,valAltered=!1,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLenOld=oldSelectionLength||0,isSelected=getSelectionLength(this)>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&40>=eventWhich&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&-1===caretPosDelta,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=getSelectionLength(this),!isSelection&&(!isSelected||"click"!==eventType&&"keyup"!==eventType)){if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPosMax>caretPos&&-1===maskCaretMap.indexOf(caretPos);)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valAltered=!0}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valUnmasked)}),isAddition&&caretPosMin>=caretPos&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPosMin>caretPos?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPosMax>caretPos;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPosMax>caretPos||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos)}}}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(!input)return 0;if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",-input.value.length),selection.text.length}return 0}function setCaretPosition(input,pos){if(!input)return 0;if(0!==input.offsetWidth&&0!==input.offsetHeight)if(input.setSelectionRange)input.focus(),input.setSelectionRange(pos,pos);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return input?void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength,linkOptions={};iAttrs.uiOptions?(linkOptions=scope.$eval("["+iAttrs.uiOptions+"]"),angular.isObject(linkOptions[0])&&(linkOptions=function(original,current){for(var i in original)Object.prototype.hasOwnProperty.call(original,i)&&(current[i]?angular.extend(current[i],original[i]):current[i]=angular.copy(original[i]));return current}(options,linkOptions[0]))):linkOptions=options,iAttrs.$observe("uiMask",initialize),iAttrs.$observe("placeholder",initPlaceholder),controller.$formatters.push(formatter),controller.$parsers.push(parser),iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);len>k;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}}]),angular.module("ui.reset",[]).value("uiResetConfig",null).directive("uiReset",["uiResetConfig",function(uiResetConfig){var resetValue=null;return void 0!==uiResetConfig&&(resetValue=uiResetConfig),{require:"ngModel",link:function(scope,elm,attrs,ctrl){var aElement;aElement=angular.element('<a class="ui-reset" />'),elm.wrap('<span class="ui-resetwrap" />').after(aElement),aElement.bind("click",function(e){e.preventDefault(),scope.$apply(function(){attrs.uiReset?ctrl.$setViewValue(scope.$eval(attrs.uiReset)):ctrl.$setViewValue(resetValue),ctrl.$render()})})}}}]),angular.module("ui.route",[]).directive("uiRoute",["$location","$parse",function($location,$parse){return{restrict:"AC",scope:!0,compile:function(tElement,tAttrs){var useProperty;if(tAttrs.uiRoute)useProperty="uiRoute";else if(tAttrs.ngHref)useProperty="ngHref";else{if(!tAttrs.href)throw new Error("uiRoute missing a route or href property on "+tElement[0]);useProperty="href"}return function($scope,elm,attrs){function staticWatcher(newVal){var hash=newVal.indexOf("#");hash>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){modelSetter($scope,$location.path().indexOf(newVal)>-1)})()}function regexWatcher(newVal){var hash=newVal.indexOf("#");hash>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){var regexp=new RegExp("^"+newVal+"$",["i"]);modelSetter($scope,regexp.test($location.path()))})()}var modelSetter=$parse(attrs.ngModel||attrs.routeModel||"$uiRoute").assign,watcher=angular.noop;switch(useProperty){case"uiRoute":attrs.uiRoute?regexWatcher(attrs.uiRoute):attrs.$observe("uiRoute",regexWatcher);break;case"ngHref":attrs.ngHref?staticWatcher(attrs.ngHref):attrs.$observe("ngHref",staticWatcher);break;case"href":staticWatcher(attrs.href)}$scope.$on("$routeChangeSuccess",function(){watcher()}),$scope.$on("$stateChangeSuccess",function(){watcher()})}}}}]),angular.module("ui.scroll.jqlite",["ui.scroll"]).service("jqLiteExtras",["$log","$window",function(console,window){return{registerFor:function(element){var convertToPx,css,getMeasurements,getStyle,getWidthHeight,isWindow,scrollTo;return css=angular.element.prototype.css,element.prototype.css=function(name,value){var elem,self;return self=this,elem=self[0],elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style?css.call(self,name,value):void 0},isWindow=function(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval},scrollTo=function(self,direction,value){var elem,method,preserve,prop,_ref;return elem=self[0],_ref={top:["scrollTop","pageYOffset","scrollLeft"],left:["scrollLeft","pageXOffset","scrollTop"]}[direction],method=_ref[0],prop=_ref[1],preserve=_ref[2],isWindow(elem)?angular.isDefined(value)?elem.scrollTo(self[preserve].call(self),value):prop in elem?elem[prop]:elem.document.documentElement[method]:angular.isDefined(value)?elem[method]=value:elem[method]},window.getComputedStyle?(getStyle=function(elem){return window.getComputedStyle(elem,null)},convertToPx=function(elem,value){return parseFloat(value)}):(getStyle=function(elem){return elem.currentStyle},convertToPx=function(elem,value){var core_pnum,left,result,rnumnonpx,rs,rsLeft,style;return core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rnumnonpx.test(value)?(style=elem.style,left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rs&&(rs.left=style.left),style.left=value,result=style.pixelLeft,style.left=left,rsLeft&&(rs.left=rsLeft),result):parseFloat(value)}),getMeasurements=function(elem,measure){var base,borderA,borderB,computedMarginA,computedMarginB,computedStyle,dirA,dirB,marginA,marginB,paddingA,paddingB,_ref;return isWindow(elem)?(base=document.documentElement[{height:"clientHeight",width:"clientWidth"}[measure]],{base:base,padding:0,border:0,margin:0}):(_ref={width:[elem.offsetWidth,"Left","Right"],height:[elem.offsetHeight,"Top","Bottom"]}[measure],base=_ref[0],dirA=_ref[1],dirB=_ref[2],computedStyle=getStyle(elem),paddingA=convertToPx(elem,computedStyle["padding"+dirA])||0,paddingB=convertToPx(elem,computedStyle["padding"+dirB])||0,borderA=convertToPx(elem,computedStyle["border"+dirA+"Width"])||0,borderB=convertToPx(elem,computedStyle["border"+dirB+"Width"])||0,computedMarginA=computedStyle["margin"+dirA],computedMarginB=computedStyle["margin"+dirB],marginA=convertToPx(elem,computedMarginA)||0,marginB=convertToPx(elem,computedMarginB)||0,{base:base,padding:paddingA+paddingB,border:borderA+borderB,margin:marginA+marginB})},getWidthHeight=function(elem,direction,measure){var computedStyle,measurements,result;return measurements=getMeasurements(elem,direction),measurements.base>0?{base:measurements.base-measurements.padding-measurements.border,outer:measurements.base,outerfull:measurements.base+measurements.margin}[measure]:(computedStyle=getStyle(elem),result=computedStyle[direction],(0>result||null===result)&&(result=elem.style[direction]||0),result=parseFloat(result)||0,{base:result-measurements.padding-measurements.border,outer:result,outerfull:result+measurements.padding+measurements.border+measurements.margin}[measure])},angular.forEach({before:function(newElem){var children,elem,i,parent,self,_i,_ref;if(self=this,elem=self[0],parent=self.parent(),children=parent.contents(),children[0]===elem)return parent.prepend(newElem);for(i=_i=1,_ref=children.length-1;_ref>=1?_ref>=_i:_i>=_ref;i=_ref>=1?++_i:--_i)if(children[i]===elem)return void angular.element(children[i-1]).after(newElem);throw new Error("invalid DOM structure "+elem.outerHTML)},height:function(value){var self;return self=this,angular.isDefined(value)?(angular.isNumber(value)&&(value+="px"),css.call(self,"height",value)):getWidthHeight(this[0],"height","base")},outerHeight:function(option){return getWidthHeight(this[0],"height",option?"outerfull":"outer")},offset:function(value){var box,doc,docElem,elem,self,win;return self=this,arguments.length?void 0===value?self:value:(box={top:0,left:0},elem=self[0],(doc=elem&&elem.ownerDocument)?(docElem=doc.documentElement,elem.getBoundingClientRect&&(box=elem.getBoundingClientRect()),win=doc.defaultView||doc.parentWindow,{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):void 0)},scrollTop:function(value){return scrollTo(this,"top",value)},scrollLeft:function(value){return scrollTo(this,"left",value)}},function(value,key){return element.prototype[key]?void 0:element.prototype[key]=value})}}}]).run(["$log","$window","jqLiteExtras",function(console,window,jqLiteExtras){return window.jQuery?void 0:jqLiteExtras.registerFor(angular.element)}]),angular.module("ui.scroll",[]).directive("ngScrollViewport",["$log",function(){return{controller:["$scope","$element",function(scope,element){return element}]}}]).directive("ngScroll",["$log","$injector","$rootScope","$timeout",function(console,$injector,$rootScope,$timeout){return{require:["?^ngScrollViewport"],transclude:"element",priority:1e3,terminal:!0,compile:function(element,attr,linker){return function($scope,$element,$attr,controllers){var adapter,adjustBuffer,adjustRowHeight,bof,bottomVisiblePos,buffer,bufferPadding,bufferSize,clipBottom,clipTop,datasource,datasourceName,enqueueFetch,eof,eventListener,fetch,finalize,first,insert,isDatasource,isLoading,itemName,loading,match,next,pending,reload,removeFromBuffer,resizeHandler,scrollHandler,scrollHeight,shouldLoadBottom,shouldLoadTop,tempScope,topVisiblePos,viewport;if(match=$attr.ngScroll.match(/^\s*(\w+)\s+in\s+(\w+)\s*$/),!match)throw new Error('Expected ngScroll in form of "item_ in _datasource_" but got "'+$attr.ngScroll+'"');if(itemName=match[1],datasourceName=match[2],isDatasource=function(datasource){return angular.isObject(datasource)&&datasource.get&&angular.isFunction(datasource.get)},datasource=$scope[datasourceName],!isDatasource(datasource)&&(datasource=$injector.get(datasourceName),!isDatasource(datasource)))throw new Error(datasourceName+" is not a valid datasource");return bufferSize=Math.max(3,+$attr.bufferSize||10),bufferPadding=function(){return viewport.height()*Math.max(.1,+$attr.padding||.1)},scrollHeight=function(elem){return elem[0].scrollHeight||elem[0].document.documentElement.scrollHeight},adapter=null,linker(tempScope=$scope.$new(),function(template){var bottomPadding,createPadding,padding,repeaterType,topPadding,viewport;if(repeaterType=template[0].localName,"dl"===repeaterType)throw new Error("ng-scroll directive does not support <"+template[0].localName+"> as a repeating tag: "+template[0].outerHTML);return"li"!==repeaterType&&"tr"!==repeaterType&&(repeaterType="div"),viewport=controllers[0]||angular.element(window),viewport.css({"overflow-y":"auto",display:"block"}),padding=function(repeaterType){var div,result,table;switch(repeaterType){case"tr":return table=angular.element("<table><tr><td><div></div></td></tr></table>"),div=table.find("div"),result=table.find("tr"),result.paddingHeight=function(){return div.height.apply(div,arguments)},result;default:return result=angular.element("<"+repeaterType+"></"+repeaterType+">"),result.paddingHeight=result.height,result}},createPadding=function(padding,element,direction){return element[{top:"before",bottom:"after"}[direction]](padding),{paddingHeight:function(){return padding.paddingHeight.apply(padding,arguments)},insert:function(element){return padding[{top:"after",bottom:"before"}[direction]](element)}}},topPadding=createPadding(padding(repeaterType),element,"top"),bottomPadding=createPadding(padding(repeaterType),element,"bottom"),tempScope.$destroy(),adapter={viewport:viewport,topPadding:topPadding.paddingHeight,bottomPadding:bottomPadding.paddingHeight,append:bottomPadding.insert,prepend:topPadding.insert,bottomDataPos:function(){return scrollHeight(viewport)-bottomPadding.paddingHeight()},topDataPos:function(){return topPadding.paddingHeight()}}}),viewport=adapter.viewport,first=1,next=1,buffer=[],pending=[],eof=!1,bof=!1,loading=datasource.loading||function(){},isLoading=!1,removeFromBuffer=function(start,stop){var i,_i;for(i=_i=start;stop>=start?stop>_i:_i>stop;i=stop>=start?++_i:--_i)buffer[i].scope.$destroy(),buffer[i].element.remove();return buffer.splice(start,stop-start)},reload=function(){return first=1,next=1,removeFromBuffer(0,buffer.length),adapter.topPadding(0),adapter.bottomPadding(0),pending=[],eof=!1,bof=!1,adjustBuffer(!1)},bottomVisiblePos=function(){return viewport.scrollTop()+viewport.height()},topVisiblePos=function(){return viewport.scrollTop()},shouldLoadBottom=function(){return!eof&&adapter.bottomDataPos()<bottomVisiblePos()+bufferPadding()},clipBottom=function(){var bottomHeight,i,itemHeight,overage,_i,_ref;for(bottomHeight=0,overage=0,i=_i=_ref=buffer.length-1;(0>=_ref?0>=_i:_i>=0)&&(itemHeight=buffer[i].element.outerHeight(!0),adapter.bottomDataPos()-bottomHeight-itemHeight>bottomVisiblePos()+bufferPadding());i=0>=_ref?++_i:--_i)bottomHeight+=itemHeight,overage++,eof=!1;return overage>0?(adapter.bottomPadding(adapter.bottomPadding()+bottomHeight),removeFromBuffer(buffer.length-overage,buffer.length),next-=overage,console.log("clipped off bottom "+overage+" bottom padding "+adapter.bottomPadding())):void 0},shouldLoadTop=function(){return!bof&&adapter.topDataPos()>topVisiblePos()-bufferPadding()},clipTop=function(){var item,itemHeight,overage,topHeight,_i,_len;for(topHeight=0,overage=0,_i=0,_len=buffer.length;_len>_i&&(item=buffer[_i],itemHeight=item.element.outerHeight(!0),adapter.topDataPos()+topHeight+itemHeight<topVisiblePos()-bufferPadding());_i++)topHeight+=itemHeight,overage++,bof=!1;return overage>0?(adapter.topPadding(adapter.topPadding()+topHeight),removeFromBuffer(0,overage),first+=overage,console.log("clipped off top "+overage+" top padding "+adapter.topPadding())):void 0},enqueueFetch=function(direction,scrolling){return isLoading||(isLoading=!0,loading(!0)),1===pending.push(direction)?fetch(scrolling):void 0},insert=function(index,item){var itemScope,toBeAppended,wrapper;return itemScope=$scope.$new(),itemScope[itemName]=item,toBeAppended=index>first,itemScope.$index=index,toBeAppended&&itemScope.$index--,wrapper={scope:itemScope},linker(itemScope,function(clone){return wrapper.element=clone,toBeAppended?index===next?(adapter.append(clone),buffer.push(wrapper)):(buffer[index-first].element.after(clone),buffer.splice(index-first+1,0,wrapper)):(adapter.prepend(clone),buffer.unshift(wrapper))}),{appended:toBeAppended,wrapper:wrapper}},adjustRowHeight=function(appended,wrapper){var newHeight;return appended?adapter.bottomPadding(Math.max(0,adapter.bottomPadding()-wrapper.element.outerHeight(!0))):(newHeight=adapter.topPadding()-wrapper.element.outerHeight(!0),newHeight>=0?adapter.topPadding(newHeight):viewport.scrollTop(viewport.scrollTop()+wrapper.element.outerHeight(!0)))},adjustBuffer=function(scrolling,newItems,finalize){var doAdjustment;return doAdjustment=function(){return console.log("top {actual="+adapter.topDataPos()+" visible from="+topVisiblePos()+" bottom {visible through="+bottomVisiblePos()+" actual="+adapter.bottomDataPos()+"}"),shouldLoadBottom()?enqueueFetch(!0,scrolling):shouldLoadTop()&&enqueueFetch(!1,scrolling),finalize?finalize():void 0},newItems?$timeout(function(){var row,_i,_len;for(_i=0,_len=newItems.length;_len>_i;_i++)row=newItems[_i],adjustRowHeight(row.appended,row.wrapper);return doAdjustment()}):doAdjustment()},finalize=function(scrolling,newItems){return adjustBuffer(scrolling,newItems,function(){return pending.shift(),0===pending.length?(isLoading=!1,loading(!1)):fetch(scrolling)})},fetch=function(scrolling){var direction;return direction=pending[0],direction?buffer.length&&!shouldLoadBottom()?finalize(scrolling):datasource.get(next,bufferSize,function(result){var item,newItems,_i,_len;if(newItems=[],0===result.length)eof=!0,adapter.bottomPadding(0),console.log("appended: requested "+bufferSize+" records starting from "+next+" recieved: eof");else{for(clipTop(),_i=0,_len=result.length;_len>_i;_i++)item=result[_i],newItems.push(insert(++next,item));console.log("appended: requested "+bufferSize+" received "+result.length+" buffer size "+buffer.length+" first "+first+" next "+next)}return finalize(scrolling,newItems)}):buffer.length&&!shouldLoadTop()?finalize(scrolling):datasource.get(first-bufferSize,bufferSize,function(result){var i,newItems,_i,_ref;if(newItems=[],0===result.length)bof=!0,adapter.topPadding(0),console.log("prepended: requested "+bufferSize+" records starting from "+(first-bufferSize)+" recieved: bof");else{for(clipBottom(),i=_i=_ref=result.length-1;0>=_ref?0>=_i:_i>=0;i=0>=_ref?++_i:--_i)newItems.unshift(insert(--first,result[i]));console.log("prepended: requested "+bufferSize+" received "+result.length+" buffer size "+buffer.length+" first "+first+" next "+next)}return finalize(scrolling,newItems)})},resizeHandler=function(){return $rootScope.$$phase||isLoading?void 0:(adjustBuffer(!1),$scope.$apply())},viewport.bind("resize",resizeHandler),scrollHandler=function(){return $rootScope.$$phase||isLoading?void 0:(adjustBuffer(!0),$scope.$apply())},viewport.bind("scroll",scrollHandler),$scope.$watch(datasource.revision,function(){return reload()}),eventListener=datasource.scope?datasource.scope.$new():$scope.$new(),$scope.$on("$destroy",function(){return eventListener.$destroy(),viewport.unbind("resize",resizeHandler),viewport.unbind("scroll",scrollHandler)}),eventListener.$on("update.items",function(event,locator,newItem){var wrapper,_fn,_i,_len,_ref;if(angular.isFunction(locator))for(_fn=function(wrapper){return locator(wrapper.scope)},_i=0,_len=buffer.length;_len>_i;_i++)wrapper=buffer[_i],_fn(wrapper);else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(buffer[locator-first-1].scope[itemName]=newItem);return null}),eventListener.$on("delete.items",function(event,locator){var i,item,temp,wrapper,_fn,_i,_j,_k,_len,_len1,_len2,_ref;if(angular.isFunction(locator)){for(temp=[],_i=0,_len=buffer.length;_len>_i;_i++)item=buffer[_i],temp.unshift(item);for(_fn=function(wrapper){
return locator(wrapper.scope)?(removeFromBuffer(temp.length-1-i,temp.length-i),next--):void 0},i=_j=0,_len1=temp.length;_len1>_j;i=++_j)wrapper=temp[i],_fn(wrapper)}else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(removeFromBuffer(locator-first-1,locator-first),next--);for(i=_k=0,_len2=buffer.length;_len2>_k;i=++_k)item=buffer[i],item.scope.$index=first+i;return adjustBuffer(!1)}),eventListener.$on("insert.item",function(event,locator,item){var i,inserted,temp,wrapper,_fn,_i,_j,_k,_len,_len1,_len2,_ref;if(inserted=[],angular.isFunction(locator)){for(temp=[],_i=0,_len=buffer.length;_len>_i;_i++)item=buffer[_i],temp.unshift(item);for(_fn=function(wrapper){var j,newItems,_k,_len2,_results;if(newItems=locator(wrapper.scope)){if(insert=function(index,newItem){return insert(index,newItem),next++},angular.isArray(newItems)){for(_results=[],j=_k=0,_len2=newItems.length;_len2>_k;j=++_k)item=newItems[j],_results.push(inserted.push(insert(i+j,item)));return _results}return inserted.push(insert(i,newItems))}},i=_j=0,_len1=temp.length;_len1>_j;i=++_j)wrapper=temp[i],_fn(wrapper)}else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(inserted.push(insert(locator,item)),next++);for(i=_k=0,_len2=buffer.length;_len2>_k;i=++_k)item=buffer[i],item.scope.$index=first+i;return adjustBuffer(!1,inserted)})}}}}]),angular.module("ui.scrollfix",[]).directive("uiScrollfix",["$window",function($window){return{require:"^?uiScrollfixTarget",link:function(scope,elm,attrs,uiScrollfixTarget){function onScroll(){var offset;if(angular.isDefined($window.pageYOffset))offset=$window.pageYOffset;else{var iebody=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;offset=iebody.scrollTop}!elm.hasClass("ui-scrollfix")&&offset>attrs.uiScrollfix?elm.addClass("ui-scrollfix"):elm.hasClass("ui-scrollfix")&&offset<attrs.uiScrollfix&&elm.removeClass("ui-scrollfix")}var top=elm[0].offsetTop,$target=uiScrollfixTarget&&uiScrollfixTarget.$element||angular.element($window);attrs.uiScrollfix?"string"==typeof attrs.uiScrollfix&&("-"===attrs.uiScrollfix.charAt(0)?attrs.uiScrollfix=top-parseFloat(attrs.uiScrollfix.substr(1)):"+"===attrs.uiScrollfix.charAt(0)&&(attrs.uiScrollfix=top+parseFloat(attrs.uiScrollfix.substr(1)))):attrs.uiScrollfix=top,$target.on("scroll",onScroll),scope.$on("$destroy",function(){$target.off("scroll",onScroll)})}}}]).directive("uiScrollfixTarget",[function(){return{controller:["$element",function($element){this.$element=$element}]}}]),angular.module("ui.showhide",[]).directive("uiShow",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiShow,function(newVal){newVal?elm.addClass("ui-show"):elm.removeClass("ui-show")})}}]).directive("uiHide",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiHide,function(newVal){newVal?elm.addClass("ui-hide"):elm.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiToggle,function(newVal){newVal?elm.removeClass("ui-hide").addClass("ui-show"):elm.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.unique",[]).filter("unique",["$parse",function($parse){return function(items,filterOn){if(filterOn===!1)return items;if((filterOn||angular.isUndefined(filterOn))&&angular.isArray(items)){var newItems=[],get=angular.isString(filterOn)?$parse(filterOn):function(item){return item},extractValueToCompare=function(item){return angular.isObject(item)?get(item):item};angular.forEach(items,function(item){for(var isDuplicate=!1,i=0;i<newItems.length;i++)if(angular.equals(extractValueToCompare(newItems[i]),extractValueToCompare(item))){isDuplicate=!0;break}isDuplicate||newItems.push(item)}),items=newItems}return items}}]),angular.module("ui.validate",[]).directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){function apply_watch(watch){return angular.isString(watch)?void scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})}):angular.isArray(watch)?void angular.forEach(watch,function(expression){scope.$watch(expression,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})})}):void(angular.isObject(watch)&&angular.forEach(watch,function(expression,validatorKey){angular.isString(expression)&&scope.$watch(expression,function(){validators[validatorKey](ctrl.$modelValue)}),angular.isArray(expression)&&angular.forEach(expression,function(intExpression){scope.$watch(intExpression,function(){validators[validatorKey](ctrl.$modelValue)})})}))}var validateFn,validators={},validateExpr=scope.$eval(attrs.uiValidate);validateExpr&&(angular.isString(validateExpr)&&(validateExpr={validator:validateExpr}),angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{$value:valueToValidate});return angular.isObject(expression)&&angular.isFunction(expression.then)?(expression.then(function(){ctrl.$setValidity(key,!0)},function(){ctrl.$setValidity(key,!1)}),valueToValidate):expression?(ctrl.$setValidity(key,!0),valueToValidate):(ctrl.$setValidity(key,!1),valueToValidate)},validators[key]=validateFn,ctrl.$formatters.push(validateFn),ctrl.$parsers.push(validateFn)}),attrs.uiValidateWatch&&apply_watch(scope.$eval(attrs.uiValidateWatch)))}}}),angular.module("ui.utils",["ui.event","ui.format","ui.highlight","ui.include","ui.indeterminate","ui.inflector","ui.jq","ui.keypress","ui.mask","ui.reset","ui.route","ui.scrollfix","ui.scroll","ui.scroll.jqlite","ui.showhide","ui.unique","ui.validate"]);
!function(window,angular,undefined){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;ii>i&&obj!==undefined;i++){var key=keys[i];obj=null!==obj?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;angular.module("ngResource",["ng"]).provider("$resource",function(){var provider=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$q",function($http,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=extend({},provider.defaults,defaults),this.urlParams={}}function resourceFactory(url,paramDefaults,actions,options){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url,options);return actions=extend({},provider.defaults.actions,actions),Resource.prototype.toJSON=function(){var data=extend({},this);return delete data.$promise,delete data.$resolved,data},forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&"interceptor"!=key&&(httpConfig[key]=copy(value))}),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2}",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object");action.isArray?(value.length=0,forEach(data,function(item){"object"==typeof item?value.push(new Resource(item)):value.push(item)})):(shallowClearAndCopy(data,value),value.$promise=promise)}return value.$resolved=!0,response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)});return promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),self.defaults.stripTrailingSlashes&&(url=url.replace(/\/+$/,"")||"/"),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}]})}(window,window.angular);
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function objectKeys(object){if(Object.keys)return Object.keys(object);var result=[];return forEach(object,function(val,key){result.push(key)}),result}function indexOf(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i].params&&(parentParams=objectKeys(parents[i].params),parentParams.length))for(var j in parentParams)indexOf(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]]);return extend({},inherited,newParams)}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function pick(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return forEach(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy}function omit(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var key in obj)-1==indexOf(keys,key)&&(copy[key]=obj[key]);return copy}function filter(collection,callback){var array=isArray(collection),result=array?[]:{};return forEach(collection,function(val,i){callback(val,i)&&(result[array?result.length:i]=val)}),result}function map(collection,callback){var result=isArray(collection)?[]:{};return forEach(collection,function(val,i){result[i]=callback(val,i)}),result}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,indexOf(cycle,key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var invocableKeys=objectKeys(invocables||{}),plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=result.$$promises||!0,delete result.$$inheritedValues,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$inheritedValues&&merge(values,omit(parent.$$inheritedValues,invocableKeys)),extend(promises,parent.$$promises),parent.$$values?(merged=merge(values,omit(parent.$$values,invocableKeys)),result.$$inheritedValues=omit(parent.$$values,invocableKeys),done()):(parent.$$inheritedValues&&(result.$$inheritedValues=omit(parent.$$inheritedValues,invocableKeys)),parent.then(done,fail));for(var i=0,ii=plan.length;ii>i;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache,headers:{Accept:"text/html"}}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern,config,parentMatcher){function addParameter(id,type,config,location){if(paramNames.push(id),parentParams[id])return parentParams[id];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(params[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");return params[id]=new $$UMFP.Param(id,type,config,location),params[id]}function quoteRegExp(string,pattern,squash,optional){var surroundPattern=["",""],result=string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!pattern)return result;switch(squash){case!1:surroundPattern=["(",")"+(optional?"?":"")];break;case!0:surroundPattern=["?(",")?"];break;default:surroundPattern=["("+squash+"|",")?"]}return result+surroundPattern[0]+pattern+surroundPattern[1]}function matchDetails(m,isSearch){var id,regexp,segment,type,cfg;return id=m[2]||m[3],cfg=config.params[id],segment=pattern.substring(last,m.index),regexp=isSearch?m[4]:m[4]||("*"==m[1]?".*":null),type=$$UMFP.type(regexp||"string")||inherit($$UMFP.type("string"),{pattern:new RegExp(regexp,config.caseInsensitive?"i":undefined)}),{id:id,regexp:regexp,segment:segment,type:type,cfg:cfg}}config=extend({params:{}},isObject(config)?config:{});var m,placeholder=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,searchPlaceholder=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,compiled="^",last=0,segments=this.segments=[],parentParams=parentMatcher?parentMatcher.params:{},params=this.params=parentMatcher?parentMatcher.params.$$new():new $$UMFP.ParamSet,paramNames=[];this.source=pattern;for(var p,param,segment;(m=placeholder.exec(pattern))&&(p=matchDetails(m,!1),!(p.segment.indexOf("?")>=0));)param=addParameter(p.id,p.type,p.cfg,"path"),compiled+=quoteRegExp(p.segment,param.type.pattern.source,param.squash,param.isOptional),segments.push(p.segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);if(segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),search.length>0)for(last=0;m=searchPlaceholder.exec(search);)p=matchDetails(m,!0),param=addParameter(p.id,p.type,p.cfg,"search"),last=placeholder.lastIndex}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+(config.strict===!1?"/?":"")+"$",segments.push(segment),this.regexp=new RegExp(compiled,config.caseInsensitive?"i":undefined),this.prefix=segments[0],this.$$paramNames=paramNames}function Type(config){extend(this,config)}function $UrlMatcherFactory(){function valToString(val){return null!=val?val.toString().replace(/\//g,"%2F"):val}function valFromString(val){return null!=val?val.toString().replace(/%2F/g,"/"):val}function getDefaultConfig(){return{strict:isStrictMode,caseInsensitive:isCaseInsensitive}}function isInjectable(value){return isFunction(value)||isArray(value)&&isFunction(value[value.length-1])}function flushTypeQueue(){for(;typeQueue.length;){var type=typeQueue.shift();if(type.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend($types[type.name],injector.invoke(type.def))}}function ParamSet(params){extend(this,params||{})}$$UMFP=this;var injector,isCaseInsensitive=!1,isStrictMode=!0,defaultSquashPolicy=!1,$types={},enqueue=!0,typeQueue=[],defaultTypes={string:{encode:valToString,decode:valFromString,is:function(val){return null==val||!isDefined(val)||"string"==typeof val},pattern:/[^/]*/},"int":{encode:valToString,decode:function(val){return parseInt(val,10)},is:function(val){return isDefined(val)&&this.decode(val.toString())===val},pattern:/\d+/},bool:{encode:function(val){return val?1:0},decode:function(val){return 0!==parseInt(val,10)},is:function(val){return val===!0||val===!1},pattern:/0|1/},date:{encode:function(val){return this.is(val)?[val.getFullYear(),("0"+(val.getMonth()+1)).slice(-2),("0"+val.getDate()).slice(-2)].join("-"):undefined},decode:function(val){if(this.is(val))return val;var match=this.capture.exec(val);return match?new Date(match[1],match[2]-1,match[3]):undefined},is:function(val){return val instanceof Date&&!isNaN(val.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^/]*/},any:{encode:angular.identity,decode:angular.identity,equals:angular.equals,pattern:/.*/}};$UrlMatcherFactory.$$getDefaultValue=function(config){if(!isInjectable(config.value))return config.value;if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.value)},this.caseInsensitive=function(value){return isDefined(value)&&(isCaseInsensitive=value),isCaseInsensitive},this.strictMode=function(value){return isDefined(value)&&(isStrictMode=value),isStrictMode},this.defaultSquashPolicy=function(value){if(!isDefined(value))return defaultSquashPolicy;if(value!==!0&&value!==!1&&!isString(value))throw new Error("Invalid squash policy: "+value+". Valid policies: false, true, arbitrary-string");return defaultSquashPolicy=value,value},this.compile=function(pattern,config){return new UrlMatcher(pattern,extend(getDefaultConfig(),config))},this.isMatcher=function(o){if(!isObject(o))return!1;var result=!0;return forEach(UrlMatcher.prototype,function(val,name){isFunction(val)&&(result=result&&isDefined(o[name])&&isFunction(o[name]))}),result},this.type=function(name,definition,definitionFn){if(!isDefined(definition))return $types[name];if($types.hasOwnProperty(name))throw new Error("A type named '"+name+"' has already been defined.");return $types[name]=new Type(extend({name:name},definition)),definitionFn&&(typeQueue.push({name:name,def:definitionFn}),enqueue||flushTypeQueue()),this},forEach(defaultTypes,function(type,name){$types[name]=new Type(extend({name:name},type))}),$types=inherit($types,{}),this.$get=["$injector",function($injector){return injector=$injector,enqueue=!1,flushTypeQueue(),forEach(defaultTypes,function(type,name){$types[name]||($types[name]=new Type(type))}),this}],this.Param=function(id,type,config,location){function unwrapShorthand(config){var keys=isObject(config)?objectKeys(config):[],isShorthand=-1===indexOf(keys,"value")&&-1===indexOf(keys,"type")&&-1===indexOf(keys,"squash")&&-1===indexOf(keys,"array");return isShorthand&&(config={value:config}),config.$$fn=isInjectable(config.value)?config.value:function(){return config.value},config}function getType(config,urlType,location){if(config.type&&urlType)throw new Error("Param '"+id+"' has two type configurations.");return urlType?urlType:config.type?config.type instanceof Type?config.type:new Type(config.type):"config"===location?$types.any:$types.string}function getArrayMode(){var arrayDefaults={array:"search"===location?"auto":!1},arrayParamNomenclature=id.match(/\[\]$/)?{array:!0}:{};return extend(arrayDefaults,arrayParamNomenclature,config).array}function getSquashPolicy(config,isOptional){var squash=config.squash;if(!isOptional||squash===!1)return!1;if(!isDefined(squash)||null==squash)return defaultSquashPolicy;if(squash===!0||isString(squash))return squash;throw new Error("Invalid squash policy: '"+squash+"'. Valid policies: false, true, or arbitrary string")}function getReplace(config,arrayMode,isOptional,squash){var replace,configuredKeys,defaultPolicy=[{from:"",to:isOptional||arrayMode?undefined:""},{from:null,to:isOptional||arrayMode?undefined:""}];return replace=isArray(config.replace)?config.replace:[],isString(squash)&&replace.push({from:squash,to:undefined}),configuredKeys=map(replace,function(item){return item.from}),filter(defaultPolicy,function(item){return-1===indexOf(configuredKeys,item.from)}).concat(replace)}function $$getDefaultValue(){if(!injector)throw new Error("Injectable functions cannot be called at configuration time");var defaultValue=injector.invoke(config.$$fn);if(null!==defaultValue&&defaultValue!==undefined&&!self.type.is(defaultValue))throw new Error("Default value ("+defaultValue+") for parameter '"+self.id+"' is not an instance of Type ("+self.type.name+")");return defaultValue}function $value(value){function hasReplaceVal(val){return function(obj){return obj.from===val}}function $replace(value){var replacement=map(filter(self.replace,hasReplaceVal(value)),function(obj){return obj.to});return replacement.length?replacement[0]:value}return value=$replace(value),isDefined(value)?self.type.$normalize(value):$$getDefaultValue()}function toString(){return"{Param:"+id+" "+type+" squash: '"+squash+"' optional: "+isOptional+"}"}var self=this;config=unwrapShorthand(config),type=getType(config,type,location);var arrayMode=getArrayMode();type=arrayMode?type.$asArray(arrayMode,"search"===location):type,"string"!==type.name||arrayMode||"path"!==location||config.value!==undefined||(config.value="");var isOptional=config.value!==undefined,squash=getSquashPolicy(config,isOptional),replace=getReplace(config,arrayMode,isOptional,squash);extend(this,{id:id,type:type,location:location,array:arrayMode,squash:squash,replace:replace,isOptional:isOptional,value:$value,dynamic:undefined,config:config,toString:toString})},ParamSet.prototype={$$new:function(){return inherit(this,extend(new ParamSet,{$$parent:this}))},$$keys:function(){for(var keys=[],chain=[],parent=this,ignore=objectKeys(ParamSet.prototype);parent;)chain.push(parent),parent=parent.$$parent;return chain.reverse(),forEach(chain,function(paramset){forEach(objectKeys(paramset),function(key){-1===indexOf(keys,key)&&-1===indexOf(ignore,key)&&keys.push(key)})}),keys},$$values:function(paramValues){var values={},self=this;return forEach(self.$$keys(),function(key){values[key]=self[key].value(paramValues&&paramValues[key])}),values},$$equals:function(paramValues1,paramValues2){var equal=!0,self=this;return forEach(self.$$keys(),function(key){var left=paramValues1&&paramValues1[key],right=paramValues2&&paramValues2[key];self[key].type.equals(left,right)||(equal=!1)}),equal},$$validates:function(paramValues){var i,param,rawVal,normalized,encoded,keys=this.$$keys();for(i=0;i<keys.length&&(param=this[keys[i]],rawVal=paramValues[keys[i]],rawVal!==undefined&&null!==rawVal||!param.isOptional);i++){if(normalized=param.type.$normalize(rawVal),!param.type.is(normalized))return!1;if(encoded=param.type.encode(normalized),angular.isString(encoded)&&!param.type.pattern.exec(encoded))return!1}return!0},$$parent:undefined},this.ParamSet=ParamSet}function $UrlRouterProvider($locationProvider,$urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:!0}function $get($location,$rootScope,$injector,$browser){function appendBasePath(url,isHtml5,absolute){return"/"===baseHref?url:isHtml5?baseHref.slice(0,-1)+url:absolute?baseHref.slice(1)+url:url}function update(evt){function check(rule){var handled=rule($injector,$location);return handled?(isString(handled)&&$location.replace().url(handled),!0):!1}if(!evt||!evt.defaultPrevented){lastPushedUrl&&$location.url()===lastPushedUrl;lastPushedUrl=undefined;var i,n=rules.length;for(i=0;n>i;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}function listen(){return listener=listener||$rootScope.$on("$locationChangeSuccess",update)}var lastPushedUrl,baseHref=$browser.baseHref(),location=$location.url();return interceptDeferred||listen(),{sync:function(){update()},listen:function(){return listen()},update:function(read){return read?void(location=$location.url()):void($location.url()!==location&&($location.url(location),$location.replace()))},push:function(urlMatcher,params,options){var url=urlMatcher.format(params||{});null!==url&&params&&params["#"]&&(url+="#"+params["#"]),$location.url(url),lastPushedUrl=options&&options.$$avoidResync?$location.url():undefined,options&&options.replace&&$location.replace()},href:function(urlMatcher,params,options){if(!urlMatcher.validates(params))return null;var isHtml5=$locationProvider.html5Mode();angular.isObject(isHtml5)&&(isHtml5=isHtml5.enabled);var url=urlMatcher.format(params);if(options=options||{},isHtml5||null===url||(url="#"+$locationProvider.hashPrefix()+url),null!==url&&params&&params["#"]&&(url+="#"+params["#"]),url=appendBasePath(url,isHtml5,options.absolute),!options.absolute||!url)return url;var slash=!isHtml5&&url?"/":"",port=$location.port();return port=80===port||443===port?"":":"+port,[$location.protocol(),"://",$location.host(),port,slash,url].join("")}}}var listener,rules=[],otherwise=null,interceptDeferred=!1;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(defer){defer===undefined&&(defer=!0),interceptDeferred=defer},this.$get=$get,$get.$inject=["$location","$rootScope","$injector","$browser"]}function $StateProvider($urlRouterProvider,$urlMatcherFactory){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){if(!stateOrName)return undefined;var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");base=findState(base);for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;pathLength>i;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function flushQueuedChildren(parentName){for(var queued=queue[parentName]||[];queued.length;)registerState(queued.shift())}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=-1!==name.indexOf(".")?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:isObject(state.parent)&&isString(state.parent.name)?state.parent.name:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));return states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{inherit:!0,location:!1})}]),flushQueuedChildren(name),state}function isGlob(text){return text.indexOf("*")>-1}function doesStateMatchGlob(glob){for(var globSegments=glob.split("."),segments=$state.$current.name.split("."),i=0,l=globSegments.length;l>i;i++)"*"===globSegments[i]&&(segments[i]="*");return"**"===globSegments[0]&&(segments=segments.slice(indexOf(segments,globSegments[1])),segments.unshift("**")),"**"===globSegments[globSegments.length-1]&&(segments.splice(indexOf(segments,globSegments[globSegments.length-2])+1,Number.MAX_VALUE),segments.push("**")),globSegments.length!=segments.length?!1:segments.join("")===globSegments.join("")}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$urlRouter,$location,$urlMatcherFactory){function handleRedirect(redirect,state,params,options){var evt=$rootScope.$broadcast("$stateNotFound",redirect,state,params);if(evt.defaultPrevented)return $urlRouter.update(),TransitionAborted;if(!evt.retry)return null;if(options.$retry)return $urlRouter.update(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),$urlRouter.update(),retryTransition}function resolveState(state,params,paramsAreFiltered,inherited,dst,options){function resolveViews(){var viewsPromises=[];return forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:dst.globals,params:$stateParams,notify:options.notify})||""}],viewsPromises.push($resolve.resolve(injectables,dst.globals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,dst.globals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,result.$$controllerAs=view.controllerAs,dst[name]=result}))}),$q.all(viewsPromises).then(function(){return dst.globals})}var $stateParams=paramsAreFiltered?params:filterByKeys(state.params.$$keys(),params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),$q.all(promises).then(resolveViews).then(function(values){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed"));return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(state){return $state.transitionTo($state.current,$stateParams,{reload:state||!0,inherit:!1,notify:!0})},$state.go=function(to,params,options){return $state.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative),hash=toParams["#"];if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options},redirectResult=handleRedirect(redirect,from.self,fromParams,options);if(redirectResult)return redirectResult;if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(!options.relative)throw new Error("No such state '"+to+"'");throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");if(options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),!toState.params.$$validates(toParams))return TransitionFailed;toParams=toState.params.$$values(toParams),to=toState;var toPath=to.path,keep=0,state=toPath[keep],locals=root.locals,toLocals=[];if(options.reload){if(isString(options.reload)||isObject(options.reload)){if(isObject(options.reload)&&!options.reload.name)throw new Error("Invalid reload state object");var reloadState=options.reload===!0?fromPath[0]:findState(options.reload);if(options.reload&&!reloadState)throw new Error("No such reload state '"+(isString(options.reload)?options.reload:options.reload.name)+"'");for(;state&&state===fromPath[keep]&&state!==reloadState;)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep]}}else for(;state&&state===fromPath[keep]&&state.ownParams.$$equals(toParams,fromParams);)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep];if(shouldSkipReload(to,toParams,from,fromParams,locals,options))return hash&&(toParams["#"]=hash),$state.params=toParams,copy($state.params,$stateParams),options.location&&to.navigable&&to.navigable.url&&($urlRouter.push(to.navigable.url,toParams,{$$avoidResync:!0,replace:"replace"===options.location}),$urlRouter.update(!0)),$state.transition=null,$q.when($state.current);if(toParams=filterByKeys(to.params.$$keys(),toParams||{}),options.notify&&$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams).defaultPrevented)return $rootScope.$broadcast("$stateChangeCancel",to.self,toParams,from.self,fromParams),$urlRouter.update(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals,options);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);return hash&&(toParams["#"]=hash),$state.transition!==transition?TransitionSuperseded:($state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null,options.location&&to.navigable&&$urlRouter.push(to.navigable.url,to.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===options.location}),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),$urlRouter.update(!0),$state.current)},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,evt=$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),evt.defaultPrevented||$urlRouter.update(),$q.reject(error))});return transition},$state.is=function(stateOrName,params,options){options=extend({relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);return isDefined(state)?$state.$current!==state?!1:params?equalForKeys(state.params.$$values(params),$stateParams):!0:undefined},$state.includes=function(stateOrName,params,options){if(options=extend({relative:$state.$current},options||{}),isString(stateOrName)&&isGlob(stateOrName)){if(!doesStateMatchGlob(stateOrName))return!1;stateOrName=$state.$current.name}var state=findState(stateOrName,options.relative);return isDefined(state)?isDefined($state.$current.includes[state.name])?params?equalForKeys(state.params.$$values(params),$stateParams,objectKeys(params)):!0:!1:undefined},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!0,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;options.inherit&&(params=inheritParams($stateParams,params||{},$state.$current,state));var nav=state&&options.lossy?state.navigable:state;return nav&&nav.url!==undefined&&null!==nav.url?$urlRouter.href(nav.url,filterByKeys(state.params.$$keys().concat("#"),params||{}),{absolute:options.absolute}):null;
},$state.get=function(stateOrName,context){if(0===arguments.length)return map(objectKeys(states),function(name){return states[name].self});var state=findState(stateOrName,context||$state.$current);return state&&state.self?state.self:null},$state}function shouldSkipReload(to,toParams,from,fromParams,locals,options){function nonSearchParamsEqual(fromAndToState,fromParams,toParams){function notSearchParam(key){return"search"!=fromAndToState.params[key].location}var nonQueryParamKeys=fromAndToState.params.$$keys().filter(notSearchParam),nonQueryParams=pick.apply({},[fromAndToState.params].concat(nonQueryParamKeys)),nonQueryParamSet=new $$UMFP.ParamSet(nonQueryParams);return nonQueryParamSet.$$equals(fromParams,toParams)}return!options.reload&&to===from&&(locals===from.locals||to.self.reloadOnSearch===!1&&nonSearchParamsEqual(from,fromParams,toParams))?!0:void 0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=extend({},state.parent.data,state.data)),state.data},url:function(state){var url=state.url,config={params:state.params||{}};if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1),config):(state.parent.navigable||root).url.concat(url,config);if(!url||$urlMatcherFactory.isMatcher(url))return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},ownParams:function(state){var params=state.url&&state.url.params||new $$UMFP.ParamSet;return forEach(state.params||{},function(config,id){params[id]||(params[id]=new $$UMFP.Param(id,null,config,"config"))}),params},params:function(state){return state.parent&&state.parent.params?extend(state.parent.params.$$new(),state.ownParams):new $$UMFP.ParamSet},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view}),views},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result&&options.notify&&$rootScope.$broadcast("$viewContentLoading",options),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){return $timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$injector,$uiViewScroll,$interpolate){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(attrs,scope){var statics=function(){return{enter:function(element,target,cb){target.after(element),cb()},leave:function(element,cb){element.remove(),cb()}}};if($animate)return{enter:function(element,target,cb){var promise=$animate.enter(element,null,target,cb);promise&&promise.then&&promise.then(cb)},leave:function(element,cb){var promise=$animate.leave(element,cb);promise&&promise.then&&promise.then(cb)}};if($animator){var animate=$animator&&$animator(scope,attrs);return{enter:function(element,target,cb){animate.enter(element,null,target),cb()},leave:function(element,cb){animate.leave(element),cb()}}}return statics()}var service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(tElement,tAttrs,$transclude){return function(scope,$element,attrs){function cleanupLastView(){previousEl&&(previousEl.remove(),previousEl=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentEl&&(renderer.leave(currentEl,function(){previousEl=null}),previousEl=currentEl,currentEl=null)}function updateView(firstTime){var newScope,name=getUiViewName(scope,attrs,$element,$interpolate),previousLocals=name&&$state.$current&&$state.$current.locals[name];if(firstTime||previousLocals!==latestLocals){newScope=scope.$new(),latestLocals=$state.$current.locals[name];var clone=$transclude(newScope,function(clone){renderer.enter(clone,$element,function(){currentScope&&currentScope.$emit("$viewContentAnimationEnded"),(angular.isDefined(autoScrollExp)&&!autoScrollExp||scope.$eval(autoScrollExp))&&$uiViewScroll(clone)}),cleanupLastView()});currentEl=clone,currentScope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}}var previousEl,currentEl,currentScope,latestLocals,onloadExp=attrs.onload||"",autoScrollExp=attrs.autoscroll,renderer=getRenderer(attrs,scope);scope.$on("$stateChangeSuccess",function(){updateView(!1)}),scope.$on("$viewContentLoading",function(){updateView(!1)}),updateView(!0)}}};return directive}function $ViewDirectiveFill($compile,$controller,$state,$interpolate){return{restrict:"ECA",priority:-400,compile:function(tElement){var initial=tElement.html();return function(scope,$element,attrs){var current=$state.$current,name=getUiViewName(scope,attrs,$element,$interpolate),locals=current&&current.locals[name];if(locals){$element.data("$uiView",{name:name,state:locals.$$state}),$element.html(locals.$template?locals.$template:initial);var link=$compile($element.contents());if(locals.$$controller){locals.$scope=scope,locals.$element=$element;var controller=$controller(locals.$$controller,locals);locals.$$controllerAs&&(scope[locals.$$controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}}}function getUiViewName(scope,attrs,element,$interpolate){var name=$interpolate(attrs.uiView||attrs.name||"")(scope),inherited=element.inheritedData("$uiView");return name.indexOf("@")>=0?name:name+"@"+(inherited?inherited.state.name:"")}function parseStateRef(ref,current){var parsed,preparsed=ref.match(/^\s*({[^}]*})\s*$/);if(preparsed&&(ref=current+"("+preparsed[1]+")"),parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");return stateData&&stateData.state&&stateData.state.name?stateData.state:void 0}function $StateRefDirective($state,$timeout){var allowedOptions=["location","inherit","reload","absolute"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref,$state.current.name),params=null,base=stateContext(element)||$state.$current,hrefKind="[object SVGAnimatedString]"===Object.prototype.toString.call(element.prop("href"))?"xlink:href":"href",newHref=null,isAnchor="A"===element.prop("tagName").toUpperCase(),isForm="FORM"===element[0].nodeName,attr=isForm?"action":hrefKind,nav=!0,options={relative:base,inherit:!0},optionsOverride=scope.$eval(attrs.uiSrefOpts)||{};angular.forEach(allowedOptions,function(option){option in optionsOverride&&(options[option]=optionsOverride[option])});var update=function(newVal){if(newVal&&(params=angular.copy(newVal)),nav){newHref=$state.href(ref.state,params,options);var activeDirective=uiSrefActive[1]||uiSrefActive[0];return activeDirective&&activeDirective.$$addStateInfo(ref.state,params),null===newHref?(nav=!1,!1):void attrs.$set(attr,newHref)}};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(newVal,oldVal){newVal!==params&&update(newVal)},!0),params=angular.copy(scope.$eval(ref.paramExpr))),update(),isForm||element.bind("click",function(e){var button=e.which||e.button;if(!(button>1||e.ctrlKey||e.metaKey||e.shiftKey||element.attr("target"))){var transition=$timeout(function(){$state.go(ref.state,params,options)});e.preventDefault();var ignorePreventDefaultCount=isAnchor&&!newHref?1:0;e.preventDefault=function(){ignorePreventDefaultCount--<=0&&$timeout.cancel(transition)}}})}}}function $StateRefActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function update(){anyMatch()?$element.addClass(activeClass):$element.removeClass(activeClass)}function anyMatch(){for(var i=0;i<states.length;i++)if(isMatch(states[i].state,states[i].params))return!0;return!1}function isMatch(state,params){return"undefined"!=typeof $attrs.uiSrefActiveEq?$state.is(state.name,params):$state.includes(state.name,params)}var activeClass,states=[];activeClass=$interpolate($attrs.uiSrefActiveEq||$attrs.uiSrefActive||"",!1)($scope),this.$$addStateInfo=function(newState,newParams){var state=$state.get(newState,stateContext($element));states.push({state:state||{name:newState},params:newParams}),update()},$scope.$on("$stateChangeSuccess",update)}]}}function $IsStateFilter($state){var isFilter=function(state){return $state.is(state)};return isFilter.$stateful=!0,isFilter}function $IncludedByStateFilter($state){var includesFilter=function(state){return $state.includes(state)};return includesFilter.$stateful=!0,includesFilter}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory);var $$UMFP;UrlMatcher.prototype.concat=function(pattern,config){var defaultConfig={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch,extend(defaultConfig,config),this)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){function decodePathArray(string){function reverseString(str){return str.split("").reverse().join("")}function unquoteDashes(str){return str.replace(/\\-/g,"-")}var split=reverseString(string).split(/-(?!\\)/),allReversed=map(split,reverseString);return map(allReversed,unquoteDashes).reverse()}var m=this.regexp.exec(path);if(!m)return null;searchParams=searchParams||{};var i,j,paramName,paramNames=this.parameters(),nTotal=paramNames.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;nPath>i;i++){paramName=paramNames[i];var param=this.params[paramName],paramVal=m[i+1];for(j=0;j<param.replace;j++)param.replace[j].from===paramVal&&(paramVal=param.replace[j].to);paramVal&&param.array===!0&&(paramVal=decodePathArray(paramVal)),values[paramName]=param.value(paramVal)}for(;nTotal>i;i++)paramName=paramNames[i],values[paramName]=this.params[paramName].value(searchParams[paramName]);return values},UrlMatcher.prototype.parameters=function(param){return isDefined(param)?this.params[param]||null:this.$$paramNames},UrlMatcher.prototype.validates=function(params){return this.params.$$validates(params)},UrlMatcher.prototype.format=function(values){function encodeDashes(str){return encodeURIComponent(str).replace(/-/g,function(c){return"%5C%"+c.charCodeAt(0).toString(16).toUpperCase()})}values=values||{};var segments=this.segments,params=this.parameters(),paramset=this.params;if(!this.validates(values))return null;var i,search=!1,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;nTotal>i;i++){var isPathParam=nPath>i,name=params[i],param=paramset[name],value=param.value(values[name]),isDefaultValue=param.isOptional&&param.type.equals(param.value(),value),squash=isDefaultValue?param.squash:!1,encoded=param.type.encode(value);if(isPathParam){var nextSegment=segments[i+1];if(squash===!1)null!=encoded&&(result+=isArray(encoded)?map(encoded,encodeDashes).join("-"):encodeURIComponent(encoded)),result+=nextSegment;else if(squash===!0){var capture=result.match(/\/$/)?/\/?(.*)/:/(.*)/;result+=nextSegment.match(capture)[1]}else isString(squash)&&(result+=squash+nextSegment)}else{if(null==encoded||isDefaultValue&&squash!==!1)continue;isArray(encoded)||(encoded=[encoded]),encoded=map(encoded,encodeURIComponent).join("&"+name+"="),result+=(search?"&":"?")+(name+"="+encoded),search=!0}}return result},Type.prototype.is=function(val,key){return!0},Type.prototype.encode=function(val,key){return val},Type.prototype.decode=function(val,key){return val},Type.prototype.equals=function(a,b){return a==b},Type.prototype.$subPattern=function(){var sub=this.pattern.toString();return sub.substr(1,sub.length-2)},Type.prototype.pattern=/.*/,Type.prototype.toString=function(){return"{Type:"+this.name+"}"},Type.prototype.$normalize=function(val){return this.is(val)?val:this.decode(val)},Type.prototype.$asArray=function(mode,isSearch){function ArrayType(type,mode){function bindTo(type,callbackName){return function(){return type[callbackName].apply(type,arguments)}}function arrayWrap(val){return isArray(val)?val:isDefined(val)?[val]:[]}function arrayUnwrap(val){switch(val.length){case 0:return undefined;case 1:return"auto"===mode?val[0]:val;default:return val}}function falsey(val){return!val}function arrayHandler(callback,allTruthyMode){return function(val){val=arrayWrap(val);var result=map(val,callback);return allTruthyMode===!0?0===filter(result,falsey).length:arrayUnwrap(result)}}function arrayEqualsHandler(callback){return function(val1,val2){var left=arrayWrap(val1),right=arrayWrap(val2);if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!callback(left[i],right[i]))return!1;return!0}}this.encode=arrayHandler(bindTo(type,"encode")),this.decode=arrayHandler(bindTo(type,"decode")),this.is=arrayHandler(bindTo(type,"is"),!0),this.equals=arrayEqualsHandler(bindTo(type,"equals")),this.pattern=type.pattern,this.$normalize=arrayHandler(bindTo(type,"$normalize")),this.name=type.name,this.$arrayMode=mode}if(!mode)return this;if("auto"===mode&&!isSearch)throw new Error("'auto' array mode is for query parameters only");return new ArrayType(this,mode)},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),angular.module("ui.router.util").run(["$urlMatcherFactory",function($urlMatcherFactory){}]),$UrlRouterProvider.$inject=["$locationProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider),$ViewDirective.$inject=["$state","$injector","$uiViewScroll","$interpolate"],$ViewDirectiveFill.$inject=["$compile","$controller","$state","$interpolate"],angular.module("ui.router.state").directive("uiView",$ViewDirective),angular.module("ui.router.state").directive("uiView",$ViewDirectiveFill),$StateRefDirective.$inject=["$state","$timeout"],$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter)}(window,window.angular);
!function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function runTranslate($translate){"use strict";var key=$translate.storageKey(),storage=$translate.storage(),fallbackFromIncorrectStorageValue=function(){var preferred=$translate.preferredLanguage();angular.isString(preferred)?$translate.use(preferred):storage.put(key,$translate.use())};fallbackFromIncorrectStorageValue.displayName="fallbackFromIncorrectStorageValue",storage?storage.get(key)?$translate.use(storage.get(key))["catch"](fallbackFromIncorrectStorageValue):fallbackFromIncorrectStorageValue():angular.isString($translate.preferredLanguage())&&$translate.use($translate.preferredLanguage())}function $translateSanitizationProvider(){"use strict";var $sanitize,strategies,currentStrategy=null,hasConfiguredStrategy=!1,hasShownNoStrategyConfiguredWarning=!1;strategies={sanitize:function(value,mode){return"text"===mode&&(value=htmlSanitizeValue(value)),value},escape:function(value,mode){return"text"===mode&&(value=htmlEscapeValue(value)),value},sanitizeParameters:function(value,mode){return"params"===mode&&(value=mapInterpolationParameters(value,htmlSanitizeValue)),value},escapeParameters:function(value,mode){return"params"===mode&&(value=mapInterpolationParameters(value,htmlEscapeValue)),value}},strategies.escaped=strategies.escapeParameters,this.addStrategy=function(strategyName,strategyFunction){return strategies[strategyName]=strategyFunction,this},this.removeStrategy=function(strategyName){return delete strategies[strategyName],this},this.useStrategy=function(strategy){return hasConfiguredStrategy=!0,currentStrategy=strategy,this},this.$get=["$injector","$log",function($injector,$log){var applyStrategies=function(value,mode,selectedStrategies){return angular.forEach(selectedStrategies,function(selectedStrategy){if(angular.isFunction(selectedStrategy))value=selectedStrategy(value,mode);else{if(!angular.isFunction(strategies[selectedStrategy]))throw new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+selectedStrategy+"'");value=strategies[selectedStrategy](value,mode)}}),value},showNoStrategyConfiguredWarning=function(){hasConfiguredStrategy||hasShownNoStrategyConfiguredWarning||($log.warn("pascalprecht.translate.$translateSanitization: No sanitization strategy has been configured. This can have serious security implications. See http://angular-translate.github.io/docs/#/guide/19_security for details."),hasShownNoStrategyConfiguredWarning=!0)};return $injector.has("$sanitize")&&($sanitize=$injector.get("$sanitize")),{useStrategy:function(self){return function(strategy){self.useStrategy(strategy)}}(this),sanitize:function(value,mode,strategy){if(currentStrategy||showNoStrategyConfiguredWarning(),arguments.length<3&&(strategy=currentStrategy),!strategy)return value;var selectedStrategies=angular.isArray(strategy)?strategy:[strategy];return applyStrategies(value,mode,selectedStrategies)}}}];var htmlEscapeValue=function(value){var element=angular.element("<div></div>");return element.text(value),element.html()},htmlSanitizeValue=function(value){if(!$sanitize)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot find $sanitize service. Either include the ngSanitize module (https://docs.angularjs.org/api/ngSanitize) or use a sanitization strategy which does not depend on $sanitize, such as 'escape'.");return $sanitize(value)},mapInterpolationParameters=function(value,iteratee){if(angular.isObject(value)){var result=angular.isArray(value)?[]:{};return angular.forEach(value,function(propertyValue,propertyKey){result[propertyKey]=mapInterpolationParameters(propertyValue,iteratee)}),result}return angular.isNumber(value)?value:iteratee(value)}}function $translate($STORAGE_KEY,$windowProvider,$translateSanitizationProvider,pascalprechtTranslateOverrider){"use strict";var $preferredLanguage,$languageKeyAliases,$fallbackLanguage,$fallbackWasString,$uses,$nextLang,$storageFactory,$storagePrefix,$missingTranslationHandlerFactory,$interpolationFactory,$loaderFactory,$loaderOptions,$notFoundIndicatorLeft,$notFoundIndicatorRight,loaderCache,$translationTable={},$availableLanguageKeys=[],$storageKey=$STORAGE_KEY,$interpolatorFactories=[],$cloakClassName="translate-cloak",$postCompilingEnabled=!1,$forceAsyncReloadEnabled=!1,NESTED_OBJECT_DELIMITER=".",directivePriority=0,statefulFilter=!0,uniformLanguageTagResolver="default",languageTagResolver={"default":function(tag){return(tag||"").split("-").join("_")},java:function(tag){var temp=(tag||"").split("-").join("_"),parts=temp.split("_");return parts.length>1?parts[0].toLowerCase()+"_"+parts[1].toUpperCase():temp},bcp47:function(tag){var temp=(tag||"").split("_").join("-"),parts=temp.split("-");return parts.length>1?parts[0].toLowerCase()+"-"+parts[1].toUpperCase():temp}},version="2.7.2",getFirstBrowserLanguage=function(){if(angular.isFunction(pascalprechtTranslateOverrider.getLocale))return pascalprechtTranslateOverrider.getLocale();var i,language,nav=$windowProvider.$get().navigator,browserLanguagePropertyKeys=["language","browserLanguage","systemLanguage","userLanguage"];if(angular.isArray(nav.languages))for(i=0;i<nav.languages.length;i++)if(language=nav.languages[i],language&&language.length)return language;for(i=0;i<browserLanguagePropertyKeys.length;i++)if(language=nav[browserLanguagePropertyKeys[i]],language&&language.length)return language;return null};getFirstBrowserLanguage.displayName="angular-translate/service: getFirstBrowserLanguage";var getLocale=function(){var locale=getFirstBrowserLanguage()||"";return languageTagResolver[uniformLanguageTagResolver]&&(locale=languageTagResolver[uniformLanguageTagResolver](locale)),locale};getLocale.displayName="angular-translate/service: getLocale";var indexOf=function(array,searchElement){for(var i=0,len=array.length;len>i;i++)if(array[i]===searchElement)return i;return-1},trim=function(){return this.toString().replace(/^\s+|\s+$/g,"")},negotiateLocale=function(preferred){for(var avail=[],locale=angular.lowercase(preferred),i=0,n=$availableLanguageKeys.length;n>i;i++)avail.push(angular.lowercase($availableLanguageKeys[i]));if(indexOf(avail,locale)>-1)return preferred;if($languageKeyAliases){var alias;for(var langKeyAlias in $languageKeyAliases){var hasWildcardKey=!1,hasExactKey=Object.prototype.hasOwnProperty.call($languageKeyAliases,langKeyAlias)&&angular.lowercase(langKeyAlias)===angular.lowercase(preferred);if("*"===langKeyAlias.slice(-1)&&(hasWildcardKey=langKeyAlias.slice(0,-1)===preferred.slice(0,langKeyAlias.length-1)),(hasExactKey||hasWildcardKey)&&(alias=$languageKeyAliases[langKeyAlias],indexOf(avail,angular.lowercase(alias))>-1))return alias}}if(preferred){var parts=preferred.split("_");if(parts.length>1&&indexOf(avail,angular.lowercase(parts[0]))>-1)return parts[0]}return preferred},translations=function(langKey,translationTable){if(!langKey&&!translationTable)return $translationTable;if(langKey&&!translationTable){if(angular.isString(langKey))return $translationTable[langKey]}else angular.isObject($translationTable[langKey])||($translationTable[langKey]={}),angular.extend($translationTable[langKey],flatObject(translationTable));return this};this.translations=translations,this.cloakClassName=function(name){return name?($cloakClassName=name,this):$cloakClassName};var flatObject=function(data,path,result,prevKey){var key,keyWithPath,keyWithShortPath,val;path||(path=[]),result||(result={});for(key in data)Object.prototype.hasOwnProperty.call(data,key)&&(val=data[key],angular.isObject(val)?flatObject(val,path.concat(key),result,key):(keyWithPath=path.length?""+path.join(NESTED_OBJECT_DELIMITER)+NESTED_OBJECT_DELIMITER+key:key,path.length&&key===prevKey&&(keyWithShortPath=""+path.join(NESTED_OBJECT_DELIMITER),result[keyWithShortPath]="@:"+keyWithPath),result[keyWithPath]=val));return result};flatObject.displayName="flatObject",this.addInterpolation=function(factory){return $interpolatorFactories.push(factory),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(factory){return $interpolationFactory=factory,this},this.useSanitizeValueStrategy=function(value){return $translateSanitizationProvider.useStrategy(value),this},this.preferredLanguage=function(langKey){return setupPreferredLanguage(langKey),this};var setupPreferredLanguage=function(langKey){return langKey&&($preferredLanguage=langKey),$preferredLanguage};this.translationNotFoundIndicator=function(indicator){return this.translationNotFoundIndicatorLeft(indicator),this.translationNotFoundIndicatorRight(indicator),this},this.translationNotFoundIndicatorLeft=function(indicator){return indicator?($notFoundIndicatorLeft=indicator,this):$notFoundIndicatorLeft},this.translationNotFoundIndicatorRight=function(indicator){return indicator?($notFoundIndicatorRight=indicator,this):$notFoundIndicatorRight},this.fallbackLanguage=function(langKey){return fallbackStack(langKey),this};var fallbackStack=function(langKey){return langKey?(angular.isString(langKey)?($fallbackWasString=!0,$fallbackLanguage=[langKey]):angular.isArray(langKey)&&($fallbackWasString=!1,$fallbackLanguage=langKey),angular.isString($preferredLanguage)&&indexOf($fallbackLanguage,$preferredLanguage)<0&&$fallbackLanguage.push($preferredLanguage),this):$fallbackWasString?$fallbackLanguage[0]:$fallbackLanguage};this.use=function(langKey){if(langKey){if(!$translationTable[langKey]&&!$loaderFactory)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+langKey+"'");return $uses=langKey,this}return $uses};var storageKey=function(key){return key?($storageKey=key,this):$storagePrefix?$storagePrefix+$storageKey:$storageKey};this.storageKey=storageKey,this.useUrlLoader=function(url,options){return this.useLoader("$translateUrlLoader",angular.extend({url:url},options))},this.useStaticFilesLoader=function(options){return this.useLoader("$translateStaticFilesLoader",options)},this.useLoader=function(loaderFactory,options){return $loaderFactory=loaderFactory,$loaderOptions=options||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(storageFactory){return $storageFactory=storageFactory,this},this.storagePrefix=function(prefix){return prefix?($storagePrefix=prefix,this):prefix},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(factory){return $missingTranslationHandlerFactory=factory,this},this.usePostCompiling=function(value){return $postCompilingEnabled=!!value,this},this.forceAsyncReload=function(value){return $forceAsyncReloadEnabled=!!value,this},this.uniformLanguageTag=function(options){return options?angular.isString(options)&&(options={standard:options}):options={},uniformLanguageTagResolver=options.standard,this},this.determinePreferredLanguage=function(fn){var locale=fn&&angular.isFunction(fn)?fn():getLocale();return $preferredLanguage=$availableLanguageKeys.length?negotiateLocale(locale):locale,this},this.registerAvailableLanguageKeys=function(languageKeys,aliases){return languageKeys?($availableLanguageKeys=languageKeys,aliases&&($languageKeyAliases=aliases),this):$availableLanguageKeys},this.useLoaderCache=function(cache){return cache===!1?loaderCache=void 0:cache===!0?loaderCache=!0:"undefined"==typeof cache?loaderCache="$translationCache":cache&&(loaderCache=cache),this},this.directivePriority=function(priority){return void 0===priority?directivePriority:(directivePriority=priority,this)},this.statefulFilter=function(state){return void 0===state?statefulFilter:(statefulFilter=state,this)},this.$get=["$log","$injector","$rootScope","$q",function($log,$injector,$rootScope,$q){var Storage,fallbackIndex,startFallbackIteration,defaultInterpolator=$injector.get($interpolationFactory||"$translateDefaultInterpolation"),pendingLoader=!1,interpolatorHashMap={},langPromises={},$translate=function(translationId,interpolateParams,interpolationId,defaultTranslationText){if(angular.isArray(translationId)){var translateAll=function(translationIds){for(var results={},promises=[],translate=function(translationId){var deferred=$q.defer(),regardless=function(value){results[translationId]=value,deferred.resolve([translationId,value])};return $translate(translationId,interpolateParams,interpolationId,defaultTranslationText).then(regardless,regardless),deferred.promise},i=0,c=translationIds.length;c>i;i++)promises.push(translate(translationIds[i]));return $q.all(promises).then(function(){return results})};return translateAll(translationId)}var deferred=$q.defer();translationId&&(translationId=trim.apply(translationId));var promiseToWaitFor=function(){var promise=$preferredLanguage?langPromises[$preferredLanguage]:langPromises[$uses];if(fallbackIndex=0,$storageFactory&&!promise){var langKey=Storage.get($storageKey);if(promise=langPromises[langKey],$fallbackLanguage&&$fallbackLanguage.length){var index=indexOf($fallbackLanguage,langKey);fallbackIndex=0===index?1:0,indexOf($fallbackLanguage,$preferredLanguage)<0&&$fallbackLanguage.push($preferredLanguage)}}return promise}();if(promiseToWaitFor){var promiseResolved=function(){determineTranslation(translationId,interpolateParams,interpolationId,defaultTranslationText).then(deferred.resolve,deferred.reject)};promiseResolved.displayName="promiseResolved",promiseToWaitFor["finally"](promiseResolved,deferred.reject)}else determineTranslation(translationId,interpolateParams,interpolationId,defaultTranslationText).then(deferred.resolve,deferred.reject);return deferred.promise},applyNotFoundIndicators=function(translationId){return $notFoundIndicatorLeft&&(translationId=[$notFoundIndicatorLeft,translationId].join(" ")),$notFoundIndicatorRight&&(translationId=[translationId,$notFoundIndicatorRight].join(" ")),translationId},useLanguage=function(key){$uses=key,$rootScope.$emit("$translateChangeSuccess",{language:key}),$storageFactory&&Storage.put($translate.storageKey(),$uses),defaultInterpolator.setLocale($uses);var eachInterpolator=function(interpolator,id){interpolatorHashMap[id].setLocale($uses)};eachInterpolator.displayName="eachInterpolatorLocaleSetter",angular.forEach(interpolatorHashMap,eachInterpolator),$rootScope.$emit("$translateChangeEnd",{language:key})},loadAsync=function(key){if(!key)throw"No language key specified for loading.";var deferred=$q.defer();$rootScope.$emit("$translateLoadingStart",{language:key}),pendingLoader=!0;var cache=loaderCache;"string"==typeof cache&&(cache=$injector.get(cache));var loaderOptions=angular.extend({},$loaderOptions,{key:key,$http:angular.extend({},{cache:cache},$loaderOptions.$http)}),onLoaderSuccess=function(data){var translationTable={};$rootScope.$emit("$translateLoadingSuccess",{language:key}),angular.isArray(data)?angular.forEach(data,function(table){angular.extend(translationTable,flatObject(table))}):angular.extend(translationTable,flatObject(data)),pendingLoader=!1,deferred.resolve({key:key,table:translationTable}),$rootScope.$emit("$translateLoadingEnd",{language:key})};onLoaderSuccess.displayName="onLoaderSuccess";var onLoaderError=function(key){$rootScope.$emit("$translateLoadingError",{language:key}),deferred.reject(key),$rootScope.$emit("$translateLoadingEnd",{language:key})};return onLoaderError.displayName="onLoaderError",$injector.get($loaderFactory)(loaderOptions).then(onLoaderSuccess,onLoaderError),deferred.promise};if($storageFactory&&(Storage=$injector.get($storageFactory),!Storage.get||!Storage.put))throw new Error("Couldn't use storage '"+$storageFactory+"', missing get() or put() method!");if($interpolatorFactories.length){var eachInterpolationFactory=function(interpolatorFactory){var interpolator=$injector.get(interpolatorFactory);interpolator.setLocale($preferredLanguage||$uses),interpolatorHashMap[interpolator.getInterpolationIdentifier()]=interpolator};eachInterpolationFactory.displayName="interpolationFactoryAdder",angular.forEach($interpolatorFactories,eachInterpolationFactory)}var getTranslationTable=function(langKey){var deferred=$q.defer();if(Object.prototype.hasOwnProperty.call($translationTable,langKey))deferred.resolve($translationTable[langKey]);else if(langPromises[langKey]){var onResolve=function(data){translations(data.key,data.table),deferred.resolve(data.table)};onResolve.displayName="translationTableResolver",langPromises[langKey].then(onResolve,deferred.reject)}else deferred.reject();return deferred.promise},getFallbackTranslation=function(langKey,translationId,interpolateParams,Interpolator){var deferred=$q.defer(),onResolve=function(translationTable){if(Object.prototype.hasOwnProperty.call(translationTable,translationId)){Interpolator.setLocale(langKey);var translation=translationTable[translationId];"@:"===translation.substr(0,2)?getFallbackTranslation(langKey,translation.substr(2),interpolateParams,Interpolator).then(deferred.resolve,deferred.reject):deferred.resolve(Interpolator.interpolate(translationTable[translationId],interpolateParams)),Interpolator.setLocale($uses)}else deferred.reject()};return onResolve.displayName="fallbackTranslationResolver",getTranslationTable(langKey).then(onResolve,deferred.reject),deferred.promise},getFallbackTranslationInstant=function(langKey,translationId,interpolateParams,Interpolator){var result,translationTable=$translationTable[langKey];if(translationTable&&Object.prototype.hasOwnProperty.call(translationTable,translationId)){if(Interpolator.setLocale(langKey),result=Interpolator.interpolate(translationTable[translationId],interpolateParams),"@:"===result.substr(0,2))return getFallbackTranslationInstant(langKey,result.substr(2),interpolateParams,Interpolator);Interpolator.setLocale($uses)}return result},translateByHandler=function(translationId,interpolateParams){if($missingTranslationHandlerFactory){var resultString=$injector.get($missingTranslationHandlerFactory)(translationId,$uses,interpolateParams);return void 0!==resultString?resultString:translationId}return translationId},resolveForFallbackLanguage=function(fallbackLanguageIndex,translationId,interpolateParams,Interpolator,defaultTranslationText){var deferred=$q.defer();if(fallbackLanguageIndex<$fallbackLanguage.length){var langKey=$fallbackLanguage[fallbackLanguageIndex];getFallbackTranslation(langKey,translationId,interpolateParams,Interpolator).then(deferred.resolve,function(){resolveForFallbackLanguage(fallbackLanguageIndex+1,translationId,interpolateParams,Interpolator,defaultTranslationText).then(deferred.resolve)})}else defaultTranslationText?deferred.resolve(defaultTranslationText):deferred.resolve(translateByHandler(translationId,interpolateParams));return deferred.promise},resolveForFallbackLanguageInstant=function(fallbackLanguageIndex,translationId,interpolateParams,Interpolator){var result;if(fallbackLanguageIndex<$fallbackLanguage.length){var langKey=$fallbackLanguage[fallbackLanguageIndex];result=getFallbackTranslationInstant(langKey,translationId,interpolateParams,Interpolator),result||(result=resolveForFallbackLanguageInstant(fallbackLanguageIndex+1,translationId,interpolateParams,Interpolator))}return result},fallbackTranslation=function(translationId,interpolateParams,Interpolator,defaultTranslationText){return resolveForFallbackLanguage(startFallbackIteration>0?startFallbackIteration:fallbackIndex,translationId,interpolateParams,Interpolator,defaultTranslationText)},fallbackTranslationInstant=function(translationId,interpolateParams,Interpolator){return resolveForFallbackLanguageInstant(startFallbackIteration>0?startFallbackIteration:fallbackIndex,translationId,interpolateParams,Interpolator)},determineTranslation=function(translationId,interpolateParams,interpolationId,defaultTranslationText){var deferred=$q.defer(),table=$uses?$translationTable[$uses]:$translationTable,Interpolator=interpolationId?interpolatorHashMap[interpolationId]:defaultInterpolator;if(table&&Object.prototype.hasOwnProperty.call(table,translationId)){var translation=table[translationId];"@:"===translation.substr(0,2)?$translate(translation.substr(2),interpolateParams,interpolationId,defaultTranslationText).then(deferred.resolve,deferred.reject):deferred.resolve(Interpolator.interpolate(translation,interpolateParams))}else{var missingTranslationHandlerTranslation;$missingTranslationHandlerFactory&&!pendingLoader&&(missingTranslationHandlerTranslation=translateByHandler(translationId,interpolateParams)),$uses&&$fallbackLanguage&&$fallbackLanguage.length?fallbackTranslation(translationId,interpolateParams,Interpolator,defaultTranslationText).then(function(translation){deferred.resolve(translation)},function(_translationId){deferred.reject(applyNotFoundIndicators(_translationId))}):$missingTranslationHandlerFactory&&!pendingLoader&&missingTranslationHandlerTranslation?defaultTranslationText?deferred.resolve(defaultTranslationText):deferred.resolve(missingTranslationHandlerTranslation):defaultTranslationText?deferred.resolve(defaultTranslationText):deferred.reject(applyNotFoundIndicators(translationId))}return deferred.promise},determineTranslationInstant=function(translationId,interpolateParams,interpolationId){var result,table=$uses?$translationTable[$uses]:$translationTable,Interpolator=defaultInterpolator;if(interpolatorHashMap&&Object.prototype.hasOwnProperty.call(interpolatorHashMap,interpolationId)&&(Interpolator=interpolatorHashMap[interpolationId]),table&&Object.prototype.hasOwnProperty.call(table,translationId)){var translation=table[translationId];result="@:"===translation.substr(0,2)?determineTranslationInstant(translation.substr(2),interpolateParams,interpolationId):Interpolator.interpolate(translation,interpolateParams)}else{var missingTranslationHandlerTranslation;$missingTranslationHandlerFactory&&!pendingLoader&&(missingTranslationHandlerTranslation=translateByHandler(translationId,interpolateParams)),$uses&&$fallbackLanguage&&$fallbackLanguage.length?(fallbackIndex=0,result=fallbackTranslationInstant(translationId,interpolateParams,Interpolator)):result=$missingTranslationHandlerFactory&&!pendingLoader&&missingTranslationHandlerTranslation?missingTranslationHandlerTranslation:applyNotFoundIndicators(translationId)}return result},clearNextLangAndPromise=function(key){$nextLang===key&&($nextLang=void 0),langPromises[key]=void 0};if($translate.preferredLanguage=function(langKey){return langKey&&setupPreferredLanguage(langKey),$preferredLanguage},$translate.cloakClassName=function(){return $cloakClassName},$translate.fallbackLanguage=function(langKey){if(void 0!==langKey&&null!==langKey){if(fallbackStack(langKey),$loaderFactory&&$fallbackLanguage&&$fallbackLanguage.length)for(var i=0,len=$fallbackLanguage.length;len>i;i++)langPromises[$fallbackLanguage[i]]||(langPromises[$fallbackLanguage[i]]=loadAsync($fallbackLanguage[i]));$translate.use($translate.use())}return $fallbackWasString?$fallbackLanguage[0]:$fallbackLanguage},$translate.useFallbackLanguage=function(langKey){if(void 0!==langKey&&null!==langKey)if(langKey){var langKeyPosition=indexOf($fallbackLanguage,langKey);langKeyPosition>-1&&(startFallbackIteration=langKeyPosition)}else startFallbackIteration=0},$translate.proposedLanguage=function(){return $nextLang},$translate.storage=function(){return Storage},$translate.use=function(key){if(!key)return $uses;var deferred=$q.defer();$rootScope.$emit("$translateChangeStart",{language:key});var aliasedKey=negotiateLocale(key);return aliasedKey&&(key=aliasedKey),!$forceAsyncReloadEnabled&&$translationTable[key]||!$loaderFactory||langPromises[key]?$nextLang===key&&langPromises[key]?langPromises[key].then(function(translation){return deferred.resolve(translation.key),translation},function(key){return deferred.reject(key),$q.reject(key)}):(deferred.resolve(key),useLanguage(key)):($nextLang=key,langPromises[key]=loadAsync(key).then(function(translation){return translations(translation.key,translation.table),deferred.resolve(translation.key),useLanguage(translation.key),translation},function(key){return $rootScope.$emit("$translateChangeError",{language:key}),deferred.reject(key),$rootScope.$emit("$translateChangeEnd",{language:key}),$q.reject(key)}),langPromises[key]["finally"](function(){clearNextLangAndPromise(key)})),deferred.promise},$translate.storageKey=function(){return storageKey()},$translate.isPostCompilingEnabled=function(){return $postCompilingEnabled},$translate.isForceAsyncReloadEnabled=function(){return $forceAsyncReloadEnabled},$translate.refresh=function(langKey){function resolve(){deferred.resolve(),$rootScope.$emit("$translateRefreshEnd",{language:langKey})}function reject(){deferred.reject(),$rootScope.$emit("$translateRefreshEnd",{language:langKey})}if(!$loaderFactory)throw new Error("Couldn't refresh translation table, no loader registered!");var deferred=$q.defer();if($rootScope.$emit("$translateRefreshStart",{language:langKey}),langKey)if($translationTable[langKey]){var oneTranslationsLoaded=function(data){translations(data.key,data.table),langKey===$uses&&useLanguage($uses),resolve()};oneTranslationsLoaded.displayName="refreshPostProcessor",loadAsync(langKey).then(oneTranslationsLoaded,reject)}else reject();else{var tables=[],loadingKeys={};if($fallbackLanguage&&$fallbackLanguage.length)for(var i=0,len=$fallbackLanguage.length;len>i;i++)tables.push(loadAsync($fallbackLanguage[i])),loadingKeys[$fallbackLanguage[i]]=!0;$uses&&!loadingKeys[$uses]&&tables.push(loadAsync($uses));var allTranslationsLoaded=function(tableData){$translationTable={},angular.forEach(tableData,function(data){translations(data.key,data.table)}),$uses&&useLanguage($uses),resolve()};allTranslationsLoaded.displayName="refreshPostProcessor",$q.all(tables).then(allTranslationsLoaded,reject)}return deferred.promise},$translate.instant=function(translationId,interpolateParams,interpolationId){if(null===translationId||angular.isUndefined(translationId))return translationId;if(angular.isArray(translationId)){for(var results={},i=0,c=translationId.length;c>i;i++)results[translationId[i]]=$translate.instant(translationId[i],interpolateParams,interpolationId);return results}if(angular.isString(translationId)&&translationId.length<1)return translationId;translationId&&(translationId=trim.apply(translationId));var result,possibleLangKeys=[];$preferredLanguage&&possibleLangKeys.push($preferredLanguage),$uses&&possibleLangKeys.push($uses),$fallbackLanguage&&$fallbackLanguage.length&&(possibleLangKeys=possibleLangKeys.concat($fallbackLanguage));for(var j=0,d=possibleLangKeys.length;d>j;j++){var possibleLangKey=possibleLangKeys[j];if($translationTable[possibleLangKey]&&("undefined"!=typeof $translationTable[possibleLangKey][translationId]?result=determineTranslationInstant(translationId,interpolateParams,interpolationId):($notFoundIndicatorLeft||$notFoundIndicatorRight)&&(result=applyNotFoundIndicators(translationId))),"undefined"!=typeof result)break}return result||""===result||(result=defaultInterpolator.interpolate(translationId,interpolateParams),$missingTranslationHandlerFactory&&!pendingLoader&&(result=translateByHandler(translationId,interpolateParams))),result},$translate.versionInfo=function(){return version},$translate.loaderCache=function(){return loaderCache},$translate.directivePriority=function(){return directivePriority},$translate.statefulFilter=function(){return statefulFilter},$loaderFactory&&(angular.equals($translationTable,{})&&$translate.use($translate.use()),$fallbackLanguage&&$fallbackLanguage.length))for(var processAsyncResult=function(translation){return translations(translation.key,translation.table),$rootScope.$emit("$translateChangeEnd",{language:translation.key}),translation},i=0,len=$fallbackLanguage.length;len>i;i++){var fallbackLanguageId=$fallbackLanguage[i];($forceAsyncReloadEnabled||!$translationTable[fallbackLanguageId])&&(langPromises[fallbackLanguageId]=loadAsync(fallbackLanguageId).then(processAsyncResult))}return $translate}]}function $translateDefaultInterpolation($interpolate,$translateSanitization){"use strict";var $locale,$translateInterpolator={},$identifier="default";return $translateInterpolator.setLocale=function(locale){$locale=locale},$translateInterpolator.getInterpolationIdentifier=function(){return $identifier},$translateInterpolator.useSanitizeValueStrategy=function(value){return $translateSanitization.useStrategy(value),this},$translateInterpolator.interpolate=function(string,interpolationParams){interpolationParams=interpolationParams||{},interpolationParams=$translateSanitization.sanitize(interpolationParams,"params");var interpolatedText=$interpolate(string)(interpolationParams);return interpolatedText=$translateSanitization.sanitize(interpolatedText,"text")},$translateInterpolator}function translateDirective($translate,$q,$interpolate,$compile,$parse,$rootScope){"use strict";var trim=function(){return this.toString().replace(/^\s+|\s+$/g,"")};return{restrict:"AE",scope:!0,priority:$translate.directivePriority(),compile:function(tElement,tAttr){var translateValuesExist=tAttr.translateValues?tAttr.translateValues:void 0,translateInterpolation=tAttr.translateInterpolation?tAttr.translateInterpolation:void 0,translateValueExist=tElement[0].outerHTML.match(/translate-value-+/i),interpolateRegExp="^(.*)("+$interpolate.startSymbol()+".*"+$interpolate.endSymbol()+")(.*)",watcherRegExp="^(.*)"+$interpolate.startSymbol()+"(.*)"+$interpolate.endSymbol()+"(.*)";return function(scope,iElement,iAttr){scope.interpolateParams={},scope.preText="",scope.postText="";var translationIds={},initInterpolationParams=function(interpolateParams,iAttr,tAttr){if(iAttr.translateValues&&angular.extend(interpolateParams,$parse(iAttr.translateValues)(scope.$parent)),translateValueExist)for(var attr in tAttr)if(Object.prototype.hasOwnProperty.call(iAttr,attr)&&"translateValue"===attr.substr(0,14)&&"translateValues"!==attr){var attributeName=angular.lowercase(attr.substr(14,1))+attr.substr(15);interpolateParams[attributeName]=tAttr[attr]}},observeElementTranslation=function(translationId){if(angular.isFunction(observeElementTranslation._unwatchOld)&&(observeElementTranslation._unwatchOld(),observeElementTranslation._unwatchOld=void 0),angular.equals(translationId,"")||!angular.isDefined(translationId)){var interpolateMatches=trim.apply(iElement.text()).match(interpolateRegExp);if(angular.isArray(interpolateMatches)){scope.preText=interpolateMatches[1],scope.postText=interpolateMatches[3],translationIds.translate=$interpolate(interpolateMatches[2])(scope.$parent);var watcherMatches=iElement.text().match(watcherRegExp);angular.isArray(watcherMatches)&&watcherMatches[2]&&watcherMatches[2].length&&(observeElementTranslation._unwatchOld=scope.$watch(watcherMatches[2],function(newValue){translationIds.translate=newValue,updateTranslations()}))}else translationIds.translate=iElement.text().replace(/^\s+|\s+$/g,"")}else translationIds.translate=translationId;updateTranslations()},observeAttributeTranslation=function(translateAttr){iAttr.$observe(translateAttr,function(translationId){translationIds[translateAttr]=translationId,updateTranslations()})};initInterpolationParams(scope.interpolateParams,iAttr,tAttr);var firstAttributeChangedEvent=!0;iAttr.$observe("translate",function(translationId){"undefined"==typeof translationId?observeElementTranslation(""):""===translationId&&firstAttributeChangedEvent||(translationIds.translate=translationId,updateTranslations()),firstAttributeChangedEvent=!1});for(var translateAttr in iAttr)iAttr.hasOwnProperty(translateAttr)&&"translateAttr"===translateAttr.substr(0,13)&&observeAttributeTranslation(translateAttr);if(iAttr.$observe("translateDefault",function(value){scope.defaultText=value}),translateValuesExist&&iAttr.$observe("translateValues",function(interpolateParams){
interpolateParams&&scope.$parent.$watch(function(){angular.extend(scope.interpolateParams,$parse(interpolateParams)(scope.$parent))})}),translateValueExist){var observeValueAttribute=function(attrName){iAttr.$observe(attrName,function(value){var attributeName=angular.lowercase(attrName.substr(14,1))+attrName.substr(15);scope.interpolateParams[attributeName]=value})};for(var attr in iAttr)Object.prototype.hasOwnProperty.call(iAttr,attr)&&"translateValue"===attr.substr(0,14)&&"translateValues"!==attr&&observeValueAttribute(attr)}var updateTranslations=function(){for(var key in translationIds)translationIds.hasOwnProperty(key)&&void 0!==translationIds[key]&&updateTranslation(key,translationIds[key],scope,scope.interpolateParams,scope.defaultText)},updateTranslation=function(translateAttr,translationId,scope,interpolateParams,defaultTranslationText){translationId?$translate(translationId,interpolateParams,translateInterpolation,defaultTranslationText).then(function(translation){applyTranslation(translation,scope,!0,translateAttr)},function(translationId){applyTranslation(translationId,scope,!1,translateAttr)}):applyTranslation(translationId,scope,!1,translateAttr)},applyTranslation=function(value,scope,successful,translateAttr){if("translate"===translateAttr){successful||"undefined"==typeof scope.defaultText||(value=scope.defaultText),iElement.html(scope.preText+value+scope.postText);var globallyEnabled=$translate.isPostCompilingEnabled(),locallyDefined="undefined"!=typeof tAttr.translateCompile,locallyEnabled=locallyDefined&&"false"!==tAttr.translateCompile;(globallyEnabled&&!locallyDefined||locallyEnabled)&&$compile(iElement.contents())(scope)}else{successful||"undefined"==typeof scope.defaultText||(value=scope.defaultText);var attributeName=iAttr.$attr[translateAttr];"data-"===attributeName.substr(0,5)&&(attributeName=attributeName.substr(5)),attributeName=attributeName.substr(15),iElement.attr(attributeName,value)}};(translateValuesExist||translateValueExist||iAttr.translateDefault)&&scope.$watch("interpolateParams",updateTranslations,!0);var unbind=$rootScope.$on("$translateChangeSuccess",updateTranslations);iElement.text().length?observeElementTranslation(iAttr.translate?iAttr.translate:""):iAttr.translate&&observeElementTranslation(iAttr.translate),updateTranslations(),scope.$on("$destroy",unbind)}}}}function translateCloakDirective($rootScope,$translate){"use strict";return{compile:function(tElement){var applyCloak=function(){tElement.addClass($translate.cloakClassName())},removeCloak=function(){tElement.removeClass($translate.cloakClassName())},removeListener=$rootScope.$on("$translateChangeEnd",function(){removeCloak(),removeListener(),removeListener=null});return applyCloak(),function(scope,iElement,iAttr){iAttr.translateCloak&&iAttr.translateCloak.length&&iAttr.$observe("translateCloak",function(translationId){$translate(translationId).then(removeCloak,applyCloak)})}}}}function translateFilterFactory($parse,$translate){"use strict";var translateFilter=function(translationId,interpolateParams,interpolation){return angular.isObject(interpolateParams)||(interpolateParams=$parse(interpolateParams)(this)),$translate.instant(translationId,interpolateParams,interpolation)};return $translate.statefulFilter()&&(translateFilter.$stateful=!0),translateFilter}function $translationCache($cacheFactory){"use strict";return $cacheFactory("translations")}return angular.module("pascalprecht.translate",["ng"]).run(runTranslate),runTranslate.$inject=["$translate"],runTranslate.displayName="runTranslate",angular.module("pascalprecht.translate").provider("$translateSanitization",$translateSanitizationProvider),angular.module("pascalprecht.translate").constant("pascalprechtTranslateOverrider",{}).provider("$translate",$translate),$translate.$inject=["$STORAGE_KEY","$windowProvider","$translateSanitizationProvider","pascalprechtTranslateOverrider"],$translate.displayName="displayName",angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",$translateDefaultInterpolation),$translateDefaultInterpolation.$inject=["$interpolate","$translateSanitization"],$translateDefaultInterpolation.displayName="$translateDefaultInterpolation",angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",translateDirective),translateDirective.$inject=["$translate","$q","$interpolate","$compile","$parse","$rootScope"],translateDirective.displayName="translateDirective",angular.module("pascalprecht.translate").directive("translateCloak",translateCloakDirective),translateCloakDirective.$inject=["$rootScope","$translate"],translateCloakDirective.displayName="translateCloakDirective",angular.module("pascalprecht.translate").filter("translate",translateFilterFactory),translateFilterFactory.$inject=["$parse","$translate"],translateFilterFactory.displayName="translateFilterFactory",angular.module("pascalprecht.translate").factory("$translationCache",$translationCache),$translationCache.$inject=["$cacheFactory"],$translationCache.displayName="$translationCache","pascalprecht.translate"});
!function(global,factory){"function"==typeof define&&define.amd?define([],factory):"undefined"!=typeof module&&module.exports?module.exports=factory():global.tv4=factory()}(this,function(){function recursiveCompare(A,B){if(A===B)return!0;if("object"==typeof A&&"object"==typeof B){if(Array.isArray(A)!==Array.isArray(B))return!1;if(Array.isArray(A)){if(A.length!==B.length)return!1;for(var i=0;i<A.length;i++)if(!recursiveCompare(A[i],B[i]))return!1}else{var key;for(key in A)if(void 0===B[key]&&void 0!==A[key])return!1;for(key in B)if(void 0===A[key]&&void 0!==B[key])return!1;for(key in A)if(!recursiveCompare(A[key],B[key]))return!1}return!0}return!1}function parseURI(url){var m=String(url).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return m?{href:m[0]||"",protocol:m[1]||"",authority:m[2]||"",host:m[3]||"",hostname:m[4]||"",port:m[5]||"",pathname:m[6]||"",search:m[7]||"",hash:m[8]||""}:null}function resolveUrl(base,href){function removeDotSegments(input){var output=[];return input.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(p){"/.."===p?output.pop():output.push(p)}),output.join("").replace(/^\//,"/"===input.charAt(0)?"/":"")}return href=parseURI(href||""),base=parseURI(base||""),href&&base?(href.protocol||base.protocol)+(href.protocol||href.authority?href.authority:base.authority)+removeDotSegments(href.protocol||href.authority||"/"===href.pathname.charAt(0)?href.pathname:href.pathname?(base.authority&&!base.pathname?"/":"")+base.pathname.slice(0,base.pathname.lastIndexOf("/")+1)+href.pathname:base.pathname)+(href.protocol||href.authority||href.pathname?href.search:href.search||base.search)+href.hash:null}function getDocumentUri(uri){return uri.split("#")[0]}function normSchema(schema,baseUri){if(schema&&"object"==typeof schema)if(void 0===baseUri?baseUri=schema.id:"string"==typeof schema.id&&(baseUri=resolveUrl(baseUri,schema.id),schema.id=baseUri),Array.isArray(schema))for(var i=0;i<schema.length;i++)normSchema(schema[i],baseUri);else{"string"==typeof schema.$ref&&(schema.$ref=resolveUrl(baseUri,schema.$ref));for(var key in schema)"enum"!==key&&normSchema(schema[key],baseUri)}}function ValidationError(code,message,dataPath,schemaPath,subErrors){if(Error.call(this),void 0===code)throw new Error("No code supplied for error: "+message);this.message=message,this.code=code,this.dataPath=dataPath||"",this.schemaPath=schemaPath||"",this.subErrors=subErrors||null;var err=new Error(this.message);if(this.stack=err.stack||err.stacktrace,!this.stack)try{throw err}catch(err){this.stack=err.stack||err.stacktrace}}function isTrustedUrl(baseUrl,testUrl){if(testUrl.substring(0,baseUrl.length)===baseUrl){var remainder=testUrl.substring(baseUrl.length);if(testUrl.length>0&&"/"===testUrl.charAt(baseUrl.length-1)||"#"===remainder.charAt(0)||"?"===remainder.charAt(0))return!0}return!1}function createApi(language){var globalContext=new ValidatorContext,currentLanguage=language||"en",api={addFormat:function(){globalContext.addFormat.apply(globalContext,arguments)},language:function(code){return code?(languages[code]||(code=code.split("-")[0]),languages[code]?(currentLanguage=code,code):!1):currentLanguage},addLanguage:function(code,messageMap){var key;for(key in ErrorCodes)messageMap[key]&&!messageMap[ErrorCodes[key]]&&(messageMap[ErrorCodes[key]]=messageMap[key]);var rootCode=code.split("-")[0];if(languages[rootCode]){languages[code]=Object.create(languages[rootCode]);for(key in messageMap)"undefined"==typeof languages[rootCode][key]&&(languages[rootCode][key]=messageMap[key]),languages[code][key]=messageMap[key]}else languages[code]=messageMap,languages[rootCode]=messageMap;return this},freshApi:function(language){var result=createApi();return language&&result.language(language),result},validate:function(data,schema,checkRecursive,banUnknownProperties){var context=new ValidatorContext(globalContext,!1,languages[currentLanguage],checkRecursive,banUnknownProperties);"string"==typeof schema&&(schema={$ref:schema}),context.addSchema("",schema);var error=context.validateAll(data,schema,null,null,"");return!error&&banUnknownProperties&&(error=context.banUnknownProperties()),this.error=error,this.missing=context.missing,this.valid=null===error,this.valid},validateResult:function(){var result={};return this.validate.apply(result,arguments),result},validateMultiple:function(data,schema,checkRecursive,banUnknownProperties){var context=new ValidatorContext(globalContext,!0,languages[currentLanguage],checkRecursive,banUnknownProperties);"string"==typeof schema&&(schema={$ref:schema}),context.addSchema("",schema),context.validateAll(data,schema,null,null,""),banUnknownProperties&&context.banUnknownProperties();var result={};return result.errors=context.errors,result.missing=context.missing,result.valid=0===result.errors.length,result},addSchema:function(){return globalContext.addSchema.apply(globalContext,arguments)},getSchema:function(){return globalContext.getSchema.apply(globalContext,arguments)},getSchemaMap:function(){return globalContext.getSchemaMap.apply(globalContext,arguments)},getSchemaUris:function(){return globalContext.getSchemaUris.apply(globalContext,arguments)},getMissingUris:function(){return globalContext.getMissingUris.apply(globalContext,arguments)},dropSchemas:function(){globalContext.dropSchemas.apply(globalContext,arguments)},defineKeyword:function(){globalContext.defineKeyword.apply(globalContext,arguments)},defineError:function(codeName,codeNumber,defaultMessage){if("string"!=typeof codeName||!/^[A-Z]+(_[A-Z]+)*$/.test(codeName))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof codeNumber||codeNumber%1!==0||1e4>codeNumber)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof ErrorCodes[codeName])throw new Error("Error already defined: "+codeName+" as "+ErrorCodes[codeName]);if("undefined"!=typeof ErrorCodeLookup[codeNumber])throw new Error("Error code already used: "+ErrorCodeLookup[codeNumber]+" as "+codeNumber);ErrorCodes[codeName]=codeNumber,ErrorCodeLookup[codeNumber]=codeName,ErrorMessagesDefault[codeName]=ErrorMessagesDefault[codeNumber]=defaultMessage;for(var langCode in languages){var language=languages[langCode];language[codeName]&&(language[codeNumber]=language[codeNumber]||language[codeName])}},reset:function(){globalContext.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:normSchema,resolveUrl:resolveUrl,getDocumentUri:getDocumentUri,errorCodes:ErrorCodes};return api}Object.keys||(Object.keys=function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if("object"!=typeof obj&&"function"!=typeof obj||null===obj)throw new TypeError("Object.keys called on non-object");var result=[];for(var prop in obj)hasOwnProperty.call(obj,prop)&&result.push(prop);if(hasDontEnumBug)for(var i=0;dontEnumsLength>i;i++)hasOwnProperty.call(obj,dontEnums[i])&&result.push(dontEnums[i]);return result}}()),Object.create||(Object.create=function(){function F(){}return function(o){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return F.prototype=o,new F}}()),Array.isArray||(Array.isArray=function(vArg){return"[object Array]"===Object.prototype.toString.call(vArg)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);len>k;k++)if(k in t&&t[k]===searchElement)return k;return-1}),Object.isFrozen||(Object.isFrozen=function(obj){for(var key="tv4_test_frozen_key";obj.hasOwnProperty(key);)key+=Math.random();try{return obj[key]=!0,delete obj[key],!1}catch(e){return!0}});var ValidatorContext=function(parent,collectMultiple,errorMessages,checkRecursive,trackUnknownProperties){if(this.missing=[],this.missingMap={},this.formatValidators=parent?Object.create(parent.formatValidators):{},this.schemas=parent?Object.create(parent.schemas):{},this.collectMultiple=collectMultiple,this.errors=[],this.handleError=collectMultiple?this.collectError:this.returnError,checkRecursive&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),trackUnknownProperties&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=errorMessages,this.definedKeywords={},parent)for(var key in parent.definedKeywords)this.definedKeywords[key]=parent.definedKeywords[key].slice(0)};ValidatorContext.prototype.defineKeyword=function(keyword,keywordFunction){this.definedKeywords[keyword]=this.definedKeywords[keyword]||[],this.definedKeywords[keyword].push(keywordFunction)},ValidatorContext.prototype.createError=function(code,messageParams,dataPath,schemaPath,subErrors){var messageTemplate=this.errorMessages[code]||ErrorMessagesDefault[code];if("string"!=typeof messageTemplate)return new ValidationError(code,"Unknown error code "+code+": "+JSON.stringify(messageParams),dataPath,schemaPath,subErrors);var message=messageTemplate.replace(/\{([^{}]*)\}/g,function(whole,varName){var subValue=messageParams[varName];return"string"==typeof subValue||"number"==typeof subValue?subValue:whole});return new ValidationError(code,message,dataPath,schemaPath,subErrors)},ValidatorContext.prototype.returnError=function(error){return error},ValidatorContext.prototype.collectError=function(error){return error&&this.errors.push(error),null},ValidatorContext.prototype.prefixErrors=function(startIndex,dataPath,schemaPath){for(var i=startIndex;i<this.errors.length;i++)this.errors[i]=this.errors[i].prefixWith(dataPath,schemaPath);return this},ValidatorContext.prototype.banUnknownProperties=function(){for(var unknownPath in this.unknownPropertyPaths){var error=this.createError(ErrorCodes.UNKNOWN_PROPERTY,{path:unknownPath},unknownPath,""),result=this.handleError(error);if(result)return result}return null},ValidatorContext.prototype.addFormat=function(format,validator){if("object"==typeof format){for(var key in format)this.addFormat(key,format[key]);return this}this.formatValidators[format]=validator},ValidatorContext.prototype.resolveRefs=function(schema,urlHistory){if(void 0!==schema.$ref){if(urlHistory=urlHistory||{},urlHistory[schema.$ref])return this.createError(ErrorCodes.CIRCULAR_REFERENCE,{urls:Object.keys(urlHistory).join(", ")},"","");urlHistory[schema.$ref]=!0,schema=this.getSchema(schema.$ref,urlHistory)}return schema},ValidatorContext.prototype.getSchema=function(url,urlHistory){var schema;if(void 0!==this.schemas[url])return schema=this.schemas[url],this.resolveRefs(schema,urlHistory);var baseUrl=url,fragment="";if(-1!==url.indexOf("#")&&(fragment=url.substring(url.indexOf("#")+1),baseUrl=url.substring(0,url.indexOf("#"))),"object"==typeof this.schemas[baseUrl]){schema=this.schemas[baseUrl];var pointerPath=decodeURIComponent(fragment);if(""===pointerPath)return this.resolveRefs(schema,urlHistory);if("/"!==pointerPath.charAt(0))return void 0;for(var parts=pointerPath.split("/").slice(1),i=0;i<parts.length;i++){var component=parts[i].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===schema[component]){schema=void 0;break}schema=schema[component]}if(void 0!==schema)return this.resolveRefs(schema,urlHistory)}void 0===this.missing[baseUrl]&&(this.missing.push(baseUrl),this.missing[baseUrl]=baseUrl,this.missingMap[baseUrl]=baseUrl)},ValidatorContext.prototype.searchSchemas=function(schema,url){if(schema&&"object"==typeof schema){"string"==typeof schema.id&&isTrustedUrl(url,schema.id)&&void 0===this.schemas[schema.id]&&(this.schemas[schema.id]=schema);for(var key in schema)if("enum"!==key)if("object"==typeof schema[key])this.searchSchemas(schema[key],url);else if("$ref"===key){var uri=getDocumentUri(schema[key]);uri&&void 0===this.schemas[uri]&&void 0===this.missingMap[uri]&&(this.missingMap[uri]=uri)}}},ValidatorContext.prototype.addSchema=function(url,schema){if("string"!=typeof url||"undefined"==typeof schema){if("object"!=typeof url||"string"!=typeof url.id)return;schema=url,url=schema.id}(url=getDocumentUri(url)+"#")&&(url=getDocumentUri(url)),this.schemas[url]=schema,delete this.missingMap[url],normSchema(schema,url),this.searchSchemas(schema,url)},ValidatorContext.prototype.getSchemaMap=function(){var map={};for(var key in this.schemas)map[key]=this.schemas[key];return map},ValidatorContext.prototype.getSchemaUris=function(filterRegExp){var list=[];for(var key in this.schemas)(!filterRegExp||filterRegExp.test(key))&&list.push(key);return list},ValidatorContext.prototype.getMissingUris=function(filterRegExp){var list=[];for(var key in this.missingMap)(!filterRegExp||filterRegExp.test(key))&&list.push(key);return list},ValidatorContext.prototype.dropSchemas=function(){this.schemas={},this.reset()},ValidatorContext.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},ValidatorContext.prototype.validateAll=function(data,schema,dataPathParts,schemaPathParts,dataPointerPath){var topLevel;if(schema=this.resolveRefs(schema),!schema)return null;if(schema instanceof ValidationError)return this.errors.push(schema),schema;var frozenIndex,startErrorCount=this.errors.length,scannedFrozenSchemaIndex=null,scannedSchemasIndex=null;if(this.checkRecursive&&data&&"object"==typeof data){if(topLevel=!this.scanned.length,data[this.validatedSchemasKey]){var schemaIndex=data[this.validatedSchemasKey].indexOf(schema);if(-1!==schemaIndex)return this.errors=this.errors.concat(data[this.validationErrorsKey][schemaIndex]),null}if(Object.isFrozen(data)&&(frozenIndex=this.scannedFrozen.indexOf(data),-1!==frozenIndex)){var frozenSchemaIndex=this.scannedFrozenSchemas[frozenIndex].indexOf(schema);if(-1!==frozenSchemaIndex)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]),null}if(this.scanned.push(data),Object.isFrozen(data))-1===frozenIndex&&(frozenIndex=this.scannedFrozen.length,this.scannedFrozen.push(data),this.scannedFrozenSchemas.push([])),scannedFrozenSchemaIndex=this.scannedFrozenSchemas[frozenIndex].length,this.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex]=schema,this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex]=[];else{if(!data[this.validatedSchemasKey])try{Object.defineProperty(data,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(data,this.validationErrorsKey,{value:[],configurable:!0})}catch(e){data[this.validatedSchemasKey]=[],data[this.validationErrorsKey]=[]}scannedSchemasIndex=data[this.validatedSchemasKey].length,data[this.validatedSchemasKey][scannedSchemasIndex]=schema,data[this.validationErrorsKey][scannedSchemasIndex]=[]}}var errorCount=this.errors.length,error=this.validateBasic(data,schema,dataPointerPath)||this.validateNumeric(data,schema,dataPointerPath)||this.validateString(data,schema,dataPointerPath)||this.validateArray(data,schema,dataPointerPath)||this.validateObject(data,schema,dataPointerPath)||this.validateCombinations(data,schema,dataPointerPath)||this.validateFormat(data,schema,dataPointerPath)||this.validateDefinedKeywords(data,schema,dataPointerPath)||null;if(topLevel){for(;this.scanned.length;){var item=this.scanned.pop();delete item[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(error||errorCount!==this.errors.length)for(;dataPathParts&&dataPathParts.length||schemaPathParts&&schemaPathParts.length;){var dataPart=dataPathParts&&dataPathParts.length?""+dataPathParts.pop():null,schemaPart=schemaPathParts&&schemaPathParts.length?""+schemaPathParts.pop():null;error&&(error=error.prefixWith(dataPart,schemaPart)),this.prefixErrors(errorCount,dataPart,schemaPart)}return null!==scannedFrozenSchemaIndex?this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex]=this.errors.slice(startErrorCount):null!==scannedSchemasIndex&&(data[this.validationErrorsKey][scannedSchemasIndex]=this.errors.slice(startErrorCount)),this.handleError(error)},ValidatorContext.prototype.validateFormat=function(data,schema){if("string"!=typeof schema.format||!this.formatValidators[schema.format])return null;var errorMessage=this.formatValidators[schema.format].call(null,data,schema);return"string"==typeof errorMessage||"number"==typeof errorMessage?this.createError(ErrorCodes.FORMAT_CUSTOM,{message:errorMessage}).prefixWith(null,"format"):errorMessage&&"object"==typeof errorMessage?this.createError(ErrorCodes.FORMAT_CUSTOM,{message:errorMessage.message||"?"},errorMessage.dataPath||null,errorMessage.schemaPath||"/format"):null},ValidatorContext.prototype.validateDefinedKeywords=function(data,schema){for(var key in this.definedKeywords)for(var validationFunctions=this.definedKeywords[key],i=0;i<validationFunctions.length;i++){var func=validationFunctions[i],result=func(data,schema[key],schema);if("string"==typeof result||"number"==typeof result)return this.createError(ErrorCodes.KEYWORD_CUSTOM,{key:key,message:result}).prefixWith(null,"format");if(result&&"object"==typeof result){var code=result.code||ErrorCodes.KEYWORD_CUSTOM;if("string"==typeof code){if(!ErrorCodes[code])throw new Error("Undefined error code (use defineError): "+code);code=ErrorCodes[code]}var messageParams="object"==typeof result.message?result.message:{key:key,message:result.message||"?"},schemaPath=result.schemaPath||"/"+key.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(code,messageParams,result.dataPath||null,schemaPath)}}return null},ValidatorContext.prototype.validateBasic=function(data,schema,dataPointerPath){var error;return(error=this.validateType(data,schema,dataPointerPath))?error.prefixWith(null,"type"):(error=this.validateEnum(data,schema,dataPointerPath))?error.prefixWith(null,"type"):null},ValidatorContext.prototype.validateType=function(data,schema){if(void 0===schema.type)return null;var dataType=typeof data;null===data?dataType="null":Array.isArray(data)&&(dataType="array");var allowedTypes=schema.type;"object"!=typeof allowedTypes&&(allowedTypes=[allowedTypes]);for(var i=0;i<allowedTypes.length;i++){var type=allowedTypes[i];if(type===dataType||"integer"===type&&"number"===dataType&&data%1===0)return null}return this.createError(ErrorCodes.INVALID_TYPE,{type:dataType,expected:allowedTypes.join("/")})},ValidatorContext.prototype.validateEnum=function(data,schema){if(void 0===schema["enum"])return null;for(var i=0;i<schema["enum"].length;i++){var enumVal=schema["enum"][i];if(recursiveCompare(data,enumVal))return null}return this.createError(ErrorCodes.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(data):data})},ValidatorContext.prototype.validateNumeric=function(data,schema,dataPointerPath){return this.validateMultipleOf(data,schema,dataPointerPath)||this.validateMinMax(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateMultipleOf=function(data,schema){var multipleOf=schema.multipleOf||schema.divisibleBy;return void 0===multipleOf?null:"number"==typeof data&&data%multipleOf!==0?this.createError(ErrorCodes.NUMBER_MULTIPLE_OF,{value:data,multipleOf:multipleOf}):null},ValidatorContext.prototype.validateMinMax=function(data,schema){if("number"!=typeof data)return null;if(void 0!==schema.minimum){if(data<schema.minimum)return this.createError(ErrorCodes.NUMBER_MINIMUM,{value:data,minimum:schema.minimum}).prefixWith(null,"minimum");if(schema.exclusiveMinimum&&data===schema.minimum)return this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE,{value:data,minimum:schema.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==schema.maximum){if(data>schema.maximum)return this.createError(ErrorCodes.NUMBER_MAXIMUM,{value:data,maximum:schema.maximum}).prefixWith(null,"maximum");if(schema.exclusiveMaximum&&data===schema.maximum)return this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE,{value:data,maximum:schema.maximum}).prefixWith(null,"exclusiveMaximum")}return null},ValidatorContext.prototype.validateString=function(data,schema,dataPointerPath){return this.validateStringLength(data,schema,dataPointerPath)||this.validateStringPattern(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateStringLength=function(data,schema){return"string"!=typeof data?null:void 0!==schema.minLength&&data.length<schema.minLength?this.createError(ErrorCodes.STRING_LENGTH_SHORT,{length:data.length,minimum:schema.minLength}).prefixWith(null,"minLength"):void 0!==schema.maxLength&&data.length>schema.maxLength?this.createError(ErrorCodes.STRING_LENGTH_LONG,{length:data.length,maximum:schema.maxLength}).prefixWith(null,"maxLength"):null},ValidatorContext.prototype.validateStringPattern=function(data,schema){if("string"!=typeof data||void 0===schema.pattern)return null;var regexp=new RegExp(schema.pattern);return regexp.test(data)?null:this.createError(ErrorCodes.STRING_PATTERN,{pattern:schema.pattern}).prefixWith(null,"pattern")},ValidatorContext.prototype.validateArray=function(data,schema,dataPointerPath){return Array.isArray(data)?this.validateArrayLength(data,schema,dataPointerPath)||this.validateArrayUniqueItems(data,schema,dataPointerPath)||this.validateArrayItems(data,schema,dataPointerPath)||null:null},ValidatorContext.prototype.validateArrayLength=function(data,schema){var error;return void 0!==schema.minItems&&data.length<schema.minItems&&(error=this.createError(ErrorCodes.ARRAY_LENGTH_SHORT,{length:data.length,minimum:schema.minItems}).prefixWith(null,"minItems"),this.handleError(error))?error:void 0!==schema.maxItems&&data.length>schema.maxItems&&(error=this.createError(ErrorCodes.ARRAY_LENGTH_LONG,{length:data.length,maximum:schema.maxItems}).prefixWith(null,"maxItems"),this.handleError(error))?error:null},ValidatorContext.prototype.validateArrayUniqueItems=function(data,schema){if(schema.uniqueItems)for(var i=0;i<data.length;i++)for(var j=i+1;j<data.length;j++)if(recursiveCompare(data[i],data[j])){var error=this.createError(ErrorCodes.ARRAY_UNIQUE,{match1:i,match2:j}).prefixWith(null,"uniqueItems");if(this.handleError(error))return error}return null},ValidatorContext.prototype.validateArrayItems=function(data,schema,dataPointerPath){if(void 0===schema.items)return null;var error,i;if(Array.isArray(schema.items)){for(i=0;i<data.length;i++)if(i<schema.items.length){if(error=this.validateAll(data[i],schema.items[i],[i],["items",i],dataPointerPath+"/"+i))return error}else if(void 0!==schema.additionalItems)if("boolean"==typeof schema.additionalItems){if(!schema.additionalItems&&(error=this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+i,"additionalItems"),this.handleError(error)))return error}else if(error=this.validateAll(data[i],schema.additionalItems,[i],["additionalItems"],dataPointerPath+"/"+i))return error}else for(i=0;i<data.length;i++)if(error=this.validateAll(data[i],schema.items,[i],["items"],dataPointerPath+"/"+i))return error;return null},ValidatorContext.prototype.validateObject=function(data,schema,dataPointerPath){return"object"!=typeof data||null===data||Array.isArray(data)?null:this.validateObjectMinMaxProperties(data,schema,dataPointerPath)||this.validateObjectRequiredProperties(data,schema,dataPointerPath)||this.validateObjectProperties(data,schema,dataPointerPath)||this.validateObjectDependencies(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateObjectMinMaxProperties=function(data,schema){var error,keys=Object.keys(data);return void 0!==schema.minProperties&&keys.length<schema.minProperties&&(error=this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM,{propertyCount:keys.length,minimum:schema.minProperties}).prefixWith(null,"minProperties"),this.handleError(error))?error:void 0!==schema.maxProperties&&keys.length>schema.maxProperties&&(error=this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:keys.length,maximum:schema.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(error))?error:null},ValidatorContext.prototype.validateObjectRequiredProperties=function(data,schema){if(void 0!==schema.required)for(var i=0;i<schema.required.length;i++){var key=schema.required[i];if(void 0===data[key]){var error=this.createError(ErrorCodes.OBJECT_REQUIRED,{key:key}).prefixWith(null,""+i).prefixWith(null,"required");if(this.handleError(error))return error}}return null},ValidatorContext.prototype.validateObjectProperties=function(data,schema,dataPointerPath){var error;for(var key in data){var keyPointerPath=dataPointerPath+"/"+key.replace(/~/g,"~0").replace(/\//g,"~1"),foundMatch=!1;if(void 0!==schema.properties&&void 0!==schema.properties[key]&&(foundMatch=!0,error=this.validateAll(data[key],schema.properties[key],[key],["properties",key],keyPointerPath)))return error;if(void 0!==schema.patternProperties)for(var patternKey in schema.patternProperties){var regexp=new RegExp(patternKey);if(regexp.test(key)&&(foundMatch=!0,error=this.validateAll(data[key],schema.patternProperties[patternKey],[key],["patternProperties",patternKey],keyPointerPath)))return error}if(foundMatch)this.trackUnknownProperties&&(this.knownPropertyPaths[keyPointerPath]=!0,delete this.unknownPropertyPaths[keyPointerPath]);else if(void 0!==schema.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[keyPointerPath]=!0,delete this.unknownPropertyPaths[keyPointerPath]),"boolean"==typeof schema.additionalProperties){if(!schema.additionalProperties&&(error=this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(key,"additionalProperties"),this.handleError(error)))return error}else if(error=this.validateAll(data[key],schema.additionalProperties,[key],["additionalProperties"],keyPointerPath))return error}else this.trackUnknownProperties&&!this.knownPropertyPaths[keyPointerPath]&&(this.unknownPropertyPaths[keyPointerPath]=!0)}return null},ValidatorContext.prototype.validateObjectDependencies=function(data,schema,dataPointerPath){var error;if(void 0!==schema.dependencies)for(var depKey in schema.dependencies)if(void 0!==data[depKey]){var dep=schema.dependencies[depKey];if("string"==typeof dep){if(void 0===data[dep]&&(error=this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY,{key:depKey,missing:dep}).prefixWith(null,depKey).prefixWith(null,"dependencies"),this.handleError(error)))return error}else if(Array.isArray(dep))for(var i=0;i<dep.length;i++){var requiredKey=dep[i];if(void 0===data[requiredKey]&&(error=this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY,{key:depKey,missing:requiredKey}).prefixWith(null,""+i).prefixWith(null,depKey).prefixWith(null,"dependencies"),this.handleError(error)))return error}else if(error=this.validateAll(data,dep,[],["dependencies",depKey],dataPointerPath))return error}return null},ValidatorContext.prototype.validateCombinations=function(data,schema,dataPointerPath){return this.validateAllOf(data,schema,dataPointerPath)||this.validateAnyOf(data,schema,dataPointerPath)||this.validateOneOf(data,schema,dataPointerPath)||this.validateNot(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateAllOf=function(data,schema,dataPointerPath){if(void 0===schema.allOf)return null;for(var error,i=0;i<schema.allOf.length;i++){var subSchema=schema.allOf[i];if(error=this.validateAll(data,subSchema,[],["allOf",i],dataPointerPath))return error}return null},ValidatorContext.prototype.validateAnyOf=function(data,schema,dataPointerPath){if(void 0===schema.anyOf)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,errors=[],startErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths);for(var errorAtEnd=!0,i=0;i<schema.anyOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var subSchema=schema.anyOf[i],errorCount=this.errors.length,error=this.validateAll(data,subSchema,[],["anyOf",i],dataPointerPath);if(null===error&&errorCount===this.errors.length){if(this.errors=this.errors.slice(0,startErrorCount),this.trackUnknownProperties){for(var knownKey in this.knownPropertyPaths)oldKnownPropertyPaths[knownKey]=!0,delete oldUnknownPropertyPaths[knownKey];for(var unknownKey in this.unknownPropertyPaths)oldKnownPropertyPaths[unknownKey]||(oldUnknownPropertyPaths[unknownKey]=!0);errorAtEnd=!1;continue}return null}error&&errors.push(error.prefixWith(null,""+i).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),errorAtEnd?(errors=errors.concat(this.errors.slice(startErrorCount)),this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ANY_OF_MISSING,{},"","/anyOf",errors)):void 0},ValidatorContext.prototype.validateOneOf=function(data,schema,dataPointerPath){if(void 0===schema.oneOf)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,validIndex=null,errors=[],startErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths);for(var i=0;i<schema.oneOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var subSchema=schema.oneOf[i],errorCount=this.errors.length,error=this.validateAll(data,subSchema,[],["oneOf",i],dataPointerPath);if(null===error&&errorCount===this.errors.length){if(null!==validIndex)return this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ONE_OF_MULTIPLE,{index1:validIndex,index2:i},"","/oneOf");if(validIndex=i,this.trackUnknownProperties){for(var knownKey in this.knownPropertyPaths)oldKnownPropertyPaths[knownKey]=!0,delete oldUnknownPropertyPaths[knownKey];for(var unknownKey in this.unknownPropertyPaths)oldKnownPropertyPaths[unknownKey]||(oldUnknownPropertyPaths[unknownKey]=!0)}}else error&&errors.push(error.prefixWith(null,""+i).prefixWith(null,"oneOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),null===validIndex?(errors=errors.concat(this.errors.slice(startErrorCount)),this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ONE_OF_MISSING,{},"","/oneOf",errors)):(this.errors=this.errors.slice(0,startErrorCount),null)},ValidatorContext.prototype.validateNot=function(data,schema,dataPointerPath){if(void 0===schema.not)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,oldErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var error=this.validateAll(data,schema.not,null,null,dataPointerPath),notErrors=this.errors.slice(oldErrorCount);return this.errors=this.errors.slice(0,oldErrorCount),this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),null===error&&0===notErrors.length?this.createError(ErrorCodes.NOT_PASSED,{},"","/not"):null};var ErrorCodes={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,
OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},ErrorCodeLookup={};for(var key in ErrorCodes)ErrorCodeLookup[ErrorCodes[key]]=key;var ErrorMessagesDefault={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};ValidationError.prototype=Object.create(Error.prototype),ValidationError.prototype.constructor=ValidationError,ValidationError.prototype.name="ValidationError",ValidationError.prototype.prefixWith=function(dataPrefix,schemaPrefix){if(null!==dataPrefix&&(dataPrefix=dataPrefix.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+dataPrefix+this.dataPath),null!==schemaPrefix&&(schemaPrefix=schemaPrefix.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+schemaPrefix+this.schemaPath),null!==this.subErrors)for(var i=0;i<this.subErrors.length;i++)this.subErrors[i].prefixWith(dataPrefix,schemaPrefix);return this};var languages={},tv4=createApi();return tv4.addLanguage("en-gb",ErrorMessagesDefault),tv4.tv4=tv4,tv4});
"use strict";!function(undefined){var ObjectPath={parse:function(str){if("string"!=typeof str)throw new TypeError("ObjectPath.parse must be passed a string");for(var d,b,q,c,i=0,parts=[];i<str.length;)if(d=str.indexOf(".",i),b=str.indexOf("[",i),-1===d&&-1===b)parts.push(str.slice(i,str.length)),i=str.length;else if(-1===b||-1!==d&&b>d)parts.push(str.slice(i,d)),i=d+1;else if(b>i&&(parts.push(str.slice(i,b)),i=b),q=str.slice(b+1,b+2),'"'!==q&&"'"!==q)c=str.indexOf("]",b),-1===c&&(c=str.length),parts.push(str.slice(i+1,c)),i="."===str.slice(c+1,c+2)?c+2:c+1;else{for(c=str.indexOf(q+"]",b),-1===c&&(c=str.length);"\\"===str.slice(c-1,c)&&b<str.length;)b++,c=str.indexOf(q+"]",b);parts.push(str.slice(i+2,c).replace(new RegExp("\\"+q,"g"),q)),i="."===str.slice(c+2,c+3)?c+3:c+2}return parts},stringify:function(arr,quote){return Array.isArray(arr)||(arr=[arr.toString()]),quote='"'===quote?'"':"'",arr.map(function(n){return"["+quote+n.toString().replace(new RegExp(quote,"g"),"\\"+quote)+quote+"]"}).join("")},normalize:function(data,quote){return ObjectPath.stringify(Array.isArray(data)?data:ObjectPath.parse(data),quote)},registerModule:function(angular){angular.module("ObjectPath",[]).provider("ObjectPath",function(){this.parse=ObjectPath.parse,this.stringify=ObjectPath.stringify,this.normalize=ObjectPath.normalize,this.$get=function(){return ObjectPath}})}};"function"==typeof define&&define.amd?define(function(){return ObjectPath}):"object"==typeof exports?exports.ObjectPath=ObjectPath:window.ObjectPath=ObjectPath}();
!function(window,angular,undefined){"use strict";angular.module("ngAnimate",["ng"]).directive("ngAnimateChildren",function(){var NG_ANIMATE_CHILDREN="$$ngAnimateChildren";return function(scope,element,attrs){var val=attrs.ngAnimateChildren;angular.isString(val)&&0===val.length?element.data(NG_ANIMATE_CHILDREN,!0):scope.$watch(val,function(value){element.data(NG_ANIMATE_CHILDREN,!!value)})}}).factory("$$animateReflow",["$$rAF","$document",function($$rAF,$document){var bod=$document[0].body;return function(fn){return $$rAF(function(){fn(bod.offsetWidth)})}}]).config(["$provide","$animateProvider",function($provide,$animateProvider){function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType==ELEMENT_NODE)return elm}}function prepareElement(element){return element&&angular.element(element)}function stripCommentsFromElement(element){return angular.element(extractElementNode(element))}function isMatchingElement(elm1,elm2){return extractElementNode(elm1)==extractElementNode(elm2)}var noop=angular.noop,forEach=angular.forEach,selectors=$animateProvider.$$selectors,ELEMENT_NODE=1,NG_ANIMATE_STATE="$$ngAnimateState",NG_ANIMATE_CHILDREN="$$ngAnimateChildren",NG_ANIMATE_CLASS_NAME="ng-animate",rootAnimateState={running:!0};$provide.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document",function($delegate,$injector,$sniffer,$rootElement,$$asyncCallback,$rootScope,$document){function blockElementAnimations(element){var data=element.data(NG_ANIMATE_STATE)||{};data.running=!0,element.data(NG_ANIMATE_STATE,data)}function lookup(name){if(name){var matches=[],flagMap={},classes=name.substr(1).split(".");($sniffer.transitions||$sniffer.animations)&&matches.push($injector.get(selectors[""]));for(var i=0;i<classes.length;i++){var klass=classes[i],selectorFactoryName=selectors[klass];selectorFactoryName&&!flagMap[klass]&&(matches.push($injector.get(selectorFactoryName)),flagMap[klass]=!0)}return matches}}function animationRunner(element,animationEvent,className){function registerAnimation(animationFactory,event){var afterFn=animationFactory[event],beforeFn=animationFactory["before"+event.charAt(0).toUpperCase()+event.substr(1)];return afterFn||beforeFn?("leave"==event&&(beforeFn=afterFn,afterFn=null),after.push({event:event,fn:afterFn}),before.push({event:event,fn:beforeFn}),!0):void 0}function run(fns,cancellations,allCompleteFn){function afterAnimationComplete(index){if(cancellations){if((cancellations[index]||noop)(),++count<animations.length)return;cancellations=null}allCompleteFn()}var animations=[];forEach(fns,function(animation){animation.fn&&animations.push(animation)});var count=0;forEach(animations,function(animation,index){var progress=function(){afterAnimationComplete(index)};switch(animation.event){case"setClass":cancellations.push(animation.fn(element,classNameAdd,classNameRemove,progress));break;case"addClass":cancellations.push(animation.fn(element,classNameAdd||className,progress));break;case"removeClass":cancellations.push(animation.fn(element,classNameRemove||className,progress));break;default:cancellations.push(animation.fn(element,progress))}}),cancellations&&0===cancellations.length&&allCompleteFn()}var node=element[0];if(node){var classNameAdd,classNameRemove,isSetClassOperation="setClass"==animationEvent,isClassBased=isSetClassOperation||"addClass"==animationEvent||"removeClass"==animationEvent;angular.isArray(className)&&(classNameAdd=className[0],classNameRemove=className[1],className=classNameAdd+" "+classNameRemove);var currentClassName=element.attr("class"),classes=currentClassName+" "+className;if(isAnimatableClassName(classes)){var beforeComplete=noop,beforeCancel=[],before=[],afterComplete=noop,afterCancel=[],after=[],animationLookup=(" "+classes).replace(/\s+/g,".");return forEach(lookup(animationLookup),function(animationFactory){var created=registerAnimation(animationFactory,animationEvent);!created&&isSetClassOperation&&(registerAnimation(animationFactory,"addClass"),registerAnimation(animationFactory,"removeClass"))}),{node:node,event:animationEvent,className:className,isClassBased:isClassBased,isSetClassOperation:isSetClassOperation,before:function(allCompleteFn){beforeComplete=allCompleteFn,run(before,beforeCancel,function(){beforeComplete=noop,allCompleteFn()})},after:function(allCompleteFn){afterComplete=allCompleteFn,run(after,afterCancel,function(){afterComplete=noop,allCompleteFn()})},cancel:function(){beforeCancel&&(forEach(beforeCancel,function(cancelFn){(cancelFn||noop)(!0)}),beforeComplete(!0)),afterCancel&&(forEach(afterCancel,function(cancelFn){(cancelFn||noop)(!0)}),afterComplete(!0))}}}}}function performAnimation(animationEvent,className,element,parentElement,afterElement,domOperation,doneCallback){function fireDOMCallback(animationPhase){var eventName="$animate:"+animationPhase;elementEvents&&elementEvents[eventName]&&elementEvents[eventName].length>0&&$$asyncCallback(function(){element.triggerHandler(eventName,{event:animationEvent,className:className})})}function fireBeforeCallbackAsync(){fireDOMCallback("before")}function fireAfterCallbackAsync(){fireDOMCallback("after")}function fireDoneCallbackAsync(){fireDOMCallback("close"),doneCallback&&$$asyncCallback(function(){doneCallback()})}function fireDOMOperation(){fireDOMOperation.hasBeenRun||(fireDOMOperation.hasBeenRun=!0,domOperation())}function closeAnimation(){if(!closeAnimation.hasBeenRun){closeAnimation.hasBeenRun=!0;var data=element.data(NG_ANIMATE_STATE);data&&(runner&&runner.isClassBased?cleanup(element,className):($$asyncCallback(function(){var data=element.data(NG_ANIMATE_STATE)||{};localAnimationCount==data.index&&cleanup(element,className,animationEvent)}),element.data(NG_ANIMATE_STATE,data))),fireDoneCallbackAsync()}}var runner=animationRunner(element,animationEvent,className);if(!runner)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void closeAnimation();className=runner.className;var elementEvents=angular.element._data(runner.node);elementEvents=elementEvents&&elementEvents.events,parentElement||(parentElement=afterElement?afterElement.parent():element.parent());var skipAnimations,ngAnimateState=element.data(NG_ANIMATE_STATE)||{},runningAnimations=ngAnimateState.active||{},totalActiveAnimations=ngAnimateState.totalActive||0,lastAnimation=ngAnimateState.last;if(runner.isClassBased&&(skipAnimations=ngAnimateState.running||ngAnimateState.disabled||lastAnimation&&!lastAnimation.isClassBased),skipAnimations||animationsDisabled(element,parentElement))return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void closeAnimation();var skipAnimation=!1;if(totalActiveAnimations>0){var animationsToCancel=[];if(runner.isClassBased){if("setClass"==lastAnimation.event)animationsToCancel.push(lastAnimation),cleanup(element,className);else if(runningAnimations[className]){var current=runningAnimations[className];current.event==animationEvent?skipAnimation=!0:(animationsToCancel.push(current),cleanup(element,className))}}else if("leave"==animationEvent&&runningAnimations["ng-leave"])skipAnimation=!0;else{for(var klass in runningAnimations)animationsToCancel.push(runningAnimations[klass]),cleanup(element,klass);runningAnimations={},totalActiveAnimations=0}animationsToCancel.length>0&&forEach(animationsToCancel,function(operation){operation.cancel()})}if(!runner.isClassBased||runner.isSetClassOperation||skipAnimation||(skipAnimation="addClass"==animationEvent==element.hasClass(className)),skipAnimation)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void fireDoneCallbackAsync();"leave"==animationEvent&&element.one("$destroy",function(e){var element=angular.element(this),state=element.data(NG_ANIMATE_STATE);if(state){var activeLeaveAnimation=state.active["ng-leave"];activeLeaveAnimation&&(activeLeaveAnimation.cancel(),cleanup(element,"ng-leave"))}}),element.addClass(NG_ANIMATE_CLASS_NAME);var localAnimationCount=globalAnimationCounter++;totalActiveAnimations++,runningAnimations[className]=runner,element.data(NG_ANIMATE_STATE,{last:runner,active:runningAnimations,index:localAnimationCount,totalActive:totalActiveAnimations}),fireBeforeCallbackAsync(),runner.before(function(cancelled){var data=element.data(NG_ANIMATE_STATE);cancelled=cancelled||!data||!data.active[className]||runner.isClassBased&&data.active[className].event!=animationEvent,fireDOMOperation(),cancelled===!0?closeAnimation():(fireAfterCallbackAsync(),runner.after(closeAnimation))})}function cancelChildAnimations(element){var node=extractElementNode(element);if(node){var nodes=angular.isFunction(node.getElementsByClassName)?node.getElementsByClassName(NG_ANIMATE_CLASS_NAME):node.querySelectorAll("."+NG_ANIMATE_CLASS_NAME);forEach(nodes,function(element){element=angular.element(element);var data=element.data(NG_ANIMATE_STATE);data&&data.active&&forEach(data.active,function(runner){runner.cancel()})})}}function cleanup(element,className){if(isMatchingElement(element,$rootElement))rootAnimateState.disabled||(rootAnimateState.running=!1,rootAnimateState.structural=!1);else if(className){var data=element.data(NG_ANIMATE_STATE)||{},removeAnimations=className===!0;!removeAnimations&&data.active&&data.active[className]&&(data.totalActive--,delete data.active[className]),(removeAnimations||!data.totalActive)&&(element.removeClass(NG_ANIMATE_CLASS_NAME),element.removeData(NG_ANIMATE_STATE))}}function animationsDisabled(element,parentElement){if(rootAnimateState.disabled)return!0;if(isMatchingElement(element,$rootElement))return rootAnimateState.running;var allowChildAnimations,parentRunningAnimation,hasParent;do{if(0===parentElement.length)break;var isRoot=isMatchingElement(parentElement,$rootElement),state=isRoot?rootAnimateState:parentElement.data(NG_ANIMATE_STATE)||{};if(state.disabled)return!0;if(isRoot&&(hasParent=!0),allowChildAnimations!==!1){var animateChildrenFlag=parentElement.data(NG_ANIMATE_CHILDREN);angular.isDefined(animateChildrenFlag)&&(allowChildAnimations=animateChildrenFlag)}parentRunningAnimation=parentRunningAnimation||state.running||state.last&&!state.last.isClassBased}while(parentElement=parentElement.parent());return!hasParent||!allowChildAnimations&&parentRunningAnimation}var globalAnimationCounter=0;$rootElement.data(NG_ANIMATE_STATE,rootAnimateState),$rootScope.$$postDigest(function(){$rootScope.$$postDigest(function(){rootAnimateState.running=!1})});var classNameFilter=$animateProvider.classNameFilter(),isAnimatableClassName=classNameFilter?function(className){return classNameFilter.test(className)}:function(){return!0};return{enter:function(element,parentElement,afterElement,doneCallback){element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),blockElementAnimations(element),$delegate.enter(element,parentElement,afterElement),$rootScope.$$postDigest(function(){element=stripCommentsFromElement(element),performAnimation("enter","ng-enter",element,parentElement,afterElement,noop,doneCallback)})},leave:function(element,doneCallback){element=angular.element(element),cancelChildAnimations(element),blockElementAnimations(element),$rootScope.$$postDigest(function(){performAnimation("leave","ng-leave",stripCommentsFromElement(element),null,null,function(){$delegate.leave(element)},doneCallback)})},move:function(element,parentElement,afterElement,doneCallback){element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),cancelChildAnimations(element),blockElementAnimations(element),$delegate.move(element,parentElement,afterElement),$rootScope.$$postDigest(function(){element=stripCommentsFromElement(element),performAnimation("move","ng-move",element,parentElement,afterElement,noop,doneCallback)})},addClass:function(element,className,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("addClass",className,element,null,null,function(){$delegate.addClass(element,className)},doneCallback)},removeClass:function(element,className,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("removeClass",className,element,null,null,function(){$delegate.removeClass(element,className)},doneCallback)},setClass:function(element,add,remove,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("setClass",[add,remove],element,null,null,function(){$delegate.setClass(element,add,remove)},doneCallback)},enabled:function(value,element){switch(arguments.length){case 2:if(value)cleanup(element);else{var data=element.data(NG_ANIMATE_STATE)||{};data.disabled=!0,element.data(NG_ANIMATE_STATE,data)}break;case 1:rootAnimateState.disabled=!value;break;default:value=!rootAnimateState.disabled}return!!value}}}]),$animateProvider.register("",["$window","$sniffer","$timeout","$$animateReflow",function($window,$sniffer,$timeout,$$animateReflow){function clearCacheAfterReflow(){cancelAnimationReflow||(cancelAnimationReflow=$$animateReflow(function(){animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}}))}function afterReflow(element,callback){cancelAnimationReflow&&cancelAnimationReflow(),animationReflowQueue.push(callback),cancelAnimationReflow=$$animateReflow(function(){forEach(animationReflowQueue,function(fn){fn()}),animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}})}function animationCloseHandler(element,totalTime){var node=extractElementNode(element);element=angular.element(node),animationElementQueue.push(element);var futureTimestamp=Date.now()+totalTime;closingTimestamp>=futureTimestamp||($timeout.cancel(closingTimer),closingTimestamp=futureTimestamp,closingTimer=$timeout(function(){closeAllAnimations(animationElementQueue),animationElementQueue=[]},totalTime,!1))}function closeAllAnimations(elements){forEach(elements,function(element){var elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);elementData&&(elementData.closeAnimationFn||noop)()})}function getElementAnimationDetails(element,cacheKey){var data=cacheKey?lookupCache[cacheKey]:null;if(!data){var transitionDelayStyle,animationDelayStyle,transitionDurationStyle,transitionPropertyStyle,transitionDuration=0,transitionDelay=0,animationDuration=0,animationDelay=0;forEach(element,function(element){if(element.nodeType==ELEMENT_NODE){var elementStyles=$window.getComputedStyle(element)||{};transitionDurationStyle=elementStyles[TRANSITION_PROP+DURATION_KEY],transitionDuration=Math.max(parseMaxTime(transitionDurationStyle),transitionDuration),transitionPropertyStyle=elementStyles[TRANSITION_PROP+PROPERTY_KEY],transitionDelayStyle=elementStyles[TRANSITION_PROP+DELAY_KEY],transitionDelay=Math.max(parseMaxTime(transitionDelayStyle),transitionDelay),animationDelayStyle=elementStyles[ANIMATION_PROP+DELAY_KEY],animationDelay=Math.max(parseMaxTime(animationDelayStyle),animationDelay);var aDuration=parseMaxTime(elementStyles[ANIMATION_PROP+DURATION_KEY]);aDuration>0&&(aDuration*=parseInt(elementStyles[ANIMATION_PROP+ANIMATION_ITERATION_COUNT_KEY],10)||1),animationDuration=Math.max(aDuration,animationDuration)}}),data={total:0,transitionPropertyStyle:transitionPropertyStyle,transitionDurationStyle:transitionDurationStyle,transitionDelayStyle:transitionDelayStyle,transitionDelay:transitionDelay,transitionDuration:transitionDuration,animationDelayStyle:animationDelayStyle,animationDelay:animationDelay,animationDuration:animationDuration},cacheKey&&(lookupCache[cacheKey]=data)}return data}function parseMaxTime(str){var maxValue=0,values=angular.isString(str)?str.split(/\s*,\s*/):[];return forEach(values,function(value){maxValue=Math.max(parseFloat(value)||0,maxValue)}),maxValue}function getCacheKey(element){var parentElement=element.parent(),parentID=parentElement.data(NG_ANIMATE_PARENT_KEY);return parentID||(parentElement.data(NG_ANIMATE_PARENT_KEY,++parentCounter),parentID=parentCounter),parentID+"-"+extractElementNode(element).getAttribute("class")}function animateSetup(animationEvent,element,className,calculationDecorator){var cacheKey=getCacheKey(element),eventCacheKey=cacheKey+" "+className,itemIndex=lookupCache[eventCacheKey]?++lookupCache[eventCacheKey].total:0,stagger={};if(itemIndex>0){var staggerClassName=className+"-stagger",staggerCacheKey=cacheKey+" "+staggerClassName,applyClasses=!lookupCache[staggerCacheKey];applyClasses&&element.addClass(staggerClassName),stagger=getElementAnimationDetails(element,staggerCacheKey),applyClasses&&element.removeClass(staggerClassName)}calculationDecorator=calculationDecorator||function(fn){return fn()},element.addClass(className);var formerData=element.data(NG_ANIMATE_CSS_DATA_KEY)||{},timings=calculationDecorator(function(){return getElementAnimationDetails(element,eventCacheKey)}),transitionDuration=timings.transitionDuration,animationDuration=timings.animationDuration;if(0===transitionDuration&&0===animationDuration)return element.removeClass(className),!1;element.data(NG_ANIMATE_CSS_DATA_KEY,{running:formerData.running||0,itemIndex:itemIndex,stagger:stagger,timings:timings,closeAnimationFn:noop});var isCurrentlyAnimating=formerData.running>0||"setClass"==animationEvent;return transitionDuration>0&&blockTransitions(element,className,isCurrentlyAnimating),animationDuration>0&&stagger.animationDelay>0&&0===stagger.animationDuration&&blockKeyframeAnimations(element),!0}function isStructuralAnimation(className){return"ng-enter"==className||"ng-move"==className||"ng-leave"==className}function blockTransitions(element,className,isAnimating){isStructuralAnimation(className)||!isAnimating?extractElementNode(element).style[TRANSITION_PROP+PROPERTY_KEY]="none":element.addClass(NG_ANIMATE_BLOCK_CLASS_NAME)}function blockKeyframeAnimations(element){extractElementNode(element).style[ANIMATION_PROP]="none 0s"}function unblockTransitions(element,className){var prop=TRANSITION_PROP+PROPERTY_KEY,node=extractElementNode(element);node.style[prop]&&node.style[prop].length>0&&(node.style[prop]=""),element.removeClass(NG_ANIMATE_BLOCK_CLASS_NAME)}function unblockKeyframeAnimations(element){var prop=ANIMATION_PROP,node=extractElementNode(element);node.style[prop]&&node.style[prop].length>0&&(node.style[prop]="")}function animateRun(animationEvent,element,className,activeAnimationComplete){function onEnd(cancelled){element.off(css3AnimationEvents,onAnimationProgress),element.removeClass(activeClassName),animateClose(element,className);var node=extractElementNode(element);for(var i in appliedStyles)node.style.removeProperty(appliedStyles[i])}function onAnimationProgress(event){event.stopPropagation();var ev=event.originalEvent||event,timeStamp=ev.$manualTimeStamp||ev.timeStamp||Date.now(),elapsedTime=parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));Math.max(timeStamp-startTime,0)>=maxDelayTime&&elapsedTime>=maxDuration&&activeAnimationComplete()}var node=extractElementNode(element),elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);if(-1==node.getAttribute("class").indexOf(className)||!elementData)return void activeAnimationComplete();var activeClassName="";forEach(className.split(" "),function(klass,i){activeClassName+=(i>0?" ":"")+klass+"-active"});var stagger=elementData.stagger,timings=elementData.timings,itemIndex=elementData.itemIndex,maxDuration=Math.max(timings.transitionDuration,timings.animationDuration),maxDelay=Math.max(timings.transitionDelay,timings.animationDelay),maxDelayTime=maxDelay*ONE_SECOND,startTime=Date.now(),css3AnimationEvents=ANIMATIONEND_EVENT+" "+TRANSITIONEND_EVENT,style="",appliedStyles=[];if(timings.transitionDuration>0){var propertyStyle=timings.transitionPropertyStyle;-1==propertyStyle.indexOf("all")&&(style+=CSS_PREFIX+"transition-property: "+propertyStyle+";",style+=CSS_PREFIX+"transition-duration: "+timings.transitionDurationStyle+";",appliedStyles.push(CSS_PREFIX+"transition-property"),appliedStyles.push(CSS_PREFIX+"transition-duration"))}if(itemIndex>0){if(stagger.transitionDelay>0&&0===stagger.transitionDuration){var delayStyle=timings.transitionDelayStyle;style+=CSS_PREFIX+"transition-delay: "+prepareStaggerDelay(delayStyle,stagger.transitionDelay,itemIndex)+"; ",appliedStyles.push(CSS_PREFIX+"transition-delay")}stagger.animationDelay>0&&0===stagger.animationDuration&&(style+=CSS_PREFIX+"animation-delay: "+prepareStaggerDelay(timings.animationDelayStyle,stagger.animationDelay,itemIndex)+"; ",appliedStyles.push(CSS_PREFIX+"animation-delay"))}if(appliedStyles.length>0){var oldStyle=node.getAttribute("style")||"";node.setAttribute("style",oldStyle+"; "+style)}element.on(css3AnimationEvents,onAnimationProgress),element.addClass(activeClassName),elementData.closeAnimationFn=function(){onEnd(),activeAnimationComplete()};var staggerTime=itemIndex*(Math.max(stagger.animationDelay,stagger.transitionDelay)||0),animationTime=(maxDelay+maxDuration)*CLOSING_TIME_BUFFER,totalTime=(staggerTime+animationTime)*ONE_SECOND;return elementData.running++,animationCloseHandler(element,totalTime),onEnd}function prepareStaggerDelay(delayStyle,staggerDelay,index){var style="";return forEach(delayStyle.split(","),function(val,i){style+=(i>0?",":"")+(index*staggerDelay+parseInt(val,10))+"s"}),style}function animateBefore(animationEvent,element,className,calculationDecorator){return animateSetup(animationEvent,element,className,calculationDecorator)?function(cancelled){cancelled&&animateClose(element,className)}:void 0}function animateAfter(animationEvent,element,className,afterAnimationComplete){return element.data(NG_ANIMATE_CSS_DATA_KEY)?animateRun(animationEvent,element,className,afterAnimationComplete):(animateClose(element,className),void afterAnimationComplete())}function animate(animationEvent,element,className,animationComplete){var preReflowCancellation=animateBefore(animationEvent,element,className);if(!preReflowCancellation)return clearCacheAfterReflow(),void animationComplete();var cancel=preReflowCancellation;return afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),cancel=animateAfter(animationEvent,element,className,animationComplete)}),function(cancelled){(cancel||noop)(cancelled)}}function animateClose(element,className){element.removeClass(className);var data=element.data(NG_ANIMATE_CSS_DATA_KEY);data&&(data.running&&data.running--,data.running&&0!==data.running||element.removeData(NG_ANIMATE_CSS_DATA_KEY))}function suffixClasses(classes,suffix){var className="";return classes=angular.isArray(classes)?classes:classes.split(/\s+/),forEach(classes,function(klass,i){klass&&klass.length>0&&(className+=(i>0?" ":"")+klass+suffix)}),className}var TRANSITION_PROP,TRANSITIONEND_EVENT,ANIMATION_PROP,ANIMATIONEND_EVENT,CSS_PREFIX="";window.ontransitionend===undefined&&window.onwebkittransitionend!==undefined?(CSS_PREFIX="-webkit-",TRANSITION_PROP="WebkitTransition",TRANSITIONEND_EVENT="webkitTransitionEnd transitionend"):(TRANSITION_PROP="transition",TRANSITIONEND_EVENT="transitionend"),window.onanimationend===undefined&&window.onwebkitanimationend!==undefined?(CSS_PREFIX="-webkit-",ANIMATION_PROP="WebkitAnimation",ANIMATIONEND_EVENT="webkitAnimationEnd animationend"):(ANIMATION_PROP="animation",ANIMATIONEND_EVENT="animationend");var cancelAnimationReflow,DURATION_KEY="Duration",PROPERTY_KEY="Property",DELAY_KEY="Delay",ANIMATION_ITERATION_COUNT_KEY="IterationCount",NG_ANIMATE_PARENT_KEY="$$ngAnimateKey",NG_ANIMATE_CSS_DATA_KEY="$$ngAnimateCSS3Data",NG_ANIMATE_BLOCK_CLASS_NAME="ng-animate-block-transitions",ELAPSED_TIME_MAX_DECIMAL_PLACES=3,CLOSING_TIME_BUFFER=1.5,ONE_SECOND=1e3,lookupCache={},parentCounter=0,animationReflowQueue=[],closingTimer=null,closingTimestamp=0,animationElementQueue=[];return{enter:function(element,animationCompleted){return animate("enter",element,"ng-enter",animationCompleted)},leave:function(element,animationCompleted){return animate("leave",element,"ng-leave",animationCompleted)},move:function(element,animationCompleted){return animate("move",element,"ng-move",animationCompleted)},beforeSetClass:function(element,add,remove,animationCompleted){var className=suffixClasses(remove,"-remove")+" "+suffixClasses(add,"-add"),cancellationMethod=animateBefore("setClass",element,className,function(fn){var klass=element.attr("class");element.removeClass(remove),element.addClass(add);var timings=fn();return element.attr("class",klass),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},beforeAddClass:function(element,className,animationCompleted){var cancellationMethod=animateBefore("addClass",element,suffixClasses(className,"-add"),function(fn){element.addClass(className);var timings=fn();return element.removeClass(className),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},setClass:function(element,add,remove,animationCompleted){remove=suffixClasses(remove,"-remove"),add=suffixClasses(add,"-add");var className=remove+" "+add;return animateAfter("setClass",element,className,animationCompleted)},addClass:function(element,className,animationCompleted){return animateAfter("addClass",element,suffixClasses(className,"-add"),animationCompleted)},beforeRemoveClass:function(element,className,animationCompleted){var cancellationMethod=animateBefore("removeClass",element,suffixClasses(className,"-remove"),function(fn){var klass=element.attr("class");element.removeClass(className);var timings=fn();return element.attr("class",klass),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):void animationCompleted()},removeClass:function(element,className,animationCompleted){return animateAfter("removeClass",element,suffixClasses(className,"-remove"),animationCompleted)}}}])}])}(window,window.angular);
!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function bubbleUp(heap,weightFunc,n){for(var element=heap[n],weight=weightFunc(element);n>0;){var parentN=Math.floor((n+1)/2)-1,parent=heap[parentN];if(weight>=weightFunc(parent))break;heap[parentN]=element,heap[n]=parent,n=parentN}}function bubbleDown(heap,weightFunc,n){for(var length=heap.length,node=heap[n],nodeWeight=weightFunc(node);;){var child2N=2*(n+1),child1N=child2N-1,swap=null;if(length>child1N){var child1=heap[child1N],child1Weight=weightFunc(child1);nodeWeight>child1Weight&&(swap=child1N)}if(length>child2N){var child2=heap[child2N],child2Weight=weightFunc(child2);child2Weight<(null===swap?nodeWeight:weightFunc(heap[child1N]))&&(swap=child2N)}if(null===swap)break;heap[n]=heap[swap],heap[swap]=node,n=swap}}function DSBinaryHeap(weightFunc){if(weightFunc&&!angular.isFunction(weightFunc))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");weightFunc=weightFunc||function(x){return x},this.weightFunc=weightFunc,this.heap=[]}function DSBinaryHeapProvider(){this.$get=function(){return DSBinaryHeap}}DSBinaryHeap.prototype.push=function(node){this.heap.push(node),bubbleUp(this.heap,this.weightFunc,this.heap.length-1)},DSBinaryHeap.prototype.peek=function(){return this.heap[0]},DSBinaryHeap.prototype.pop=function(){var front=this.heap[0],end=this.heap.pop();return this.heap.length>0&&(this.heap[0]=end,bubbleDown(this.heap,this.weightFunc,0)),front},DSBinaryHeap.prototype.remove=function(node){for(var length=this.heap.length,i=0;length>i;i++)if(angular.equals(this.heap[i],node)){var removed=this.heap[i],end=this.heap.pop();return i!==length-1&&(this.heap[i]=end,bubbleUp(this.heap,this.weightFunc,i),bubbleDown(this.heap,this.weightFunc,i)),removed}return null},DSBinaryHeap.prototype.removeAll=function(){this.heap=[]},DSBinaryHeap.prototype.size=function(){return this.heap.length},module.exports={DSBinaryHeapProvider:DSBinaryHeapProvider,DSBinaryHeap:DSBinaryHeap}},{}],2:[function(require,module,exports){module.exports=function(){var _this=this;clearInterval(_this.$$cacheFlushIntervalId),clearInterval(_this.$$recycleFreqId),_this.removeAll(),_this.$$storage&&(_this.$$storage().removeItem(_this.$$prefix+".keys"),_this.$$storage().removeItem(_this.$$prefix)),_this.$$storage=null,_this.$$data=null,_this.$$lruHeap=null,_this.$$expiresHeap=null,_this.$$prefix=null}},{}],3:[function(require,module,exports){var utils=require("../utils");module.exports=function(key,options){var _this=this;if(angular.isArray(key)){var keys=key,values=[];return angular.forEach(keys,function(key){var value=_this.get(key,options);null!==value&&void 0!==value&&values.push(value)}),values}if(key=utils.stringifyNumber(key),!_this.$$disabled){if(options=options||{},!angular.isString(key))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof key);if(options&&!angular.isObject(options))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof options);if(options.onExpire&&!angular.isFunction(options.onExpire))throw angular.$$minErr("ng")("areq","Expected options.onExpire to be a function! Found: {0}.",typeof options.onExpire);var item;if(_this.$$storage){if(_this.$$promises[key])return _this.$$promises[key];var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(!itemJson)return;item=angular.fromJson(itemJson)}else{if(!(key in _this.$$data))return;item=_this.$$data[key]}var value=item.value,now=(new Date).getTime();return _this.$$storage?(_this.$$lruHeap.remove({key:key,accessed:item.accessed}),item.accessed=now,_this.$$lruHeap.push({key:key,accessed:now})):(_this.$$lruHeap.remove(item),item.accessed=now,_this.$$lruHeap.push(item)),"passive"===_this.$$deleteOnExpire&&"expires"in item&&item.expires<now?(_this.remove(key),_this.$$onExpire?_this.$$onExpire(key,item.value,options.onExpire):options.onExpire&&options.onExpire(key,item.value),value=void 0):_this.$$storage&&_this.$$storage().setItem(_this.$$prefix+".data."+key,JSON.stringify(item)),value}}},{"../utils":21}],4:[function(require,module,exports){function _setStorageMode(storageMode,storageImpl){var _this=this;if(!angular.isString(storageMode))throw angular.$$minErr("ng")("areq","Expected storageMode to be a string! Found: {0}.",typeof storageMode);if("memory"!==storageMode&&"localStorage"!==storageMode&&"sessionStorage"!==storageMode)throw angular.$$minErr("ng")("areq",'Expected storageMode to be "memory", "localStorage" or "sessionStorage"! Found: {0}.',storageMode);if(_this.$$storageMode=storageMode,storageImpl){if(!angular.isObject(storageImpl))throw angular.$$minErr("ng")("areq","Expected storageImpl to be an object! Found: {0}.",typeof storageImpl);if(!("setItem"in storageImpl&&"function"==typeof storageImpl.setItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "setItem(key, value)"! Found: {0}.',typeof storageImpl.setItem);if(!("getItem"in storageImpl&&"function"==typeof storageImpl.getItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "getItem(key)"! Found: {0}.',typeof storageImpl.getItem);if(!("removeItem"in storageImpl)||"function"!=typeof storageImpl.removeItem)throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "removeItem(key)"! Found: {0}.',typeof storageImpl.removeItem);_this.$$storage=function(){return storageImpl}}else if("localStorage"===_this.$$storageMode)try{localStorage.setItem("angular-cache","angular-cache"),localStorage.removeItem("angular-cache"),_this.$$storage=function(){return localStorage}}catch(e){delete _this.$$storage,_this.$$storageMode="memory"}else if("sessionStorage"===_this.$$storageMode)try{sessionStorage.setItem("angular-cache","angular-cache"),sessionStorage.removeItem("angular-cache"),_this.$$storage=function(){return sessionStorage}}catch(e){delete _this.$$storage,_this.$$storageMode="memory"}}function _setOptions(cacheOptions,strict){var _this=this;if(cacheOptions=cacheOptions||{},strict=!!strict,!angular.isObject(cacheOptions))throw angular.$$minErr("ng")("areq","Expected cacheOptions to be an object! Found: {0}.",typeof cacheOptions);"disabled"in cacheOptions?_this.$$disabled=!!cacheOptions.disabled:strict&&delete _this.$$disabled,"storeOnResolve"in cacheOptions?_this.$$storeOnResolve=!!cacheOptions.storeOnResolve:strict&&(_this.$$storeOnResolve=!1),"storeOnReject"in cacheOptions?_this.$$storeOnReject=!!cacheOptions.storeOnReject:strict&&(_this.$$storeOnReject=!1),"capacity"in cacheOptions?_this.setCapacity(cacheOptions.capacity):strict&&_this.setCapacity(null),"deleteOnExpire"in cacheOptions?_this.setDeleteOnExpire(cacheOptions.deleteOnExpire):strict&&_this.setDeleteOnExpire(null),"maxAge"in cacheOptions?_this.setMaxAge(cacheOptions.maxAge):strict&&_this.setMaxAge(null),"recycleFreq"in cacheOptions?_this.setRecycleFreq(cacheOptions.recycleFreq):strict&&_this.setRecycleFreq(null),"cacheFlushInterval"in cacheOptions?_this.setCacheFlushInterval(cacheOptions.cacheFlushInterval):strict&&_this.setCacheFlushInterval(null),"onExpire"in cacheOptions?_this.setOnExpire(cacheOptions.onExpire):strict&&_this.setOnExpire(null)}function DSCache(cacheId,options){var _this=this;_this.$$data={},_this.$$promises={},_this.$$id=cacheId,_this.$$storage=null,_this.$$expiresHeap=new DSBinaryHeap(function(x){return x.expires}),_this.$$lruHeap=new DSBinaryHeap(function(x){return x.accessed}),options=options||{},"storageMode"in options&&_setStorageMode.apply(_this,[options.storageMode,options.storageImpl]),"storagePrefix"in options&&(_this.$$storagePrefix=options.storagePrefix),_this.$$prefix=_this.$$storagePrefix+cacheId,_setOptions.apply(_this,[options,!0])}var defaults=require("../defaults"),DSBinaryHeap=require("../DSBinaryHeap").DSBinaryHeap;for(var key in defaults.defaults)DSCache.prototype["$$"+key]=defaults.defaults[key];DSCache.prototype.setOptions=_setOptions,DSCache.prototype.setCapacity=require("./setCapacity"),DSCache.prototype.setDeleteOnExpire=require("./setDeleteOnExpire"),DSCache.prototype.setMaxAge=require("./setMaxAge"),DSCache.prototype.setRecycleFreq=require("./setRecycleFreq"),DSCache.prototype.setCacheFlushInterval=require("./setCacheFlushInterval"),DSCache.prototype.setOnExpire=require("./setOnExpire"),DSCache.prototype.put=require("./put"),DSCache.prototype.get=require("./get"),DSCache.prototype.remove=require("./remove"),DSCache.prototype.removeAll=require("./removeAll"),DSCache.prototype.removeExpired=require("./removeExpired"),DSCache.prototype.destroy=require("./destroy"),DSCache.prototype.info=require("./info"),DSCache.prototype.keySet=require("./keySet"),DSCache.prototype.keys=require("./keys"),DSCache.prototype.disable=function(){this.$$disabled=!0},DSCache.prototype.enable=function(){delete this.$$disabled},DSCache.prototype.touch=function(key){var _this=this;if(key){var val=_this.get(key,{onExpire:function(k,v){_this.put(k,v)}});val&&_this.put(key,val)}else for(var keys=_this.keys(),i=0;i<keys.length;i++)_this.touch(keys[i])},module.exports=DSCache},{"../DSBinaryHeap":1,"../defaults":19,"./destroy":2,"./get":3,"./info":5,"./keySet":6,"./keys":7,"./put":8,"./remove":9,"./removeAll":10,"./removeExpired":11,"./setCacheFlushInterval":12,"./setCapacity":13,"./setDeleteOnExpire":14,"./setMaxAge":15,"./setOnExpire":16,"./setRecycleFreq":17}],5:[function(require,module,exports){module.exports=function(key){var _this=this;if(key){var item;if(_this.$$storage){var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);return itemJson?(item=angular.fromJson(itemJson),{created:item.created,accessed:item.accessed,expires:item.expires,isExpired:(new Date).getTime()-item.created>_this.$$maxAge}):void 0}return key in _this.$$data?(item=_this.$$data[key],{created:item.created,accessed:item.accessed,expires:item.expires,isExpired:(new Date).getTime()-item.created>_this.$$maxAge}):void 0}return{id:_this.$$id,capacity:_this.$$capacity,maxAge:_this.$$maxAge,deleteOnExpire:_this.$$deleteOnExpire,onExpire:_this.$$onExpire,cacheFlushInterval:_this.$$cacheFlushInterval,recycleFreq:_this.$$recycleFreq,storageMode:_this.$$storageMode,storageImpl:_this.$$storage?_this.$$storage():void 0,disabled:_this.$$disabled,size:_this.$$lruHeap&&_this.$$lruHeap.size()||0}}},{}],6:[function(require,module,exports){var utils=require("../utils");module.exports=function(){var _this=this;if(_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),kSet={};if(keysJson)for(var keys=angular.fromJson(keysJson),i=0;i<keys.length;i++)kSet[keys[i]]=keys[i];return kSet}return utils.keySet(_this.$$data)}},{"../utils":21}],7:[function(require,module,exports){var utils=require("../utils");module.exports=function(){var _this=this;if(_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");return keysJson?angular.fromJson(keysJson):[]}return utils.keys(_this.$$data)}},{"../utils":21}],8:[function(require,module,exports){function isPromiseLike(v){return v&&"function"==typeof v.then}var utils=require("../utils");module.exports=function(key,value,options){function getHandler(store,isError){return function(v){return store&&(delete _this.$$promises[key],angular.isObject(v)&&"status"in v&&"data"in v?(v=[v.status,v.data,v.headers(),v.statusText],_this.put(key,v)):_this.put(key,v)),isError?_this.$q.reject(v):v}}options=options||{};var _this=this,storeOnResolve="storeOnResolve"in options?!!options.storeOnResolve:_this.$$storeOnResolve,storeOnReject="storeOnReject"in options?!!options.storeOnReject:_this.$$storeOnReject;if(!_this.$$disabled&&null!==value&&void 0!==value){if(key=utils.stringifyNumber(key),!angular.isString(key))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof key);var now=(new Date).getTime(),item={key:key,value:isPromiseLike(value)?value.then(getHandler(storeOnResolve,!1),getHandler(storeOnReject,!0)):value,created:now,accessed:now};if(item.expires=item.created+_this.$$maxAge,_this.$$storage){if(isPromiseLike(item.value))return _this.$$promises[key]=item.value,_this.$$promises[key];var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),keys=keysJson?angular.fromJson(keysJson):[],itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);itemJson&&_this.remove(key),_this.$$expiresHeap.push({key:key,expires:item.expires}),_this.$$lruHeap.push({key:key,accessed:item.accessed}),_this.$$storage().setItem(_this.$$prefix+".data."+key,JSON.stringify(item));for(var exists=!1,i=0;i<keys.length;i++)if(keys[i]===key){exists=!0;break}exists||keys.push(key),_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify(keys))}else _this.$$data[key]&&_this.remove(key),_this.$$expiresHeap.push(item),_this.$$lruHeap.push(item),_this.$$data[key]=item,delete _this.$$promises[key];return _this.$$lruHeap.size()>_this.$$capacity&&_this.remove(_this.$$lruHeap.peek().key),value}}},{"../utils":21}],9:[function(require,module,exports){module.exports=function(key){var _this=this;if(key+="",delete _this.$$promises[key],!_this.$$storage){var value=_this.$$data[key]?_this.$$data[key].value:void 0;return _this.$$lruHeap.remove(_this.$$data[key]),_this.$$expiresHeap.remove(_this.$$data[key]),_this.$$data[key]=null,delete _this.$$data[key],value}var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(itemJson){var item=angular.fromJson(itemJson);_this.$$lruHeap.remove({key:key,accessed:item.accessed}),_this.$$expiresHeap.remove({key:key,expires:item.expires}),_this.$$storage().removeItem(_this.$$prefix+".data."+key);var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),keys=keysJson?angular.fromJson(keysJson):[],index=keys.indexOf(key);return index>=0&&keys.splice(index,1),_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify(keys)),item.value}}},{}],10:[function(require,module,exports){module.exports=function(){var _this=this;if(_this.$$storage){_this.$$lruHeap.removeAll(),_this.$$expiresHeap.removeAll();var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");if(keysJson)for(var keys=angular.fromJson(keysJson),i=0;i<keys.length;i++)_this.remove(keys[i]);_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify([]))}else{_this.$$lruHeap.removeAll(),_this.$$expiresHeap.removeAll();for(var key in _this.$$data)_this.$$data[key]=null;_this.$$data={}}}},{}],11:[function(require,module,exports){module.exports=function(){for(var key,expiredItem,_this=this,now=(new Date).getTime(),expired={};(expiredItem=_this.$$expiresHeap.peek())&&expiredItem.expires<=now;)expired[expiredItem.key]=expiredItem.value?expiredItem.value:null,_this.$$expiresHeap.pop();if(_this.$$storage)for(key in expired){var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);itemJson&&(expired[key]=angular.fromJson(itemJson).value,_this.remove(key))}else for(key in expired)_this.remove(key);if(_this.$$onExpire)for(key in expired)_this.$$onExpire(key,expired[key]);return expired}},{}],12:[function(require,module,exports){module.exports=function(cacheFlushInterval){var _this=this;if(null===cacheFlushInterval)delete _this.$$cacheFlushInterval;else{if(!angular.isNumber(cacheFlushInterval))throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be a number! Found: {0}.",typeof cacheFlushInterval);if(0>cacheFlushInterval)throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be greater than zero! Found: {0}.",cacheFlushInterval);cacheFlushInterval!==_this.$$cacheFlushInterval&&(_this.$$cacheFlushInterval=cacheFlushInterval,clearInterval(_this.$$cacheFlushIntervalId),function(self){self.$$cacheFlushIntervalId=setInterval(function(){self.removeAll()},self.$$cacheFlushInterval)}(_this))}}},{}],13:[function(require,module,exports){module.exports=function(capacity){var _this=this;if(null===capacity)delete _this.$$capacity;else{if(!angular.isNumber(capacity))throw angular.$$minErr("ng")("areq","Expected capacity to be a number! Found: {0}.",typeof capacity);if(0>capacity)throw angular.$$minErr("ng")("areq","Expected capacity to be greater than zero! Found: {0}.",capacity);_this.$$capacity=capacity}for(var removed={};_this.$$lruHeap.size()>_this.$$capacity;)removed[_this.$$lruHeap.peek().key]=_this.remove(_this.$$lruHeap.peek().key);return removed}},{}],14:[function(require,module,exports){module.exports=function(deleteOnExpire){var _this=this;if(null===deleteOnExpire)delete _this.$$deleteOnExpire;else{if(!angular.isString(deleteOnExpire))throw angular.$$minErr("ng")("areq","Expected deleteOnExpire to be a string! Found: {0}.",typeof deleteOnExpire);if("none"!==deleteOnExpire&&"passive"!==deleteOnExpire&&"aggressive"!==deleteOnExpire)throw angular.$$minErr("ng")("areq",'Expected deleteOnExpire to be "none", "passive" or "aggressive"! Found: {0}.',deleteOnExpire);_this.$$deleteOnExpire=deleteOnExpire}_this.setRecycleFreq(_this.$$recycleFreq)}},{}],15:[function(require,module,exports){var utils=require("../utils");module.exports=function(maxAge){var _this=this;if(null===maxAge)delete _this.$$maxAge;else{if(!angular.isNumber(maxAge))throw angular.$$minErr("ng")("areq","Expected maxAge to be a number! Found: {0}.",typeof maxAge);if(0>maxAge)throw angular.$$minErr("ng")("areq","Expected maxAge to be greater than zero! Found: {0}.",maxAge);_this.$$maxAge=maxAge}var i,keys,key;if(_this.$$expiresHeap.removeAll(),_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");for(keys=keysJson?angular.fromJson(keysJson):[],i=0;i<keys.length;i++){key=keys[i];var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(itemJson){var item=angular.fromJson(itemJson);_this.$$maxAge===Number.MAX_VALUE?item.expires=Number.MAX_VALUE:item.expires=item.created+_this.$$maxAge,_this.$$expiresHeap.push({key:key,expires:item.expires})}}}else for(keys=utils.keys(_this.$$data),i=0;i<keys.length;i++)key=keys[i],_this.$$maxAge===Number.MAX_VALUE?_this.$$data[key].expires=Number.MAX_VALUE:_this.$$data[key].expires=_this.$$data[key].created+_this.$$maxAge,_this.$$expiresHeap.push(_this.$$data[key]);return"aggressive"===_this.$$deleteOnExpire?_this.removeExpired():{}}},{"../utils":21}],16:[function(require,module,exports){module.exports=function(onExpire){if(null===onExpire)delete this.$$onExpire;else{if(!angular.isFunction(onExpire))throw angular.$$minErr("ng")("areq","Expected onExpire to be a function! Found: {0}.",typeof onExpire);this.$$onExpire=onExpire}}},{}],17:[function(require,module,exports){module.exports=function(recycleFreq){var _this=this;if(null===recycleFreq)delete _this.$$recycleFreq;else{if(!angular.isNumber(recycleFreq))throw angular.$$minErr("ng")("areq","Expected recycleFreq to be a number! Found: {0}.",typeof recycleFreq);if(0>recycleFreq)throw angular.$$minErr("ng")("areq","Expected recycleFreq to be greater than zero! Found: {0}.",recycleFreq);_this.$$recycleFreq=recycleFreq}clearInterval(_this.$$recycleFreqId),"aggressive"===_this.$$deleteOnExpire?!function(self){self.$$recycleFreqId=setInterval(function(){self.removeExpired()},self.$$recycleFreq)}(_this):delete _this.$$recycleFreqId}},{}],18:[function(require,module,exports){function DSCacheFactoryProvider(){var _this=this,config=new defaults.Config;_this.version=version,_this.setCacheDefaults=function(options){if(options=options||{},!angular.isObject(options))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof options);for(var key in defaults.defaults)key in options&&(config[key]=options[key]);"disabled"in options&&(config.$$disabled=!!options.disabled)},_this.$get=["$q",function($q){function _keys(collection){var key,keys=[];for(key in collection)collection.hasOwnProperty(key)&&keys.push(key);return keys}function createCache(cacheId,options){if(cacheId in caches)throw angular.$$minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);if(!angular.isString(cacheId))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof cacheId);return caches[cacheId]=new DSCache(cacheId,angular.extend({},config,options)),caches[cacheId].destroy=function(){this.constructor.prototype.destroy.call(this),delete caches[this.$$id]},caches[cacheId].$q=$q,caches[cacheId]}function DSCacheFactory(cacheId,options){return createCache(cacheId,options)}var caches={};return DSCacheFactory.createCache=createCache,DSCacheFactory.version=version,DSCacheFactory.info=function(){for(var keys=_keys(caches),info={size:keys.length,caches:{}},i=0;i<keys.length;i++){var key=keys[i];info.caches[key]=caches[key].info()}var c=info.cacheDefaults=angular.extend({},config);for(var option in defaults.defaults)option in c||(c[option]=config["$$"+option]);return info},DSCacheFactory.get=function(cacheId){if(!angular.isString(cacheId))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof cacheId);return caches[cacheId]},DSCacheFactory.keySet=function(){var cacheId,cacheIds={};for(cacheId in caches)caches.hasOwnProperty(cacheId)&&(cacheIds[cacheId]=cacheId);return cacheIds},DSCacheFactory.keys=function(){return _keys(caches)},DSCacheFactory.destroyAll=function(){for(var cacheId in caches)caches[cacheId].destroy();caches={}},DSCacheFactory.clearAll=function(){for(var cacheId in caches)caches[cacheId].removeAll()},DSCacheFactory.enableAll=function(){for(var cacheId in caches)caches[cacheId].$$disabled=!1},DSCacheFactory.disableAll=function(){for(var cacheId in caches)caches[cacheId].$$disabled=!0},DSCacheFactory}]}var defaults=require("../defaults"),DSCache=require("../DSCache"),version="3.2.5";module.exports=DSCacheFactoryProvider},{"../DSCache":4,"../defaults":19}],19:[function(require,module,exports){function Config(){}var defaults={capacity:Number.MAX_VALUE,maxAge:Number.MAX_VALUE,deleteOnExpire:"none",onExpire:null,cacheFlushInterval:null,recycleFreq:1e3,storageMode:"memory",storageImpl:null,disabled:!1,storagePrefix:"angular-cache.caches.",storeOnResolve:!1,storeOnReject:!1};for(var option in defaults)Config.prototype["$$"+option]=defaults[option];module.exports={Config:Config,defaults:defaults}},{}],20:[function(require,module,exports){!function(window,angular,undefined){"use strict";angular.$$minErr=angular.$$minErr||function(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?angular.toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/"+angular.version.full+"/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}},angular.module("angular-data.DSBinaryHeap",[]).provider("DSBinaryHeap",require("./DSBinaryHeap").DSBinaryHeapProvider),angular.module("angular-data.DSCacheFactory",["ng","angular-data.DSBinaryHeap"]).provider("DSCacheFactory",require("./DSCacheFactory"))}(window,window.angular)},{"./DSBinaryHeap":1,"./DSCacheFactory":18}],21:[function(require,module,exports){module.exports={stringifyNumber:function(number){return angular.isNumber(number)?number.toString():number},keySet:function(collection){var key,keySet={};for(key in collection)collection.hasOwnProperty(key)&&(keySet[key]=key);return keySet},keys:function(collection){var key,keys=[];for(key in collection)collection.hasOwnProperty(key)&&keys.push(key);return keys}}},{}]},{},[20]);
!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports&&"object"==typeof module?module.exports=factory:factory(jQuery)}(function($,undefined){"use strict";function paletteTemplate(p,color,className,opts){for(var html=[],i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current),c=tiny.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(color,current)?" sp-thumb-active":"";var formattedString=tiny.toString(opts.preferredFormat||"rgb"),swatchStyle=rgbaSupport?"background-color:"+tiny.toRgbString():"filter:"+tiny.toFilter();html.push('<span title="'+formattedString+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>')}else{var cls="sp-clear-display";html.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="'+cls+'"></span>').attr("title",opts.noColorSelectedText)).html())}}return"<div class='sp-cf "+className+"'>"+html.join("")+"</div>"}function hideAll(){for(var i=0;i<spectrums.length;i++)spectrums[i]&&spectrums[i].hide()}function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);return opts.callbacks={move:bind(opts.move,callbackContext),change:bind(opts.change,callbackContext),show:bind(opts.show,callbackContext),hide:bind(opts.hide,callbackContext),beforeShow:bind(opts.beforeShow,callbackContext)},opts}function spectrum(element,o){function applyOptions(){if(opts.showPaletteOnly&&(opts.showPalette=!0),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),opts.palette){palette=opts.palette.slice(0),paletteArray=$.isArray(palette[0])?palette:[palette],paletteLookup={};for(var i=0;i<paletteArray.length;i++)for(var j=0;j<paletteArray[i].length;j++){var rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=!0}}container.toggleClass("sp-flat",flat),container.toggleClass("sp-input-disabled",!opts.showInput),container.toggleClass("sp-alpha-enabled",opts.showAlpha),container.toggleClass("sp-clear-enabled",allowEmpty),container.toggleClass("sp-buttons-disabled",!opts.showButtons),container.toggleClass("sp-palette-buttons-disabled",!opts.togglePaletteOnly),container.toggleClass("sp-palette-disabled",!opts.showPalette),container.toggleClass("sp-palette-only",opts.showPaletteOnly),container.toggleClass("sp-initial-disabled",!opts.showInitial),container.addClass(opts.className).addClass(opts.containerClassName),reflow()}function initialize(){function paletteElementClick(e){return e.data&&e.data.ignore?(set($(e.target).closest(".sp-thumb-el").data("color")),move()):(set($(e.target).closest(".sp-thumb-el").data("color")),move(),updateOriginalInput(!0),opts.hideAfterPaletteSelect&&hide()),!1}if(IE&&container.find("*:not(input)").attr("unselectable","on"),applyOptions(),shouldReplace&&boundElement.after(replacer).hide(),allowEmpty||clearButton.hide(),flat)boundElement.after(container).hide();else{var appendTo="parent"===opts.appendTo?boundElement.parent():$(opts.appendTo);1!==appendTo.length&&(appendTo=$("body")),appendTo.append(container)}updateSelectionPaletteFromStorage(),offsetElement.bind("click.spectrum touchstart.spectrum",function(e){disabled||toggle(),e.stopPropagation(),$(e.target).is("input")||e.preventDefault()}),(boundElement.is(":disabled")||opts.disabled===!0)&&disable(),container.click(stopPropagation),textInput.change(setFromTextInput),textInput.bind("paste",function(){setTimeout(setFromTextInput,1)}),textInput.keydown(function(e){13==e.keyCode&&setFromTextInput()}),cancelButton.text(opts.cancelText),cancelButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),revert(),hide()}),clearButton.attr("title",opts.clearText),clearButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isEmpty=!0,move(),flat&&updateOriginalInput(!0)}),chooseButton.text(opts.chooseText),chooseButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isValid()&&(updateOriginalInput(!0),hide())}),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),toggleButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),opts.showPaletteOnly=!opts.showPaletteOnly,opts.showPaletteOnly||flat||container.css("left","-="+(pickerContainer.outerWidth(!0)+5)),applyOptions()}),draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=dragX/alphaWidth,isEmpty=!1,e.shiftKey&&(currentAlpha=Math.round(10*currentAlpha)/10),move()},dragStart,dragStop),draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),draggable(dragger,function(dragX,dragY,e){if(e.shiftKey){if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth,oldDragY=dragHeight-currentValue*dragHeight,furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y"}}else shiftMovementDirection=null;var setSaturation=!shiftMovementDirection||"x"===shiftMovementDirection,setValue=!shiftMovementDirection||"y"===shiftMovementDirection;setSaturation&&(currentSaturation=parseFloat(dragX/dragWidth)),setValue&&(currentValue=parseFloat((dragHeight-dragY)/dragHeight)),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),initialColor?(set(initialColor),updateUI(),currentPreferredFormat=preferredFormat||tinycolor(initialColor).format,addColorToSelectionPalette(initialColor)):updateUI(),flat&&show();var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,paletteElementClick),initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:!0},paletteElementClick)}function updateSelectionPaletteFromStorage(){if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");oldPalette.length>1&&(delete window.localStorage[localStorageKey],$.each(oldPalette,function(i,c){addColorToSelectionPalette(c)}))}catch(e){}try{selectionPalette=window.localStorage[localStorageKey].split(";")}catch(e){}}}function addColorToSelectionPalette(color){if(showSelectionPalette){var rgb=tinycolor(color).toRgbString();if(!paletteLookup[rgb]&&-1===$.inArray(rgb,selectionPalette))for(selectionPalette.push(rgb);selectionPalette.length>maxSelectionSize;)selectionPalette.shift();if(localStorageKey&&window.localStorage)try{window.localStorage[localStorageKey]=selectionPalette.join(";")}catch(e){}}}function getUniqueSelectionPalette(){var unique=[];if(opts.showPalette)for(var i=0;i<selectionPalette.length;i++){var rgb=tinycolor(selectionPalette[i]).toRgbString();paletteLookup[rgb]||unique.push(selectionPalette[i])}return unique.reverse().slice(0,opts.maxSelectionSize)}function drawPalette(){var currentColor=get(),html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i,opts)});updateSelectionPaletteFromStorage(),selectionPalette&&html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection",opts)),paletteContainer.html(html.join(""))}function drawInitial(){if(opts.showInitial){var initial=colorOnShow,current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial",opts))}}function dragStart(){(0>=dragHeight||0>=dragWidth||0>=slideHeight)&&reflow(),container.addClass(draggingClass),shiftMovementDirection=null,boundElement.trigger("dragstart.spectrum",[get()])}function dragStop(){container.removeClass(draggingClass),boundElement.trigger("dragstop.spectrum",[get()])}function setFromTextInput(){var value=textInput.val();if(null!==value&&""!==value||!allowEmpty){var tiny=tinycolor(value);tiny.isValid()?(set(tiny),updateOriginalInput(!0)):textInput.addClass("sp-validation-error")}else set(null),updateOriginalInput(!0)}function toggle(){visible?hide():show()}function show(){var event=$.Event("beforeShow.spectrum");return visible?void reflow():(boundElement.trigger(event,[get()]),void(callbacks.beforeShow(get())===!1||event.isDefaultPrevented()||(hideAll(),visible=!0,$(doc).bind("click.spectrum",clickout),$(window).bind("resize.spectrum",resize),replacer.addClass("sp-active"),container.removeClass("sp-hidden"),reflow(),updateUI(),colorOnShow=get(),drawInitial(),callbacks.show(colorOnShow),boundElement.trigger("show.spectrum",[colorOnShow]))))}function clickout(e){2!=e.button&&(clickoutFiresChange?updateOriginalInput(!0):revert(),hide())}function hide(){visible&&!flat&&(visible=!1,$(doc).unbind("click.spectrum",clickout),$(window).unbind("resize.spectrum",resize),replacer.removeClass("sp-active"),container.addClass("sp-hidden"),callbacks.hide(get()),boundElement.trigger("hide.spectrum",[get()]))}function revert(){set(colorOnShow,!0)}function set(color,ignoreFormatChange){if(tinycolor.equals(color,get()))return void updateUI();var newColor,newHsv;!color&&allowEmpty?isEmpty=!0:(isEmpty=!1,newColor=tinycolor(color),newHsv=newColor.toHsv(),currentHue=newHsv.h%360/360,currentSaturation=newHsv.s,currentValue=newHsv.v,currentAlpha=newHsv.a),updateUI(),newColor&&newColor.isValid()&&!ignoreFormatChange&&(currentPreferredFormat=preferredFormat||newColor.getFormat())}function get(opts){return opts=opts||{},allowEmpty&&isEmpty?null:tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(100*currentAlpha)/100},{format:opts.format||currentPreferredFormat})}function isValid(){return!textInput.hasClass("sp-validation-error")}function move(){updateUI(),callbacks.move(get()),boundElement.trigger("move.spectrum",[get()])}function updateUI(){textInput.removeClass("sp-validation-error"),updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;1>currentAlpha&&(0!==currentAlpha||"name"!==format)&&("hex"===format||"hex3"===format||"hex6"===format||"name"===format)&&(format="rgb");var realColor=get({format:format}),displayColor="";if(previewElement.removeClass("sp-clear-display"),previewElement.css("background-color","transparent"),!realColor&&allowEmpty)previewElement.addClass("sp-clear-display");else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||1===realColor.alpha?previewElement.css("background-color",realRgb):(previewElement.css("background-color","transparent"),previewElement.css("filter",realColor.toFilter())),opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString(),gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";IE?alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex)):(alphaSliderInner.css("background","-webkit-"+gradient),alphaSliderInner.css("background","-moz-"+gradient),alphaSliderInner.css("background","-ms-"+gradient),alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")"))}displayColor=realColor.toString(format)}opts.showInput&&textInput.val(displayColor),opts.showPalette&&drawPalette(),drawInitial()}function updateHelperLocations(){var s=currentSaturation,v=currentValue;if(allowEmpty&&isEmpty)alphaSlideHelper.hide(),slideHelper.hide(),dragHelper.hide();else{alphaSlideHelper.show(),slideHelper.show(),dragHelper.show();var dragX=s*dragWidth,dragY=dragHeight-v*dragHeight;dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight)),dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight)),dragHelper.css({top:dragY+"px",left:dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({left:alphaX-alphaSlideHelperWidth/2+"px"});var slideY=currentHue*slideHeight;slideHelper.css({top:slideY-slideHelperHeight+"px"})}}function updateOriginalInput(fireCallback){var color=get(),displayColor="",hasChanged=!tinycolor.equals(color,colorOnShow);color&&(displayColor=color.toString(currentPreferredFormat),addColorToSelectionPalette(color)),isInput&&boundElement.val(displayColor),fireCallback&&hasChanged&&(callbacks.change(color),boundElement.trigger("change",[color]))}function reflow(){dragWidth=dragger.width(),dragHeight=dragger.height(),dragHelperHeight=dragHelper.height(),slideWidth=slider.width(),slideHeight=slider.height(),slideHelperHeight=slideHelper.height(),alphaWidth=alphaSlider.width(),alphaSlideHelperWidth=alphaSlideHelper.width(),flat||(container.css("position","absolute"),opts.offset?container.offset(opts.offset):container.offset(getOffset(container,offsetElement))),updateHelperLocations(),opts.showPalette&&drawPalette(),boundElement.trigger("reflow.spectrum")}function destroy(){boundElement.show(),offsetElement.unbind("click.spectrum touchstart.spectrum"),container.remove(),replacer.remove(),spectrums[spect.id]=null}function option(optionName,optionValue){return optionName===undefined?$.extend({},opts):optionValue===undefined?opts[optionName]:(opts[optionName]=optionValue,void applyOptions())}function enable(){disabled=!1,boundElement.attr("disabled",!1),offsetElement.removeClass("sp-disabled")}function disable(){hide(),disabled=!0,boundElement.attr("disabled",!0),offsetElement.addClass("sp-disabled")}function setOffset(coord){opts.offset=coord,reflow()}var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=!1,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],paletteLookup={},selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null,doc=element.ownerDocument,boundElement=(doc.body,$(element)),disabled=!1,container=$(markup,doc).addClass(theme),pickerContainer=container.find(".sp-picker-container"),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),toggleButton=container.find(".sp-palette-toggle"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&inputTypeColorSupport&&"color"===boundElement.attr("type"),shouldReplace=isInput&&!flat,replacer=shouldReplace?$(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName):$([]),offsetElement=shouldReplace?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||isInput&&boundElement.val(),colorOnShow=!1,preferredFormat=opts.preferredFormat,currentPreferredFormat=preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;initialize();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,offset:setOffset,set:function(c){set(c),updateOriginalInput()},get:get,destroy:destroy,container:container};return spect.id=spectrums.push(spect)-1,spect}function getOffset(picker,input){var extraY=0,dpWidth=picker.outerWidth(),dpHeight=picker.outerHeight(),inputHeight=input.outerHeight(),doc=picker[0].ownerDocument,docElem=doc.documentElement,viewWidth=docElem.clientWidth+$(doc).scrollLeft(),viewHeight=docElem.clientHeight+$(doc).scrollTop(),offset=input.offset();return offset.top+=inputHeight,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight-extraY):extraY),offset}function noop(){}function stopPropagation(e){e.stopPropagation()}function bind(func,obj){var slice=Array.prototype.slice,args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}}function draggable(element,onmove,onstart,onstop){function prevent(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function move(e){if(dragging){if(IE&&doc.documentMode<9&&!e.button)return stop();var touches=e.originalEvent&&e.originalEvent.touches,pageX=touches?touches[0].pageX:e.pageX,pageY=touches?touches[0].pageY:e.pageY,dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth)),dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));hasTouch&&prevent(e),onmove.apply(element,[dragX,dragY,e])}}function start(e){var rightclick=e.which?3==e.which:2==e.button;rightclick||dragging||onstart.apply(element,arguments)!==!1&&(dragging=!0,maxHeight=$(element).height(),maxWidth=$(element).width(),offset=$(element).offset(),$(doc).bind(duringDragEvents),$(doc.body).addClass("sp-dragging"),hasTouch||move(e),prevent(e))}function stop(){dragging&&($(doc).unbind(duringDragEvents),$(doc.body).removeClass("sp-dragging"),onstop.apply(element,arguments)),dragging=!1}onmove=onmove||function(){},onstart=onstart||function(){},onstop=onstop||function(){};var doc=document,dragging=!1,offset={},maxHeight=0,maxWidth=0,hasTouch="ontouchstart"in window,duringDragEvents={};duringDragEvents.selectstart=prevent,duringDragEvents.dragstart=prevent,duringDragEvents["touchmove mousemove"]=move,duringDragEvents["touchend mouseup"]=stop,$(element).bind("touchstart mousedown",start)}function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments,throttler=function(){timeout=null,func.apply(context,args)};debounce&&clearTimeout(timeout),(debounce||!timeout)&&(timeout=setTimeout(throttler,wait))}}var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=function(){function contains(str,substr){return!!~(""+str).indexOf(substr)}var elem=document.createElement("div"),style=elem.style;return style.cssText="background-color:rgba(0,0,0,.5)",contains(style.backgroundColor,"rgba")||contains(style.backgroundColor,"hsla")}(),inputTypeColorSupport=function(){var colorInput=$("<input type='color' value='!' />")[0];return"color"===colorInput.type&&"!"!==colorInput.value}(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),markup=function(){var gradientFix="";if(IE)for(var i=1;6>=i;i++)gradientFix+="<div class='sp-"+i+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),dataID="spectrum.id";$.fn.spectrum=function(opts,extra){if("string"==typeof opts){var returnValue=this,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var spect=spectrums[$(this).data(dataID)];if(spect){var method=spect[opts];if(!method)throw new Error("Spectrum: no such method: '"+opts+"'");"get"==opts?returnValue=spect.get():"container"==opts?returnValue=spect.container:"option"==opts?returnValue=spect.option.apply(spect,args):"destroy"==opts?(spect.destroy(),$(this).removeData(dataID)):method.apply(spect,args)}}),returnValue}return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data()),spect=spectrum(this,options);$(this).data(dataID,spect.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=draggable,$.fn.spectrum.defaults=defaultOpts,$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){inputTypeColorSupport||$("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")?(color.s=convertToPercentage(color.s),color.v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,color.s,color.v),ok=!0,format="hsv"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")&&(color.s=convertToPercentage(color.s),color.l=convertToPercentage(color.l),rgb=hslToRgb(color.h,color.s,color.l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(b>g?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?p+6*(q-p)*t:.5>t?q:2/3>t?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=.5>l?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(b>g?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:255*r,g:255*g,b:255*b}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(255*-(amount/100)))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(255*-(amount/100)))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(255*-(amount/100)))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(mathRound(hsl.h)+amount)%360;return hsl.h=0>hue?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return 1>=n&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:(match=matchers.hex3.exec(color))?{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}:!1}var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random,tinycolor=function tinycolor(color,opts){if(color=color?color:"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1;
},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String=s.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0,needsAlphaFormat=!formatSet&&hasAlpha&&("hex"===format||"hex6"===format||"hex3"===format||"name"===format);return needsAlphaFormat?"name"===format&&0===this._a?this.toName():this.toRgbString():("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),("hex"===format||"hex6"===format)&&(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&("a"===i?newColor[i]=color[i]:newColor[i]=convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return color1&&color2?tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString():!1},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var w1,rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,w=2*p-1,a=rgb2.a-rgb1.a;w1=w*a==-1?w:(w+a)/(1+w*a),w1=(w1+1)/2;var w2=1-w1,rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2),rgb1=c1.toRgb(),rgb2=c2.toRgb(),brightnessA=c1.getBrightness(),brightnessB=c2.getBrightness(),colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}},tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500},tinycolor.mostReadable=function(baseColor,colorList){for(var bestColor=null,bestScore=0,bestIsReadable=!1,i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]),readable=readability.brightness>125&&readability.color>500,score=3*(readability.brightness/125)+readability.color/500;(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore)&&(bestIsReadable=readable,bestScore=score,bestColor=tinycolor(colorList[i]))}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names),matchers=function(){var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=tinycolor}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})});
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var version=$.fn.jquery.split(" ")[0].split(".");if(version[0]<2&&version[1]<9||1==version[0]&&9==version[1]&&version[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){return $(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})}var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.3.5",Alert.TRANSITION_DURATION=150,Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$(selector);e&&e.preventDefault(),$parent.length||($parent=$this.closest(".alert")),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(Alert.TRANSITION_DURATION):removeElement())};var old=$.fn.alert;$.fn.alert=Plugin,$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||$this.data("bs.button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.3.5",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),setTimeout($.proxy(function(){$el[val](null==data[state]?this.options[state]:data[state]),"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")?($input.prop("checked")&&(changed=!1),$parent.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==$input.prop("type")&&($input.prop("checked")!==this.$element.hasClass("active")&&(changed=!1),this.$element.toggleClass("active")),$input.prop("checked",this.$element.hasClass("active")),changed&&$input.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var $btn=$(e.target);$btn.hasClass("btn")||($btn=$btn.closest(".btn")),Plugin.call($btn,"toggle"),$(e.target).is('input[type="radio"]')||$(e.target).is('input[type="checkbox"]')||e.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){$(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",$.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.3.5",Carousel.TRANSITION_DURATION=600,Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},Carousel.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.getItemForDirection=function(direction,active){var activeIndex=this.getItemIndex(active),willWrap="prev"==direction&&0===activeIndex||"next"==direction&&activeIndex==this.$items.length-1;if(willWrap&&!this.options.wrap)return active;var delta="prev"==direction?-1:1,itemIndex=(activeIndex+delta)%this.$items.length;return this.$items.eq(itemIndex)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));return pos>this.$items.length-1||0>pos?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",this.$items.eq(pos))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){return this.sliding?void 0:this.slide("next")},Carousel.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||this.getItemForDirection(type,$active),isCycling=this.interval,direction="next"==type?"left":"right",that=this;if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd(Carousel.TRANSITION_DURATION)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this};var clickHandler=function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}};$(document).on("click.bs.carousel.data-api","[data-slide]",clickHandler).on("click.bs.carousel.data-api","[data-slide-to]",clickHandler),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),+function($){"use strict";function getTargetFromTrigger($trigger){var href,target=$trigger.attr("data-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"");return $(target)}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&/show|hide/.test(option)&&(options.toggle=!1),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.$trigger=$('[data-toggle="collapse"][href="#'+element.id+'"],[data-toggle="collapse"][data-target="#'+element.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};Collapse.VERSION="3.3.5",Collapse.TRANSITION_DURATION=350,Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var activesData,actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(actives&&actives.length&&(activesData=actives.data("bs.collapse"),activesData&&activesData.transitioning))){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){actives&&actives.length&&(Plugin.call(actives,"hide"),activesData||actives.data("bs.collapse",null));var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return $.support.transition?void this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION):complete.call(this)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},Collapse.prototype.getParent=function(){return $(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each($.proxy(function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)},this)).end()},Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen),$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var $this=$(this);$this.attr("data-target")||e.preventDefault();var $target=getTargetFromTrigger($this),data=$target.data("bs.collapse"),option=data?"toggle":$this.data();Plugin.call($target,option)})}(jQuery),+function($){"use strict";function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&$.contains($parent[0],e.target)||($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget))))}))}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.5",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$(document.createElement("div")).addClass("dropdown-backdrop").insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget)}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.disabled):visible a",$items=$parent.find(".dropdown-menu"+desc);if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",Dropdown.prototype.keydown)}(jQuery),+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.3.5",Modal.TRANSITION_DURATION=300,Modal.BACKDROP_TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){that.$element.one("mouseup.dismiss.bs.modal",function(e){$(e.target).is(that.$element)&&(that.ignoreBackdropClick=!0)})}),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),that.adjustDialog(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in"),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$dialog.one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$(document.createElement("div")).addClass("modal-backdrop "+animate).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()}else callback&&callback()},Modal.prototype.handleUpdate=function(){this.adjustDialog()},Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})},Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},Modal.prototype.checkScrollbar=function(){var fullWindowWidth=window.innerWidth;if(!fullWindowWidth){var documentElementRect=document.documentElement.getBoundingClientRect();fullWindowWidth=documentElementRect.right-Math.abs(documentElementRect.left)}this.bodyIsOverflowing=document.body.clientWidth<fullWindowWidth,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||!/destroy|hide/.test(option))&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})}var Tooltip=function(element,options){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.5",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){if(this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$($.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusin"==obj.type?"focus":"hover"]=!0),self.tip().hasClass("in")||"in"==self.hoverState?void(self.hoverState="in"):(clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show())},Tooltip.prototype.isInStateTrue=function(){for(var key in this.inState)if(this.inState[key])return!0;return!1},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusout"==obj.type?"focus":"hover"]=!1),self.isInStateTrue()?void 0:(clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide())},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,viewportDim=this.getPosition(this.$viewport);placement="bottom"==placement&&pos.bottom+actualHeight>viewportDim.bottom?"top":"top"==placement&&pos.top-actualHeight<viewportDim.top?"bottom":"right"==placement&&pos.right+actualWidth>viewportDim.width?"left":"left"==placement&&pos.left-actualWidth<viewportDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top+=marginTop,offset.left+=marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isVertical){this.arrow().css(isVertical?"left":"top",50*(1-delta/dimension)+"%").css(isVertical?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}var that=this,$tip=$(this.$tip),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var elOffset=isBody?{top:0,left:0}:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()
},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.right&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){if(!this.$tip&&(this.$tip=$(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),e?(self.inState.click=!self.inState.click,self.isInStateTrue()?self.enter(self):self.leave(self)):self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide(function(){that.$element.off("."+that.type).removeData("bs."+that.type),that.$tip&&that.$tip.detach(),that.$tip=null,that.$arrow=null,that.$viewport=null})};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||!/destroy|hide/.test(option))&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})}var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.3.5",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var old=$.fn.popover;$.fn.popover=Plugin,$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),+function($){"use strict";function ScrollSpy(element,options){this.$body=$(document.body),this.$scrollElement=$($(element).is(document.body)?window:element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",$.proxy(this.process,this)),this.refresh(),this.process()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.scrollspy"),options="object"==typeof option&&option;data||$this.data("bs.scrollspy",data=new ScrollSpy(this,options)),"string"==typeof option&&data[option]()})}ScrollSpy.VERSION="3.3.5",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var that=this,offsetMethod="offset",offsetBase=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(href);return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){that.offsets.push(this[0]),that.targets.push(this[1])})},ScrollSpy.prototype.process=function(){var i,scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget;if(this.scrollHeight!=scrollHeight&&this.refresh(),scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<offsets[0])return this.activeTarget=null,this.clear();for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(void 0===offsets[i+1]||scrollTop<offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,this.clear();var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]',active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")},ScrollSpy.prototype.clear=function(){$(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);Plugin.call($spy,$spy.data())})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),"string"==typeof option&&data[option]()})}var Tab=function(element){this.element=$(element)};Tab.VERSION="3.3.5",Tab.TRANSITION_DURATION=150,Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");if(selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")),!$this.parent("li").hasClass("active")){var $previous=$ul.find(".active:last a"),hideEvent=$.Event("hide.bs.tab",{relatedTarget:$this[0]}),showEvent=$.Event("show.bs.tab",{relatedTarget:$previous[0]});if($previous.trigger(hideEvent),$this.trigger(showEvent),!showEvent.isDefaultPrevented()&&!hideEvent.isDefaultPrevented()){var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),function(){$previous.trigger({type:"hidden.bs.tab",relatedTarget:$this[0]}),$this.trigger({type:"shown.bs.tab",relatedTarget:$previous[0]})})}}},Tab.prototype.activate=function(element,container,callback){function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),element.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu").length&&element.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),callback&&callback()}var $active=container.find("> .active"),transition=callback&&$.support.transition&&($active.length&&$active.hasClass("fade")||!!container.find("> .fade").length);$active.length&&transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(Tab.TRANSITION_DURATION):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this};var clickHandler=function(e){e.preventDefault(),Plugin.call($(this),"show")};$(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',clickHandler).on("click.bs.tab.data-api",'[data-toggle="pill"]',clickHandler)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix"),options="object"==typeof option&&option;data||$this.data("bs.affix",data=new Affix(this,options)),"string"==typeof option&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.3.5",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getState=function(scrollHeight,height,offsetTop,offsetBottom){var scrollTop=this.$target.scrollTop(),position=this.$element.offset(),targetHeight=this.$target.height();if(null!=offsetTop&&"top"==this.affixed)return offsetTop>scrollTop?"top":!1;if("bottom"==this.affixed)return null!=offsetTop?scrollTop+this.unpin<=position.top?!1:"bottom":scrollHeight-offsetBottom>=scrollTop+targetHeight?!1:"bottom";var initializing=null==this.affixed,colliderTop=initializing?scrollTop:position.top,colliderHeight=initializing?targetHeight:height;return null!=offsetTop&&offsetTop>=scrollTop?"top":null!=offsetBottom&&colliderTop+colliderHeight>=scrollHeight-offsetBottom?"bottom":!1},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var height=this.$element.height(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom,scrollHeight=Math.max($(document).height(),$(document.body).height());"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=this.getState(scrollHeight,height,offsetTop,offsetBottom);if(this.affixed!=affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");if(this.$element.trigger(e),e.isDefaultPrevented())return;this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger(affixType.replace("affix","affixed")+".bs.affix")}"bottom"==affix&&this.$element.offset({top:scrollHeight-height-offsetBottom})}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},null!=data.offsetBottom&&(data.offset.bottom=data.offsetBottom),null!=data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery);
!function(window,angular,undefined){"use strict";function $KeepaliveProvider(){var options={http:null,interval:600};this.http=function(value){if(!value)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");angular.isString(value)&&(value={url:value,method:"GET"}),value.cache=!1,options.http=value},this.interval=function(seconds){if(seconds=parseInt(seconds),isNaN(seconds)||0>=seconds)throw new Error("Interval must be expressed in seconds and be greater than 0.");options.interval=seconds},this.$get=function($rootScope,$log,$interval,$http){function handleResponse(data,status){$rootScope.$broadcast("$keepaliveResponse",data,status)}function ping(){$rootScope.$broadcast("$keepalive"),angular.isObject(options.http)&&$http(options.http).success(handleResponse).error(handleResponse)}var state={ping:null};return{_options:function(){return options},start:function(){$interval.cancel(state.ping),state.ping=$interval(ping,1e3*options.interval)},stop:function(){$interval.cancel(state.ping)},ping:function(){ping()}}},this.$get.$inject=["$rootScope","$log","$interval","$http"]}function $IdleProvider(){var options={idleDuration:1200,warningDuration:30,autoResume:!0,events:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart",keepalive:!0};this.activeOn=function(events){options.events=events},this.idleDuration=function(seconds){if(0>=seconds)throw new Error("idleDuration must be a value in seconds, greater than 0.");options.idleDuration=seconds},this.warningDuration=function(seconds){if(0>seconds)throw new Error("warning must be a value in seconds, greater than 0.");options.warningDuration=seconds},this.autoResume=function(value){options.autoResume=value===!0},this.keepalive=function(enabled){options.keepalive=enabled===!0},this.$get=function($interval,$log,$rootScope,$document,$keepalive){function startKeepalive(){options.keepalive&&(state.running&&$keepalive.ping(),$keepalive.start())}function stopKeepalive(){options.keepalive&&$keepalive.stop()}function toggleState(){state.idling=!state.idling;var name=state.idling?"Start":"End";$rootScope.$broadcast("$idle"+name),state.idling?(stopKeepalive(),state.countdown=options.warningDuration,countdown(),state.warning=$interval(countdown,1e3,options.warningDuration)):startKeepalive(),$interval.cancel(state.idle)}function countdown(){state.countdown<=0?$rootScope.$broadcast("$idleTimeout"):$rootScope.$broadcast("$idleWarn",state.countdown),state.countdown--}var state={idle:null,warning:null,idling:!1,running:!1,countdown:null},svc={_options:function(){return options},running:function(){return state.running},idling:function(){return state.idling},watch:function(){$interval.cancel(state.idle),$interval.cancel(state.warning),state.idling?toggleState():state.running||startKeepalive(),state.running=!0,state.idle=$interval(toggleState,1e3*options.idleDuration)},unwatch:function(){$interval.cancel(state.idle),$interval.cancel(state.warning),state.idling=!1,state.running=!1}},interrupt=function(){state.running&&options.autoResume&&svc.watch()};return $document.find("body").on(options.events,interrupt),svc},this.$get.$inject=["$interval","$log","$rootScope","$document","$keepalive"]}angular.module("ngIdle.keepalive",[]).provider("$keepalive",$KeepaliveProvider),angular.module("ngIdle.idle",[]).provider("$idle",$IdleProvider),angular.module("ngIdle.ngIdleCountdown",[]).directive("ngIdleCountdown",function(){return{restrict:"A",scope:{value:"=ngIdleCountdown"},link:function($scope){$scope.$on("$idleWarn",function(e,countdown){$scope.value=countdown}),$scope.$on("$idleTimeout",function(){$scope.value=0})}}}),angular.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.ngIdleCountdown"])}(window,window.angular);
(function(){var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?createCallback(value,context,argCount):_.isObject(value)?_.matches(value):_.property(value)},_.each=_.forEach=function(obj,iteratee,context){if(null==obj)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length)for(i=0;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){if(null==obj)return[];iteratee=_.iteratee(iteratee,context);for(var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;length>index;index++)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.reduceRight=_.foldr=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}for(;index--;)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.find=_.detect=function(obj,predicate,context){var result;return predicate=_.iteratee(predicate,context),_.some(obj,function(value,index,list){return predicate(value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(predicate=_.iteratee(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)},_.every=_.all=function(obj,predicate,context){if(null==obj)return!0;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){if(null==obj)return!1;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.include=function(obj,target){return null==obj?!1:(obj.length!==+obj.length&&(obj=_.values(obj)),_.indexOf(obj,target)>=0)},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-(1/0)&&result===-(1/0))&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||computed===1/0&&result===1/0)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=obj&&obj.length===+obj.length?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=_.iteratee(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;length>i;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=_.iteratee(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i];if(isSorted)i&&seen===value||result.push(value),seen=value;else if(iteratee){var computed=iteratee(value,i,array);_.indexOf(seen,computed)<0&&(seen.push(computed),result.push(value))}else _.indexOf(result,value)<0&&result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(array){if(null==array)return[];for(var length=_.max(arguments,"length").length,results=Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var idx=array.length;for("number"==typeof from&&(idx=0>from?idx+from+1:Math.min(idx,from+1));--idx>=0;)if(array[idx]===item)return idx;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return _.isObject(result)?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=hasher?hasher.apply(this,arguments):key;return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}},_.once=_.partial(_.before,2),_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){if(!_.isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;length>i;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj},_.pick=function(obj,iteratee,context){var key,result={};if(null==obj)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;length>i;i++)key=keys[i],key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;length>i;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size,result;if("[object Array]"===className){if(size=a.length,result=size===b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{var key,keys=_.keys(a);if(size=keys.length,result=_.keys(b).length===size)for(;size--&&(key=keys[size],result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)););}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(null==obj)return!length;obj=new Object(obj);for(var i=0;length>i;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return!1}return!0}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this);
!function(window){function sprintf(){var key=arguments[0],cache=sprintf.cache;return cache[key]&&cache.hasOwnProperty(key)||(cache[key]=sprintf.parse(key)),sprintf.format.call(null,cache[key],arguments)}function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}function str_repeat(input,multiplier){return Array(multiplier+1).join(input)}var re={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,cursor=1,tree_length=parse_tree.length,node_type="",output=[],is_positive=!0,sign="";for(i=0;tree_length>i;i++)if(node_type=get_type(parse_tree[i]),"string"===node_type)output[output.length]=parse_tree[i];else if("array"===node_type){if(match=parse_tree[i],match[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if("function"==get_type(arg)&&(arg=arg()),re.not_string.test(match[8])&&re.not_json.test(match[8])&&"number"!=get_type(arg)&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"g":arg=match[7]?parseFloat(arg).toPrecision(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}re.json.test(match[8])?output[output.length]=arg:(!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?str_repeat(pad_character,pad_length):"",output[output.length]=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg)}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree[parse_tree.length]=match[0];else if(null!==(match=re.modulo.exec(_fmt)))parse_tree[parse_tree.length]="%";else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list[field_list.length]=field_match[1];""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list[field_list.length]=field_match[1];else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list[field_list.length]=field_match[1]}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree[parse_tree.length]=match}_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){return _argv=(argv||[]).slice(0),_argv.splice(0,0,fmt),sprintf.apply(null,_argv)};"undefined"!=typeof exports?(exports.sprintf=sprintf,exports.vsprintf=vsprintf):(window.sprintf=sprintf,window.vsprintf=vsprintf,"function"==typeof define&&define.amd&&define(function(){return{sprintf:sprintf,vsprintf:vsprintf}}))}("undefined"==typeof window?this:window);
angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(event){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){return{link:function(scope,element,attrs){function doTransition(change){function newTransitionDone(){currentTransition===newTransition&&(currentTransition=void 0)}var newTransition=$transition(element,change);return currentTransition&&currentTransition.cancel(),currentTransition=newTransition,newTransition.then(newTransitionDone,newTransitionDone),newTransition}function expand(){initialAnimSkip?(initialAnimSkip=!1,expandDone()):(element.removeClass("collapse").addClass("collapsing"),doTransition({height:element[0].scrollHeight+"px"}).then(expandDone))}function expandDone(){element.removeClass("collapsing"),element.addClass("collapse in"),element.css({height:"auto"})}function collapse(){if(initialAnimSkip)initialAnimSkip=!1,collapseDone(),element.css({height:0});else{element.css({height:element[0].scrollHeight+"px"});element[0].offsetWidth;element.removeClass("collapse in").addClass("collapsing"),doTransition({height:0}).then(collapseDone)}}function collapseDone(){element.removeClass("collapsing"),element.addClass("collapse")}var currentTransition,initialAnimSkip=!0;scope.$watch(attrs.collapse,function(shouldCollapse){shouldCollapse?collapse():expand()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(event){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);-1!==index&&this.groups.splice(index,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){accordionCtrl.addGroup(scope),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope)}),scope.toggleOpen=function(){scope.isDisabled||(scope.isOpen=!scope.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(scope,element,attr,accordionGroupCtrl,transclude){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function($scope,$attrs){$scope.closeable="close"in $attrs,this.close=$scope.close}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}).directive("dismissOnTimeout",["$timeout",function($timeout){return{require:"alert",link:function(scope,element,attrs,alertCtrl){$timeout(function(){alertCtrl.close()},parseInt(attrs.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe),scope.$watch(attr.bindHtmlUnsafe,function(value){element.html(value||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(buttonConfig){this.activeClass=buttonConfig.activeClass||"active",this.toggleEvent=buttonConfig.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,scope.$eval(attrs.btnRadio)))},element.bind(buttonsCtrl.toggleEvent,function(){var isActive=element.hasClass(buttonsCtrl.activeClass);(!isActive||angular.isDefined(attrs.uncheckable))&&scope.$apply(function(){ngModelCtrl.$setViewValue(isActive?null:scope.$eval(attrs.btnRadio)),ngModelCtrl.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){function getTrueValue(){return getCheckboxValue(attrs.btnCheckboxTrue,!0)}function getFalseValue(){return getCheckboxValue(attrs.btnCheckboxFalse,!1)}function getCheckboxValue(attributeValue,defaultValue){var val=scope.$eval(attributeValue);return angular.isDefined(val)?val:defaultValue}var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,getTrueValue()))},element.bind(buttonsCtrl.toggleEvent,function(){scope.$apply(function(){ngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass)?getFalseValue():getTrueValue()),ngModelCtrl.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$interval","$transition",function($scope,$timeout,$interval,$transition){function restartTimer(){resetTimer();var interval=+$scope.interval;!isNaN(interval)&&interval>0&&(currentInterval=$interval(timerFn,interval))}function resetTimer(){currentInterval&&($interval.cancel(currentInterval),currentInterval=null)}function timerFn(){var interval=+$scope.interval;isPlaying&&!isNaN(interval)&&interval>0?$scope.next():$scope.pause()}var currentInterval,isPlaying,self=this,slides=self.slides=$scope.slides=[],currentIndex=-1;self.currentSlide=null;var destroyed=!1;self.select=$scope.select=function(nextSlide,direction){function goNext(){if(!destroyed){if(self.currentSlide&&angular.isString(direction)&&!$scope.noTransition&&nextSlide.$element){nextSlide.$element.addClass(direction);nextSlide.$element[0].offsetWidth;angular.forEach(slides,function(slide){angular.extend(slide,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(nextSlide,{direction:direction,active:!0,entering:!0}),angular.extend(self.currentSlide||{},{direction:direction,leaving:!0}),$scope.$currentTransition=$transition(nextSlide.$element,{}),function(next,current){$scope.$currentTransition.then(function(){transitionDone(next,current)},function(){transitionDone(next,current)})}(nextSlide,self.currentSlide)}else transitionDone(nextSlide,self.currentSlide);self.currentSlide=nextSlide,currentIndex=nextIndex,restartTimer()}}function transitionDone(next,current){angular.extend(next,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(current||{},{direction:"",active:!1,leaving:!1,entering:!1}),$scope.$currentTransition=null}var nextIndex=slides.indexOf(nextSlide);void 0===direction&&(direction=nextIndex>currentIndex?"next":"prev"),nextSlide&&nextSlide!==self.currentSlide&&($scope.$currentTransition?($scope.$currentTransition.cancel(),$timeout(goNext)):goNext())},$scope.$on("$destroy",function(){destroyed=!0}),self.indexOfSlide=function(slide){return slides.indexOf(slide)},$scope.next=function(){var newIndex=(currentIndex+1)%slides.length;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"next")},$scope.prev=function(){var newIndex=0>currentIndex-1?slides.length-1:currentIndex-1;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"prev")},$scope.isActive=function(slide){return self.currentSlide===slide},$scope.$watch("interval",restartTimer),$scope.$on("$destroy",resetTimer),$scope.play=function(){isPlaying||(isPlaying=!0,restartTimer())},$scope.pause=function(){$scope.noPause||(isPlaying=!1,resetTimer())},self.addSlide=function(slide,element){slide.$element=element,slides.push(slide),1===slides.length||slide.active?(self.select(slides[slides.length-1]),1==slides.length&&$scope.play()):slide.active=!1},self.removeSlide=function(slide){var index=slides.indexOf(slide);slides.splice(index,1),slides.length>0&&slide.active?index>=slides.length?self.select(slides[index-1]):self.select(slides[index]):currentIndex>index&&currentIndex--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(scope,element,attrs,carouselCtrl){carouselCtrl.addSlide(scope,element),scope.$on("$destroy",function(){carouselCtrl.removeSlide(scope)}),scope.$watch("active",function(active){active&&carouselCtrl.select(scope)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function($locale,orderByFilter){function createParser(format){var map=[],regex=format.split("");return angular.forEach(formatCodeToRegex,function(data,code){var index=format.indexOf(code);if(index>-1){format=format.split(""),regex[index]="("+data.regex+")",format[index]="$";for(var i=index+1,n=index+code.length;n>i;i++)regex[i]="",format[i]="$";format=format.join(""),map.push({index:index,apply:data.apply})}}),{regex:new RegExp("^"+regex.join("")+"$"),map:orderByFilter(map,"index")}}function isValid(year,month,date){return 1===month&&date>28?29===date&&(year%4===0&&year%100!==0||year%400===0):3===month||5===month||8===month||10===month?31>date:!0}this.parsers={};var formatCodeToRegex={yyyy:{regex:"\\d{4}",apply:function(value){this.year=+value}},yy:{regex:"\\d{2}",apply:function(value){this.year=+value+2e3}},y:{regex:"\\d{1,4}",apply:function(value){this.year=+value}},MMMM:{regex:$locale.DATETIME_FORMATS.MONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.MONTH.indexOf(value)}},MMM:{regex:$locale.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(value){this.month=value-1}},M:{regex:"[1-9]|1[0-2]",apply:function(value){this.month=value-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},EEEE:{regex:$locale.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:$locale.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(input,format){if(!angular.isString(input)||!format)return input;format=$locale.DATETIME_FORMATS[format]||format,this.parsers[format]||(this.parsers[format]=createParser(format));var parser=this.parsers[format],regex=parser.regex,map=parser.map,results=input.match(regex);if(results&&results.length){for(var dt,fields={year:1900,month:0,date:1,hours:0},i=1,n=results.length;n>i;i++){var mapper=map[i-1];mapper.apply&&mapper.apply.call(fields,results[i])}return isValid(fields.year,fields.month,fields.date)&&(dt=new Date(fields.year,fields.month,fields.date,fields.hours)),dt}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}return targetElPos}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!1,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function($scope,$attrs,$parse,$interpolate,$timeout,$log,dateFilter,datepickerConfig){var self=this,ngModelCtrl={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(key,index){self[key]=angular.isDefined($attrs[key])?8>index?$interpolate($attrs[key])($scope.$parent):$scope.$parent.$eval($attrs[key]):datepickerConfig[key]}),angular.forEach(["minDate","maxDate"],function(key){$attrs[key]?$scope.$parent.$watch($parse($attrs[key]),function(value){self[key]=value?new Date(value):null,self.refreshView()}):self[key]=datepickerConfig[key]?new Date(datepickerConfig[key]):null}),$scope.datepickerMode=$scope.datepickerMode||datepickerConfig.datepickerMode,$scope.uniqueId="datepicker-"+$scope.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined($attrs.initDate)?$scope.$parent.$eval($attrs.initDate):new Date,$scope.isActive=function(dateObject){return 0===self.compare(dateObject.date,self.activeDate)?($scope.activeDateId=dateObject.uid,!0):!1},this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=function(){self.render()}},this.render=function(){if(ngModelCtrl.$modelValue){var date=new Date(ngModelCtrl.$modelValue),isValid=!isNaN(date);isValid?this.activeDate=date:$log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),ngModelCtrl.$setValidity("date",isValid)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;ngModelCtrl.$setValidity("date-disabled",!date||this.element&&!this.isDisabled(date))}},this.createDateObject=function(date,format){var model=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;return{date:date,label:dateFilter(date,format),selected:model&&0===this.compare(date,model),disabled:this.isDisabled(date),current:0===this.compare(date,new Date)}},this.isDisabled=function(date){return this.minDate&&this.compare(date,this.minDate)<0||this.maxDate&&this.compare(date,this.maxDate)>0||$attrs.dateDisabled&&$scope.dateDisabled({date:date,mode:$scope.datepickerMode})},this.split=function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},$scope.select=function(date){if($scope.datepickerMode===self.minMode){var dt=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):new Date(0,0,0,0,0,0,0);dt.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),ngModelCtrl.$setViewValue(dt),ngModelCtrl.$render()}else self.activeDate=date,$scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)-1]},$scope.move=function(direction){var year=self.activeDate.getFullYear()+direction*(self.step.years||0),month=self.activeDate.getMonth()+direction*(self.step.months||0);self.activeDate.setFullYear(year,month,1),self.refreshView()},$scope.toggleMode=function(direction){direction=direction||1,$scope.datepickerMode===self.maxMode&&1===direction||$scope.datepickerMode===self.minMode&&-1===direction||($scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)+direction])},$scope.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var focusElement=function(){$timeout(function(){self.element[0].focus()},0,!1)};$scope.$on("datepicker.focus",focusElement),$scope.keydown=function(evt){var key=$scope.keys[evt.which];if(key&&!evt.shiftKey&&!evt.altKey)if(evt.preventDefault(),evt.stopPropagation(),"enter"===key||"space"===key){if(self.isDisabled(self.activeDate))return;$scope.select(self.activeDate),focusElement()}else!evt.ctrlKey||"up"!==key&&"down"!==key?(self.handleKeyDown(key,evt),self.refreshView()):($scope.toggleMode("up"===key?1:-1),focusElement())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(scope,element,attrs,ctrls){var datepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&datepickerCtrl.init(ngModelCtrl)}}}).directive("daypicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getDaysInMonth(year,month){return 1!==month||year%4!==0||year%100===0&&year%400!==0?DAYS_IN_MONTH[month]:29}function getDates(startDate,n){var dates=new Array(n),current=new Date(startDate),i=0;for(current.setHours(12);n>i;)dates[i++]=new Date(current),current.setDate(current.getDate()+1);return dates}function getISO8601WeekNumber(date){var checkDate=new Date(date);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1}scope.showWeeks=ctrl.showWeeks,ctrl.step={months:1},ctrl.element=element;var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ctrl._refreshView=function(){var year=ctrl.activeDate.getFullYear(),month=ctrl.activeDate.getMonth(),firstDayOfMonth=new Date(year,month,1),difference=ctrl.startingDay-firstDayOfMonth.getDay(),numDisplayedFromPreviousMonth=difference>0?7-difference:-difference,firstDate=new Date(firstDayOfMonth);numDisplayedFromPreviousMonth>0&&firstDate.setDate(-numDisplayedFromPreviousMonth+1);for(var days=getDates(firstDate,42),i=0;42>i;i++)days[i]=angular.extend(ctrl.createDateObject(days[i],ctrl.formatDay),{secondary:days[i].getMonth()!==month,uid:scope.uniqueId+"-"+i});scope.labels=new Array(7);for(var j=0;7>j;j++)scope.labels[j]={abbr:dateFilter(days[j].date,ctrl.formatDayHeader),full:dateFilter(days[j].date,"EEEE")};if(scope.title=dateFilter(ctrl.activeDate,ctrl.formatDayTitle),scope.rows=ctrl.split(days,7),scope.showWeeks){scope.weekNumbers=[];for(var weekNumber=getISO8601WeekNumber(scope.rows[0][0].date),numWeeks=scope.rows.length;scope.weekNumbers.push(weekNumber++)<numWeeks;);}},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},ctrl.handleKeyDown=function(key,evt){var date=ctrl.activeDate.getDate();if("left"===key)date-=1;else if("up"===key)date-=7;else if("right"===key)date+=1;else if("down"===key)date+=7;else if("pageup"===key||"pagedown"===key){var month=ctrl.activeDate.getMonth()+("pageup"===key?-1:1);ctrl.activeDate.setMonth(month,1),date=Math.min(getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()),date)}else"home"===key?date=1:"end"===key&&(date=getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()));ctrl.activeDate.setDate(date)},ctrl.refreshView()}}}]).directive("monthpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){ctrl.step={years:1},ctrl.element=element,ctrl._refreshView=function(){for(var months=new Array(12),year=ctrl.activeDate.getFullYear(),i=0;12>i;i++)months[i]=angular.extend(ctrl.createDateObject(new Date(year,i,1),ctrl.formatMonth),{uid:scope.uniqueId+"-"+i});scope.title=dateFilter(ctrl.activeDate,ctrl.formatMonthTitle),scope.rows=ctrl.split(months,3)},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth())-new Date(date2.getFullYear(),date2.getMonth())},ctrl.handleKeyDown=function(key,evt){var date=ctrl.activeDate.getMonth();if("left"===key)date-=1;else if("up"===key)date-=3;else if("right"===key)date+=1;else if("down"===key)date+=3;else if("pageup"===key||"pagedown"===key){var year=ctrl.activeDate.getFullYear()+("pageup"===key?-1:1);ctrl.activeDate.setFullYear(year)}else"home"===key?date=0:"end"===key&&(date=11);ctrl.activeDate.setMonth(date)},ctrl.refreshView()}}}]).directive("yearpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getStartingYear(year){return parseInt((year-1)/range,10)*range+1}var range=ctrl.yearRange;ctrl.step={years:range},ctrl.element=element,ctrl._refreshView=function(){for(var years=new Array(range),i=0,start=getStartingYear(ctrl.activeDate.getFullYear());range>i;i++)years[i]=angular.extend(ctrl.createDateObject(new Date(start+i,0,1),ctrl.formatYear),{uid:scope.uniqueId+"-"+i});scope.title=[years[0].label,years[range-1].label].join(" - "),scope.rows=ctrl.split(years,5)},ctrl.compare=function(date1,date2){return date1.getFullYear()-date2.getFullYear()},ctrl.handleKeyDown=function(key,evt){var date=ctrl.activeDate.getFullYear();"left"===key?date-=1:"up"===key?date-=5:"right"===key?date+=1:"down"===key?date+=5:"pageup"===key||"pagedown"===key?date+=("pageup"===key?-1:1)*ctrl.step.years:"home"===key?date=getStartingYear(ctrl.activeDate.getFullYear()):"end"===key&&(date=getStartingYear(ctrl.activeDate.getFullYear())+range-1),ctrl.activeDate.setFullYear(date)},ctrl.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function($compile,$parse,$document,$position,dateFilter,dateParser,datepickerPopupConfig){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(scope,element,attrs,ngModel){function cameltoDash(string){return string.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function parseDate(viewValue){if(viewValue){if(angular.isDate(viewValue)&&!isNaN(viewValue))return ngModel.$setValidity("date",!0),viewValue;if(angular.isString(viewValue)){var date=dateParser.parse(viewValue,dateFormat)||new Date(viewValue);return isNaN(date)?void ngModel.$setValidity("date",!1):(ngModel.$setValidity("date",!0),date)}return void ngModel.$setValidity("date",!1)}return ngModel.$setValidity("date",!0),null}var dateFormat,closeOnDateSelection=angular.isDefined(attrs.closeOnDateSelection)?scope.$parent.$eval(attrs.closeOnDateSelection):datepickerPopupConfig.closeOnDateSelection,appendToBody=angular.isDefined(attrs.datepickerAppendToBody)?scope.$parent.$eval(attrs.datepickerAppendToBody):datepickerPopupConfig.appendToBody;scope.showButtonBar=angular.isDefined(attrs.showButtonBar)?scope.$parent.$eval(attrs.showButtonBar):datepickerPopupConfig.showButtonBar,scope.getText=function(key){return scope[key+"Text"]||datepickerPopupConfig[key+"Text"]},attrs.$observe("datepickerPopup",function(value){dateFormat=value||datepickerPopupConfig.datepickerPopup,ngModel.$render()});var popupEl=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");popupEl.attr({"ng-model":"date","ng-change":"dateSelection()"});var datepickerEl=angular.element(popupEl.children()[0]);attrs.datepickerOptions&&angular.forEach(scope.$parent.$eval(attrs.datepickerOptions),function(value,option){datepickerEl.attr(cameltoDash(option),value)}),scope.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(key){if(attrs[key]){var getAttribute=$parse(attrs[key]);if(scope.$parent.$watch(getAttribute,function(value){scope.watchData[key]=value}),datepickerEl.attr(cameltoDash(key),"watchData."+key),"datepickerMode"===key){var setAttribute=getAttribute.assign;scope.$watch("watchData."+key,function(value,oldvalue){value!==oldvalue&&setAttribute(scope.$parent,value)})}}}),attrs.dateDisabled&&datepickerEl.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),ngModel.$parsers.unshift(parseDate),scope.dateSelection=function(dt){angular.isDefined(dt)&&(scope.date=dt),ngModel.$setViewValue(scope.date),ngModel.$render(),closeOnDateSelection&&(scope.isOpen=!1,element[0].focus())},element.bind("input change keyup",function(){scope.$apply(function(){scope.date=ngModel.$modelValue})}),ngModel.$render=function(){var date=ngModel.$viewValue?dateFilter(ngModel.$viewValue,dateFormat):"";element.val(date),scope.date=parseDate(ngModel.$modelValue)};var documentClickBind=function(event){scope.isOpen&&event.target!==element[0]&&scope.$apply(function(){scope.isOpen=!1})},keydown=function(evt,noApply){scope.keydown(evt)};element.bind("keydown",keydown),scope.keydown=function(evt){27===evt.which?(evt.preventDefault(),evt.stopPropagation(),scope.close()):40!==evt.which||scope.isOpen||(scope.isOpen=!0)},scope.$watch("isOpen",function(value){value?(scope.$broadcast("datepicker.focus"),scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),$document.bind("click",documentClickBind)):$document.unbind("click",documentClickBind)}),scope.select=function(date){if("today"===date){var today=new Date;angular.isDate(ngModel.$modelValue)?(date=new Date(ngModel.$modelValue),date.setFullYear(today.getFullYear(),today.getMonth(),today.getDate())):date=new Date(today.setHours(0,0,0,0))}scope.dateSelection(date)},scope.close=function(){scope.isOpen=!1,element[0].focus()};var $popup=$compile(popupEl)(scope);popupEl.remove(),appendToBody?$document.find("body").append($popup):element.after($popup),scope.$on("$destroy",function(){$popup.remove(),element.unbind("keydown",keydown),$document.unbind("click",documentClickBind)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(scope,element,attrs){element.bind("click",function(event){event.preventDefault(),
event.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function($document){var openScope=null;this.open=function(dropdownScope){openScope||($document.bind("click",closeDropdown),$document.bind("keydown",escapeKeyBind)),openScope&&openScope!==dropdownScope&&(openScope.isOpen=!1),openScope=dropdownScope},this.close=function(dropdownScope){openScope===dropdownScope&&(openScope=null,$document.unbind("click",closeDropdown),$document.unbind("keydown",escapeKeyBind))};var closeDropdown=function(evt){if(openScope){var toggleElement=openScope.getToggleElement();evt&&toggleElement&&toggleElement[0].contains(evt.target)||openScope.$apply(function(){openScope.isOpen=!1})}},escapeKeyBind=function(evt){27===evt.which&&(openScope.focusToggleElement(),closeDropdown())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function($scope,$attrs,$parse,dropdownConfig,dropdownService,$animate){var getIsOpen,self=this,scope=$scope.$new(),openClass=dropdownConfig.openClass,setIsOpen=angular.noop,toggleInvoker=$attrs.onToggle?$parse($attrs.onToggle):angular.noop;this.init=function(element){self.$element=element,$attrs.isOpen&&(getIsOpen=$parse($attrs.isOpen),setIsOpen=getIsOpen.assign,$scope.$watch(getIsOpen,function(value){scope.isOpen=!!value}))},this.toggle=function(open){return scope.isOpen=arguments.length?!!open:!scope.isOpen},this.isOpen=function(){return scope.isOpen},scope.getToggleElement=function(){return self.toggleElement},scope.focusToggleElement=function(){self.toggleElement&&self.toggleElement[0].focus()},scope.$watch("isOpen",function(isOpen,wasOpen){$animate[isOpen?"addClass":"removeClass"](self.$element,openClass),isOpen?(scope.focusToggleElement(),dropdownService.open(scope)):dropdownService.close(scope),setIsOpen($scope,isOpen),angular.isDefined(isOpen)&&isOpen!==wasOpen&&toggleInvoker($scope,{open:!!isOpen})}),$scope.$on("$locationChangeSuccess",function(){scope.isOpen=!1}),$scope.$on("$destroy",function(){scope.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(scope,element,attrs,dropdownCtrl){dropdownCtrl.init(element)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(scope,element,attrs,dropdownCtrl){if(dropdownCtrl){dropdownCtrl.toggleElement=element;var toggleDropdown=function(event){event.preventDefault(),element.hasClass("disabled")||attrs.disabled||scope.$apply(function(){dropdownCtrl.toggle()})};element.bind("click",toggleDropdown),element.attr({"aria-haspopup":!0,"aria-expanded":!1}),scope.$watch(dropdownCtrl.isOpen,function(isOpen){element.attr("aria-expanded",!!isOpen)}),scope.$on("$destroy",function(){element.unbind("click",toggleDropdown)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var stack=[];return{add:function(key,value){stack.push({key:key,value:value})},get:function(key){for(var i=0;i<stack.length;i++)if(key==stack[i].key)return stack[i]},keys:function(){for(var keys=[],i=0;i<stack.length;i++)keys.push(stack[i].key);return keys},top:function(){return stack[stack.length-1]},remove:function(key){for(var idx=-1,i=0;i<stack.length;i++)if(key==stack[i].key){idx=i;break}return stack.splice(idx,1)[0]},removeTop:function(){return stack.splice(stack.length-1,1)[0]},length:function(){return stack.length}}}}}).directive("modalBackdrop",["$timeout",function($timeout){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(scope,element,attrs){scope.backdropClass=attrs.backdropClass||"",scope.animate=!1,$timeout(function(){scope.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function($modalStack,$timeout){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(tElement,tAttrs){return tAttrs.templateUrl||"template/modal/window.html"},link:function(scope,element,attrs){element.addClass(attrs.windowClass||""),scope.size=attrs.size,$timeout(function(){scope.animate=!0,element[0].querySelectorAll("[autofocus]").length||element[0].focus()}),scope.close=function(evt){var modal=$modalStack.getTop();modal&&modal.value.backdrop&&"static"!=modal.value.backdrop&&evt.target===evt.currentTarget&&(evt.preventDefault(),evt.stopPropagation(),$modalStack.dismiss(modal.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function($scope,$element,$attrs,controller,$transclude){$transclude($scope.$parent,function(clone){$element.empty(),$element.append(clone)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function($transition,$timeout,$document,$compile,$rootScope,$$stackedMap){function backdropIndex(){for(var topBackdropIndex=-1,opened=openedWindows.keys(),i=0;i<opened.length;i++)openedWindows.get(opened[i]).value.backdrop&&(topBackdropIndex=i);return topBackdropIndex}function removeModalWindow(modalInstance){var body=$document.find("body").eq(0),modalWindow=openedWindows.get(modalInstance).value;openedWindows.remove(modalInstance),removeAfterAnimate(modalWindow.modalDomEl,modalWindow.modalScope,300,function(){modalWindow.modalScope.$destroy(),body.toggleClass(OPENED_MODAL_CLASS,openedWindows.length()>0),checkRemoveBackdrop()})}function checkRemoveBackdrop(){if(backdropDomEl&&-1==backdropIndex()){var backdropScopeRef=backdropScope;removeAfterAnimate(backdropDomEl,backdropScope,150,function(){backdropScopeRef.$destroy(),backdropScopeRef=null}),backdropDomEl=void 0,backdropScope=void 0}}function removeAfterAnimate(domEl,scope,emulateTime,done){function afterAnimating(){afterAnimating.done||(afterAnimating.done=!0,domEl.remove(),done&&done())}scope.animate=!1;var transitionEndEventName=$transition.transitionEndEventName;if(transitionEndEventName){var timeout=$timeout(afterAnimating,emulateTime);domEl.bind(transitionEndEventName,function(){$timeout.cancel(timeout),afterAnimating(),scope.$apply()})}else $timeout(afterAnimating)}var backdropDomEl,backdropScope,OPENED_MODAL_CLASS="modal-open",openedWindows=$$stackedMap.createNew(),$modalStack={};return $rootScope.$watch(backdropIndex,function(newBackdropIndex){backdropScope&&(backdropScope.index=newBackdropIndex)}),$document.bind("keydown",function(evt){var modal;27===evt.which&&(modal=openedWindows.top(),modal&&modal.value.keyboard&&(evt.preventDefault(),$rootScope.$apply(function(){$modalStack.dismiss(modal.key,"escape key press")})))}),$modalStack.open=function(modalInstance,modal){openedWindows.add(modalInstance,{deferred:modal.deferred,modalScope:modal.scope,backdrop:modal.backdrop,keyboard:modal.keyboard});var body=$document.find("body").eq(0),currBackdropIndex=backdropIndex();if(currBackdropIndex>=0&&!backdropDomEl){backdropScope=$rootScope.$new(!0),backdropScope.index=currBackdropIndex;var angularBackgroundDomEl=angular.element("<div modal-backdrop></div>");angularBackgroundDomEl.attr("backdrop-class",modal.backdropClass),backdropDomEl=$compile(angularBackgroundDomEl)(backdropScope),body.append(backdropDomEl)}var angularDomEl=angular.element("<div modal-window></div>");angularDomEl.attr({"template-url":modal.windowTemplateUrl,"window-class":modal.windowClass,size:modal.size,index:openedWindows.length()-1,animate:"animate"}).html(modal.content);var modalDomEl=$compile(angularDomEl)(modal.scope);openedWindows.top().value.modalDomEl=modalDomEl,body.append(modalDomEl),body.addClass(OPENED_MODAL_CLASS)},$modalStack.close=function(modalInstance,result){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.resolve(result),removeModalWindow(modalInstance))},$modalStack.dismiss=function(modalInstance,reason){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.reject(reason),removeModalWindow(modalInstance))},$modalStack.dismissAll=function(reason){for(var topModal=this.getTop();topModal;)this.dismiss(topModal.key,reason),topModal=this.getTop()},$modalStack.getTop=function(){return openedWindows.top()},$modalStack}]).provider("$modal",function(){var $modalProvider={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function($injector,$rootScope,$q,$http,$templateCache,$controller,$modalStack){function getTemplatePromise(options){return options.template?$q.when(options.template):$http.get(angular.isFunction(options.templateUrl)?options.templateUrl():options.templateUrl,{cache:$templateCache}).then(function(result){return result.data})}function getResolvePromises(resolves){var promisesArr=[];return angular.forEach(resolves,function(value){(angular.isFunction(value)||angular.isArray(value))&&promisesArr.push($q.when($injector.invoke(value)))}),promisesArr}var $modal={};return $modal.open=function(modalOptions){var modalResultDeferred=$q.defer(),modalOpenedDeferred=$q.defer(),modalInstance={result:modalResultDeferred.promise,opened:modalOpenedDeferred.promise,close:function(result){$modalStack.close(modalInstance,result)},dismiss:function(reason){$modalStack.dismiss(modalInstance,reason)}};if(modalOptions=angular.extend({},$modalProvider.options,modalOptions),modalOptions.resolve=modalOptions.resolve||{},!modalOptions.template&&!modalOptions.templateUrl)throw new Error("One of template or templateUrl options is required.");var templateAndResolvePromise=$q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));return templateAndResolvePromise.then(function(tplAndVars){var modalScope=(modalOptions.scope||$rootScope).$new();modalScope.$close=modalInstance.close,modalScope.$dismiss=modalInstance.dismiss;var ctrlInstance,ctrlLocals={},resolveIter=1;modalOptions.controller&&(ctrlLocals.$scope=modalScope,ctrlLocals.$modalInstance=modalInstance,angular.forEach(modalOptions.resolve,function(value,key){ctrlLocals[key]=tplAndVars[resolveIter++]}),ctrlInstance=$controller(modalOptions.controller,ctrlLocals),modalOptions.controllerAs&&(modalScope[modalOptions.controllerAs]=ctrlInstance)),$modalStack.open(modalInstance,{scope:modalScope,deferred:modalResultDeferred,content:tplAndVars[0],backdrop:modalOptions.backdrop,keyboard:modalOptions.keyboard,backdropClass:modalOptions.backdropClass,windowClass:modalOptions.windowClass,windowTemplateUrl:modalOptions.windowTemplateUrl,size:modalOptions.size})},function(reason){modalResultDeferred.reject(reason)}),templateAndResolvePromise.then(function(){modalOpenedDeferred.resolve(!0)},function(){modalOpenedDeferred.reject(!1)}),modalInstance},$modal}]};return $modalProvider}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function($scope,$attrs,$parse){var self=this,ngModelCtrl={$setViewValue:angular.noop},setNumPages=$attrs.numPages?$parse($attrs.numPages).assign:angular.noop;this.init=function(ngModelCtrl_,config){ngModelCtrl=ngModelCtrl_,this.config=config,ngModelCtrl.$render=function(){self.render()},$attrs.itemsPerPage?$scope.$parent.$watch($parse($attrs.itemsPerPage),function(value){self.itemsPerPage=parseInt(value,10),$scope.totalPages=self.calculateTotalPages()}):this.itemsPerPage=config.itemsPerPage},this.calculateTotalPages=function(){var totalPages=this.itemsPerPage<1?1:Math.ceil($scope.totalItems/this.itemsPerPage);return Math.max(totalPages||0,1)},this.render=function(){$scope.page=parseInt(ngModelCtrl.$viewValue,10)||1},$scope.selectPage=function(page){$scope.page!==page&&page>0&&page<=$scope.totalPages&&(ngModelCtrl.$setViewValue(page),ngModelCtrl.$render())},$scope.getText=function(key){return $scope[key+"Text"]||self.config[key+"Text"]},$scope.noPrevious=function(){return 1===$scope.page},$scope.noNext=function(){return $scope.page===$scope.totalPages},$scope.$watch("totalItems",function(){$scope.totalPages=self.calculateTotalPages()}),$scope.$watch("totalPages",function(value){setNumPages($scope.$parent,value),$scope.page>value?$scope.selectPage(value):ngModelCtrl.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function($parse,paginationConfig){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(scope,element,attrs,ctrls){function makePage(number,text,isActive){return{number:number,text:text,active:isActive}}function getPages(currentPage,totalPages){var pages=[],startPage=1,endPage=totalPages,isMaxSized=angular.isDefined(maxSize)&&totalPages>maxSize;isMaxSized&&(rotate?(startPage=Math.max(currentPage-Math.floor(maxSize/2),1),endPage=startPage+maxSize-1,endPage>totalPages&&(endPage=totalPages,startPage=endPage-maxSize+1)):(startPage=(Math.ceil(currentPage/maxSize)-1)*maxSize+1,endPage=Math.min(startPage+maxSize-1,totalPages)));for(var number=startPage;endPage>=number;number++){var page=makePage(number,number,number===currentPage);pages.push(page)}if(isMaxSized&&!rotate){if(startPage>1){var previousPageSet=makePage(startPage-1,"...",!1);pages.unshift(previousPageSet)}if(totalPages>endPage){var nextPageSet=makePage(endPage+1,"...",!1);pages.push(nextPageSet)}}return pages}var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];if(ngModelCtrl){var maxSize=angular.isDefined(attrs.maxSize)?scope.$parent.$eval(attrs.maxSize):paginationConfig.maxSize,rotate=angular.isDefined(attrs.rotate)?scope.$parent.$eval(attrs.rotate):paginationConfig.rotate;scope.boundaryLinks=angular.isDefined(attrs.boundaryLinks)?scope.$parent.$eval(attrs.boundaryLinks):paginationConfig.boundaryLinks,scope.directionLinks=angular.isDefined(attrs.directionLinks)?scope.$parent.$eval(attrs.directionLinks):paginationConfig.directionLinks,paginationCtrl.init(ngModelCtrl,paginationConfig),attrs.maxSize&&scope.$parent.$watch($parse(attrs.maxSize),function(value){maxSize=parseInt(value,10),paginationCtrl.render()});var originalRender=paginationCtrl.render;paginationCtrl.render=function(){originalRender(),scope.page>0&&scope.page<=scope.totalPages&&(scope.pages=getPages(scope.page,scope.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("pager",["pagerConfig",function(pagerConfig){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(scope,element,attrs,ctrls){var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&(scope.align=angular.isDefined(attrs.align)?scope.$parent.$eval(attrs.align):pagerConfig.align,paginationCtrl.init(ngModelCtrl,pagerConfig))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g,separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function($window,$compile,$timeout,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow,hide=triggerMap[show]||show;return{show:show,hide:hide}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<div "+directiveName+'-popup title="'+startSym+"title"+endSym+'" content="'+startSym+"content"+endSym+'" placement="'+startSym+"placement"+endSym+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(tElem,tAttrs){var tooltipLinker=$compile(template);return function(scope,element,attrs){function toggleTooltipBind(){ttScope.isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){(!hasEnableExp||scope.$eval(attrs[prefix+"Enable"]))&&(prepareTooltip(),ttScope.popupDelay?popupTimeout||(popupTimeout=$timeout(show,ttScope.popupDelay,!1),popupTimeout.then(function(reposition){reposition()})):show()())}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){return popupTimeout=null,transitionTimeout&&($timeout.cancel(transitionTimeout),transitionTimeout=null),ttScope.content?(createTooltip(),tooltip.css({top:0,left:0,display:"block"}),appendToBody?$document.find("body").append(tooltip):element.after(tooltip),positionTooltip(),ttScope.isOpen=!0,ttScope.$digest(),positionTooltip):angular.noop}function hide(){ttScope.isOpen=!1,$timeout.cancel(popupTimeout),popupTimeout=null,ttScope.animation?transitionTimeout||(transitionTimeout=$timeout(removeTooltip,500)):removeTooltip()}function createTooltip(){tooltip&&removeTooltip(),tooltipLinkedScope=ttScope.$new(),tooltip=tooltipLinker(tooltipLinkedScope,angular.noop)}function removeTooltip(){transitionTimeout=null,tooltip&&(tooltip.remove(),tooltip=null),tooltipLinkedScope&&(tooltipLinkedScope.$destroy(),tooltipLinkedScope=null)}function prepareTooltip(){prepPlacement(),prepPopupDelay()}function prepPlacement(){var val=attrs[prefix+"Placement"];ttScope.placement=angular.isDefined(val)?val:options.placement}function prepPopupDelay(){var val=attrs[prefix+"PopupDelay"],delay=parseInt(val,10);ttScope.popupDelay=isNaN(delay)?options.popupDelay:delay}function prepTriggers(){var val=attrs[prefix+"Trigger"];unregisterTriggers(),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind))}var tooltip,tooltipLinkedScope,transitionTimeout,popupTimeout,appendToBody=angular.isDefined(options.appendToBody)?options.appendToBody:!1,triggers=getTriggers(void 0),hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]),ttScope=scope.$new(!0),positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,ttScope.placement,appendToBody);ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition)};ttScope.isOpen=!1,attrs.$observe(type,function(val){ttScope.content=val,!val&&ttScope.isOpen&&hide()}),attrs.$observe(prefix+"Title",function(val){ttScope.title=val});var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)};prepTriggers();var animation=scope.$eval(attrs[prefix+"Animation"]);ttScope.animation=angular.isDefined(animation)?!!animation:options.animation;var appendToBodyVal=scope.$eval(attrs[prefix+"AppendToBody"]);appendToBody=angular.isDefined(appendToBodyVal)?appendToBodyVal:appendToBody,appendToBody&&scope.$on("$locationChangeSuccess",function(){ttScope.isOpen&&hide()}),scope.$on("$destroy",function(){$timeout.cancel(transitionTimeout),$timeout.cancel(popupTimeout),unregisterTriggers(),removeTooltip(),ttScope=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function($tooltip){return $tooltip("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function($scope,$attrs,progressConfig){var self=this,animate=angular.isDefined($attrs.animate)?$scope.$parent.$eval($attrs.animate):progressConfig.animate;this.bars=[],$scope.max=angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):progressConfig.max,this.addBar=function(bar,element){animate||element.css({transition:"none"}),this.bars.push(bar),bar.$watch("value",function(value){bar.percent=+(100*value/$scope.max).toFixed(2)}),bar.$on("$destroy",function(){element=null,self.removeBar(bar)})},this.removeBar=function(bar){this.bars.splice(this.bars.indexOf(bar),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,element)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,angular.element(element.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function($scope,$attrs,ratingConfig){var ngModelCtrl={$setViewValue:angular.noop};this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render,this.stateOn=angular.isDefined($attrs.stateOn)?$scope.$parent.$eval($attrs.stateOn):ratingConfig.stateOn,this.stateOff=angular.isDefined($attrs.stateOff)?$scope.$parent.$eval($attrs.stateOff):ratingConfig.stateOff;var ratingStates=angular.isDefined($attrs.ratingStates)?$scope.$parent.$eval($attrs.ratingStates):new Array(angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):ratingConfig.max);$scope.range=this.buildTemplateObjects(ratingStates)},this.buildTemplateObjects=function(states){for(var i=0,n=states.length;n>i;i++)states[i]=angular.extend({index:i},{stateOn:this.stateOn,stateOff:this.stateOff},states[i]);return states},$scope.rate=function(value){!$scope.readonly&&value>=0&&value<=$scope.range.length&&(ngModelCtrl.$setViewValue(value),ngModelCtrl.$render())},$scope.enter=function(value){$scope.readonly||($scope.value=value),$scope.onHover({value:value})},$scope.reset=function(){$scope.value=ngModelCtrl.$viewValue,$scope.onLeave()},$scope.onKeydown=function(evt){/(37|38|39|40)/.test(evt.which)&&(evt.preventDefault(),evt.stopPropagation(),$scope.rate($scope.value+(38===evt.which||39===evt.which?1:-1)))},this.render=function(){$scope.value=ngModelCtrl.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(scope,element,attrs,ctrls){var ratingCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&ratingCtrl.init(ngModelCtrl)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function($scope){var ctrl=this,tabs=ctrl.tabs=$scope.tabs=[];ctrl.select=function(selectedTab){angular.forEach(tabs,function(tab){tab.active&&tab!==selectedTab&&(tab.active=!1,tab.onDeselect())}),selectedTab.active=!0,selectedTab.onSelect()},ctrl.addTab=function(tab){tabs.push(tab),1===tabs.length?tab.active=!0:tab.active&&ctrl.select(tab)},ctrl.removeTab=function(tab){var index=tabs.indexOf(tab);if(tab.active&&tabs.length>1&&!destroyed){var newActiveIndex=index==tabs.length-1?index-1:index+1;ctrl.select(tabs[newActiveIndex])}tabs.splice(index,1)};var destroyed;$scope.$on("$destroy",function(){destroyed=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(scope,element,attrs){scope.vertical=angular.isDefined(attrs.vertical)?scope.$parent.$eval(attrs.vertical):!1,scope.justified=angular.isDefined(attrs.justified)?scope.$parent.$eval(attrs.justified):!1}}}).directive("tab",["$parse",function($parse){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(elm,attrs,transclude){return function(scope,elm,attrs,tabsetCtrl){scope.$watch("active",function(active){active&&tabsetCtrl.select(scope)}),scope.disabled=!1,attrs.disabled&&scope.$parent.$watch($parse(attrs.disabled),function(value){scope.disabled=!!value}),scope.select=function(){scope.disabled||(scope.active=!0)},tabsetCtrl.addTab(scope),scope.$on("$destroy",function(){tabsetCtrl.removeTab(scope)}),scope.$transcludeFn=transclude}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(scope,elm,attrs,tabCtrl){scope.$watch("headingElement",function(heading){heading&&(elm.html(""),elm.append(heading))})}}}]).directive("tabContentTransclude",function(){function isTabHeading(node){return node.tagName&&(node.hasAttribute("tab-heading")||node.hasAttribute("data-tab-heading")||"tab-heading"===node.tagName.toLowerCase()||"data-tab-heading"===node.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(scope,elm,attrs){var tab=scope.$eval(attrs.tabContentTransclude);tab.$transcludeFn(tab.$parent,function(contents){angular.forEach(contents,function(node){isTabHeading(node)?tab.headingElement=node:elm.append(node)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function($scope,$attrs,$parse,$log,$locale,timepickerConfig){function getHoursFromTemplate(){var hours=parseInt($scope.hours,10),valid=$scope.showMeridian?hours>0&&13>hours:hours>=0&&24>hours;return valid?($scope.showMeridian&&(12===hours&&(hours=0),$scope.meridian===meridians[1]&&(hours+=12)),hours):void 0}function getMinutesFromTemplate(){var minutes=parseInt($scope.minutes,10);return minutes>=0&&60>minutes?minutes:void 0}function pad(value){return angular.isDefined(value)&&value.toString().length<2?"0"+value:value}function refresh(keyboardChange){makeValid(),ngModelCtrl.$setViewValue(new Date(selected)),updateTemplate(keyboardChange)}function makeValid(){ngModelCtrl.$setValidity("time",!0),$scope.invalidHours=!1,$scope.invalidMinutes=!1}function updateTemplate(keyboardChange){var hours=selected.getHours(),minutes=selected.getMinutes();$scope.showMeridian&&(hours=0===hours||12===hours?12:hours%12),$scope.hours="h"===keyboardChange?hours:pad(hours),$scope.minutes="m"===keyboardChange?minutes:pad(minutes),$scope.meridian=selected.getHours()<12?meridians[0]:meridians[1]}function addMinutes(minutes){var dt=new Date(selected.getTime()+6e4*minutes);selected.setHours(dt.getHours(),dt.getMinutes()),refresh()}var selected=new Date,ngModelCtrl={$setViewValue:angular.noop},meridians=angular.isDefined($attrs.meridians)?$scope.$parent.$eval($attrs.meridians):timepickerConfig.meridians||$locale.DATETIME_FORMATS.AMPMS;this.init=function(ngModelCtrl_,inputs){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render;var hoursInputEl=inputs.eq(0),minutesInputEl=inputs.eq(1),mousewheel=angular.isDefined($attrs.mousewheel)?$scope.$parent.$eval($attrs.mousewheel):timepickerConfig.mousewheel;mousewheel&&this.setupMousewheelEvents(hoursInputEl,minutesInputEl),$scope.readonlyInput=angular.isDefined($attrs.readonlyInput)?$scope.$parent.$eval($attrs.readonlyInput):timepickerConfig.readonlyInput,this.setupInputEvents(hoursInputEl,minutesInputEl)};var hourStep=timepickerConfig.hourStep;$attrs.hourStep&&$scope.$parent.$watch($parse($attrs.hourStep),function(value){hourStep=parseInt(value,10)});var minuteStep=timepickerConfig.minuteStep;$attrs.minuteStep&&$scope.$parent.$watch($parse($attrs.minuteStep),function(value){minuteStep=parseInt(value,10)}),$scope.showMeridian=timepickerConfig.showMeridian,$attrs.showMeridian&&$scope.$parent.$watch($parse($attrs.showMeridian),function(value){if($scope.showMeridian=!!value,ngModelCtrl.$error.time){var hours=getHoursFromTemplate(),minutes=getMinutesFromTemplate();angular.isDefined(hours)&&angular.isDefined(minutes)&&(selected.setHours(hours),refresh())}else updateTemplate()}),this.setupMousewheelEvents=function(hoursInputEl,minutesInputEl){var isScrollingUp=function(e){e.originalEvent&&(e=e.originalEvent);var delta=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||delta>0};hoursInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementHours():$scope.decrementHours()),e.preventDefault()}),minutesInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementMinutes():$scope.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(hoursInputEl,minutesInputEl){if($scope.readonlyInput)return $scope.updateHours=angular.noop,void($scope.updateMinutes=angular.noop);var invalidate=function(invalidHours,invalidMinutes){ngModelCtrl.$setViewValue(null),ngModelCtrl.$setValidity("time",!1),angular.isDefined(invalidHours)&&($scope.invalidHours=invalidHours),angular.isDefined(invalidMinutes)&&($scope.invalidMinutes=invalidMinutes)};$scope.updateHours=function(){var hours=getHoursFromTemplate();angular.isDefined(hours)?(selected.setHours(hours),refresh("h")):invalidate(!0)},hoursInputEl.bind("blur",function(e){!$scope.invalidHours&&$scope.hours<10&&$scope.$apply(function(){$scope.hours=pad($scope.hours)})}),$scope.updateMinutes=function(){var minutes=getMinutesFromTemplate();angular.isDefined(minutes)?(selected.setMinutes(minutes),refresh("m")):invalidate(void 0,!0)},minutesInputEl.bind("blur",function(e){!$scope.invalidMinutes&&$scope.minutes<10&&$scope.$apply(function(){$scope.minutes=pad($scope.minutes)})})},this.render=function(){var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;isNaN(date)?(ngModelCtrl.$setValidity("time",!1),$log.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(date&&(selected=date),makeValid(),updateTemplate())},$scope.incrementHours=function(){addMinutes(60*hourStep)},$scope.decrementHours=function(){addMinutes(60*-hourStep)},$scope.incrementMinutes=function(){addMinutes(minuteStep)},$scope.decrementMinutes=function(){addMinutes(-minuteStep)},$scope.toggleMeridian=function(){addMinutes(720*(selected.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(scope,element,attrs,ctrls){var timepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&timepickerCtrl.init(ngModelCtrl,element.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function($parse){var TYPEAHEAD_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;
return{parse:function(input){var match=input.match(TYPEAHEAD_REGEXP);if(!match)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+input+'".');return{itemName:match[3],source:$parse(match[4]),viewMapper:$parse(match[2]||match[1]),modelMapper:$parse(match[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function($compile,$parse,$q,$timeout,$document,$position,typeaheadParser){var HOT_KEYS=[9,13,27,38,40];return{require:"ngModel",link:function(originalScope,element,attrs,modelCtrl){var hasFocus,minSearch=originalScope.$eval(attrs.typeaheadMinLength)||1,waitTime=originalScope.$eval(attrs.typeaheadWaitMs)||0,isEditable=originalScope.$eval(attrs.typeaheadEditable)!==!1,isLoadingSetter=$parse(attrs.typeaheadLoading).assign||angular.noop,onSelectCallback=$parse(attrs.typeaheadOnSelect),inputFormatter=attrs.typeaheadInputFormatter?$parse(attrs.typeaheadInputFormatter):void 0,appendToBody=attrs.typeaheadAppendToBody?originalScope.$eval(attrs.typeaheadAppendToBody):!1,focusFirst=originalScope.$eval(attrs.typeaheadFocusFirst)!==!1,$setModelValue=$parse(attrs.ngModel).assign,parserResult=typeaheadParser.parse(attrs.typeahead),scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()});var popupId="typeahead-"+scope.$id+"-"+Math.floor(1e4*Math.random());element.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":popupId});var popUpEl=angular.element("<div typeahead-popup></div>");popUpEl.attr({id:popupId,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(attrs.typeaheadTemplateUrl)&&popUpEl.attr("template-url",attrs.typeaheadTemplateUrl);var resetMatches=function(){scope.matches=[],scope.activeIdx=-1,element.attr("aria-expanded",!1)},getMatchId=function(index){return popupId+"-option-"+index};scope.$watch("activeIdx",function(index){0>index?element.removeAttr("aria-activedescendant"):element.attr("aria-activedescendant",getMatchId(index))});var getMatchesAsync=function(inputValue){var locals={$viewValue:inputValue};isLoadingSetter(originalScope,!0),$q.when(parserResult.source(originalScope,locals)).then(function(matches){var onCurrentRequest=inputValue===modelCtrl.$viewValue;if(onCurrentRequest&&hasFocus)if(matches.length>0){scope.activeIdx=focusFirst?0:-1,scope.matches.length=0;for(var i=0;i<matches.length;i++)locals[parserResult.itemName]=matches[i],scope.matches.push({id:getMatchId(i),label:parserResult.viewMapper(scope,locals),model:matches[i]});scope.query=inputValue,scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),element.attr("aria-expanded",!0)}else resetMatches();onCurrentRequest&&isLoadingSetter(originalScope,!1)},function(){resetMatches(),isLoadingSetter(originalScope,!1)})};resetMatches(),scope.query=void 0;var timeoutPromise,scheduleSearchWithTimeout=function(inputValue){timeoutPromise=$timeout(function(){getMatchesAsync(inputValue)},waitTime)},cancelPreviousTimeout=function(){timeoutPromise&&$timeout.cancel(timeoutPromise)};modelCtrl.$parsers.unshift(function(inputValue){return hasFocus=!0,inputValue&&inputValue.length>=minSearch?waitTime>0?(cancelPreviousTimeout(),scheduleSearchWithTimeout(inputValue)):getMatchesAsync(inputValue):(isLoadingSetter(originalScope,!1),cancelPreviousTimeout(),resetMatches()),isEditable?inputValue:inputValue?void modelCtrl.$setValidity("editable",!1):(modelCtrl.$setValidity("editable",!0),inputValue)}),modelCtrl.$formatters.push(function(modelValue){var candidateViewValue,emptyViewValue,locals={};return inputFormatter?(locals.$model=modelValue,inputFormatter(originalScope,locals)):(locals[parserResult.itemName]=modelValue,candidateViewValue=parserResult.viewMapper(originalScope,locals),locals[parserResult.itemName]=void 0,emptyViewValue=parserResult.viewMapper(originalScope,locals),candidateViewValue!==emptyViewValue?candidateViewValue:modelValue)}),scope.select=function(activeIdx){var model,item,locals={};locals[parserResult.itemName]=item=scope.matches[activeIdx].model,model=parserResult.modelMapper(originalScope,locals),$setModelValue(originalScope,model),modelCtrl.$setValidity("editable",!0),onSelectCallback(originalScope,{$item:item,$model:model,$label:parserResult.viewMapper(originalScope,locals)}),resetMatches(),$timeout(function(){element[0].focus()},0,!1)},element.bind("keydown",function(evt){0!==scope.matches.length&&-1!==HOT_KEYS.indexOf(evt.which)&&(-1!=scope.activeIdx||13!==evt.which&&9!==evt.which)&&(evt.preventDefault(),40===evt.which?(scope.activeIdx=(scope.activeIdx+1)%scope.matches.length,scope.$digest()):38===evt.which?(scope.activeIdx=(scope.activeIdx>0?scope.activeIdx:scope.matches.length)-1,scope.$digest()):13===evt.which||9===evt.which?scope.$apply(function(){scope.select(scope.activeIdx)}):27===evt.which&&(evt.stopPropagation(),resetMatches(),scope.$digest()))}),element.bind("blur",function(evt){hasFocus=!1});var dismissClickHandler=function(evt){element[0]!==evt.target&&(resetMatches(),scope.$digest())};$document.bind("click",dismissClickHandler),originalScope.$on("$destroy",function(){$document.unbind("click",dismissClickHandler),appendToBody&&$popup.remove()});var $popup=$compile(popUpEl)(scope);appendToBody?$document.find("body").append($popup):element.after($popup)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(scope,element,attrs){scope.templateUrl=attrs.templateUrl,scope.isOpen=function(){return scope.matches.length>0},scope.isActive=function(matchIdx){return scope.active==matchIdx},scope.selectActive=function(matchIdx){scope.active=matchIdx},scope.selectMatch=function(activeIdx){scope.select({activeIdx:activeIdx})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function($http,$templateCache,$compile,$parse){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(scope,element,attrs){var tplUrl=$parse(attrs.templateUrl)(scope.$parent)||"template/typeahead/typeahead-match.html";$http.get(tplUrl,{cache:$templateCache}).success(function(tplContent){element.replaceWith($compile(tplContent.trim())(scope))})}}}]).filter("typeaheadHighlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query?(""+matchItem).replace(new RegExp(escapeRegexp(query),"gi"),"<strong>$&</strong>"):matchItem}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading" ng-click="toggleOpen()">\n    <h4 class="panel-title">\n      <span class="accordion-toggle" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></span>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group pull-left">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind-html="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]);
(function(){function baseCompareAscending(value,other){if(value!==other){var valIsNull=null===value,valIsUndef=value===undefined,valIsReflexive=value===value,othIsNull=null===other,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive)return 1;if(other>value&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive)return-1}return 0}function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIsFunction(value){return"function"==typeof value||!1}function baseToString(value){return null==value?"":value+""}function charsLeftIndex(string,chars){for(var index=-1,length=string.length;++index<length&&chars.indexOf(string.charAt(index))>-1;);return index}function charsRightIndex(string,chars){for(var index=string.length;index--&&chars.indexOf(string.charAt(index))>-1;);return index}function compareAscending(object,other){return baseCompareAscending(object.criteria,other.criteria)||object.index-other.index}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=baseCompareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;var order=orders[index];return result*("asc"===order||order===!0?1:-1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeRegExpChar(chr,leadingChar,whitespaceChar){return leadingChar?chr=regexpEscapes[chr]:whitespaceChar&&(chr=stringEscapes[chr]),"\\"+chr}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}function isObjectLike(value){return!!value&&"object"==typeof value}function isSpace(charCode){return 160>=charCode&&charCode>=9&&13>=charCode||32==charCode||160==charCode||5760==charCode||6158==charCode||charCode>=8192&&(8202>=charCode||8232==charCode||8233==charCode||8239==charCode||8287==charCode||12288==charCode||65279==charCode)}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}function sortedUniq(array,iteratee){for(var seen,index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;index&&seen===computed||(seen=computed,result[++resIndex]=value)}return result}function trimmedLeftIndex(string){for(var index=-1,length=string.length;++index<length&&isSpace(string.charCodeAt(index)););return index}function trimmedRightIndex(string){for(var index=string.length;index--&&isSpace(string.charCodeAt(index)););return index}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll,actions){this.__wrapped__=value,this.__actions__=actions||[],this.__chain__=!!chainAll}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=POSITIVE_INFINITY,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=arrayCopy(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=arrayCopy(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=arrayCopy(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=0>dir,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||LARGE_ARRAY_SIZE>arrLength||arrLength==length&&takeCount==length)return baseWrapperValue(array,this.__actions__);var result=[];outer:for(;length--&&takeCount>resIndex;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function MapCache(){this.__data__={}}function mapDelete(key){return this.has(key)&&delete this.__data__[key]}function mapGet(key){return"__proto__"==key?undefined:this.__data__[key]}function mapHas(key){return"__proto__"!=key&&hasOwnProperty.call(this.__data__,key)}function mapSet(key,value){return"__proto__"!=key&&(this.__data__[key]=value),this}function SetCache(values){var length=values?values.length:0;for(this.data={hash:nativeCreate(null),set:new Set};length--;)this.push(values[length])}function cacheIndexOf(cache,value){var data=cache.data,result="string"==typeof value||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1}function cachePush(value){var data=this.data;"string"==typeof value||isObject(value)?data.set.add(value):data.hash[value]=!0}function arrayConcat(array,other){for(var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);++index<length;)result[index]=array[index];for(;++othIndex<othLength;)result[index++]=other[othIndex];return result}function arrayCopy(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function arrayEachRight(array,iteratee){for(var length=array.length;length--&&iteratee(array[length],length,array)!==!1;);return array}function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayExtremum(array,iteratee,comparator,exValue){for(var index=-1,length=array.length,computed=exValue,result=computed;++index<length;){var value=array[index],current=+iteratee(value);comparator(current,computed)&&(computed=current,result=value)}return result}function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;for(initFromArray&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initFromArray){var length=array.length;for(initFromArray&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function arraySum(array,iteratee){for(var length=array.length,result=0;length--;)result+=+iteratee(array[length])||0;return result}function assignDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:objectValue}function assignOwnDefaults(objectValue,sourceValue,key,object){return objectValue!==undefined&&hasOwnProperty.call(object,key)?objectValue:sourceValue}function assignWith(object,source,customizer){for(var index=-1,props=keys(source),length=props.length;++index<length;){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);(result===result?result===value:value!==value)&&(value!==undefined||key in object)||(object[key]=result)}return object}function baseAssign(object,source){return null==source?object:baseCopy(source,keys(source),object)}function baseAt(collection,props){for(var index=-1,isNil=null==collection,isArr=!isNil&&isArrayLike(collection),length=isArr?collection.length:0,propsLength=props.length,result=Array(propsLength);++index<propsLength;){var key=props[index];isArr?result[index]=isIndex(key,length)?collection[key]:undefined:result[index]=isNil?undefined:collection[key]}return result}function baseCopy(source,props,object){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index];object[key]=source[key]}return object}function baseCallback(func,thisArg,argCount){var type=typeof func;return"function"==type?thisArg===undefined?func:bindCallback(func,thisArg,argCount):null==func?identity:"object"==type?baseMatches(func):thisArg===undefined?property(func):baseMatchesProperty(func,thisArg)}function baseClone(value,isDeep,customizer,key,object,stackA,stackB){var result;if(customizer&&(result=object?customizer(value,key,object):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return arrayCopy(value,result)}else{var tag=objToString.call(value),isFunc=tag==funcTag;if(tag!=objectTag&&tag!=argsTag&&(!isFunc||object))return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};if(result=initCloneObject(isFunc?{}:value),!isDeep)return baseAssign(result,value)}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return stackA.push(value),stackB.push(result),(isArr?arrayEach:baseForOwn)(value,function(subValue,key){result[key]=baseClone(subValue,isDeep,customizer,key,value,stackA,stackB)}),result}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=getIndexOf(),isCommon=indexOf===baseIndexOf,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:for(;++index<length;){var value=array[index];if(isCommon&&value===value){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===value)continue outer;result.push(value)}else indexOf(values,value,0)<0&&result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(collection,iteratee,comparator,exValue){var computed=exValue,result=computed;return baseEach(collection,function(value,index,collection){var current=+iteratee(value,index,collection);(comparator(current,computed)||current===exValue&&current===result)&&(computed=current,result=value)}),result}function baseFill(array,value,start,end){var length=array.length;for(start=null==start?0:+start||0,0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,0>end&&(end+=length),length=start>end?0:end>>>0,start>>>=0;length>start;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){return predicate(value,key,collection)?(result=retKey?key:value,!1):void 0}),result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return baseForRight(object,iteratee,keys)}function baseFunctions(object,props){for(var index=-1,length=props.length,resIndex=-1,result=[];++index<length;){var key=props[index];isFunction(object[key])&&(result[++resIndex]=key)}return result}function baseGet(object,path,pathKey){if(null!=object){pathKey!==undefined&&pathKey in toObject(object)&&(path=[pathKey]);for(var index=0,length=path.length;null!=object&&length>index;)object=object[path[index++]];return index&&index==length?object:undefined}}function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other?!0:null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB)}function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result}function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=toObject(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1}}return!0}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null==object?!1:object[key]===value&&(value!==undefined||key in toObject(object))}}return function(object){return baseIsMatch(object,matchData)}}function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";return path=toPath(path),function(object){if(null==object)return!1;var key=pathKey;if(object=toObject(object),(isArr||!isCommon)&&!(key in object)){if(object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;key=last(path),object=toObject(object)}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,!0)}}function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object))return object;var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);return arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObjectLike(srcValue))stackA||(stackA=[]),stackB||(stackB=[]),baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue),result===undefined&&(!isSrcArr||key in object)||!isCommon&&(result===result?result===value:value!==value)||(object[key]=result)}}),object}function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){for(var length=stackA.length,srcValue=source[key];length--;)if(stackA[length]==srcValue)return void(object[key]=stackB[length]);var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue,isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))?result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]:isPlainObject(srcValue)||isArguments(srcValue)?result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}:isCommon=!1),stackA.push(srcValue),stackB.push(result),isCommon?object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB):(result===result?result!==value:value===value)&&(object[key]=result)}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyDeep(path){var pathKey=path+"";return path=toPath(path),function(object){return baseGet(object,path,pathKey)}}function basePullAt(array,indexes){for(var length=array?indexes.length:0;length--;){var index=indexes[length];if(index!=previous&&isIndex(index)){var previous=index;splice.call(array,index,1)}}return array}function baseRandom(min,max){return min+nativeFloor(nativeRandom()*(max-min+1))}function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSlice(array,start,end){var index=-1,length=array.length;start=null==start?0:+start||0,0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,0>end&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return result=predicate(value,index,collection),!result}),!!result}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSortByOrder(collection,iteratees,orders){var callback=getCallback(),index=-1;iteratees=arrayMap(iteratees,function(iteratee){return callback(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function baseSum(collection,iteratee){var result=0;return baseEach(collection,function(value,index,collection){result+=+iteratee(value,index,collection)||0}),result}function baseUniq(array,iteratee){var index=-1,indexOf=getIndexOf(),length=array.length,isCommon=indexOf===baseIndexOf,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];seen?(indexOf=cacheIndexOf,isCommon=!1):(isLarge=!1,seen=iteratee?[]:result);outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else indexOf(seen,computed,0)<0&&((iteratee||isLarge)&&seen.push(computed),result.push(value))}return result}function baseValues(object,props){for(var index=-1,length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;result instanceof LazyWrapper&&(result=result.value());for(var index=-1,length=actions.length;++index<length;){var action=actions[index];result=action.func.apply(action.thisArg,arrayPush([result],action.args))}return result}function binaryIndex(array,value,retHighest){var low=0,high=array?array.length:low;if("number"==typeof value&&value===value&&HALF_MAX_ARRAY_LENGTH>=high){for(;high>low;){var mid=low+high>>>1,computed=array[mid];(retHighest?value>=computed:value>computed)&&null!==computed?low=mid+1:high=mid}return high}return binaryIndexBy(array,value,identity,retHighest)}function binaryIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=null===value,valIsUndef=value===undefined;high>low;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN)var setLow=isReflexive||retHighest;else setLow=valIsNull?isReflexive&&isDef&&(retHighest||null!=computed):valIsUndef?isReflexive&&(retHighest||isDef):null==computed?!1:retHighest?value>=computed:value>computed;setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function bindCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if(thisArg===undefined)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}function bufferClone(buffer){var result=new ArrayBuffer(buffer.byteLength),view=new Uint8Array(result);return view.set(new Uint8Array(buffer)),result}function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=getCallback(iteratee,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)});return result}}function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=null==object?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;for("function"==typeof customizer?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer="function"==typeof thisArg?thisArg:undefined,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=3>length?undefined:customizer,length=1);++index<length;){var source=sources[index];source&&assigner(object,source,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);for(var index=fromRight?length:-1,iterable=toObject(collection);(fromRight?index--:++index<length)&&iteratee(iterable[index],index,iterable)!==!1;);return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;fromRight?index--:++index<length;){var key=props[index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function createBindWrapper(func,thisArg){function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(thisArg,arguments)}var Ctor=createCtorWrapper(func);return wrapper}function createCache(values){return nativeCreate&&Set?new SetCache(values):null}function createCompounder(callback){return function(string){for(var index=-1,array=words(deburr(string)),length=array.length,result="";++index<length;)result=callback(result,array[index],index);return result}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(flag){function curryFunc(func,arity,guard){guard&&isIterateeCall(func,arity,guard)&&(arity=undefined);var result=createWrapper(func,flag,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryFunc.placeholder,result}return curryFunc}function createDefaults(assigner,customizer){return restParam(function(args){var object=args[0];return null==object?object:(args.push(customizer),assigner.apply(undefined,args))})}function createExtremum(comparator,exValue){return function(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length){collection=isArray(collection)?collection:toIterable(collection);var result=arrayExtremum(collection,iteratee,comparator,exValue);if(!collection.length||result!==exValue)return result}return baseExtremum(collection,iteratee,comparator,exValue)}}function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=getCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,eachFunc)}}function createFindIndex(fromRight){return function(array,predicate,thisArg){return array&&array.length?(predicate=getCallback(predicate,thisArg,3),baseFindIndex(array,predicate,fromRight)):-1}}function createFindKey(objectFunc){return function(object,predicate,thisArg){return predicate=getCallback(predicate,thisArg,3),baseFind(object,predicate,objectFunc,!0)}}function createFlow(fromRight){return function(){for(var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);fromRight?index--:++index<length;){var func=funcs[leftIndex++]=arguments[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);!wrapper&&LodashWrapper.prototype.thru&&"wrapper"==getFuncName(func)&&(wrapper=new LodashWrapper([],!0))}for(index=wrapper?-1:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE)return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}}}function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}function createForIn(objectFunc){return function(object,iteratee,thisArg){return("function"!=typeof iteratee||thisArg!==undefined)&&(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee,keysIn)}}function createForOwn(objectFunc){return function(object,iteratee,thisArg){return("function"!=typeof iteratee||thisArg!==undefined)&&(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee)}}function createObjectMapper(isMapKeys){return function(object,iteratee,thisArg){var result={};return iteratee=getCallback(iteratee,thisArg,3),baseForOwn(object,function(value,key,object){var mapped=iteratee(value,key,object);key=isMapKeys?mapped:key,value=isMapKeys?value:mapped,result[key]=value}),result}}function createPadDir(fromRight){return function(string,length,chars){return string=baseToString(string),(fromRight?string:"")+createPadding(string,length,chars)+(fromRight?"":string)}}function createPartial(flag){var partialFunc=restParam(function(func,partials){var holders=replaceHolders(partials,partialFunc.placeholder);return createWrapper(func,flag,undefined,partials,holders)});return partialFunc}function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,getCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc);
}}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if(length-=argsHolders.length,arity>length){var newArgPos=argPos?arrayCopy(argPos):undefined,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:undefined,newHoldersRight=isCurry?undefined:argsHolders,newPartials=isCurry?args:undefined,newPartialsRight=isCurry?undefined:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),isCurryBound||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(undefined,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos&&(args=reorder(args,argPos)),isAry&&ary<args.length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(func)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);return wrapper}function createPadding(string,length,chars){var strLength=string.length;if(length=+length,strLength>=length||!nativeIsFinite(length))return"";var padLength=length-strLength;return chars=null==chars?" ":chars+"",repeat(chars,nativeCeil(padLength/chars.length)).slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createRound(methodName){var func=Math[methodName];return function(number,precision){return precision=precision===undefined?0:+precision||0,precision?(precision=pow(10,precision),func(number*precision)/precision):func(number)}}function createSortedIndex(retHighest){return function(array,value,iteratee,thisArg){var callback=getCallback(iteratee);return null==iteratee&&callback===baseCallback?binaryIndex(array,value,retHighest):binaryIndexBy(array,value,callback(iteratee,thisArg,1),retHighest)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=undefined),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&(mergeData(newData,data),bitmask=newData[1],arity=newData[9]),newData[9]=null==arity?isBindKey?0:func.length:nativeMax(arity-length,0)||0,bitmask==BIND_FLAG)var result=createBindWrapper(newData[0],newData[2]);else result=bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||newData[4].length?createHybridWrapper.apply(undefined,newData):createPartialWrapper.apply(undefined,newData);var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;for(;++index<arrLength;){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result)continue;return!1}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)}))return!1}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))return!1}return!0}function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return!1}function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1}for(var skipCtor=isLoose;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor="constructor"==key)}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor))return!1}return!0}function getCallback(func,thisArg,argCount){var result=lodash.callback||callback;return result=result===callback?baseCallback:result,argCount?result(func,thisArg,argCount):result}function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=array?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getIndexOf(collection,target,fromIndex){var result=lodash.indexOf||indexOf;return result=result===indexOf?baseIndexOf:result,collection?result(collection,target,fromIndex):result}function getMatchData(object){for(var result=pairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}function getNative(object,key){var value=null==object?undefined:object[key];return isNative(value)?value:undefined}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){var Ctor=object.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor||(Ctor=Object),new Ctor}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return bufferClone(object);case boolTag:case dateTag:return new Ctor(+object);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:var buffer=object.buffer;return new Ctor(isDeep?bufferClone(buffer):buffer,object.byteOffset,object.length);case numberTag:case stringTag:return new Ctor(object);case regexpTag:var result=new Ctor(object.source,reFlags.exec(object));result.lastIndex=object.lastIndex}return result}function invokePath(object,path,args){null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),path=last(path));var func=null==object?object:object[path];return null==func?undefined:func.apply(object,args)}function isArrayLike(value){return null!=value&&isLength(getLength(value))}function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&length>value}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;if("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object){var other=object[index];return value===value?value===other:other!==other}return!1}function isKey(value,object){var type=typeof value;if("string"==type&&reIsPlainProp.test(value)||"number"==type)return!0;if(isArray(value))return!1;var result=!reIsDeepProp.test(value);return result||null!=object&&value in toObject(object)}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&MAX_SAFE_INTEGER>=value}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=ARY_FLAG>newBitmask,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])),value=source[7],value&&(data[7]=arrayCopy(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function mergeDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:merge(objectValue,sourceValue,mergeDefaults)}function pickByArray(object,props){object=toObject(object);for(var index=-1,length=props.length,result={};++index<length;){var key=props[index];key in object&&(result[key]=object[key])}return result}function pickByCallback(object,predicate){var result={};return baseForIn(object,function(value,key,object){predicate(value,key,object)&&(result[key]=value)}),result}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function shimKeys(object){for(var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length,allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)),index=-1,result=[];++index<propsLength;){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key)}return result}function toIterable(value){return null==value?[]:isArrayLike(value)?isObject(value)?value:Object(value):values(value)}function toObject(value){return isObject(value)?value:Object(value)}function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):null==size)?1:nativeMax(nativeFloor(size)||1,1);for(var index=0,length=array?array.length:0,resIndex=-1,result=Array(nativeCeil(length/size));length>index;)result[++resIndex]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=array?array.length:0,resIndex=-1,result=[];++index<length;){var value=array[index];value&&(result[++resIndex]=value)}return result}function drop(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0>n?0:n)):[]}function dropRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0,0>n?0:n)):[]}function dropRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0,!0):[]}function dropWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0):[]}function fill(array,value,start,end){var length=array?array.length:0;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function first(array){return array?array[0]:undefined}function flatten(array,isDeep,guard){var length=array?array.length:0;return guard&&isIterateeCall(array,isDeep,guard)&&(isDeep=!1),length?baseFlatten(array,isDeep):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[]}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;if("number"==typeof fromIndex)fromIndex=0>fromIndex?nativeMax(length+fromIndex,0):fromIndex;else if(fromIndex){var index=binaryIndex(array,value);return length>index&&(value===value?value===array[index]:array[index]!==array[index])?index:-1}return baseIndexOf(array,value,fromIndex||0)}function initial(array){return dropRight(array,1)}function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;var index=length;if("number"==typeof fromIndex)index=(0>fromIndex?nativeMax(length+fromIndex,0):nativeMin(fromIndex||0,length-1))+1;else if(fromIndex){index=binaryIndex(array,value,!0)-1;var other=array[index];return(value===value?value===other:other!==other)?index:-1}if(value!==value)return indexOfNaN(array,index,!0);for(;index--;)if(array[index]===value)return index;return-1}function pull(){var args=arguments,array=args[0];if(!array||!array.length)return array;for(var index=0,indexOf=getIndexOf(),length=args.length;++index<length;)for(var fromIndex=0,value=args[index];(fromIndex=indexOf(array,value,fromIndex))>-1;)splice.call(array,fromIndex,1);return array}function remove(array,predicate,thisArg){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getCallback(predicate,thisArg,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function rest(array){return drop(array,1)}function slice(array,start,end){var length=array?array.length:0;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)&&(start=0,end=length),baseSlice(array,start,end)):[]}function take(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0,0>n?0:n)):[]}function takeRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0>n?0:n)):[]}function takeRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!1,!0):[]}function takeWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3)):[]}function uniq(array,isSorted,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];null!=isSorted&&"boolean"!=typeof isSorted&&(thisArg=iteratee,iteratee=isIterateeCall(array,isSorted,thisArg)?undefined:isSorted,isSorted=!1);var callback=getCallback();return(null!=iteratee||callback!==baseCallback)&&(iteratee=callback(iteratee,thisArg,3)),isSorted&&getIndexOf()===baseIndexOf?sortedUniq(array,iteratee):baseUniq(array,iteratee)}function unzip(array){if(!array||!array.length)return[];var index=-1,length=0;array=arrayFilter(array,function(group){return isArrayLike(group)?(length=nativeMax(group.length,length),!0):void 0});for(var result=Array(length);++index<length;)result[index]=arrayMap(array,baseProperty(index));return result}function unzipWith(array,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];var result=unzip(array);return null==iteratee?result:(iteratee=bindCallback(iteratee,thisArg,4),arrayMap(result,function(group){return arrayReduce(group,iteratee,undefined,!0)}))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArrayLike(array))var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array}return result?baseUniq(result):[]}function zipObject(props,values){var index=-1,length=props?props.length:0,result={};for(!length||values||isArray(props[0])||(values=[]);++index<length;){var key=props[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor,thisArg){return interceptor.call(thisArg,value),value}function thru(value,interceptor,thisArg){return interceptor.call(thisArg,value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__,interceptor=function(value){return value.reverse()};if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(interceptor)}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),("function"!=typeof predicate||thisArg!==undefined)&&(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,predicate)}function findWhere(collection,source){return find(collection,baseMatches(source))}function includes(collection,target,fromIndex,guard){var length=collection?getLength(collection):0;return isLength(length)||(collection=values(collection),length=collection.length),fromIndex="number"!=typeof fromIndex||guard&&isIterateeCall(target,fromIndex,guard)?0:0>fromIndex?nativeMax(length+fromIndex,0):fromIndex||0,"string"==typeof collection||!isArray(collection)&&isString(collection)?length>=fromIndex&&collection.indexOf(target,fromIndex)>-1:!!length&&getIndexOf(collection,target,fromIndex)>-1}function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=getCallback(iteratee,thisArg,3),func(collection,iteratee)}function pluck(collection,path){return map(collection,property(path))}function reject(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):null==n){collection=toIterable(collection);var length=collection.length;return length>0?collection[baseRandom(0,length-1)]:undefined}var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;for(n=nativeMin(0>n?0:+n||0,length);++index<n;){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index],result[index]=value}return result.length=n,result}function shuffle(collection){return sample(collection,POSITIVE_INFINITY)}function size(collection){var length=collection?getLength(collection):0;return isLength(length)?length:keys(collection).length}function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),("function"!=typeof predicate||thisArg!==undefined)&&(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function sortBy(collection,iteratee,thisArg){if(null==collection)return[];thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined);var index=-1;iteratee=getCallback(iteratee,thisArg,3);var result=baseMap(collection,function(value,key,collection){return{criteria:iteratee(value,key,collection),index:++index,value:value}});return baseSortBy(result,compareAscending)}function sortByOrder(collection,iteratees,orders,guard){return null==collection?[]:(guard&&isIterateeCall(iteratees,orders,guard)&&(orders=undefined),isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),isArray(orders)||(orders=null==orders?[]:[orders]),baseSortByOrder(collection,iteratees,orders))}function where(collection,source){return filter(collection,baseMatches(source))}function after(n,func){if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return n=nativeIsFinite(n=+n)?n:0,function(){return--n<1?func.apply(this,arguments):void 0}}function ary(func,n,guard){return guard&&isIterateeCall(func,n,guard)&&(n=undefined),n=func&&null==n?func.length:nativeMax(+n||0,0),createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return function(){return--n>0&&(result=func.apply(this,arguments)),1>=n&&(func=undefined),result}}function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined))}function delayed(){var remaining=wait-(now()-stamp);0>=remaining||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=0>=remaining||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=undefined),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(wait=0>wait?0:+wait||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait),trailing="trailing"in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new memoize.Cache,memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}function restParam(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:+start||0,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);++index<length;)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs)}}function spread(func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return function(array){return func.apply(this,array)}}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}function wrap(value,wrapper){return wrapper=null==wrapper?identity:wrapper,createWrapper(wrapper,PARTIAL_FLAG,undefined,[value],[])}function clone(value,isDeep,customizer,thisArg){return isDeep&&"boolean"!=typeof isDeep&&isIterateeCall(value,isDeep,customizer)?isDeep=!1:"function"==typeof isDeep&&(thisArg=customizer,customizer=isDeep,isDeep=!1),"function"==typeof customizer?baseClone(value,isDeep,bindCallback(customizer,thisArg,3)):baseClone(value,isDeep)}function cloneDeep(value,customizer,thisArg){return"function"==typeof customizer?baseClone(value,!0,bindCallback(customizer,thisArg,3)):baseClone(value,!0)}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&objToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objToString.call(value)==dateTag}function isElement(value){return!!value&&1===value.nodeType&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){return null==value?!0:isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))?!value.length:!keys(value).length}function isEqual(value,other,customizer,thisArg){customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&"string"==typeof value.message&&objToString.call(value)==errorTag}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isMatch(object,source,customizer,thisArg){return customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined,baseIsMatch(object,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){return null==value?!1:isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value)}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objToString.call(value)==numberTag}function isPlainObject(value){var Ctor;if(!isObjectLike(value)||objToString.call(value)!=objectTag||isArguments(value)||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,"function"==typeof Ctor&&!(Ctor instanceof Ctor)))return!1;var result;return baseForIn(value,function(subValue,key){result=key}),result===undefined||hasOwnProperty.call(value,result)}function isRegExp(value){return isObject(value)&&objToString.call(value)==regexpTag}function isString(value){return"string"==typeof value||isObjectLike(value)&&objToString.call(value)==stringTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return other>value}function lte(value,other){return other>=value}function toArray(value){var length=value?getLength(value):0;return isLength(length)?length?arrayCopy(value):[]:values(value)}function toPlainObject(value){return baseCopy(value,keysIn(value))}function create(prototype,properties,guard){var result=baseCreate(prototype);return guard&&isIterateeCall(prototype,properties,guard)&&(properties=undefined),properties?baseAssign(result,properties):result}function functions(object){return baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,toPath(path),path+"");return result===undefined?defaultValue:result}function has(object,path){if(null==object)return!1;var result=hasOwnProperty.call(object,path);if(!result&&!isKey(path)){if(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;path=last(path),result=hasOwnProperty.call(object,path)}return result||isLength(object.length)&&isIndex(path,object.length)&&(isArray(object)||isArguments(object))}function invert(object,multiValue,guard){guard&&isIterateeCall(object,multiValue,guard)&&(multiValue=undefined);for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index],value=object[key];multiValue?hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]:result[value]=key}return result}function keysIn(object){if(null==object)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;for(var Ctor=object.constructor,index=-1,isProto="function"==typeof Ctor&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;++index<length;)result[index]=index+"";for(var key in object)skipIndexes&&isIndex(key,length)||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result}function pairs(object){object=toObject(object);for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]];
}return result}function result(object,path,defaultValue){var result=null==object?undefined:object[path];return result===undefined&&(null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),result=null==object?undefined:object[last(path)]),result=result===undefined?defaultValue:result),isFunction(result)?result.call(object):result}function set(object,path,value){if(null==object)return object;var pathKey=path+"";path=null!=object[pathKey]||isKey(path,object)?[pathKey]:toPath(path);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=path[index];isObject(nested)&&(index==lastIndex?nested[key]=value:null==nested[key]&&(nested[key]=isIndex(path[index+1])?[]:{})),nested=nested[key]}return object}function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);if(iteratee=getCallback(iteratee,thisArg,4),null==accumulator)if(isArr||isObject(object)){var Ctor=object.constructor;accumulator=isArr?isArray(object)?new Ctor:[]:baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function values(object){return baseValues(object,keys(object))}function valuesIn(object){return baseValues(object,keysIn(object))}function inRange(value,start,end){return start=+start||0,end===undefined?(end=start,start=0):end=+end||0,value>=nativeMin(start,end)&&value<nativeMax(start,end)}function random(min,max,floating){floating&&isIterateeCall(min,max,floating)&&(max=floating=undefined);var noMin=null==min,noMax=null==max;if(null==floating&&(noMax&&"boolean"==typeof min?(floating=min,min=1):"boolean"==typeof max&&(floating=max,noMax=!0)),noMin&&noMax&&(max=1,noMax=!1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function capitalize(string){return string=baseToString(string),string&&string.charAt(0).toUpperCase()+string.slice(1)}function deburr(string){return string=baseToString(string),string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=baseToString(string),target+="";var length=string.length;return position=position===undefined?length:nativeMin(0>position?0:+position||0,length),position-=target.length,position>=0&&string.indexOf(target,position)==position}function escape(string){return string=baseToString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=baseToString(string),string&&reHasRegExpChars.test(string)?string.replace(reRegExpChars,escapeRegExpChar):string||"(?:)"}function pad(string,length,chars){string=baseToString(string),length=+length;var strLength=string.length;if(strLength>=length||!nativeIsFinite(length))return string;var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return chars=createPadding("",rightLength,chars),chars.slice(0,leftLength)+string+chars}function parseInt(string,radix,guard){return(guard?isIterateeCall(string,radix,guard):null==radix)?radix=0:radix&&(radix=+radix),string=trim(string),nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){var result="";if(string=baseToString(string),n=+n,1>n||!string||!nativeIsFinite(n))return result;do n%2&&(result+=string),n=nativeFloor(n/2),string+=string;while(n);return result}function startsWith(string,target,position){return string=baseToString(string),position=null==position?0:nativeMin(0>position?0:+position||0,string.length),string.lastIndexOf(target,position)==position}function template(string,options,otherOptions){var settings=lodash.templateSettings;otherOptions&&isIterateeCall(string,options,otherOptions)&&(options=otherOptions=undefined),string=baseToString(string),options=assignWith(baseAssign({},otherOptions||options),settings,assignOwnDefaults);var isEscaping,isEvaluating,imports=assignWith(baseAssign({},options.imports),settings.imports,assignOwnDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function trim(string,chars,guard){var value=string;return(string=baseToString(string))?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string),trimmedRightIndex(string)+1):(chars+="",string.slice(charsLeftIndex(string,chars),charsRightIndex(string,chars)+1)):string}function trimLeft(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string)):string.slice(charsLeftIndex(string,chars+"")):string}function trimRight(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(0,trimmedRightIndex(string)+1):string.slice(0,charsRightIndex(string,chars+"")+1):string}function trunc(string,options,guard){guard&&isIterateeCall(string,options,guard)&&(options=undefined);var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(null!=options)if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?+options.length||0:length,omission="omission"in options?baseToString(options.omission):omission}else length=+options||0;if(string=baseToString(string),length>=string.length)return string;var end=length-omission.length;if(1>end)return omission;var result=string.slice(0,end);if(null==separator)return result+omission;if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,newEnd,substring=string.slice(0,end);for(separator.global||(separator=RegExp(separator.source,(reFlags.exec(separator)||"")+"g")),separator.lastIndex=0;match=separator.exec(substring);)newEnd=match.index;result=result.slice(0,null==newEnd?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=baseToString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return guard&&isIterateeCall(string,pattern,guard)&&(pattern=undefined),string=baseToString(string),string.match(pattern||reWords)||[]}function callback(func,thisArg,guard){return guard&&isIterateeCall(func,thisArg,guard)&&(thisArg=undefined),isObjectLike(func)?matches(func):baseCallback(func,thisArg)}function constant(value){return function(){return value}}function identity(value){return value}function matches(source){return baseMatches(baseClone(source,!0))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,!0))}function mixin(object,source,options){if(null==options){var isObj=isObject(source),props=isObj?keys(source):undefined,methodNames=props&&props.length?baseFunctions(source,props):undefined;(methodNames?methodNames.length:isObj)||(methodNames=!1,options=source,source=object,object=this)}methodNames||(methodNames=baseFunctions(source,keys(source)));var chain=!0,index=-1,isFunc=isFunction(object),length=methodNames.length;options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);for(;++index<length;){var methodName=methodNames[index],func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(func){return function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=arrayCopy(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))}}(func))}return object}function noConflict(){return root._=oldDash,this}function noop(){}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return baseGet(object,toPath(path),path+"")}}function range(start,end,step){step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=+start||0,step=null==step?1:+step||0,null==end?(end=start,start=0):end=+end||0;for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function times(n,iteratee,thisArg){if(n=nativeFloor(n),1>n||!nativeIsFinite(n))return[];var index=-1,result=Array(nativeMin(n,MAX_ARRAY_LENGTH));for(iteratee=bindCallback(iteratee,thisArg,1);++index<n;)MAX_ARRAY_LENGTH>index?result[index]=iteratee(index):iteratee(index);return result}function uniqueId(prefix){var id=++idCounter;return baseToString(prefix)+id}function add(augend,addend){return(+augend||0)+(+addend||0)}function sum(collection,iteratee,thisArg){return thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length?arraySum(isArray(collection)?collection:toIterable(collection),iteratee):baseSum(collection,iteratee)}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,objectProto=Object.prototype,stringProto=String.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,objToString=objectProto.toString,oldDash=root._,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ArrayBuffer=context.ArrayBuffer,clearTimeout=context.clearTimeout,parseFloat=context.parseFloat,pow=Math.pow,propertyIsEnumerable=objectProto.propertyIsEnumerable,Set=getNative(context,"Set"),setTimeout=context.setTimeout,splice=arrayProto.splice,Uint8Array=context.Uint8Array,WeakMap=getNative(context,"WeakMap"),nativeCeil=Math.ceil,nativeCreate=getNative(Object,"create"),nativeFloor=Math.floor,nativeIsArray=getNative(Array,"isArray"),nativeIsFinite=context.isFinite,nativeKeys=getNative(Object,"keys"),nativeMax=Math.max,nativeMin=Math.min,nativeNow=getNative(Date,"now"),nativeParseInt=context.parseInt,nativeRandom=Math.random,NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,POSITIVE_INFINITY=Number.POSITIVE_INFINITY,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,MAX_SAFE_INTEGER=9007199254740991,metaMap=WeakMap&&new WeakMap,realNames={};lodash.support={};lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}(),baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,getData=metaMap?function(func){return metaMap.get(func)}:noop,getLength=baseProperty("length"),setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return key}else count=0;return baseSetData(key,value)}}(),difference=restParam(function(array,values){return isObjectLike(array)&&isArrayLike(array)?baseDifference(array,baseFlatten(values,!1,!0)):[]}),findIndex=createFindIndex(),findLastIndex=createFindIndex(!0),intersection=restParam(function(arrays){for(var othLength=arrays.length,othIndex=othLength,caches=Array(length),indexOf=getIndexOf(),isCommon=indexOf===baseIndexOf,result=[];othIndex--;){var value=arrays[othIndex]=isArrayLike(value=arrays[othIndex])?value:[];caches[othIndex]=isCommon&&value.length>=120?createCache(othIndex&&value):null}var array=arrays[0],index=-1,length=array?array.length:0,seen=caches[0];outer:for(;++index<length;)if(value=array[index],(seen?cacheIndexOf(seen,value):indexOf(result,value,0))<0){for(var othIndex=othLength;--othIndex;){var cache=caches[othIndex];if((cache?cacheIndexOf(cache,value):indexOf(arrays[othIndex],value,0))<0)continue outer}seen&&seen.push(value),result.push(value)}return result}),pullAt=restParam(function(array,indexes){indexes=baseFlatten(indexes);var result=baseAt(array,indexes);return basePullAt(array,indexes.sort(baseCompareAscending)),result}),sortedIndex=createSortedIndex(),sortedLastIndex=createSortedIndex(!0),union=restParam(function(arrays){return baseUniq(baseFlatten(arrays,!1,!0))}),without=restParam(function(array,values){return isArrayLike(array)?baseDifference(array,values):[]}),zip=restParam(unzip),zipWith=restParam(function(arrays){var length=arrays.length,iteratee=length>2?arrays[length-2]:undefined,thisArg=length>1?arrays[length-1]:undefined;return length>2&&"function"==typeof iteratee?length-=2:(iteratee=length>1&&"function"==typeof thisArg?(--length,thisArg):undefined,thisArg=undefined),arrays.length=length,unzipWith(arrays,iteratee,thisArg)}),wrapperConcat=restParam(function(values){return values=baseFlatten(values),this.thru(function(array){return arrayConcat(isArray(array)?array:[toObject(array)],values)})}),at=restParam(function(collection,props){return baseAt(collection,baseFlatten(props))}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1}),find=createFind(baseEach),findLast=createFind(baseEachRight,!0),forEach=createForEach(arrayEach,baseEach),forEachRight=createForEach(arrayEachRight,baseEachRight),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}),indexBy=createAggregator(function(result,value,key){result[key]=value}),invoke=restParam(function(collection,path,args){var index=-1,isFunc="function"==typeof path,isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){var func=isFunc?path:isProp&&null!=value?value[path]:undefined;result[++index]=func?func.apply(value,args):invokePath(value,path,args)}),result}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),reduce=createReduce(arrayReduce,baseEach),reduceRight=createReduce(arrayReduceRight,baseEachRight),sortByAll=restParam(function(collection,iteratees){if(null==collection)return[];var guard=iteratees[2];return guard&&isIterateeCall(iteratees[0],iteratees[1],guard)&&(iteratees.length=1),baseSortByOrder(collection,baseFlatten(iteratees),[])}),now=nativeNow||function(){return(new Date).getTime()},bind=restParam(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)}),bindAll=restParam(function(object,methodNames){methodNames=methodNames.length?baseFlatten(methodNames):functions(object);for(var index=-1,length=methodNames.length;++index<length;){var key=methodNames[index];object[key]=createWrapper(object[key],BIND_FLAG,object)}return object}),bindKey=restParam(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)}),curry=createCurry(CURRY_FLAG),curryRight=createCurry(CURRY_RIGHT_FLAG),defer=restParam(function(func,args){return baseDelay(func,1,args)}),delay=restParam(function(func,wait,args){return baseDelay(func,wait,args)}),flow=createFlow(),flowRight=createFlow(!0),modArgs=restParam(function(func,transforms){if(transforms=baseFlatten(transforms),"function"!=typeof func||!arrayEvery(transforms,baseIsFunction))throw new TypeError(FUNC_ERROR_TEXT);var length=transforms.length;return restParam(function(args){for(var index=nativeMin(args.length,length);index--;)args[index]=transforms[index](args[index]);return func.apply(this,args)})}),partial=createPartial(PARTIAL_FLAG),partialRight=createPartial(PARTIAL_RIGHT_FLAG),rearg=restParam(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))}),isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag},merge=createAssigner(baseMerge),assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)}),defaults=createDefaults(assign,assignDefaults),defaultsDeep=createDefaults(merge,mergeDefaults),findKey=createFindKey(baseForOwn),findLastKey=createFindKey(baseForOwnRight),forIn=createForIn(baseFor),forInRight=createForIn(baseForRight),forOwn=createForOwn(baseForOwn),forOwnRight=createForOwn(baseForOwnRight),keys=nativeKeys?function(object){var Ctor=null==object?undefined:object.constructor;return"function"==typeof Ctor&&Ctor.prototype===object||"function"!=typeof object&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[]}:shimKeys,mapKeys=createObjectMapper(!0),mapValues=createObjectMapper(),omit=restParam(function(object,props){if(null==object)return{};if("function"!=typeof props[0]){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})}),pick=restParam(function(object,props){return null==object?{}:"function"==typeof props[0]?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))}),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?word.charAt(0).toUpperCase()+word.slice(1):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),padLeft=createPadDir(),padRight=createPadDir(!0),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+(word.charAt(0).toUpperCase()+word.slice(1))}),attempt=restParam(function(func,args){try{return func.apply(undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),method=restParam(function(path,args){return function(object){return invokePath(object,path,args)}}),methodOf=restParam(function(object,args){return function(path){return invokePath(object,path,args)}}),ceil=createRound("ceil"),floor=createRound("floor"),max=createExtremum(gt,NEGATIVE_INFINITY),min=createExtremum(lt,POSITIVE_INFINITY),round=createRound("round");return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,MapCache.prototype["delete"]=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.callback=callback,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flow=flow,lodash.flowRight=flowRight,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.modArgs=modArgs,lodash.negate=negate,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAt=pullAt,lodash.range=range,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.restParam=restParam,lodash.set=set,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortByAll=sortByAll,lodash.sortByOrder=sortByOrder,lodash.spread=spread,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.times=times,lodash.toArray=toArray,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipWith=zipWith,lodash.backflow=flowRight,lodash.collect=map,lodash.compose=flowRight,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.iteratee=callback,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.findWhere=findWhere,lodash.first=first,lodash.floor=floor,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isMatch=isMatch,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.min=min,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padLeft=padLeft,lodash.padRight=padRight,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedLastIndex=sortedLastIndex,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.sum=sum,lodash.template=template,lodash.trim=trim,lodash.trimLeft=trimLeft,lodash.trimRight=trimRight,lodash.trunc=trunc,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.words=words,lodash.all=every,lodash.any=some,lodash.contains=includes,lodash.eq=isEqual,lodash.detect=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.head=first,lodash.include=includes,lodash.inject=reduce,mixin(lodash,function(){var source={};return baseForOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.sample=sample,lodash.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(value){return sample(value,n)}):sample(this.value())},lodash.VERSION=VERSION,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index)return new LazyWrapper(this);n=null==n?1:nativeMax(nativeFloor(n)||0,0);var result=this.clone();return filtered?result.__takeCount__=nativeMin(result.__takeCount__,n):result.__views__.push({size:n,type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type!=LAZY_MAP_FLAG;LazyWrapper.prototype[methodName]=function(iteratee,thisArg){var result=this.clone();return result.__iteratees__.push({iteratee:getCallback(iteratee,thisArg,1),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["first","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","rest"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),arrayEach(["pluck","where"],function(methodName,index){var operationName=index?"filter":"map",createCallback=index?baseMatches:property;LazyWrapper.prototype[methodName]=function(value){return this[operationName](createCallback(value))}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.reject=function(predicate,thisArg){return predicate=getCallback(predicate,thisArg,1),this.filter(function(value){return!predicate(value)})},LazyWrapper.prototype.slice=function(start,end){start=null==start?0:+start||0;var result=this;return result.__filtered__&&(start>0||0>end)?new LazyWrapper(result):(0>start?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=+end||0,result=0>end?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate,thisArg){return this.reverse().takeWhile(predicate,thisArg).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(POSITIVE_INFINITY)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|map|reject)|While$/.test(methodName),retUnwrapped=/^(?:first|last)$/.test(methodName),lodashFunc=lodash[retUnwrapped?"take"+("last"==methodName?"Right":""):methodName];lodashFunc&&(lodash.prototype[methodName]=function(){var args=retUnwrapped?[1]:arguments,chainAll=this.__chain__,value=this.__wrapped__,isHybrid=!!this.__actions__.length,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var interceptor=function(value){return retUnwrapped&&chainAll?lodashFunc(value,1)[0]:lodashFunc.apply(undefined,arrayPush([value],args))},action={func:thru,args:[interceptor],thisArg:undefined},onlyLazy=isLazy&&!isHybrid;if(retUnwrapped&&!chainAll)return onlyLazy?(value=value.clone(),value.__actions__.push(action),func.call(value)):lodashFunc.call(undefined,this.value())[0];if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push(action),new LodashWrapper(result,chainAll)}return this.thru(interceptor)})}),arrayEach(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(methodName){var func=(/^(?:replace|split)$/.test(methodName)?stringProto:arrayProto)[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:join|pop|replace|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;return retUnwrapped&&!this.__chain__?func.apply(this.value(),args):this[chainName](function(value){return func.apply(value,args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+"",names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}}),realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.concat=wrapperConcat,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toString=wrapperToString,lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.collect=lodash.prototype.map,lodash.prototype.head=lodash.prototype.first,lodash.prototype.select=lodash.prototype.filter,lodash.prototype.tail=lodash.prototype.rest,lodash}var undefined,VERSION="3.10.1",BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=150,HOT_SPAN=16,LARGE_ARRAY_SIZE=200,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,reRegExpChars=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,reHasRegExpChars=RegExp(reRegExpChars.source),reComboMark=/[\u0300-\u036f\ufe20-\ufe23]/g,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reHasHexPrefix=/^0[xX]/,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^\d+$/,reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,reWords=function(){
var upper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lower="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(upper+"+(?="+upper+lower+")|"+upper+"?"+lower+"|"+upper+"+|[0-9]+","g")}(),contextProps=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[stringTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[mapTag]=cloneableTags[setTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},objectTypes={"function":!0,object:!0},regexpEscapes={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&"object"==typeof global&&global&&global.Object&&global,freeSelf=objectTypes[typeof self]&&self&&self.Object&&self,freeWindow=objectTypes[typeof window]&&window&&window.Object&&window,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,root=freeGlobal||freeWindow!==(this&&this.window)&&freeWindow||freeSelf||this,_=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}).call(this);
!function(){"use strict";var legacySupport=1===angular.version.major&&0===angular.version.minor;angular.module("ui-rangeSlider",[]).directive("rangeSlider",["$document","$filter","$log",function($document,$filter,$log){var eventNamespace=".rangeSlider",defaults={disabled:!1,orientation:"horizontal",step:0,decimalPlaces:0,showValues:!0,preventEqualMinMax:!1,attachHandleValues:!1},actions=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup",over:"pointerdown",out:"mouseout"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",over:"MSPointerDown",out:"mouseout"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend",over:"mouseover touchstart",out:"mouseout"},onEvent=actions.start+eventNamespace,moveEvent=actions.move+eventNamespace,offEvent=actions.end+eventNamespace,overEvent=actions.over+eventNamespace,outEvent=actions.out+eventNamespace,client=function(f){try{return[f.clientX||f.originalEvent.clientX||f.originalEvent.touches[0].clientX,f.clientY||f.originalEvent.clientY||f.originalEvent.touches[0].clientY]}catch(e){return["x","y"]}},restrict=function(value){return 0>value?0:value>100?100:value},isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},scopeOptions={disabled:"=?",min:"=",max:"=",modelMin:"=?",modelMax:"=?",onHandleDown:"&",onHandleUp:"&",orientation:"@",step:"@",decimalPlaces:"@",filter:"@",filterOptions:"@",showValues:"@",pinHandle:"@",preventEqualMinMax:"@",attachHandleValues:"@",getterSetter:"@"};return legacySupport&&(scopeOptions.disabled="=",scopeOptions.modelMin="=",scopeOptions.modelMax="="),{restrict:"A",replace:!0,template:['<div class="ngrs-range-slider">','<div class="ngrs-runner">','<div class="ngrs-handle ngrs-handle-min"><i></i></div>','<div class="ngrs-handle ngrs-handle-max"><i></i></div>','<div class="ngrs-join"></div>',"</div>",'<div class="ngrs-value-runner">','<div class="ngrs-value ngrs-value-min" ng-show="showValues"><div>{{filteredModelMin}}</div></div>','<div class="ngrs-value ngrs-value-max" ng-show="showValues"><div>{{filteredModelMax}}</div></div>',"</div>","</div>"].join(""),scope:scopeOptions,link:function(scope,element,attrs,controller){function modelMin(newValue){return scope.getterSetter?arguments.length?scope.modelMin(newValue):scope.modelMin():arguments.length?scope.modelMin=newValue:scope.modelMin}function modelMax(newValue){return scope.getterSetter?arguments.length?scope.modelMax(newValue):scope.modelMax():arguments.length?scope.modelMax=newValue:scope.modelMax}function setPinHandle(status){"min"===status?(angular.element(handles[0]).css("display","none"),angular.element(handles[1]).css("display","block")):"max"===status?(angular.element(handles[0]).css("display","block"),angular.element(handles[1]).css("display","none")):(angular.element(handles[0]).css("display","block"),angular.element(handles[1]).css("display","block"))}function setDisabledStatus(status){status?$slider.addClass("ngrs-disabled"):$slider.removeClass("ngrs-disabled")}function setMinMax(){scope.min>scope.max&&throwError("min must be less than or equal to max"),angular.isDefined(scope.min)&&angular.isDefined(scope.max)&&(isNumber(scope.min)||throwError("min must be a number"),isNumber(scope.max)||throwError("max must be a number"),range=scope.max-scope.min,allowedRange=[scope.min,scope.max],setModelMinMax())}function setModelMinMax(){if(modelMin()>modelMax()&&(throwWarning("modelMin must be less than or equal to modelMax"),modelMin(modelMax())),(angular.isDefined(modelMin())||"min"===scope.pinHandle)&&(angular.isDefined(modelMax())||"max"===scope.pinHandle)){isNumber(modelMin())||("min"!==scope.pinHandle&&throwWarning("modelMin must be a number"),modelMin(scope.min)),isNumber(modelMax())||("max"!==scope.pinHandle&&throwWarning("modelMax must be a number"),modelMax(scope.max));var value1pos,value2pos,handle1pos=restrict((modelMin()-scope.min)/range*100),handle2pos=restrict((modelMax()-scope.min)/range*100);if(scope.attachHandleValues&&(value1pos=handle1pos,value2pos=handle2pos),modelMin(Math.max(scope.min,modelMin())),modelMax(Math.min(scope.max,modelMax())),scope.filter&&scope.filterOptions)scope.filteredModelMin=$filter(scope.filter)(modelMin(),scope.filterOptions),scope.filteredModelMax=$filter(scope.filter)(modelMax(),scope.filterOptions);else if(scope.filter){var modelMinOptions,modelMaxOptions,filterTokens=scope.filter.split(":"),filterName=scope.filter.split(":")[0],filterOptions=filterTokens.slice().slice(1);filterOptions=filterOptions.map(function(arg){return isNumber(arg)?+arg:'"'==arg[0]&&'"'==arg[arg.length-1]||"'"==arg[0]&&"'"==arg[arg.length-1]?arg.slice(1,-1):void 0}),modelMinOptions=filterOptions.slice(),modelMaxOptions=filterOptions.slice(),modelMinOptions.unshift(modelMin()),modelMaxOptions.unshift(modelMax()),scope.filteredModelMin=$filter(filterName).apply(null,modelMinOptions),scope.filteredModelMax=$filter(filterName).apply(null,modelMaxOptions)}else scope.filteredModelMin=modelMin(),scope.filteredModelMax=modelMax();scope.min===scope.max&&modelMin()==modelMax()?(angular.element(handles[0]).css(pos,"0%"),angular.element(handles[1]).css(pos,"100%"),scope.attachHandleValues&&(angular.element(values[0]).css(pos,"0%"),angular.element(values[1]).css(pos,"100%")),angular.element(join).css(pos,"0%").css(posOpp,"0%")):(angular.element(handles[0]).css(pos,handle1pos+"%"),angular.element(handles[1]).css(pos,handle2pos+"%"),scope.attachHandleValues&&(angular.element(values[0]).css(pos,value1pos+"%"),angular.element(values[1]).css(pos,value2pos+"%"),angular.element(values[1]).css(posOpp,"auto")),angular.element(join).css(pos,handle1pos+"%").css(posOpp,100-handle2pos+"%"),handle1pos>95&&angular.element(handles[0]).css("z-index",3))}}function handleMove(index){var $handle=handles[index];$handle.bind(onEvent+"X",function(event){var handleDownClass=(0===index?"ngrs-handle-min":"ngrs-handle-max")+"-down",modelValue=(0===index?modelMin():modelMax())-scope.min,originalPosition=modelValue/range*100,originalClick=client(event),previousClick=originalClick,previousProposal=!1;angular.isFunction(scope.onHandleDown)&&scope.onHandleDown(),angular.element("body").bind("selectstart"+eventNamespace,function(){return!1}),scope.disabled||(down=!0,$handle.addClass("ngrs-down"),$slider.addClass("ngrs-focus "+handleDownClass),angular.element("body").addClass("ngrs-touching"),$document.bind(moveEvent,function(e){e.preventDefault();var movement,proposal,currentClick=client(e),per=scope.step/range*100,otherModelPosition=((0===index?modelMax():modelMin())-scope.min)/range*100;"x"!==currentClick[0]&&(currentClick[0]-=originalClick[0],currentClick[1]-=originalClick[1],movement=[previousClick[0]!==currentClick[0],previousClick[1]!==currentClick[1]],proposal=originalPosition+100*currentClick[orientation]/(orientation?$slider.height():$slider.width()),proposal=restrict(proposal),scope.preventEqualMinMax&&(0===per&&(per=1/range*100),0===index?otherModelPosition-=per:1===index&&(otherModelPosition+=per)),0===index?proposal=proposal>otherModelPosition?otherModelPosition:proposal:1===index&&(proposal=otherModelPosition>proposal?otherModelPosition:proposal),scope.step>0&&100>proposal&&proposal>0&&(proposal=Math.round(proposal/per)*per),proposal>95&&0===index?$handle.css("z-index",3):$handle.css("z-index",""),movement[orientation]&&proposal!=previousProposal&&(0===index?modelMin(parseFloat(parseFloat(proposal*range/100+scope.min).toFixed(scope.decimalPlaces))):1===index&&modelMax(parseFloat(parseFloat(proposal*range/100+scope.min).toFixed(scope.decimalPlaces))),scope.$apply(),previousProposal=proposal),previousClick=currentClick)}).bind(offEvent,function(){angular.isFunction(scope.onHandleUp)&&scope.onHandleUp(),$document.off(moveEvent),$document.off(offEvent),angular.element("body").removeClass("ngrs-touching"),down=!1,$handle.removeClass("ngrs-down"),$handle.removeClass("ngrs-over"),$slider.removeClass("ngrs-focus "+handleDownClass)}))}).on(overEvent,function(){$handle.addClass("ngrs-over")}).on(outEvent,function(){down||$handle.removeClass("ngrs-over")})}function throwError(message){throw scope.disabled=!0,new Error("RangeSlider: "+message)}function throwWarning(message){$log.warn(message)}var $slider=angular.element(element),handles=[element.find(".ngrs-handle-min"),element.find(".ngrs-handle-max")],values=[element.find(".ngrs-value-min"),element.find(".ngrs-value-max")],join=element.find(".ngrs-join"),pos="left",posOpp="right",orientation=0,allowedRange=[0,0],range=0,down=!1;scope.filteredModelMin=modelMin(),scope.filteredModelMax=modelMax(),attrs.$observe("disabled",function(val){angular.isDefined(val)||(scope.disabled=defaults.disabled),scope.$watch("disabled",setDisabledStatus)}),attrs.$observe("orientation",function(val){angular.isDefined(val)||(scope.orientation=defaults.orientation);for(var useClass,classNames=scope.orientation.split(" "),i=0,l=classNames.length;l>i;i++)classNames[i]="ngrs-"+classNames[i];useClass=classNames.join(" "),$slider.addClass(useClass),("vertical"===scope.orientation||"vertical left"===scope.orientation||"vertical right"===scope.orientation)&&(pos="top",posOpp="bottom",orientation=1)}),attrs.$observe("step",function(val){angular.isDefined(val)||(scope.step=defaults.step)}),attrs.$observe("decimalPlaces",function(val){angular.isDefined(val)||(scope.decimalPlaces=defaults.decimalPlaces)}),attrs.$observe("showValues",function(val){angular.isDefined(val)?"false"===val?scope.showValues=!1:scope.showValues=!0:scope.showValues=defaults.showValues}),attrs.$observe("pinHandle",function(val){angular.isDefined(val)&&("min"===val||"max"===val)?scope.pinHandle=val:scope.pinHandle=null,scope.$watch("pinHandle",setPinHandle)}),attrs.$observe("preventEqualMinMax",function(val){angular.isDefined(val)?"false"===val?scope.preventEqualMinMax=!1:scope.preventEqualMinMax=!0:scope.preventEqualMinMax=defaults.preventEqualMinMax}),attrs.$observe("attachHandleValues",function(val){angular.isDefined(val)?"true"===val||""===val?(scope.attachHandleValues=!0,element.find(".ngrs-value-runner").addClass("ngrs-attached-handles")):scope.attachHandleValues=!1:scope.attachHandleValues=defaults.attachHandleValues}),scope.$watch("min",setMinMax),scope.$watch("max",setMinMax),scope.$watch(function(){return modelMin()},setModelMinMax),scope.$watch(function(){return modelMax()},setModelMinMax),scope.$on("$destroy",function(){$slider.off(eventNamespace),angular.element("body").off(eventNamespace),$document.off(eventNamespace);for(var i=0,l=handles.length;l>i;i++)handles[i].off(eventNamespace),handles[i].off(eventNamespace+"X")}),$slider.bind("selectstart"+eventNamespace,function(event){return!1}).bind("click",function(event){event.stopPropagation()}),handleMove(0),handleMove(1)}}}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}()}();
!function(a,b,c){"use strict";function d(a){return D(a)?a:Object.keys(a).map(function(b){return a[b]})}function e(a){return null===a}function f(a,b){var d=Object.keys(a);return-1==d.map(function(d){return b[d]!==c&&b[d]==a[d]}).indexOf(!1)}function g(a,b){if(""===b)return a;var c=a.indexOf(b.charAt(0));return-1===c?!1:g(a.substr(c+1),b.substr(1))}function h(a,b,c){var d=0;return a.filter(function(a){var e=x(c)?b>d&&c(a):b>d;return d=e?d+1:d,e})}function i(a,b,c){return c.round(a*c.pow(10,b))/c.pow(10,b)}function j(a,b,c){b=b||[];var d=Object.keys(a);return d.forEach(function(d){if(C(a[d])&&!D(a[d])){var e=c?c+"."+d:c;j(a[d],b,e||d)}else{var f=c?c+"."+d:d;b.push(f)}}),b}function k(a){return a&&a.$evalAsync&&a.$watch}function l(){return function(a,b){return a>b}}function m(){return function(a,b){return a>=b}}function n(){return function(a,b){return b>a}}function o(){return function(a,b){return b>=a}}function p(){return function(a,b){return a==b}}function q(){return function(a,b){return a!=b}}function r(){return function(a,b){return a===b}}function s(){return function(a,b){return a!==b}}function t(a){return function(b,c){return b=C(b)?d(b):b,!D(b)||y(c)?!1:b.some(function(b){return C(b)||z(c)?a(c)(b):b===c})}}function u(a,b){return b=b||0,b>=a.length?a:D(a[b])?u(a.slice(0,b).concat(a[b],a.slice(b+1)),b):u(a,b+1)}function v(a){return function(b,c){function e(a,b){return y(b)?!1:a.some(function(a){return H(a,b)})}if(b=C(b)?d(b):b,!D(b))return b;var f=[],g=a(c);return y(c)?b.filter(function(a,b,c){return c.indexOf(a)===b}):b.filter(function(a){var b=g(a);return e(f,b)?!1:(f.push(b),!0)})}}function w(a,b,c){return b?a+c+w(a,--b,c):a}var x=b.isDefined,y=b.isUndefined,z=b.isFunction,A=b.isString,B=b.isNumber,C=b.isObject,D=b.isArray,E=b.forEach,F=b.extend,G=b.copy,H=b.equals;String.prototype.contains||(String.prototype.contains=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),b.module("a8m.angular",[]).filter("isUndefined",function(){return function(a){return b.isUndefined(a)}}).filter("isDefined",function(){return function(a){return b.isDefined(a)}}).filter("isFunction",function(){return function(a){return b.isFunction(a)}}).filter("isString",function(){return function(a){return b.isString(a)}}).filter("isNumber",function(){return function(a){return b.isNumber(a)}}).filter("isArray",function(){return function(a){return b.isArray(a)}}).filter("isObject",function(){return function(a){return b.isObject(a)}}).filter("isEqual",function(){return function(a,c){return b.equals(a,c)}}),b.module("a8m.conditions",[]).filter({isGreaterThan:l,">":l,isGreaterThanOrEqualTo:m,">=":m,isLessThan:n,"<":n,isLessThanOrEqualTo:o,"<=":o,isEqualTo:p,"==":p,isNotEqualTo:q,"!=":q,isIdenticalTo:r,"===":r,isNotIdenticalTo:s,"!==":s}),b.module("a8m.is-null",[]).filter("isNull",function(){return function(a){return e(a)}}),b.module("a8m.after-where",[]).filter("afterWhere",function(){return function(a,b){if(a=C(a)?d(a):a,!D(a)||y(b))return a;var c=a.map(function(a){return f(b,a)}).indexOf(!0);return a.slice(-1===c?0:c)}}),b.module("a8m.after",[]).filter("after",function(){return function(a,b){return a=C(a)?d(a):a,D(a)?a.slice(b):a}}),b.module("a8m.before-where",[]).filter("beforeWhere",function(){return function(a,b){if(a=C(a)?d(a):a,!D(a)||y(b))return a;var c=a.map(function(a){return f(b,a)}).indexOf(!0);return a.slice(0,-1===c?a.length:++c)}}),b.module("a8m.before",[]).filter("before",function(){return function(a,b){return a=C(a)?d(a):a,D(a)?a.slice(0,b?--b:b):a}}),b.module("a8m.chunk-by",["a8m.filter-watcher"]).filter("chunkBy",["filterWatcher",function(a){return function(b,c,d){function e(a,b){for(var c=[];a--;)c[a]=b;return c}function f(a,b,c){return D(a)?a.map(function(a,d,f){return d*=b,a=f.slice(d,d+b),!y(c)&&a.length<b?a.concat(e(b-a.length,c)):a}).slice(0,Math.ceil(a.length/b)):a}return a.isMemoized("chunkBy",arguments)||a.memoize("chunkBy",arguments,this,f(b,c,d))}}]),b.module("a8m.concat",[]).filter("concat",[function(){return function(a,b){if(y(b))return a;if(D(a))return C(b)?a.concat(d(b)):a.concat(b);if(C(a)){var c=d(a);return C(b)?c.concat(d(b)):c.concat(b)}return a}}]),b.module("a8m.contains",[]).filter({contains:["$parse",t],some:["$parse",t]}),b.module("a8m.count-by",[]).filter("countBy",["$parse",function(a){return function(b,c){var e,f={},g=a(c);return b=C(b)?d(b):b,!D(b)||y(c)?b:(b.forEach(function(a){e=g(a),f[e]||(f[e]=0),f[e]++}),f)}}]),b.module("a8m.defaults",[]).filter("defaults",["$parse",function(a){return function(b,c){if(b=C(b)?d(b):b,!D(b)||!C(c))return b;var e=j(c);return b.forEach(function(b){e.forEach(function(d){var e=a(d),f=e.assign;y(e(b))&&f(b,e(c))})}),b}}]),b.module("a8m.every",[]).filter("every",["$parse",function(a){return function(b,c){return b=C(b)?d(b):b,!D(b)||y(c)?!0:b.every(function(b){return C(b)||z(c)?a(c)(b):b===c})}}]),b.module("a8m.filter-by",[]).filter("filterBy",["$parse",function(a){return function(b,e,f){var g;return f=A(f)||B(f)?String(f).toLowerCase():c,b=C(b)?d(b):b,!D(b)||y(f)?b:b.filter(function(b){return e.some(function(c){if(~c.indexOf("+")){var d=c.replace(new RegExp("\\s","g"),"").split("+");g=d.reduce(function(c,d,e){return 1===e?a(c)(b)+" "+a(d)(b):c+" "+a(d)(b)})}else g=a(c)(b);return A(g)||B(g)?String(g).toLowerCase().contains(f):!1})})}}]),b.module("a8m.first",[]).filter("first",["$parse",function(a){return function(b){var e,f,g;return b=C(b)?d(b):b,D(b)?(g=Array.prototype.slice.call(arguments,1),e=B(g[0])?g[0]:1,f=B(g[0])?B(g[1])?c:g[1]:g[0],g.length?h(b,e,f?a(f):f):b[0]):b}}]),b.module("a8m.flatten",[]).filter("flatten",function(){return function(a,b){return b=b||!1,a=C(a)?d(a):a,D(a)?b?[].concat.apply([],a):u(a,0):a}}),b.module("a8m.fuzzy-by",[]).filter("fuzzyBy",["$parse",function(a){return function(b,c,e,f){var h,i,j=f||!1;return b=C(b)?d(b):b,!D(b)||y(c)||y(e)?b:(i=a(c),b.filter(function(a){return h=i(a),A(h)?(h=j?h:h.toLowerCase(),e=j?e:e.toLowerCase(),g(h,e)!==!1):!1}))}}]),b.module("a8m.fuzzy",[]).filter("fuzzy",function(){return function(a,b,c){function e(a,b){var c,d,e=Object.keys(a);return 0<e.filter(function(e){return c=a[e],d?!0:A(c)?(c=f?c:c.toLowerCase(),d=g(c,b)!==!1):!1}).length}var f=c||!1;return a=C(a)?d(a):a,!D(a)||y(b)?a:(b=f?b:b.toLowerCase(),a.filter(function(a){return A(a)?(a=f?a:a.toLowerCase(),g(a,b)!==!1):C(a)?e(a,b):!1}))}}),b.module("a8m.group-by",["a8m.filter-watcher"]).filter("groupBy",["$parse","filterWatcher",function(a,b){return function(c,d){function e(a,b){var c,d={};return E(a,function(a){c=b(a),d[c]||(d[c]=[]),d[c].push(a)}),d}return!C(c)||y(d)?c:b.isMemoized("groupBy",arguments)||b.memoize("groupBy",arguments,this,e(c,a(d)))}}]),b.module("a8m.is-empty",[]).filter("isEmpty",function(){return function(a){return C(a)?!d(a).length:!a.length}}),b.module("a8m.join",[]).filter("join",function(){return function(a,b){return y(a)||!D(a)?a:(y(b)&&(b=" "),a.join(b))}}),b.module("a8m.last",[]).filter("last",["$parse",function(a){return function(b){var e,f,g,i=G(b);return i=C(i)?d(i):i,D(i)?(g=Array.prototype.slice.call(arguments,1),e=B(g[0])?g[0]:1,f=B(g[0])?B(g[1])?c:g[1]:g[0],g.length?h(i.reverse(),e,f?a(f):f).reverse():i[i.length-1]):i}}]),b.module("a8m.map",[]).filter("map",["$parse",function(a){return function(b,c){return b=C(b)?d(b):b,!D(b)||y(c)?b:b.map(function(b){return a(c)(b)})}}]),b.module("a8m.omit",[]).filter("omit",["$parse",function(a){return function(b,c){return b=C(b)?d(b):b,!D(b)||y(c)?b:b.filter(function(b){return!a(c)(b)})}}]),b.module("a8m.pick",[]).filter("pick",["$parse",function(a){return function(b,c){return b=C(b)?d(b):b,!D(b)||y(c)?b:b.filter(function(b){return a(c)(b)})}}]),b.module("a8m.range",[]).filter("range",function(){return function(a,b){for(var c=0;c<parseInt(b);c++)a.push(c);return a}}),b.module("a8m.remove-with",[]).filter("removeWith",function(){return function(a,b){return y(b)?a:(a=C(a)?d(a):a,a.filter(function(a){return!f(b,a)}))}}),b.module("a8m.remove",[]).filter("remove",function(){return function(a){a=C(a)?d(a):a;var b=Array.prototype.slice.call(arguments,1);return D(a)?a.filter(function(a){return!b.some(function(b){return H(b,a)})}):a}}),b.module("a8m.reverse",[]).filter("reverse",[function(){return function(a){return a=C(a)?d(a):a,A(a)?a.split("").reverse().join(""):D(a)?a.slice().reverse():a}}]),b.module("a8m.search-field",[]).filter("searchField",["$parse",function(a){return function(b){var c,e;b=C(b)?d(b):b;var f=Array.prototype.slice.call(arguments,1);return D(b)&&f.length?b.map(function(b){return e=f.map(function(d){return(c=a(d))(b)}).join(" "),F(b,{searchField:e})}):b}}]),b.module("a8m.to-array",[]).filter("toArray",function(){return function(a,b){return C(a)?b?Object.keys(a).map(function(b){return F(a[b],{$key:b})}):d(a):a}}),b.module("a8m.unique",[]).filter({unique:["$parse",v],uniq:["$parse",v]}),b.module("a8m.where",[]).filter("where",function(){return function(a,b){return y(b)?a:(a=C(a)?d(a):a,a.filter(function(a){return f(b,a)}))}}),b.module("a8m.xor",[]).filter("xor",["$parse",function(a){return function(b,c,e){function f(b,c){var d=a(e);return c.some(function(a){return e?H(d(a),d(b)):H(a,b)})}return e=e||!1,b=C(b)?d(b):b,c=C(c)?d(c):c,D(b)&&D(c)?b.concat(c).filter(function(a){return!(f(a,b)&&f(a,c))}):b}}]),b.module("a8m.math.byteFmt",["a8m.math"]).filter("byteFmt",["$math",function(a){return function(b,c){return B(c)&&isFinite(c)&&c%1===0&&c>=0&&B(b)&&isFinite(b)?1024>b?i(b,c,a)+" B":1048576>b?i(b/1024,c,a)+" KB":1073741824>b?i(b/1048576,c,a)+" MB":i(b/1073741824,c,a)+" GB":"NaN"}}]),b.module("a8m.math.degrees",["a8m.math"]).filter("degrees",["$math",function(a){return function(b,c){if(B(c)&&isFinite(c)&&c%1===0&&c>=0&&B(b)&&isFinite(b)){var d=180*b/a.PI;return a.round(d*a.pow(10,c))/a.pow(10,c)}return"NaN"}}]),b.module("a8m.math.kbFmt",["a8m.math"]).filter("kbFmt",["$math",function(a){return function(b,c){return B(c)&&isFinite(c)&&c%1===0&&c>=0&&B(b)&&isFinite(b)?1024>b?i(b,c,a)+" KB":1048576>b?i(b/1024,c,a)+" MB":i(b/1048576,c,a)+" GB":"NaN"}}]),b.module("a8m.math",[]).factory("$math",["$window",function(a){return a.Math}]),b.module("a8m.math.max",["a8m.math"]).filter("max",["$math","$parse",function(a,b){function c(c,d){var e=c.map(function(a){return b(d)(a)});return e.indexOf(a.max.apply(a,e))}return function(b,d){return D(b)?y(d)?a.max.apply(a,b):b[c(b,d)]:b}}]),b.module("a8m.math.min",["a8m.math"]).filter("min",["$math","$parse",function(a,b){function c(c,d){var e=c.map(function(a){return b(d)(a)});return e.indexOf(a.min.apply(a,e))}return function(b,d){return D(b)?y(d)?a.min.apply(a,b):b[c(b,d)]:b}}]),b.module("a8m.math.percent",["a8m.math"]).filter("percent",["$math","$window",function(a,b){return function(c,d,e){var f=A(c)?b.Number(c):c;return d=d||100,e=e||!1,!B(f)||b.isNaN(f)?c:e?a.round(f/d*100):f/d*100}}]),b.module("a8m.math.radians",["a8m.math"]).filter("radians",["$math",function(a){return function(b,c){if(B(c)&&isFinite(c)&&c%1===0&&c>=0&&B(b)&&isFinite(b)){var d=3.14159265359*b/180;return a.round(d*a.pow(10,c))/a.pow(10,c)}return"NaN"}}]),b.module("a8m.math.radix",[]).filter("radix",function(){return function(a,b){var c=/^[2-9]$|^[1-2]\d$|^3[0-6]$/;return B(a)&&c.test(b)?a.toString(b).toUpperCase():a}}),b.module("a8m.math.shortFmt",["a8m.math"]).filter("shortFmt",["$math",function(a){return function(b,c){return B(c)&&isFinite(c)&&c%1===0&&c>=0&&B(b)&&isFinite(b)?1e3>b?b:1e6>b?i(b/1e3,c,a)+" K":1e9>b?i(b/1e6,c,a)+" M":i(b/1e9,c,a)+" B":"NaN"}}]),b.module("a8m.math.sum",[]).filter("sum",function(){return function(a,b){return D(a)?a.reduce(function(a,b){return a+b},b||0):a}}),b.module("a8m.ends-with",[]).filter("endsWith",function(){return function(a,b,c){var d,e=c||!1;return!A(a)||y(b)?a:(a=e?a:a.toLowerCase(),d=a.length-b.length,-1!==a.indexOf(e?b:b.toLowerCase(),d))}}),b.module("a8m.latinize",[]).filter("latinize",[function(){function a(a){return a.replace(/[^\u0000-\u007E]/g,function(a){return c[a]||a})}for(var b=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"OE",letters:""},{base:"oe",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],c={},d=0;d<b.length;d++)for(var e=b[d].letters.split(""),f=0;f<e.length;f++)c[e[f]]=b[d].base;return function(b){return A(b)?a(b):b}}]),b.module("a8m.ltrim",[]).filter("ltrim",function(){return function(a,b){var c=b||"\\s";return A(a)?a.replace(new RegExp("^"+c+"+"),""):a}}),b.module("a8m.match",[]).filter("match",function(){return function(a,b,c){var d=new RegExp(b,c);return A(a)?a.match(d):null}}),b.module("a8m.repeat",[]).filter("repeat",[function(){return function(a,b,c){var d=~~b;return A(a)&&d?w(a,--b,c||""):a}}]),b.module("a8m.rtrim",[]).filter("rtrim",function(){return function(a,b){var c=b||"\\s";return A(a)?a.replace(new RegExp(c+"+$"),""):a}}),b.module("a8m.slugify",[]).filter("slugify",[function(){return function(a,b){var c=y(b)?"-":b;return A(a)?a.toLowerCase().replace(/\s+/g,c):a}}]),b.module("a8m.starts-with",[]).filter("startsWith",function(){return function(a,b,c){var d=c||!1;return!A(a)||y(b)?a:(a=d?a:a.toLowerCase(),!a.indexOf(d?b:b.toLowerCase()))}}),b.module("a8m.stringular",[]).filter("stringular",function(){return function(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return y(b[c])?a:b[c]})}}),b.module("a8m.strip-tags",[]).filter("stripTags",function(){return function(a){return A(a)?a.replace(/<\S[^><]*>/g,""):a}}),b.module("a8m.test",[]).filter("test",function(){return function(a,b,c){var d=new RegExp(b,c);return A(a)?d.test(a):a}}),b.module("a8m.trim",[]).filter("trim",function(){return function(a,b){var c=b||"\\s";return A(a)?a.replace(new RegExp("^"+c+"+|"+c+"+$","g"),""):a}}),b.module("a8m.truncate",[]).filter("truncate",function(){return function(a,b,c,d){return b=y(b)?a.length:b,d=d||!1,c=c||"",!A(a)||a.length<=b?a:a.substring(0,d?-1===a.indexOf(" ",b)?a.length:a.indexOf(" ",b):b)+c}}),b.module("a8m.ucfirst",[]).filter("ucfirst",[function(){return function(a){return A(a)?a.split(" ").map(function(a){return a.charAt(0).toUpperCase()+a.substring(1)}).join(" "):a}}]),b.module("a8m.uri-component-encode",[]).filter("uriComponentEncode",["$window",function(a){return function(b){return A(b)?a.encodeURIComponent(b):b}}]),b.module("a8m.uri-encode",[]).filter("uriEncode",["$window",function(a){return function(b){return A(b)?a.encodeURI(b):b}}]),b.module("a8m.wrap",[]).filter("wrap",function(){return function(a,b,c){return A(a)&&x(b)?[b,a,c||b].join(""):a}}),b.module("a8m.filter-watcher",[]).provider("filterWatcher",function(){this.$get=["$window","$rootScope",function(a,b){function c(b,c){function d(){var b=[];return function(c,d){if(C(d)&&!e(d)){if(~b.indexOf(d))return"[Circular]";b.push(d)}return a==d?"$WINDOW":a.document==d?"$DOCUMENT":k(d)?"$SCOPE":d}}return[b,JSON.stringify(c,d())].join("#").replace(/"/g,"")}function d(a){var b=a.targetScope.$id;E(l[b],function(a){delete j[a]}),delete l[b]}function f(){m(function(){b.$$phase||(j={})},2e3)}function g(a,b){var c=a.$id;return y(l[c])&&(a.$on("$destroy",d),l[c]=[]),l[c].push(b)}function h(a,b){var d=c(a,b);return j[d]}function i(a,b,d,e){var h=c(a,b);return j[h]=e,k(d)?g(d,h):f(),e}var j={},l={},m=a.setTimeout;return{isMemoized:h,memoize:i}}]}),b.module("angular.filter",["a8m.ucfirst","a8m.uri-encode","a8m.uri-component-encode","a8m.slugify","a8m.latinize","a8m.strip-tags","a8m.stringular","a8m.truncate","a8m.starts-with","a8m.ends-with","a8m.wrap","a8m.trim","a8m.ltrim","a8m.rtrim","a8m.repeat","a8m.test","a8m.match","a8m.to-array","a8m.concat","a8m.contains","a8m.unique","a8m.is-empty","a8m.after","a8m.after-where","a8m.before","a8m.before-where","a8m.defaults","a8m.where","a8m.reverse","a8m.remove","a8m.remove-with","a8m.group-by","a8m.count-by","a8m.chunk-by","a8m.search-field","a8m.fuzzy-by","a8m.fuzzy","a8m.omit","a8m.pick","a8m.every","a8m.filter-by","a8m.xor","a8m.map","a8m.first","a8m.last","a8m.flatten","a8m.join","a8m.range","a8m.math","a8m.math.max","a8m.math.min","a8m.math.percent","a8m.math.radix","a8m.math.sum","a8m.math.degrees","a8m.math.radians","a8m.math.byteFmt","a8m.math.kbFmt","a8m.math.shortFmt","a8m.angular","a8m.conditions","a8m.is-null","a8m.filter-watcher"])}(window,window.angular);
!function(root,factory){"use strict";"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory():root.returnExports=factory()}(this,function(){var isCallable,$Array=Array,ArrayPrototype=$Array.prototype,$Object=Object,ObjectPrototype=$Object.prototype,FunctionPrototype=Function.prototype,$String=String,StringPrototype=$String.prototype,$Number=Number,NumberPrototype=$Number.prototype,array_slice=ArrayPrototype.slice,array_splice=ArrayPrototype.splice,array_push=ArrayPrototype.push,array_unshift=ArrayPrototype.unshift,array_concat=ArrayPrototype.concat,call=FunctionPrototype.call,max=Math.max,min=Math.min,to_string=ObjectPrototype.toString,hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,fnToStr=Function.prototype.toString,tryFunctionObject=function(value){try{return fnToStr.call(value),!0}catch(e){return!1}},fnClass="[object Function]",genClass="[object GeneratorFunction]";isCallable=function(value){if("function"!=typeof value)return!1;if(hasToStringTag)return tryFunctionObject(value);var strClass=to_string.call(value);return strClass===fnClass||strClass===genClass};var isRegex,regexExec=RegExp.prototype.exec,tryRegexExec=function(value){try{return regexExec.call(value),!0}catch(e){return!1}},regexClass="[object RegExp]";isRegex=function(value){return"object"!=typeof value?!1:hasToStringTag?tryRegexExec(value):to_string.call(value)===regexClass};var isString,strValue=String.prototype.valueOf,tryStringObject=function(value){try{return strValue.call(value),!0}catch(e){return!1}},stringClass="[object String]";isString=function(value){return"string"==typeof value?!0:"object"!=typeof value?!1:hasToStringTag?tryStringObject(value):to_string.call(value)===stringClass};var defineProperties=function(has){var defineProperty,supportsDescriptors=$Object.defineProperty&&function(){try{var obj={};$Object.defineProperty(obj,"x",{enumerable:!1,value:obj});for(var _ in obj)return!1;return obj.x===obj}catch(e){return!1}}();return defineProperty=supportsDescriptors?function(object,name,method,forceAssign){!forceAssign&&name in object||$Object.defineProperty(object,name,{configurable:!0,enumerable:!1,writable:!0,value:method})}:function(object,name,method,forceAssign){!forceAssign&&name in object||(object[name]=method)},function(object,map,forceAssign){for(var name in map)has.call(map,name)&&defineProperty(object,name,map[name],forceAssign)}}(ObjectPrototype.hasOwnProperty),isPrimitive=function(input){var type=typeof input;return null===input||"object"!==type&&"function"!==type},isActualNaN=$Number.isNaN||function(x){return x!==x},ES={ToInteger:function(num){var n=+num;return isActualNaN(n)?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n},ToPrimitive:function(input){var val,valueOf,toStr;if(isPrimitive(input))return input;if(valueOf=input.valueOf,isCallable(valueOf)&&(val=valueOf.call(input),isPrimitive(val)))return val;if(toStr=input.toString,isCallable(toStr)&&(val=toStr.call(input),isPrimitive(val)))return val;throw new TypeError},ToObject:function(o){if(null==o)throw new TypeError("can't convert "+o+" to object");return $Object(o)},ToUint32:function(x){return x>>>0}},Empty=function(){};defineProperties(FunctionPrototype,{bind:function(that){var target=this;if(!isCallable(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,args=array_slice.call(arguments,1),binder=function(){if(this instanceof bound){var result=target.apply(this,array_concat.call(args,array_slice.call(arguments)));return $Object(result)===result?result:this}return target.apply(that,array_concat.call(args,array_slice.call(arguments)))},boundLength=max(0,target.length-args.length),boundArgs=[],i=0;boundLength>i;i++)array_push.call(boundArgs,"$"+i);return bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this, arguments); }")(binder),target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}});var owns=call.bind(ObjectPrototype.hasOwnProperty),toStr=call.bind(ObjectPrototype.toString),strSlice=call.bind(StringPrototype.slice),strSplit=call.bind(StringPrototype.split),isArray=$Array.isArray||function(obj){return"[object Array]"===toStr(obj)},hasUnshiftReturnValueBug=1!==[].unshift(0);defineProperties(ArrayPrototype,{unshift:function(){return array_unshift.apply(this,arguments),this.length}},hasUnshiftReturnValueBug),defineProperties($Array,{isArray:isArray});var boxedString=$Object("a"),splitString="a"!==boxedString[0]||!(0 in boxedString),properlyBoxesContext=function(method){var properlyBoxesNonStrict=!0,properlyBoxesStrict=!0;return method&&(method.call("foo",function(_,__,context){"object"!=typeof context&&(properlyBoxesNonStrict=!1)}),method.call([1],function(){"use strict";properlyBoxesStrict="string"==typeof this},"x")),!!method&&properlyBoxesNonStrict&&properlyBoxesStrict};defineProperties(ArrayPrototype,{forEach:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,i=-1,length=ES.ToUint32(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++i<length;)i in self&&("undefined"==typeof T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object))}},!properlyBoxesContext(ArrayPrototype.forEach)),defineProperties(ArrayPrototype,{map:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length),result=$Array(length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.map callback must be a function");for(var i=0;length>i;i++)i in self&&("undefined"==typeof T?result[i]=callbackfn(self[i],i,object):result[i]=callbackfn.call(T,self[i],i,object));return result}},!properlyBoxesContext(ArrayPrototype.map)),defineProperties(ArrayPrototype,{filter:function(callbackfn){var value,T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length),result=[];if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.filter callback must be a function");for(var i=0;length>i;i++)i in self&&(value=self[i],("undefined"==typeof T?callbackfn(value,i,object):callbackfn.call(T,value,i,object))&&array_push.call(result,value));return result}},!properlyBoxesContext(ArrayPrototype.filter)),defineProperties(ArrayPrototype,{every:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.every callback must be a function");for(var i=0;length>i;i++)if(i in self&&!("undefined"==typeof T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object)))return!1;return!0}},!properlyBoxesContext(ArrayPrototype.every)),defineProperties(ArrayPrototype,{some:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.some callback must be a function");for(var i=0;length>i;i++)if(i in self&&("undefined"==typeof T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object)))return!0;return!1}},!properlyBoxesContext(ArrayPrototype.some));var reduceCoercesToObject=!1;ArrayPrototype.reduce&&(reduceCoercesToObject="object"==typeof ArrayPrototype.reduce.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduce:function(callbackfn){var object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(!isCallable(callbackfn))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===length&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=callbackfn(result,self[i],i,object));return result}},!reduceCoercesToObject);var reduceRightCoercesToObject=!1;ArrayPrototype.reduceRight&&(reduceRightCoercesToObject="object"==typeof ArrayPrototype.reduceRight.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduceRight:function(callbackfn){var object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(!isCallable(callbackfn))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===length&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>i)return result;do i in self&&(result=callbackfn(result,self[i],i,object));while(i--);return result}},!reduceRightCoercesToObject);var hasFirefox2IndexOfBug=ArrayPrototype.indexOf&&-1!==[0,1].indexOf(1,2);defineProperties(ArrayPrototype,{indexOf:function(searchElement){var self=splitString&&isString(this)?strSplit(this,""):ES.ToObject(this),length=ES.ToUint32(self.length);if(0===length)return-1;var i=0;for(arguments.length>1&&(i=ES.ToInteger(arguments[1])),i=i>=0?i:max(0,length+i);length>i;i++)if(i in self&&self[i]===searchElement)return i;return-1}},hasFirefox2IndexOfBug);var hasFirefox2LastIndexOfBug=ArrayPrototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);defineProperties(ArrayPrototype,{lastIndexOf:function(searchElement){var self=splitString&&isString(this)?strSplit(this,""):ES.ToObject(this),length=ES.ToUint32(self.length);if(0===length)return-1;var i=length-1;for(arguments.length>1&&(i=min(i,ES.ToInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&searchElement===self[i])return i;return-1}},hasFirefox2LastIndexOfBug);var spliceNoopReturnsEmptyArray=function(){var a=[1,2],result=a.splice();return 2===a.length&&isArray(result)&&0===result.length}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){return 0===arguments.length?[]:array_splice.apply(this,arguments)}},!spliceNoopReturnsEmptyArray);var spliceWorksWithEmptyObject=function(){var obj={};return ArrayPrototype.splice.call(obj,0,0,1),1===obj.length}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){if(0===arguments.length)return[];var args=arguments;return this.length=max(ES.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof deleteCount&&(args=array_slice.call(arguments),args.length<2?array_push.call(args,this.length-start):args[1]=ES.ToInteger(deleteCount)),array_splice.apply(this,args)}},!spliceWorksWithEmptyObject);var spliceWorksWithLargeSparseArrays=function(){var arr=new $Array(1e5);return arr[8]="x",arr.splice(1,1),7===arr.indexOf("x")}(),spliceWorksWithSmallSparseArrays=function(){var n=256,arr=[];return arr[n]="a",arr.splice(n+1,0,"b"),"a"===arr[n]}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){for(var from,O=ES.ToObject(this),A=[],len=ES.ToUint32(O.length),relativeStart=ES.ToInteger(start),actualStart=0>relativeStart?max(len+relativeStart,0):min(relativeStart,len),actualDeleteCount=min(max(ES.ToInteger(deleteCount),0),len-actualStart),k=0;actualDeleteCount>k;)from=$String(actualStart+k),owns(O,from)&&(A[k]=O[from]),k+=1;var to,items=array_slice.call(arguments,2),itemCount=items.length;if(actualDeleteCount>itemCount){for(k=actualStart;len-actualDeleteCount>k;)from=$String(k+actualDeleteCount),to=$String(k+itemCount),owns(O,from)?O[to]=O[from]:delete O[to],k+=1;for(k=len;k>len-actualDeleteCount+itemCount;)delete O[k-1],k-=1}else if(itemCount>actualDeleteCount)for(k=len-actualDeleteCount;k>actualStart;)from=$String(k+actualDeleteCount-1),to=$String(k+itemCount-1),owns(O,from)?O[to]=O[from]:delete O[to],k-=1;k=actualStart;for(var i=0;i<items.length;++i)O[k]=items[i],k+=1;return O.length=len-actualDeleteCount+itemCount,A}},!spliceWorksWithLargeSparseArrays||!spliceWorksWithSmallSparseArrays);var hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),hasProtoEnumBug=function(){}.propertyIsEnumerable("prototype"),hasStringEnumBug=!owns("x","0"),equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},blacklistedKeys={$window:!0,$console:!0,$parent:!0,$self:!0,$frame:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0},hasAutomationEqualityBug=function(){if("undefined"==typeof window)return!1;for(var k in window)try{!blacklistedKeys["$"+k]&&owns(window,k)&&null!==window[k]&&"object"==typeof window[k]&&equalsConstructorPrototype(window[k])}catch(e){return!0}return!1}(),equalsConstructorPrototypeIfNotBuggy=function(object){if("undefined"==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(object);try{return equalsConstructorPrototype(object)}catch(e){return!1}},dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length,isStandardArguments=function(value){return"[object Arguments]"===toStr(value)},isLegacyArguments=function(value){return null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&!isArray(value)&&isCallable(value.callee)},isArguments=isStandardArguments(arguments)?isStandardArguments:isLegacyArguments;defineProperties($Object,{keys:function(object){var isFn=isCallable(object),isArgs=isArguments(object),isObject=null!==object&&"object"==typeof object,isStr=isObject&&isString(object);if(!isObject&&!isFn&&!isArgs)throw new TypeError("Object.keys called on a non-object");var theKeys=[],skipProto=hasProtoEnumBug&&isFn;if(isStr&&hasStringEnumBug||isArgs)for(var i=0;i<object.length;++i)array_push.call(theKeys,$String(i));if(!isArgs)for(var name in object)skipProto&&"prototype"===name||!owns(object,name)||array_push.call(theKeys,$String(name));if(hasDontEnumBug)for(var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object),j=0;dontEnumsLength>j;j++){var dontEnum=dontEnums[j];skipConstructor&&"constructor"===dontEnum||!owns(object,dontEnum)||array_push.call(theKeys,dontEnum)}return theKeys}});var keysWorksWithArguments=$Object.keys&&function(){return 2===$Object.keys(arguments).length}(1,2),keysHasArgumentsLengthBug=$Object.keys&&function(){var argKeys=$Object.keys(arguments);return 1!==arguments.length||1!==argKeys.length||1!==argKeys[0]}(1),originalKeys=$Object.keys;defineProperties($Object,{keys:function(object){return originalKeys(isArguments(object)?array_slice.call(object):object)}},!keysWorksWithArguments||keysHasArgumentsLengthBug);var negativeDate=-621987552e5,negativeYearString="-000001",hasNegativeDateBug=Date.prototype.toISOString&&-1===new Date(negativeDate).toISOString().indexOf(negativeYearString),hasSafari51DateBug=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date(-1).toISOString();defineProperties(Date.prototype,{toISOString:function(){var result,length,value,year,month;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(year=this.getUTCFullYear(),month=this.getUTCMonth(),year+=Math.floor(month/12),month=(month%12+12)%12,result=[month+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],year=(0>year?"-":year>9999?"+":"")+strSlice("00000"+Math.abs(year),year>=0&&9999>=year?-4:-6),length=result.length;length--;)value=result[length],10>value&&(result[length]="0"+value);return year+"-"+array_slice.call(result,0,2).join("-")+"T"+array_slice.call(result,2).join(":")+"."+strSlice("000"+this.getUTCMilliseconds(),-3)+"Z"}},hasNegativeDateBug||hasSafari51DateBug);var dateToJSONIsSupported=function(){try{return Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(negativeDate).toJSON().indexOf(negativeYearString)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){return!1}}();dateToJSONIsSupported||(Date.prototype.toJSON=function(key){var O=$Object(this),tv=ES.ToPrimitive(O);if("number"==typeof tv&&!isFinite(tv))return null;var toISO=O.toISOString;if(!isCallable(toISO))throw new TypeError("toISOString property is not callable");return toISO.call(O)});var supportsExtendedYears=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),acceptsInvalidDates=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z")),doesNotParseY2KNewYear=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(doesNotParseY2KNewYear||acceptsInvalidDates||!supportsExtendedYears){var maxSafeUnsigned32Bit=Math.pow(2,31)-1,hasSafariSignedIntBug=(Math.floor(maxSafeUnsigned32Bit/1e3),isActualNaN(new Date(1970,0,1,0,0,0,maxSafeUnsigned32Bit+1).getTime()));Date=function(NativeDate){var DateShim=function(Y,M,D,h,m,s,ms){var date,length=arguments.length;if(this instanceof NativeDate){var seconds=s,millis=ms;if(hasSafariSignedIntBug&&length>=7&&ms>maxSafeUnsigned32Bit){var msToShift=Math.floor(ms/maxSafeUnsigned32Bit)*maxSafeUnsigned32Bit,sToShift=Math.floor(msToShift/1e3);seconds+=sToShift,millis-=1e3*sToShift}date=1===length&&$String(Y)===Y?new NativeDate(DateShim.parse(Y)):length>=7?new NativeDate(Y,M,D,h,m,seconds,millis):length>=6?new NativeDate(Y,M,D,h,m,seconds):length>=5?new NativeDate(Y,M,D,h,m):length>=4?new NativeDate(Y,M,D,h):length>=3?new NativeDate(Y,M,D):length>=2?new NativeDate(Y,M):length>=1?new NativeDate(Y):new NativeDate}else date=NativeDate.apply(this,arguments);return isPrimitive(date)||defineProperties(date,{constructor:DateShim},!0),date},isoDateExpression=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),months=[0,31,59,90,120,151,181,212,243,273,304,334,365],dayFromMonth=function(year,month){var t=month>1?1:0;return months[month]+Math.floor((year-1969+t)/4)-Math.floor((year-1901+t)/100)+Math.floor((year-1601+t)/400)+365*(year-1970)},toUTC=function(t){var s=0,ms=t;if(hasSafariSignedIntBug&&ms>maxSafeUnsigned32Bit){var msToShift=Math.floor(ms/maxSafeUnsigned32Bit)*maxSafeUnsigned32Bit,sToShift=Math.floor(msToShift/1e3);s+=sToShift,ms-=1e3*sToShift}return $Number(new NativeDate(1970,0,1,0,0,s,ms))};for(var key in NativeDate)owns(NativeDate,key)&&(DateShim[key]=NativeDate[key]);defineProperties(DateShim,{now:NativeDate.now,UTC:NativeDate.UTC},!0),DateShim.prototype=NativeDate.prototype,defineProperties(DateShim.prototype,{constructor:DateShim},!0);var parseShim=function(string){var match=isoDateExpression.exec(string);if(match){var result,year=$Number(match[1]),month=$Number(match[2]||1)-1,day=$Number(match[3]||1)-1,hour=$Number(match[4]||0),minute=$Number(match[5]||0),second=$Number(match[6]||0),millisecond=Math.floor(1e3*$Number(match[7]||0)),isLocalTime=Boolean(match[4]&&!match[8]),signOffset="-"===match[9]?1:-1,hourOffset=$Number(match[10]||0),minuteOffset=$Number(match[11]||0),hasMinutesOrSecondsOrMilliseconds=minute>0||second>0||millisecond>0;return(hasMinutesOrSecondsOrMilliseconds?24:25)>hour&&60>minute&&60>second&&1e3>millisecond&&month>-1&&12>month&&24>hourOffset&&60>minuteOffset&&day>-1&&day<dayFromMonth(year,month+1)-dayFromMonth(year,month)&&(result=60*(24*(dayFromMonth(year,month)+day)+hour+hourOffset*signOffset),result=1e3*(60*(result+minute+minuteOffset*signOffset)+second)+millisecond,isLocalTime&&(result=toUTC(result)),result>=-864e13&&864e13>=result)?result:NaN}return NativeDate.parse.apply(this,arguments)};return defineProperties(DateShim,{parse:parseShim}),DateShim}(Date)}Date.now||(Date.now=function(){return(new Date).getTime()});var hasToFixedBugs=NumberPrototype.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),toFixedHelpers={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(n,c){for(var i=-1,c2=c;++i<toFixedHelpers.size;)c2+=n*toFixedHelpers.data[i],toFixedHelpers.data[i]=c2%toFixedHelpers.base,c2=Math.floor(c2/toFixedHelpers.base)},divide:function(n){for(var i=toFixedHelpers.size,c=0;--i>=0;)c+=toFixedHelpers.data[i],toFixedHelpers.data[i]=Math.floor(c/n),c=c%n*toFixedHelpers.base},numToString:function(){for(var i=toFixedHelpers.size,s="";--i>=0;)if(""!==s||0===i||0!==toFixedHelpers.data[i]){var t=$String(toFixedHelpers.data[i]);""===s?s=t:s+=strSlice("0000000",0,7-t.length)+t}return s},pow:function pow(x,n,acc){return 0===n?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)},log:function(x){for(var n=0,x2=x;x2>=4096;)n+=12,x2/=4096;for(;x2>=2;)n+=1,x2/=2;return n}};defineProperties(NumberPrototype,{toFixed:function(fractionDigits){var f,x,s,m,e,z,j,k;if(f=$Number(fractionDigits),f=isActualNaN(f)?0:Math.floor(f),0>f||f>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(x=$Number(this),isActualNaN(x))return"NaN";if(-1e21>=x||x>=1e21)return $String(x);if(s="",0>x&&(s="-",x=-x),m="0",x>1e-21)if(e=toFixedHelpers.log(x*toFixedHelpers.pow(2,69,1))-69,z=0>e?x*toFixedHelpers.pow(2,-e,1):x/toFixedHelpers.pow(2,e,1),z*=4503599627370496,e=52-e,e>0){for(toFixedHelpers.multiply(0,z),j=f;j>=7;)toFixedHelpers.multiply(1e7,0),j-=7;for(toFixedHelpers.multiply(toFixedHelpers.pow(10,j,1),0),j=e-1;j>=23;)toFixedHelpers.divide(1<<23),j-=23;toFixedHelpers.divide(1<<j),toFixedHelpers.multiply(1,1),toFixedHelpers.divide(2),m=toFixedHelpers.numToString()}else toFixedHelpers.multiply(0,z),toFixedHelpers.multiply(1<<-e,0),m=toFixedHelpers.numToString()+strSlice("0.00000000000000000000",2,2+f);return f>0?(k=m.length,m=f>=k?s+strSlice("0.0000000000000000000",0,f-k+2)+m:s+strSlice(m,0,k-f)+"."+strSlice(m,k-f)):m=s+m,m}},hasToFixedBugs),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var compliantExecNpcg="undefined"==typeof/()??/.exec("")[1],maxSafe32BitInt=Math.pow(2,32)-1;StringPrototype.split=function(separator,limit){var string=this;if("undefined"==typeof separator&&0===limit)return[];if(!isRegex(separator))return strSplit(this,separator,limit);var separator2,match,lastIndex,lastLength,output=[],flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.unicode?"u":"")+(separator.sticky?"y":""),lastLastIndex=0,separatorCopy=new RegExp(separator.source,flags+"g");string+="",compliantExecNpcg||(separator2=new RegExp("^"+separatorCopy.source+"$(?!\\s)",flags));var splitLimit="undefined"==typeof limit?maxSafe32BitInt:ES.ToUint32(limit);for(match=separatorCopy.exec(string);match&&(lastIndex=match.index+match[0].length,!(lastIndex>lastLastIndex&&(array_push.call(output,strSlice(string,lastLastIndex,match.index)),!compliantExecNpcg&&match.length>1&&match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++)"undefined"==typeof arguments[i]&&(match[i]=void 0)}),match.length>1&&match.index<string.length&&array_push.apply(output,array_slice.call(match,1)),lastLength=match[0].length,lastLastIndex=lastIndex,output.length>=splitLimit)));)separatorCopy.lastIndex===match.index&&separatorCopy.lastIndex++,match=separatorCopy.exec(string);return lastLastIndex===string.length?(lastLength||!separatorCopy.test(""))&&array_push.call(output,""):array_push.call(output,strSlice(string,lastLastIndex)),output.length>splitLimit?strSlice(output,0,splitLimit):output}}():"0".split(void 0,0).length&&(StringPrototype.split=function(separator,limit){return"undefined"==typeof separator&&0===limit?[]:strSplit(this,separator,limit)});var str_replace=StringPrototype.replace,replaceReportsGroupsCorrectly=function(){var groups=[];return"x".replace(/x(.)?/g,function(match,group){array_push.call(groups,group)}),1===groups.length&&"undefined"==typeof groups[0]}();replaceReportsGroupsCorrectly||(StringPrototype.replace=function(searchValue,replaceValue){var isFn=isCallable(replaceValue),hasCapturingGroups=isRegex(searchValue)&&/\)[*?]/.test(searchValue.source);if(isFn&&hasCapturingGroups){var wrappedReplaceValue=function(match){var length=arguments.length,originalLastIndex=searchValue.lastIndex;searchValue.lastIndex=0;var args=searchValue.exec(match)||[];return searchValue.lastIndex=originalLastIndex,array_push.call(args,arguments[length-2],arguments[length-1]),replaceValue.apply(this,args)};return str_replace.call(this,searchValue,wrappedReplaceValue)}return str_replace.call(this,searchValue,replaceValue)});var string_substr=StringPrototype.substr,hasNegativeSubstrBug="".substr&&"b"!=="0b".substr(-1);defineProperties(StringPrototype,{substr:function(start,length){var normalizedStart=start;return 0>start&&(normalizedStart=max(this.length+start,0)),string_substr.call(this,normalizedStart,length)}},hasNegativeSubstrBug);var ws="	\n\f\r \u2028\u2029\ufeff",zeroWidth="",wsRegexChars="["+ws+"]",trimBeginRegexp=new RegExp("^"+wsRegexChars+wsRegexChars+"*"),trimEndRegexp=new RegExp(wsRegexChars+wsRegexChars+"*$"),hasTrimWhitespaceBug=StringPrototype.trim&&(ws.trim()||!zeroWidth.trim());defineProperties(StringPrototype,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return $String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}},hasTrimWhitespaceBug),(8!==parseInt(ws+"08")||22!==parseInt(ws+"0x16"))&&(parseInt=function(origParseInt){var hexRegex=/^0[xX]/;return function(str,radix){var string=$String(str).trim(),defaultedRadix=$Number(radix)||(hexRegex.test(string)?16:10);return origParseInt(string,defaultedRadix)}}(parseInt))});
!function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&($browser.cookies(name,undefined),delete lastCookies[name]);for(name in cookies)value=cookies[name],angular.isString(value)||(value=""+value,cookies[name]=value),value!==lastCookies[name]&&($browser.cookies(name,value),lastCookies[name]=value,updated=!0);if(updated){browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?(delete cookies[name],delete lastCookies[name]):cookies[name]=lastCookies[name]=browserCookies[name])}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular);
!function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function $translateCookieStorageFactory($cookieStore){"use strict";var $translateCookieStorage={get:function(name){return $cookieStore.get(name)},set:function(name,value){$cookieStore.put(name,value)},put:function(name,value){$cookieStore.put(name,value)}};return $translateCookieStorage}return angular.module("pascalprecht.translate").factory("$translateCookieStorage",$translateCookieStorageFactory),$translateCookieStorageFactory.$inject=["$cookieStore"],$translateCookieStorageFactory.displayName="$translateCookieStorage","pascalprecht.translate"});
!function(global,factory){"function"==typeof define&&define.amd?define([],factory):"undefined"!=typeof module&&module.exports?module.exports=factory():global.UriTemplate=factory()}(this,function(){function notReallyPercentEncode(string){return encodeURI(string).replace(/%25[0-9][0-9]/g,function(doubleEncoded){return"%"+doubleEncoded.substring(3)})}function uriTemplateSubstitution(spec){var modifier="";uriTemplateGlobalModifiers[spec.charAt(0)]&&(modifier=spec.charAt(0),spec=spec.substring(1));var separator="",prefix="",shouldEscape=!0,showVariables=!1,trimEmptyString=!1;"+"==modifier?shouldEscape=!1:"."==modifier?(prefix=".",separator="."):"/"==modifier?(prefix="/",separator="/"):"#"==modifier?(prefix="#",shouldEscape=!1):";"==modifier?(prefix=";",separator=";",showVariables=!0,trimEmptyString=!0):"?"==modifier?(prefix="?",separator="&",showVariables=!0):"&"==modifier&&(prefix="&",separator="&",showVariables=!0);for(var varNames=[],varList=spec.split(","),varSpecs=[],varSpecMap={},i=0;i<varList.length;i++){var varName=varList[i],truncate=null;if(-1!=varName.indexOf(":")){var parts=varName.split(":");varName=parts[0],truncate=parseInt(parts[1])}for(var suffices={};uriTemplateSuffices[varName.charAt(varName.length-1)];)suffices[varName.charAt(varName.length-1)]=!0,varName=varName.substring(0,varName.length-1);var varSpec={truncate:truncate,name:varName,suffices:suffices};varSpecs.push(varSpec),varSpecMap[varName]=varSpec,varNames.push(varName)}var subFunction=function(valueFunction){for(var result="",startIndex=0,i=0;i<varSpecs.length;i++){var varSpec=varSpecs[i],value=valueFunction(varSpec.name);if(null==value||Array.isArray(value)&&0==value.length||"object"==typeof value&&0==Object.keys(value).length)startIndex++;else if(result+=i==startIndex?prefix:separator||",",Array.isArray(value)){showVariables&&(result+=varSpec.name+"=");for(var j=0;j<value.length;j++)j>0&&(result+=varSpec.suffices["*"]?separator||",":",",varSpec.suffices["*"]&&showVariables&&(result+=varSpec.name+"=")),result+=shouldEscape?encodeURIComponent(value[j]).replace(/!/g,"%21"):notReallyPercentEncode(value[j])}else if("object"==typeof value){showVariables&&!varSpec.suffices["*"]&&(result+=varSpec.name+"=");var first=!0;for(var key in value)first||(result+=varSpec.suffices["*"]?separator||",":","),first=!1,result+=shouldEscape?encodeURIComponent(key).replace(/!/g,"%21"):notReallyPercentEncode(key),result+=varSpec.suffices["*"]?"=":",",result+=shouldEscape?encodeURIComponent(value[key]).replace(/!/g,"%21"):notReallyPercentEncode(value[key])}else showVariables&&(result+=varSpec.name,trimEmptyString&&""==value||(result+="=")),null!=varSpec.truncate&&(value=value.substring(0,varSpec.truncate)),result+=shouldEscape?encodeURIComponent(value).replace(/!/g,"%21"):notReallyPercentEncode(value)}return result},guessFunction=function(stringValue,resultObj){if(prefix){if(stringValue.substring(0,prefix.length)!=prefix)return null;stringValue=stringValue.substring(prefix.length)}if(1==varSpecs.length&&varSpecs[0].suffices["*"]){for(var varSpec=varSpecs[0],varName=varSpec.name,arrayValue=varSpec.suffices["*"]?stringValue.split(separator||","):[stringValue],hasEquals=shouldEscape&&-1!=stringValue.indexOf("="),i=1;i<arrayValue.length;i++){var stringValue=arrayValue[i];hasEquals&&-1==stringValue.indexOf("=")&&(arrayValue[i-1]+=(separator||",")+stringValue,arrayValue.splice(i,1),i--)}for(var i=0;i<arrayValue.length;i++){var stringValue=arrayValue[i];shouldEscape&&-1!=stringValue.indexOf("=")&&(hasEquals=!0);for(var innerArrayValue=stringValue.split(","),j=0;j<innerArrayValue.length;j++)shouldEscape&&(innerArrayValue[j]=decodeURIComponent(innerArrayValue[j]));1==innerArrayValue.length?arrayValue[i]=innerArrayValue[0]:arrayValue[i]=innerArrayValue}if(showVariables||hasEquals){for(var objectValue=resultObj[varName]||{},j=0;j<arrayValue.length;j++){var innerValue=stringValue;if(!showVariables||innerValue){if("string"==typeof arrayValue[j]){var stringValue=arrayValue[j],innerVarName=stringValue.split("=",1)[0],stringValue=stringValue.substring(innerVarName.length+1);innerValue=stringValue}else{var stringValue=arrayValue[j][0],innerVarName=stringValue.split("=",1)[0],stringValue=stringValue.substring(innerVarName.length+1);arrayValue[j][0]=stringValue,innerValue=arrayValue[j]}void 0!==objectValue[innerVarName]?Array.isArray(objectValue[innerVarName])?objectValue[innerVarName].push(innerValue):objectValue[innerVarName]=[objectValue[innerVarName],innerValue]:objectValue[innerVarName]=innerValue}}1==Object.keys(objectValue).length&&void 0!==objectValue[varName]?resultObj[varName]=objectValue[varName]:resultObj[varName]=objectValue}else void 0!==resultObj[varName]?Array.isArray(resultObj[varName])?resultObj[varName]=resultObj[varName].concat(arrayValue):resultObj[varName]=[resultObj[varName]].concat(arrayValue):1!=arrayValue.length||varSpec.suffices["*"]?resultObj[varName]=arrayValue:resultObj[varName]=arrayValue[0]}else{for(var arrayValue=1==varSpecs.length?[stringValue]:stringValue.split(separator||","),specIndexMap={},i=0;i<arrayValue.length;i++){for(var firstStarred=0;firstStarred<varSpecs.length-1&&i>firstStarred&&!varSpecs[firstStarred].suffices["*"];firstStarred++);if(firstStarred!=i){for(var lastStarred=varSpecs.length-1;lastStarred>0&&varSpecs.length-lastStarred<arrayValue.length-i&&!varSpecs[lastStarred].suffices["*"];lastStarred--);varSpecs.length-lastStarred!=arrayValue.length-i?specIndexMap[i]=firstStarred:specIndexMap[i]=lastStarred}else specIndexMap[i]=i}for(var i=0;i<arrayValue.length;i++){var stringValue=arrayValue[i];if(stringValue||!showVariables){var innerArrayValue=stringValue.split(","),hasEquals=!1;if(showVariables){var stringValue=innerArrayValue[0],varName=stringValue.split("=",1)[0],stringValue=stringValue.substring(varName.length+1);innerArrayValue[0]=stringValue;var varSpec=varSpecMap[varName]||varSpecs[0]}else var varSpec=varSpecs[specIndexMap[i]],varName=varSpec.name;for(var j=0;j<innerArrayValue.length;j++)shouldEscape&&(innerArrayValue[j]=decodeURIComponent(innerArrayValue[j]));(showVariables||varSpec.suffices["*"])&&void 0!==resultObj[varName]?Array.isArray(resultObj[varName])?resultObj[varName]=resultObj[varName].concat(innerArrayValue):resultObj[varName]=[resultObj[varName]].concat(innerArrayValue):1!=innerArrayValue.length||varSpec.suffices["*"]?resultObj[varName]=innerArrayValue:resultObj[varName]=innerArrayValue[0]}}}};return subFunction.varNames=varNames,{prefix:prefix,substitution:subFunction,unSubstitution:guessFunction}}function UriTemplate(template){if(!(this instanceof UriTemplate))return new UriTemplate(template);for(var parts=template.split("{"),textParts=[parts.shift()],prefixes=[],substitutions=[],unSubstitutions=[],varNames=[];parts.length>0;){var part=parts.shift(),spec=part.split("}")[0],remainder=part.substring(spec.length+1),funcs=uriTemplateSubstitution(spec);substitutions.push(funcs.substitution),unSubstitutions.push(funcs.unSubstitution),prefixes.push(funcs.prefix),textParts.push(remainder),varNames=varNames.concat(funcs.substitution.varNames)}this.fill=function(valueFunction){if(valueFunction&&"function"!=typeof valueFunction){var value=valueFunction;valueFunction=function(varName){return value[varName]}}for(var result=textParts[0],i=0;i<substitutions.length;i++){var substitution=substitutions[i];result+=substitution(valueFunction),result+=textParts[i+1]}return result},this.fromUri=function(substituted){for(var result={},i=0;i<textParts.length;i++){var part=textParts[i];if(substituted.substring(0,part.length)!==part)return void 0;if(substituted=substituted.substring(part.length),i>=textParts.length-1){if(""==substituted)break;return void 0}for(var nextPart=textParts[i+1],offset=i;;){if(offset==textParts.length-2){var endPart=substituted.substring(substituted.length-nextPart.length);if(endPart!==nextPart)return void 0;var stringValue=substituted.substring(0,substituted.length-nextPart.length);substituted=endPart}else if(nextPart){var nextPartPos=substituted.indexOf(nextPart),stringValue=substituted.substring(0,nextPartPos);substituted=substituted.substring(nextPartPos)}else if(prefixes[offset+1]){var nextPartPos=substituted.indexOf(prefixes[offset+1]);-1===nextPartPos&&(nextPartPos=substituted.length);var stringValue=substituted.substring(0,nextPartPos);substituted=substituted.substring(nextPartPos)}else{if(textParts.length>offset+2){offset++,nextPart=textParts[offset+1];continue}var stringValue=substituted;substituted=""}break}unSubstitutions[i](stringValue,result)}return result},this.varNames=varNames,this.template=template}var uriTemplateGlobalModifiers={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},uriTemplateSuffices={"*":!0};return UriTemplate.prototype={toString:function(){return this.template},fillFromObject:function(obj){return this.fill(obj)}},UriTemplate});
!function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function $translatePartialLoader(){"use strict";function Part(name,priority){this.name=name,this.isActive=!0,this.tables={},this.priority=priority||0}function hasPart(name){return Object.prototype.hasOwnProperty.call(parts,name)}function isStringValid(str){return angular.isString(str)&&""!==str}function isPartAvailable(name){if(!isStringValid(name))throw new TypeError("Invalid type of a first argument, a non-empty string expected.");return hasPart(name)&&parts[name].isActive}function deepExtend(dst,src){for(var property in src)src[property]&&src[property].constructor&&src[property].constructor===Object?(dst[property]=dst[property]||{},deepExtend(dst[property],src[property])):dst[property]=src[property];return dst}function getPrioritizedParts(){var prioritizedParts=[];for(var part in parts)parts[part].isActive&&prioritizedParts.push(parts[part]);return prioritizedParts.sort(function(a,b){return a.priority-b.priority}),prioritizedParts}Part.prototype.parseUrl=function(urlTemplate,targetLang){return angular.isFunction(urlTemplate)?urlTemplate(this.name,targetLang):urlTemplate.replace(/\{part\}/g,this.name).replace(/\{lang\}/g,targetLang)},Part.prototype.getTable=function(lang,$q,$http,$httpOptions,urlTemplate,errorHandler){var deferred=$q.defer();if(this.tables[lang])deferred.resolve(this.tables[lang]);else{var self=this;$http(angular.extend({method:"GET",url:this.parseUrl(urlTemplate,lang)},$httpOptions)).success(function(data){self.tables[lang]=data,deferred.resolve(data)}).error(function(){errorHandler?errorHandler(self.name,lang).then(function(data){self.tables[lang]=data,deferred.resolve(data)},function(){deferred.reject(self.name)}):deferred.reject(self.name)})}return deferred.promise};var parts={};this.addPart=function(name,priority){if(!isStringValid(name))throw new TypeError("Couldn't add part, part name has to be a string!");return hasPart(name)||(parts[name]=new Part(name,priority)),parts[name].isActive=!0,this},this.setPart=function(lang,part,table){if(!isStringValid(lang))throw new TypeError("Couldn't set part.`lang` parameter has to be a string!");if(!isStringValid(part))throw new TypeError("Couldn't set part.`part` parameter has to be a string!");if("object"!=typeof table||null===table)throw new TypeError("Couldn't set part. `table` parameter has to be an object!");return hasPart(part)||(parts[part]=new Part(part),parts[part].isActive=!1),parts[part].tables[lang]=table,this},this.deletePart=function(name){if(!isStringValid(name))throw new TypeError("Couldn't delete part, first arg has to be string.");return hasPart(name)&&(parts[name].isActive=!1),this},this.isPartAvailable=isPartAvailable,this.$get=["$rootScope","$injector","$q","$http",function($rootScope,$injector,$q,$http){var service=function(options){if(!isStringValid(options.key))throw new TypeError("Unable to load data, a key is not a non-empty string.");if(!isStringValid(options.urlTemplate)&&!angular.isFunction(options.urlTemplate))throw new TypeError("Unable to load data, a urlTemplate is not a non-empty string or not a function.");var errorHandler=options.loadFailureHandler;if(void 0!==errorHandler){if(!angular.isString(errorHandler))throw new Error("Unable to load data, a loadFailureHandler is not a string.");errorHandler=$injector.get(errorHandler)}var loaders=[],deferred=$q.defer(),prioritizedParts=getPrioritizedParts();return angular.forEach(prioritizedParts,function(part){loaders.push(part.getTable(options.key,$q,$http,options.$http,options.urlTemplate,errorHandler)),part.urlTemplate=options.urlTemplate}),$q.all(loaders).then(function(){var table={};angular.forEach(prioritizedParts,function(part){deepExtend(table,part.tables[options.key])}),deferred.resolve(table)},function(){deferred.reject(options.key)}),deferred.promise};return service.addPart=function(name,priority){if(!isStringValid(name))throw new TypeError("Couldn't add part, first arg has to be a string");return hasPart(name)?parts[name].isActive||(parts[name].isActive=!0,$rootScope.$emit("$translatePartialLoaderStructureChanged",name)):(parts[name]=new Part(name,priority),$rootScope.$emit("$translatePartialLoaderStructureChanged",name)),service},service.deletePart=function(name,removeData){if(!isStringValid(name))throw new TypeError("Couldn't delete part, first arg has to be string");if(void 0===removeData)removeData=!1;else if("boolean"!=typeof removeData)throw new TypeError("Invalid type of a second argument, a boolean expected.");if(hasPart(name)){var wasActive=parts[name].isActive;if(removeData){var $translate=$injector.get("$translate"),cache=$translate.loaderCache();"string"==typeof cache&&(cache=$injector.get(cache)),"object"==typeof cache&&angular.forEach(parts[name].tables,function(value,key){cache.remove(parts[name].parseUrl(parts[name].urlTemplate,key))}),delete parts[name]}else parts[name].isActive=!1;wasActive&&$rootScope.$emit("$translatePartialLoaderStructureChanged",name)}return service},service.isPartLoaded=function(name,lang){return angular.isDefined(parts[name])&&angular.isDefined(parts[name].tables[lang])},service.getRegisteredParts=function(){var registeredParts=[];return angular.forEach(parts,function(p){p.isActive&&registeredParts.push(p.name)}),registeredParts},service.isPartAvailable=isPartAvailable,service}]}return angular.module("pascalprecht.translate").provider("$translatePartialLoader",$translatePartialLoader),$translatePartialLoader.displayName="$translatePartialLoader","pascalprecht.translate"});
!function(){"use strict";function t(n){if(!n)throw new Error("No options passed to Waypoint constructor");if(!n.element)throw new Error("No element option passed to Waypoint constructor");if(!n.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+e,this.options=t.Adapter.extend({},t.defaults,n),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=n.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),i[this.key]=this,e+=1}var e=0,i={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete i[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.invokeAll=function(t){var e=[];for(var n in i)e.push(i[n]);for(var o=0,r=e.length;r>o;o++)e[o][t]()},t.destroyAll=function(){t.invokeAll("destroy")},t.disableAll=function(){t.invokeAll("disable")},t.enableAll=function(){t.invokeAll("enable")},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=t}(),function(){"use strict";function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=o.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+i,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,n[t.waypointContextKey]=this,i+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var i=0,n={},o=window.Waypoint,r=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete n[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,o.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){(!e.didScroll||o.isTouch)&&(e.didScroll=!0,o.requestAnimationFrame(t))})},e.prototype.handleResize=function(){o.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var i in e){var n=e[i],o=n.newScroll>n.oldScroll,r=o?n.forward:n.backward;for(var s in this.waypoints[i]){var l=this.waypoints[i][s],a=n.oldScroll<l.triggerPoint,h=n.newScroll>=l.triggerPoint,p=a&&h,u=!a&&!h;(p||u)&&(l.queueTrigger(r),t[l.group.id]=l.group)}}for(var c in t)t[c].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?o.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?o.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var i in this.waypoints[e])t.push(this.waypoints[e][i]);for(var n=0,o=t.length;o>n;n++)t[n].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,i=this.adapter.offset(),n={};this.handleScroll(),t={horizontal:{contextOffset:e?0:i.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:i.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var o in t){var r=t[o];for(var s in this.waypoints[o]){var l,a,h,p,u,c=this.waypoints[o][s],f=c.options.offset,d=c.triggerPoint,y=0,g=null==d;c.element!==c.element.window&&(y=c.adapter.offset()[r.offsetProp]),"function"==typeof f?f=f.apply(c):"string"==typeof f&&(f=parseFloat(f),c.options.offset.indexOf("%")>-1&&(f=Math.ceil(r.contextDimension*f/100))),l=r.contextScroll-r.contextOffset,c.triggerPoint=y+l-f,a=d<r.oldScroll,h=c.triggerPoint>=r.oldScroll,p=a&&h,u=!a&&!h,!g&&p?(c.queueTrigger(r.backward),n[c.group.id]=c.group):!g&&u?(c.queueTrigger(r.forward),n[c.group.id]=c.group):g&&r.oldScroll>=c.triggerPoint&&(c.queueTrigger(r.forward),n[c.group.id]=c.group)}}for(var w in n)n[w].flushTriggers();return this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in n)n[t].refresh()},e.findByElement=function(t){return n[t.waypointContextKey]},window.onload=function(){r&&r(),e.refreshAll()},o.requestAnimationFrame=function(e){var i=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t;i.call(window,e)},o.Context=e}(),function(){"use strict";function t(t,e){return t.triggerPoint-e.triggerPoint}function e(t,e){return e.triggerPoint-t.triggerPoint}function i(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),n[this.axis][this.name]=this}var n={vertical:{},horizontal:{}},o=window.Waypoint;i.prototype.add=function(t){this.waypoints.push(t)},i.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},i.prototype.flushTriggers=function(){for(var i in this.triggerQueues){var n=this.triggerQueues[i],o="up"===i||"left"===i;n.sort(o?e:t);for(var r=0,s=n.length;s>r;r+=1){var l=n[r];(l.options.continuous||r===n.length-1)&&l.trigger([i])}}this.clearTriggerQueues()},i.prototype.next=function(e){this.waypoints.sort(t);var i=o.Adapter.inArray(e,this.waypoints),n=i===this.waypoints.length-1;return n?null:this.waypoints[i+1]},i.prototype.previous=function(e){this.waypoints.sort(t);var i=o.Adapter.inArray(e,this.waypoints);return i?this.waypoints[i-1]:null},i.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},i.prototype.remove=function(t){var e=o.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},i.prototype.first=function(){return this.waypoints[0]},i.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},i.findOrCreate=function(t){return n[t.axis][t.name]||new i(t)},o.Group=i}(),function(){"use strict";function t(t){return t===t.window}function e(e){return t(e)?e:e.defaultView}function i(t){this.element=t,this.handlers={}}var n=window.Waypoint;i.prototype.innerHeight=function(){var e=t(this.element);return e?this.element.innerHeight:this.element.clientHeight},i.prototype.innerWidth=function(){var e=t(this.element);return e?this.element.innerWidth:this.element.clientWidth},i.prototype.off=function(t,e){function i(t,e,i){for(var n=0,o=e.length-1;o>n;n++){var r=e[n];i&&i!==r||t.removeEventListener(r)}}var n=t.split("."),o=n[0],r=n[1],s=this.element;if(r&&this.handlers[r]&&o)i(s,this.handlers[r][o],e),this.handlers[r][o]=[];else if(o)for(var l in this.handlers)i(s,this.handlers[l][o]||[],e),this.handlers[l][o]=[];else if(r&&this.handlers[r]){for(var a in this.handlers[r])i(s,this.handlers[r][a],e);this.handlers[r]={}}},i.prototype.offset=function(){if(!this.element.ownerDocument)return null;var t=this.element.ownerDocument.documentElement,i=e(this.element.ownerDocument),n={top:0,left:0};return this.element.getBoundingClientRect&&(n=this.element.getBoundingClientRect()),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}},i.prototype.on=function(t,e){var i=t.split("."),n=i[0],o=i[1]||"__default",r=this.handlers[o]=this.handlers[o]||{},s=r[n]=r[n]||[];s.push(e),this.element.addEventListener(n,e)},i.prototype.outerHeight=function(e){var i,n=this.innerHeight();return e&&!t(this.element)&&(i=window.getComputedStyle(this.element),n+=parseInt(i.marginTop,10),n+=parseInt(i.marginBottom,10)),n},i.prototype.outerWidth=function(e){var i,n=this.innerWidth();return e&&!t(this.element)&&(i=window.getComputedStyle(this.element),n+=parseInt(i.marginLeft,10),n+=parseInt(i.marginRight,10)),n},i.prototype.scrollLeft=function(){var t=e(this.element);return t?t.pageXOffset:this.element.scrollLeft},i.prototype.scrollTop=function(){var t=e(this.element);return t?t.pageYOffset:this.element.scrollTop},i.extend=function(){function t(t,e){if("object"==typeof t&&"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}for(var e=Array.prototype.slice.call(arguments),i=1,n=e.length;n>i;i++)t(e[0],e[i]);return e[0]},i.inArray=function(t,e,i){return null==e?-1:e.indexOf(t,i)},i.isEmptyObject=function(t){for(var e in t)return!1;return!0},n.adapters.push({name:"noframework",Adapter:i}),n.Adapter=i}();
(function(){function fillString(str){var i,blockAmount=(str.length+8>>6)+1,blocks=[];for(i=0;16*blockAmount>i;i++)blocks[i]=0;for(i=0;i<str.length;i++)blocks[i>>2]|=str.charCodeAt(i)<<24-8*(3&i);return blocks[i>>2]|=128<<24-8*(3&i),blocks[16*blockAmount-1]=8*str.length,blocks}function binToHex(binArray){var i,hexString="0123456789abcdef",str="";for(i=0;i<4*binArray.length;i++)str+=hexString.charAt(binArray[i>>2]>>8*(3-i%4)+4&15)+hexString.charAt(binArray[i>>2]>>8*(3-i%4)&15);return str}function coreFunction(blockArray){var olda,oldb,oldc,oldd,olde,t,i,j,w=[],a=1732584193,b=4023233417,c=2562383102,d=271733878,e=3285377520;for(i=0;i<blockArray.length;i+=16){for(olda=a,oldb=b,oldc=c,oldd=d,olde=e,j=0;80>j;j++)16>j?w[j]=blockArray[i+j]:w[j]=cyclicShift(w[j-3]^w[j-8]^w[j-14]^w[j-16],1),t=modPlus(modPlus(cyclicShift(a,5),ft(j,b,c,d)),modPlus(modPlus(e,w[j]),kt(j))),e=d,d=c,c=cyclicShift(b,30),b=a,a=t;a=modPlus(a,olda),b=modPlus(b,oldb),c=modPlus(c,oldc),d=modPlus(d,oldd),e=modPlus(e,olde)}return[a,b,c,d,e]}function ft(t,b,c,d){return 20>t?b&c|~b&d:40>t?b^c^d:60>t?b&c|b&d|c&d:b^c^d}function kt(t){return 20>t?1518500249:40>t?1859775393:60>t?2400959708:3395469782}function modPlus(x,y){var low=(65535&x)+(65535&y),high=(x>>16)+(y>>16)+(low>>16);return high<<16|65535&low}function cyclicShift(num,k){return num<<k|num>>>32-k}function sha1(s){return binToHex(coreFunction(fillString(s)))}var root=this;"function"==typeof define?define(function(){return sha1}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=sha1),exports.sha1=sha1):root.sha1=sha1}).call(this);
!function(ng){"use strict";ng.module("vcRecaptcha",[])}(angular),function(ng){"use strict";var app=ng.module("vcRecaptcha");app.service("vcRecaptchaService",["$window","$q",function($window,$q){function getRecaptcha(){return recaptcha?$q.when(recaptcha):promise}function validateRecaptchaInstance(){if(!recaptcha)throw new Error("reCaptcha has not been loaded yet.")}var recaptcha,deferred=$q.defer(),promise=deferred.promise;return $window.vcRecaptchaApiLoaded=function(){recaptcha=$window.grecaptcha,deferred.resolve(recaptcha)},ng.isDefined($window.grecaptcha)&&$window.vcRecaptchaApiLoaded(),{create:function(elm,key,fn,conf){return conf.callback=fn,conf.sitekey=key,getRecaptcha().then(function(recaptcha){return recaptcha.render(elm,conf)})},reload:function(widgetId){validateRecaptchaInstance(),recaptcha.reset(widgetId)},getResponse:function(widgetId){return validateRecaptchaInstance(),recaptcha.getResponse(widgetId)}}}])}(angular),function(ng){"use strict";function throwNoKeyException(){throw new Error('You need to set the "key" attribute to your public reCaptcha key. If you don\'t have a key, please get one from https://www.google.com/recaptcha/admin/create')}var app=ng.module("vcRecaptcha");app.directive("vcRecaptcha",["$document","$timeout","vcRecaptchaService",function($document,$timeout,vcRecaptcha){return{restrict:"A",require:"?^^form",scope:{response:"=?ngModel",key:"=",theme:"=?",size:"=?",tabindex:"=?",onCreate:"&",onSuccess:"&",onExpire:"&"},link:function(scope,elm,attrs,ctrl){function destroy(){ctrl&&ctrl.$setValidity("recaptcha",null),sessionTimeout&&($timeout.cancel(sessionTimeout),sessionTimeout=null),cleanup()}function cleanup(){angular.element($document[0].querySelectorAll(".pls-container")).parent().remove()}attrs.hasOwnProperty("key")||throwNoKeyException(),scope.widgetId=null;var sessionTimeout,removeCreationListener=scope.$watch("key",function(key){if(key){40!==key.length&&throwNoKeyException();var callback=function(gRecaptchaResponse){$timeout(function(){ctrl&&ctrl.$setValidity("recaptcha",!0),scope.response=gRecaptchaResponse,scope.onSuccess({response:gRecaptchaResponse,widgetId:scope.widgetId})}),sessionTimeout=$timeout(function(){ctrl&&ctrl.$setValidity("recaptcha",!1),scope.response="",scope.onExpire({widgetId:scope.widgetId})},12e4)};vcRecaptcha.create(elm[0],key,callback,{theme:scope.theme||attrs.theme||null,tabindex:scope.tabindex||attrs.tabindex||null,size:scope.size||attrs.size||null}).then(function(widgetId){ctrl&&ctrl.$setValidity("recaptcha",!1),scope.widgetId=widgetId,scope.onCreate({widgetId:widgetId}),scope.$on("$destroy",destroy)}),removeCreationListener()}})}}}])}(angular);
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):"undefined"!=typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b=window.Slick||{};b=function(){function c(c,d){var f,e=this;e.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:a(c),appendDots:a(c),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(a,b){return'<button type="button" data-role="none" role="button" aria-required="false" tabindex="0">'+(b+1)+"</button>"},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},e.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},a.extend(e,e.initials),e.activeBreakpoint=null,e.animType=null,e.animProp=null,e.breakpoints=[],e.breakpointSettings=[],e.cssTransitions=!1,e.hidden="hidden",e.paused=!1,e.positionProp=null,e.respondTo=null,e.rowCount=1,e.shouldClick=!0,e.$slider=a(c),e.$slidesCache=null,e.transformType=null,e.transitionType=null,e.visibilityChange="visibilitychange",e.windowWidth=0,e.windowTimer=null,f=a(c).data("slick")||{},e.options=a.extend({},e.defaults,f,d),e.currentSlide=e.options.initialSlide,e.originalSettings=e.options,"undefined"!=typeof document.mozHidden?(e.hidden="mozHidden",e.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(e.hidden="webkitHidden",e.visibilityChange="webkitvisibilitychange"),e.autoPlay=a.proxy(e.autoPlay,e),e.autoPlayClear=a.proxy(e.autoPlayClear,e),e.changeSlide=a.proxy(e.changeSlide,e),e.clickHandler=a.proxy(e.clickHandler,e),e.selectHandler=a.proxy(e.selectHandler,e),e.setPosition=a.proxy(e.setPosition,e),e.swipeHandler=a.proxy(e.swipeHandler,e),e.dragHandler=a.proxy(e.dragHandler,e),e.keyHandler=a.proxy(e.keyHandler,e),e.autoPlayIterator=a.proxy(e.autoPlayIterator,e),e.instanceUid=b++,e.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,e.registerBreakpoints(),e.init(!0),e.checkResponsive(!0)}var b=0;return c}(),b.prototype.addSlide=b.prototype.slickAdd=function(b,c,d){var e=this;if("boolean"==typeof c)d=c,c=null;else if(0>c||c>=e.slideCount)return!1;e.unload(),"number"==typeof c?0===c&&0===e.$slides.length?a(b).appendTo(e.$slideTrack):d?a(b).insertBefore(e.$slides.eq(c)):a(b).insertAfter(e.$slides.eq(c)):d===!0?a(b).prependTo(e.$slideTrack):a(b).appendTo(e.$slideTrack),e.$slides=e.$slideTrack.children(this.options.slide),e.$slideTrack.children(this.options.slide).detach(),e.$slideTrack.append(e.$slides),e.$slides.each(function(b,c){a(c).attr("data-slick-index",b)}),e.$slidesCache=e.$slides,e.reinit()},b.prototype.animateHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.animate({height:b},a.options.speed)}},b.prototype.animateSlide=function(b,c){var d={},e=this;e.animateHeight(),e.options.rtl===!0&&e.options.vertical===!1&&(b=-b),e.transformsEnabled===!1?e.options.vertical===!1?e.$slideTrack.animate({left:b},e.options.speed,e.options.easing,c):e.$slideTrack.animate({top:b},e.options.speed,e.options.easing,c):e.cssTransitions===!1?(e.options.rtl===!0&&(e.currentLeft=-e.currentLeft),a({animStart:e.currentLeft}).animate({animStart:b},{duration:e.options.speed,easing:e.options.easing,step:function(a){a=Math.ceil(a),e.options.vertical===!1?(d[e.animType]="translate("+a+"px, 0px)",e.$slideTrack.css(d)):(d[e.animType]="translate(0px,"+a+"px)",e.$slideTrack.css(d))},complete:function(){c&&c.call()}})):(e.applyTransition(),b=Math.ceil(b),d[e.animType]=e.options.vertical===!1?"translate3d("+b+"px, 0px, 0px)":"translate3d(0px,"+b+"px, 0px)",e.$slideTrack.css(d),c&&setTimeout(function(){e.disableTransition(),c.call()},e.options.speed))},b.prototype.asNavFor=function(b){var c=this,d=c.options.asNavFor;d&&null!==d&&(d=a(d).not(c.$slider)),null!==d&&"object"==typeof d&&d.each(function(){var c=a(this).slick("getSlick");c.unslicked||c.slideHandler(b,!0)})},b.prototype.applyTransition=function(a){var b=this,c={};c[b.transitionType]=b.options.fade===!1?b.transformType+" "+b.options.speed+"ms "+b.options.cssEase:"opacity "+b.options.speed+"ms "+b.options.cssEase,b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.autoPlay=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer),a.slideCount>a.options.slidesToShow&&a.paused!==!0&&(a.autoPlayTimer=setInterval(a.autoPlayIterator,a.options.autoplaySpeed))},b.prototype.autoPlayClear=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer)},b.prototype.autoPlayIterator=function(){var a=this;a.options.infinite===!1?1===a.direction?(a.currentSlide+1===a.slideCount-1&&(a.direction=0),a.slideHandler(a.currentSlide+a.options.slidesToScroll)):(0===a.currentSlide-1&&(a.direction=1),a.slideHandler(a.currentSlide-a.options.slidesToScroll)):a.slideHandler(a.currentSlide+a.options.slidesToScroll)},b.prototype.buildArrows=function(){var b=this;b.options.arrows===!0&&(b.$prevArrow=a(b.options.prevArrow).addClass("slick-arrow"),b.$nextArrow=a(b.options.nextArrow).addClass("slick-arrow"),b.slideCount>b.options.slidesToShow?(b.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.prependTo(b.options.appendArrows),b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.appendTo(b.options.appendArrows),b.options.infinite!==!0&&b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):b.$prevArrow.add(b.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},b.prototype.buildDots=function(){var c,d,b=this;if(b.options.dots===!0&&b.slideCount>b.options.slidesToShow){for(d='<ul class="'+b.options.dotsClass+'">',c=0;c<=b.getDotCount();c+=1)d+="<li>"+b.options.customPaging.call(this,b,c)+"</li>";d+="</ul>",b.$dots=a(d).appendTo(b.options.appendDots),b.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}},b.prototype.buildOut=function(){var b=this;b.$slides=b.$slider.children(b.options.slide+":not(.slick-cloned)").addClass("slick-slide"),b.slideCount=b.$slides.length,b.$slides.each(function(b,c){a(c).attr("data-slick-index",b).data("originalStyling",a(c).attr("style")||"")}),b.$slidesCache=b.$slides,b.$slider.addClass("slick-slider"),b.$slideTrack=0===b.slideCount?a('<div class="slick-track"/>').appendTo(b.$slider):b.$slides.wrapAll('<div class="slick-track"/>').parent(),b.$list=b.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(),b.$slideTrack.css("opacity",0),(b.options.centerMode===!0||b.options.swipeToSlide===!0)&&(b.options.slidesToScroll=1),a("img[data-lazy]",b.$slider).not("[src]").addClass("slick-loading"),b.setupInfinite(),b.buildArrows(),b.buildDots(),b.updateDots(),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.options.draggable===!0&&b.$list.addClass("draggable")},b.prototype.buildRows=function(){var b,c,d,e,f,g,h,a=this;if(e=document.createDocumentFragment(),g=a.$slider.children(),a.options.rows>1){for(h=a.options.slidesPerRow*a.options.rows,f=Math.ceil(g.length/h),b=0;f>b;b++){var i=document.createElement("div");for(c=0;c<a.options.rows;c++){var j=document.createElement("div");for(d=0;d<a.options.slidesPerRow;d++){var k=b*h+(c*a.options.slidesPerRow+d);g.get(k)&&j.appendChild(g.get(k))}i.appendChild(j)}e.appendChild(i)}a.$slider.html(e),a.$slider.children().children().children().css({width:100/a.options.slidesPerRow+"%",display:"inline-block"})}},b.prototype.checkResponsive=function(b,c){var e,f,g,d=this,h=!1,i=d.$slider.width(),j=window.innerWidth||a(window).width();if("window"===d.respondTo?g=j:"slider"===d.respondTo?g=i:"min"===d.respondTo&&(g=Math.min(j,i)),d.options.responsive&&d.options.responsive.length&&null!==d.options.responsive){f=null;for(e in d.breakpoints)d.breakpoints.hasOwnProperty(e)&&(d.originalSettings.mobileFirst===!1?g<d.breakpoints[e]&&(f=d.breakpoints[e]):g>d.breakpoints[e]&&(f=d.breakpoints[e]));null!==f?null!==d.activeBreakpoint?(f!==d.activeBreakpoint||c)&&(d.activeBreakpoint=f,"unslick"===d.breakpointSettings[f]?d.unslick(f):(d.options=a.extend({},d.originalSettings,d.breakpointSettings[f]),b===!0&&(d.currentSlide=d.options.initialSlide),d.refresh(b)),h=f):(d.activeBreakpoint=f,"unslick"===d.breakpointSettings[f]?d.unslick(f):(d.options=a.extend({},d.originalSettings,d.breakpointSettings[f]),b===!0&&(d.currentSlide=d.options.initialSlide),d.refresh(b)),h=f):null!==d.activeBreakpoint&&(d.activeBreakpoint=null,d.options=d.originalSettings,b===!0&&(d.currentSlide=d.options.initialSlide),d.refresh(b),h=f),b||h===!1||d.$slider.trigger("breakpoint",[d,h])}},b.prototype.changeSlide=function(b,c){var f,g,h,d=this,e=a(b.target);switch(e.is("a")&&b.preventDefault(),e.is("li")||(e=e.closest("li")),h=0!==d.slideCount%d.options.slidesToScroll,f=h?0:(d.slideCount-d.currentSlide)%d.options.slidesToScroll,b.data.message){case"previous":g=0===f?d.options.slidesToScroll:d.options.slidesToShow-f,d.slideCount>d.options.slidesToShow&&d.slideHandler(d.currentSlide-g,!1,c);break;case"next":g=0===f?d.options.slidesToScroll:f,d.slideCount>d.options.slidesToShow&&d.slideHandler(d.currentSlide+g,!1,c);break;case"index":var i=0===b.data.index?0:b.data.index||e.index()*d.options.slidesToScroll;d.slideHandler(d.checkNavigable(i),!1,c),e.children().trigger("focus");break;default:return}},b.prototype.checkNavigable=function(a){var c,d,b=this;if(c=b.getNavigableIndexes(),d=0,a>c[c.length-1])a=c[c.length-1];else for(var e in c){if(a<c[e]){a=d;break}d=c[e]}return a},b.prototype.cleanUpEvents=function(){var b=this;b.options.dots&&null!==b.$dots&&(a("li",b.$dots).off("click.slick",b.changeSlide),b.options.pauseOnDotsHover===!0&&b.options.autoplay===!0&&a("li",b.$dots).off("mouseenter.slick",a.proxy(b.setPaused,b,!0)).off("mouseleave.slick",a.proxy(b.setPaused,b,!1))),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&(b.$prevArrow&&b.$prevArrow.off("click.slick",b.changeSlide),b.$nextArrow&&b.$nextArrow.off("click.slick",b.changeSlide)),b.$list.off("touchstart.slick mousedown.slick",b.swipeHandler),b.$list.off("touchmove.slick mousemove.slick",b.swipeHandler),b.$list.off("touchend.slick mouseup.slick",b.swipeHandler),b.$list.off("touchcancel.slick mouseleave.slick",b.swipeHandler),b.$list.off("click.slick",b.clickHandler),a(document).off(b.visibilityChange,b.visibility),b.$list.off("mouseenter.slick",a.proxy(b.setPaused,b,!0)),b.$list.off("mouseleave.slick",a.proxy(b.setPaused,b,!1)),b.options.accessibility===!0&&b.$list.off("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().off("click.slick",b.selectHandler),a(window).off("orientationchange.slick.slick-"+b.instanceUid,b.orientationChange),a(window).off("resize.slick.slick-"+b.instanceUid,b.resize),a("[draggable!=true]",b.$slideTrack).off("dragstart",b.preventDefault),a(window).off("load.slick.slick-"+b.instanceUid,b.setPosition),a(document).off("ready.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.cleanUpRows=function(){var b,a=this;a.options.rows>1&&(b=a.$slides.children().children(),b.removeAttr("style"),a.$slider.html(b))},b.prototype.clickHandler=function(a){var b=this;b.shouldClick===!1&&(a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault())},b.prototype.destroy=function(b){var c=this;c.autoPlayClear(),c.touchObject={},c.cleanUpEvents(),a(".slick-cloned",c.$slider).detach(),c.$dots&&c.$dots.remove(),c.$prevArrow&&c.$prevArrow.length&&(c.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.prevArrow)&&c.$prevArrow.remove()),c.$nextArrow&&c.$nextArrow.length&&(c.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.nextArrow)&&c.$nextArrow.remove()),c.$slides&&(c.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){a(this).attr("style",a(this).data("originalStyling"))}),c.$slideTrack.children(this.options.slide).detach(),c.$slideTrack.detach(),c.$list.detach(),c.$slider.append(c.$slides)),c.cleanUpRows(),c.$slider.removeClass("slick-slider"),c.$slider.removeClass("slick-initialized"),c.unslicked=!0,b||c.$slider.trigger("destroy",[c])},b.prototype.disableTransition=function(a){var b=this,c={};c[b.transitionType]="",b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.fadeSlide=function(a,b){var c=this;c.cssTransitions===!1?(c.$slides.eq(a).css({zIndex:c.options.zIndex}),c.$slides.eq(a).animate({opacity:1},c.options.speed,c.options.easing,b)):(c.applyTransition(a),c.$slides.eq(a).css({opacity:1,zIndex:c.options.zIndex}),b&&setTimeout(function(){c.disableTransition(a),b.call()},c.options.speed))},b.prototype.fadeSlideOut=function(a){var b=this;b.cssTransitions===!1?b.$slides.eq(a).animate({opacity:0,zIndex:b.options.zIndex-2},b.options.speed,b.options.easing):(b.applyTransition(a),b.$slides.eq(a).css({opacity:0,zIndex:b.options.zIndex-2}))},b.prototype.filterSlides=b.prototype.slickFilter=function(a){var b=this;null!==a&&(b.unload(),b.$slideTrack.children(this.options.slide).detach(),b.$slidesCache.filter(a).appendTo(b.$slideTrack),b.reinit())},b.prototype.getCurrent=b.prototype.slickCurrentSlide=function(){var a=this;return a.currentSlide},b.prototype.getDotCount=function(){var a=this,b=0,c=0,d=0;if(a.options.infinite===!0)for(;b<a.slideCount;)++d,b=c+a.options.slidesToShow,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else if(a.options.centerMode===!0)d=a.slideCount;else for(;b<a.slideCount;)++d,b=c+a.options.slidesToShow,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;return d-1},b.prototype.getLeft=function(a){var c,d,f,b=this,e=0;return b.slideOffset=0,d=b.$slides.first().outerHeight(!0),b.options.infinite===!0?(b.slideCount>b.options.slidesToShow&&(b.slideOffset=-1*b.slideWidth*b.options.slidesToShow,e=-1*d*b.options.slidesToShow),0!==b.slideCount%b.options.slidesToScroll&&a+b.options.slidesToScroll>b.slideCount&&b.slideCount>b.options.slidesToShow&&(a>b.slideCount?(b.slideOffset=-1*(b.options.slidesToShow-(a-b.slideCount))*b.slideWidth,e=-1*(b.options.slidesToShow-(a-b.slideCount))*d):(b.slideOffset=-1*b.slideCount%b.options.slidesToScroll*b.slideWidth,e=-1*b.slideCount%b.options.slidesToScroll*d))):a+b.options.slidesToShow>b.slideCount&&(b.slideOffset=(a+b.options.slidesToShow-b.slideCount)*b.slideWidth,e=(a+b.options.slidesToShow-b.slideCount)*d),b.slideCount<=b.options.slidesToShow&&(b.slideOffset=0,e=0),b.options.centerMode===!0&&b.options.infinite===!0?b.slideOffset+=b.slideWidth*Math.floor(b.options.slidesToShow/2)-b.slideWidth:b.options.centerMode===!0&&(b.slideOffset=0,b.slideOffset+=b.slideWidth*Math.floor(b.options.slidesToShow/2)),c=b.options.vertical===!1?-1*a*b.slideWidth+b.slideOffset:-1*a*d+e,b.options.variableWidth===!0&&(f=b.slideCount<=b.options.slidesToShow||b.options.infinite===!1?b.$slideTrack.children(".slick-slide").eq(a):b.$slideTrack.children(".slick-slide").eq(a+b.options.slidesToShow),c=f[0]?-1*f[0].offsetLeft:0,b.options.centerMode===!0&&(f=b.options.infinite===!1?b.$slideTrack.children(".slick-slide").eq(a):b.$slideTrack.children(".slick-slide").eq(a+b.options.slidesToShow+1),c=f[0]?-1*f[0].offsetLeft:0,c+=(b.$list.width()-f.outerWidth())/2)),c},b.prototype.getOption=b.prototype.slickGetOption=function(a){var b=this;return b.options[a]},b.prototype.getNavigableIndexes=function(){var e,a=this,b=0,c=0,d=[];for(a.options.infinite===!1?e=a.slideCount:(b=-1*a.options.slidesToScroll,c=-1*a.options.slidesToScroll,e=2*a.slideCount);e>b;)d.push(b),b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;return d},b.prototype.getSlick=function(){return this},b.prototype.getSlideCount=function(){var c,d,e,b=this;return e=b.options.centerMode===!0?b.slideWidth*Math.floor(b.options.slidesToShow/2):0,b.options.swipeToSlide===!0?(b.$slideTrack.find(".slick-slide").each(function(c,f){return f.offsetLeft-e+a(f).outerWidth()/2>-1*b.swipeLeft?(d=f,!1):void 0}),c=Math.abs(a(d).attr("data-slick-index")-b.currentSlide)||1):b.options.slidesToScroll},b.prototype.goTo=b.prototype.slickGoTo=function(a,b){var c=this;c.changeSlide({data:{message:"index",index:parseInt(a)}},b)},b.prototype.init=function(b){var c=this;a(c.$slider).hasClass("slick-initialized")||(a(c.$slider).addClass("slick-initialized"),c.buildRows(),c.buildOut(),c.setProps(),c.startLoad(),c.loadSlider(),c.initializeEvents(),c.updateArrows(),c.updateDots()),b&&c.$slider.trigger("init",[c]),c.options.accessibility===!0&&c.initADA()},b.prototype.initArrowEvents=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.on("click.slick",{message:"previous"},a.changeSlide),a.$nextArrow.on("click.slick",{message:"next"},a.changeSlide))},b.prototype.initDotEvents=function(){var b=this;b.options.dots===!0&&b.slideCount>b.options.slidesToShow&&a("li",b.$dots).on("click.slick",{message:"index"},b.changeSlide),b.options.dots===!0&&b.options.pauseOnDotsHover===!0&&b.options.autoplay===!0&&a("li",b.$dots).on("mouseenter.slick",a.proxy(b.setPaused,b,!0)).on("mouseleave.slick",a.proxy(b.setPaused,b,!1))},b.prototype.initializeEvents=function(){var b=this;b.initArrowEvents(),b.initDotEvents(),b.$list.on("touchstart.slick mousedown.slick",{action:"start"},b.swipeHandler),b.$list.on("touchmove.slick mousemove.slick",{action:"move"},b.swipeHandler),b.$list.on("touchend.slick mouseup.slick",{action:"end"},b.swipeHandler),b.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},b.swipeHandler),b.$list.on("click.slick",b.clickHandler),a(document).on(b.visibilityChange,a.proxy(b.visibility,b)),b.$list.on("mouseenter.slick",a.proxy(b.setPaused,b,!0)),b.$list.on("mouseleave.slick",a.proxy(b.setPaused,b,!1)),b.options.accessibility===!0&&b.$list.on("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),a(window).on("orientationchange.slick.slick-"+b.instanceUid,a.proxy(b.orientationChange,b)),a(window).on("resize.slick.slick-"+b.instanceUid,a.proxy(b.resize,b)),a("[draggable!=true]",b.$slideTrack).on("dragstart",b.preventDefault),a(window).on("load.slick.slick-"+b.instanceUid,b.setPosition),a(document).on("ready.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.initUI=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.show(),a.$nextArrow.show()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.show(),a.options.autoplay===!0&&a.autoPlay()},b.prototype.keyHandler=function(a){var b=this;a.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===a.keyCode&&b.options.accessibility===!0?b.changeSlide({data:{message:"previous"}}):39===a.keyCode&&b.options.accessibility===!0&&b.changeSlide({data:{message:"next"}}))},b.prototype.lazyLoad=function(){function g(b){a("img[data-lazy]",b).each(function(){var b=a(this),c=a(this).attr("data-lazy"),d=document.createElement("img");d.onload=function(){b.animate({opacity:0},100,function(){b.attr("src",c).animate({opacity:1},200,function(){b.removeAttr("data-lazy").removeClass("slick-loading")})})},d.src=c})}var c,d,e,f,b=this;b.options.centerMode===!0?b.options.infinite===!0?(e=b.currentSlide+(b.options.slidesToShow/2+1),f=e+b.options.slidesToShow+2):(e=Math.max(0,b.currentSlide-(b.options.slidesToShow/2+1)),f=2+(b.options.slidesToShow/2+1)+b.currentSlide):(e=b.options.infinite?b.options.slidesToShow+b.currentSlide:b.currentSlide,f=e+b.options.slidesToShow,b.options.fade===!0&&(e>0&&e--,f<=b.slideCount&&f++)),c=b.$slider.find(".slick-slide").slice(e,f),g(c),b.slideCount<=b.options.slidesToShow?(d=b.$slider.find(".slick-slide"),g(d)):b.currentSlide>=b.slideCount-b.options.slidesToShow?(d=b.$slider.find(".slick-cloned").slice(0,b.options.slidesToShow),g(d)):0===b.currentSlide&&(d=b.$slider.find(".slick-cloned").slice(-1*b.options.slidesToShow),g(d))},b.prototype.loadSlider=function(){var a=this;a.setPosition(),a.$slideTrack.css({opacity:1}),a.$slider.removeClass("slick-loading"),a.initUI(),"progressive"===a.options.lazyLoad&&a.progressiveLazyLoad()},b.prototype.next=b.prototype.slickNext=function(){var a=this;a.changeSlide({data:{message:"next"}})},b.prototype.orientationChange=function(){var a=this;a.checkResponsive(),a.setPosition()},b.prototype.pause=b.prototype.slickPause=function(){var a=this;a.autoPlayClear(),a.paused=!0},b.prototype.play=b.prototype.slickPlay=function(){var a=this;a.paused=!1,a.autoPlay()},b.prototype.postSlide=function(a){var b=this;b.$slider.trigger("afterChange",[b,a]),b.animating=!1,b.setPosition(),b.swipeLeft=null,b.options.autoplay===!0&&b.paused===!1&&b.autoPlay(),b.options.accessibility===!0&&b.initADA()},b.prototype.prev=b.prototype.slickPrev=function(){var a=this;a.changeSlide({data:{message:"previous"}})},b.prototype.preventDefault=function(a){a.preventDefault()},b.prototype.progressiveLazyLoad=function(){var c,d,b=this;c=a("img[data-lazy]",b.$slider).length,c>0&&(d=a("img[data-lazy]",b.$slider).first(),d.attr("src",d.attr("data-lazy")).removeClass("slick-loading").load(function(){d.removeAttr("data-lazy"),b.progressiveLazyLoad(),b.options.adaptiveHeight===!0&&b.setPosition()}).error(function(){d.removeAttr("data-lazy"),b.progressiveLazyLoad()}))},b.prototype.refresh=function(b){var c=this,d=c.currentSlide;c.destroy(!0),a.extend(c,c.initials,{currentSlide:d}),c.init(),b||c.changeSlide({data:{message:"index",index:d}},!1)},b.prototype.registerBreakpoints=function(){var c,d,e,b=this,f=b.options.responsive||null;if("array"===a.type(f)&&f.length){b.respondTo=b.options.respondTo||"window";for(c in f)if(e=b.breakpoints.length-1,d=f[c].breakpoint,f.hasOwnProperty(c)){for(;e>=0;)b.breakpoints[e]&&b.breakpoints[e]===d&&b.breakpoints.splice(e,1),e--;b.breakpoints.push(d),b.breakpointSettings[d]=f[c].settings}b.breakpoints.sort(function(a,c){return b.options.mobileFirst?a-c:c-a})}},b.prototype.reinit=function(){var b=this;b.$slides=b.$slideTrack.children(b.options.slide).addClass("slick-slide"),b.slideCount=b.$slides.length,b.currentSlide>=b.slideCount&&0!==b.currentSlide&&(b.currentSlide=b.currentSlide-b.options.slidesToScroll),b.slideCount<=b.options.slidesToShow&&(b.currentSlide=0),b.registerBreakpoints(),b.setProps(),b.setupInfinite(),b.buildArrows(),b.updateArrows(),b.initArrowEvents(),b.buildDots(),b.updateDots(),b.initDotEvents(),b.checkResponsive(!1,!0),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),b.setSlideClasses(0),b.setPosition(),b.$slider.trigger("reInit",[b]),b.options.autoplay===!0&&b.focusHandler()},b.prototype.resize=function(){var b=this;a(window).width()!==b.windowWidth&&(clearTimeout(b.windowDelay),b.windowDelay=window.setTimeout(function(){b.windowWidth=a(window).width(),b.checkResponsive(),b.unslicked||b.setPosition()},50))},b.prototype.removeSlide=b.prototype.slickRemove=function(a,b,c){var d=this;return"boolean"==typeof a?(b=a,a=b===!0?0:d.slideCount-1):a=b===!0?--a:a,d.slideCount<1||0>a||a>d.slideCount-1?!1:(d.unload(),c===!0?d.$slideTrack.children().remove():d.$slideTrack.children(this.options.slide).eq(a).remove(),d.$slides=d.$slideTrack.children(this.options.slide),d.$slideTrack.children(this.options.slide).detach(),d.$slideTrack.append(d.$slides),d.$slidesCache=d.$slides,void d.reinit())},b.prototype.setCSS=function(a){var d,e,b=this,c={};b.options.rtl===!0&&(a=-a),d="left"==b.positionProp?Math.ceil(a)+"px":"0px",e="top"==b.positionProp?Math.ceil(a)+"px":"0px",c[b.positionProp]=a,b.transformsEnabled===!1?b.$slideTrack.css(c):(c={},b.cssTransitions===!1?(c[b.animType]="translate("+d+", "+e+")",b.$slideTrack.css(c)):(c[b.animType]="translate3d("+d+", "+e+", 0px)",b.$slideTrack.css(c)))},b.prototype.setDimensions=function(){var a=this;a.options.vertical===!1?a.options.centerMode===!0&&a.$list.css({padding:"0px "+a.options.centerPadding}):(a.$list.height(a.$slides.first().outerHeight(!0)*a.options.slidesToShow),a.options.centerMode===!0&&a.$list.css({padding:a.options.centerPadding+" 0px"})),a.listWidth=a.$list.width(),a.listHeight=a.$list.height(),a.options.vertical===!1&&a.options.variableWidth===!1?(a.slideWidth=Math.ceil(a.listWidth/a.options.slidesToShow),a.$slideTrack.width(Math.ceil(a.slideWidth*a.$slideTrack.children(".slick-slide").length))):a.options.variableWidth===!0?a.$slideTrack.width(5e3*a.slideCount):(a.slideWidth=Math.ceil(a.listWidth),a.$slideTrack.height(Math.ceil(a.$slides.first().outerHeight(!0)*a.$slideTrack.children(".slick-slide").length)));var b=a.$slides.first().outerWidth(!0)-a.$slides.first().width();a.options.variableWidth===!1&&a.$slideTrack.children(".slick-slide").width(a.slideWidth-b)},b.prototype.setFade=function(){var c,b=this;b.$slides.each(function(d,e){c=-1*b.slideWidth*d,b.options.rtl===!0?a(e).css({position:"relative",right:c,top:0,zIndex:b.options.zIndex-2,opacity:0}):a(e).css({position:"relative",left:c,top:0,zIndex:b.options.zIndex-2,opacity:0})}),b.$slides.eq(b.currentSlide).css({zIndex:b.options.zIndex-1,opacity:1})},b.prototype.setHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.css("height",b)}},b.prototype.setOption=b.prototype.slickSetOption=function(b,c,d){var f,g,e=this;if("responsive"===b&&"array"===a.type(c))for(g in c)if("array"!==a.type(e.options.responsive))e.options.responsive=[c[g]];else{for(f=e.options.responsive.length-1;f>=0;)e.options.responsive[f].breakpoint===c[g].breakpoint&&e.options.responsive.splice(f,1),f--;e.options.responsive.push(c[g])}else e.options[b]=c;d===!0&&(e.unload(),e.reinit())},b.prototype.setPosition=function(){var a=this;a.setDimensions(),a.setHeight(),a.options.fade===!1?a.setCSS(a.getLeft(a.currentSlide)):a.setFade(),a.$slider.trigger("setPosition",[a])},b.prototype.setProps=function(){var a=this,b=document.body.style;a.positionProp=a.options.vertical===!0?"top":"left","top"===a.positionProp?a.$slider.addClass("slick-vertical"):a.$slider.removeClass("slick-vertical"),(void 0!==b.WebkitTransition||void 0!==b.MozTransition||void 0!==b.msTransition)&&a.options.useCSS===!0&&(a.cssTransitions=!0),a.options.fade&&("number"==typeof a.options.zIndex?a.options.zIndex<3&&(a.options.zIndex=3):a.options.zIndex=a.defaults.zIndex),void 0!==b.OTransform&&(a.animType="OTransform",a.transformType="-o-transform",a.transitionType="OTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.MozTransform&&(a.animType="MozTransform",a.transformType="-moz-transform",a.transitionType="MozTransition",void 0===b.perspectiveProperty&&void 0===b.MozPerspective&&(a.animType=!1)),void 0!==b.webkitTransform&&(a.animType="webkitTransform",a.transformType="-webkit-transform",a.transitionType="webkitTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.msTransform&&(a.animType="msTransform",a.transformType="-ms-transform",a.transitionType="msTransition",void 0===b.msTransform&&(a.animType=!1)),void 0!==b.transform&&a.animType!==!1&&(a.animType="transform",a.transformType="transform",a.transitionType="transition"),a.transformsEnabled=null!==a.animType&&a.animType!==!1},b.prototype.setSlideClasses=function(a){var c,d,e,f,b=this;d=b.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),b.$slides.eq(a).addClass("slick-current"),b.options.centerMode===!0?(c=Math.floor(b.options.slidesToShow/2),b.options.infinite===!0&&(a>=c&&a<=b.slideCount-1-c?b.$slides.slice(a-c,a+c+1).addClass("slick-active").attr("aria-hidden","false"):(e=b.options.slidesToShow+a,d.slice(e-c+1,e+c+2).addClass("slick-active").attr("aria-hidden","false")),0===a?d.eq(d.length-1-b.options.slidesToShow).addClass("slick-center"):a===b.slideCount-1&&d.eq(b.options.slidesToShow).addClass("slick-center")),b.$slides.eq(a).addClass("slick-center")):a>=0&&a<=b.slideCount-b.options.slidesToShow?b.$slides.slice(a,a+b.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):d.length<=b.options.slidesToShow?d.addClass("slick-active").attr("aria-hidden","false"):(f=b.slideCount%b.options.slidesToShow,e=b.options.infinite===!0?b.options.slidesToShow+a:a,b.options.slidesToShow==b.options.slidesToScroll&&b.slideCount-a<b.options.slidesToShow?d.slice(e-(b.options.slidesToShow-f),e+f).addClass("slick-active").attr("aria-hidden","false"):d.slice(e,e+b.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")),"ondemand"===b.options.lazyLoad&&b.lazyLoad()},b.prototype.setupInfinite=function(){var c,d,e,b=this;if(b.options.fade===!0&&(b.options.centerMode=!1),b.options.infinite===!0&&b.options.fade===!1&&(d=null,b.slideCount>b.options.slidesToShow)){for(e=b.options.centerMode===!0?b.options.slidesToShow+1:b.options.slidesToShow,c=b.slideCount;c>b.slideCount-e;c-=1)d=c-1,a(b.$slides[d]).clone(!0).attr("id","").attr("data-slick-index",d-b.slideCount).prependTo(b.$slideTrack).addClass("slick-cloned");for(c=0;e>c;c+=1)d=c,a(b.$slides[d]).clone(!0).attr("id","").attr("data-slick-index",d+b.slideCount).appendTo(b.$slideTrack).addClass("slick-cloned");b.$slideTrack.find(".slick-cloned").find("[id]").each(function(){a(this).attr("id","")})}},b.prototype.setPaused=function(a){var b=this;b.options.autoplay===!0&&b.options.pauseOnHover===!0&&(b.paused=a,a?b.autoPlayClear():b.autoPlay())},b.prototype.selectHandler=function(b){var c=this,d=a(b.target).is(".slick-slide")?a(b.target):a(b.target).parents(".slick-slide"),e=parseInt(d.attr("data-slick-index"));return e||(e=0),c.slideCount<=c.options.slidesToShow?(c.setSlideClasses(e),void c.asNavFor(e)):void c.slideHandler(e)},b.prototype.slideHandler=function(a,b,c){var d,e,f,g,h=null,i=this;return b=b||!1,i.animating===!0&&i.options.waitForAnimate===!0||i.options.fade===!0&&i.currentSlide===a||i.slideCount<=i.options.slidesToShow?void 0:(b===!1&&i.asNavFor(a),d=a,h=i.getLeft(d),g=i.getLeft(i.currentSlide),i.currentLeft=null===i.swipeLeft?g:i.swipeLeft,i.options.infinite===!1&&i.options.centerMode===!1&&(0>a||a>i.getDotCount()*i.options.slidesToScroll)?void(i.options.fade===!1&&(d=i.currentSlide,c!==!0?i.animateSlide(g,function(){i.postSlide(d)}):i.postSlide(d))):i.options.infinite===!1&&i.options.centerMode===!0&&(0>a||a>i.slideCount-i.options.slidesToScroll)?void(i.options.fade===!1&&(d=i.currentSlide,c!==!0?i.animateSlide(g,function(){i.postSlide(d)}):i.postSlide(d))):(i.options.autoplay===!0&&clearInterval(i.autoPlayTimer),e=0>d?0!==i.slideCount%i.options.slidesToScroll?i.slideCount-i.slideCount%i.options.slidesToScroll:i.slideCount+d:d>=i.slideCount?0!==i.slideCount%i.options.slidesToScroll?0:d-i.slideCount:d,
i.animating=!0,i.$slider.trigger("beforeChange",[i,i.currentSlide,e]),f=i.currentSlide,i.currentSlide=e,i.setSlideClasses(i.currentSlide),i.updateDots(),i.updateArrows(),i.options.fade===!0?(c!==!0?(i.fadeSlideOut(f),i.fadeSlide(e,function(){i.postSlide(e)})):i.postSlide(e),void i.animateHeight()):void(c!==!0?i.animateSlide(h,function(){i.postSlide(e)}):i.postSlide(e))))},b.prototype.startLoad=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.hide(),a.$nextArrow.hide()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.hide(),a.$slider.addClass("slick-loading")},b.prototype.swipeDirection=function(){var a,b,c,d,e=this;return a=e.touchObject.startX-e.touchObject.curX,b=e.touchObject.startY-e.touchObject.curY,c=Math.atan2(b,a),d=Math.round(180*c/Math.PI),0>d&&(d=360-Math.abs(d)),45>=d&&d>=0?e.options.rtl===!1?"left":"right":360>=d&&d>=315?e.options.rtl===!1?"left":"right":d>=135&&225>=d?e.options.rtl===!1?"right":"left":e.options.verticalSwiping===!0?d>=35&&135>=d?"left":"right":"vertical"},b.prototype.swipeEnd=function(){var c,b=this;if(b.dragging=!1,b.shouldClick=b.touchObject.swipeLength>10?!1:!0,void 0===b.touchObject.curX)return!1;if(b.touchObject.edgeHit===!0&&b.$slider.trigger("edge",[b,b.swipeDirection()]),b.touchObject.swipeLength>=b.touchObject.minSwipe)switch(b.swipeDirection()){case"left":c=b.options.swipeToSlide?b.checkNavigable(b.currentSlide+b.getSlideCount()):b.currentSlide+b.getSlideCount(),b.slideHandler(c),b.currentDirection=0,b.touchObject={},b.$slider.trigger("swipe",[b,"left"]);break;case"right":c=b.options.swipeToSlide?b.checkNavigable(b.currentSlide-b.getSlideCount()):b.currentSlide-b.getSlideCount(),b.slideHandler(c),b.currentDirection=1,b.touchObject={},b.$slider.trigger("swipe",[b,"right"])}else b.touchObject.startX!==b.touchObject.curX&&(b.slideHandler(b.currentSlide),b.touchObject={})},b.prototype.swipeHandler=function(a){var b=this;if(!(b.options.swipe===!1||"ontouchend"in document&&b.options.swipe===!1||b.options.draggable===!1&&-1!==a.type.indexOf("mouse")))switch(b.touchObject.fingerCount=a.originalEvent&&void 0!==a.originalEvent.touches?a.originalEvent.touches.length:1,b.touchObject.minSwipe=b.listWidth/b.options.touchThreshold,b.options.verticalSwiping===!0&&(b.touchObject.minSwipe=b.listHeight/b.options.touchThreshold),a.data.action){case"start":b.swipeStart(a);break;case"move":b.swipeMove(a);break;case"end":b.swipeEnd(a)}},b.prototype.swipeMove=function(a){var d,e,f,g,h,b=this;return h=void 0!==a.originalEvent?a.originalEvent.touches:null,!b.dragging||h&&1!==h.length?!1:(d=b.getLeft(b.currentSlide),b.touchObject.curX=void 0!==h?h[0].pageX:a.clientX,b.touchObject.curY=void 0!==h?h[0].pageY:a.clientY,b.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(b.touchObject.curX-b.touchObject.startX,2))),b.options.verticalSwiping===!0&&(b.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(b.touchObject.curY-b.touchObject.startY,2)))),e=b.swipeDirection(),"vertical"!==e?(void 0!==a.originalEvent&&b.touchObject.swipeLength>4&&a.preventDefault(),g=(b.options.rtl===!1?1:-1)*(b.touchObject.curX>b.touchObject.startX?1:-1),b.options.verticalSwiping===!0&&(g=b.touchObject.curY>b.touchObject.startY?1:-1),f=b.touchObject.swipeLength,b.touchObject.edgeHit=!1,b.options.infinite===!1&&(0===b.currentSlide&&"right"===e||b.currentSlide>=b.getDotCount()&&"left"===e)&&(f=b.touchObject.swipeLength*b.options.edgeFriction,b.touchObject.edgeHit=!0),b.swipeLeft=b.options.vertical===!1?d+f*g:d+f*(b.$list.height()/b.listWidth)*g,b.options.verticalSwiping===!0&&(b.swipeLeft=d+f*g),b.options.fade===!0||b.options.touchMove===!1?!1:b.animating===!0?(b.swipeLeft=null,!1):void b.setCSS(b.swipeLeft)):void 0)},b.prototype.swipeStart=function(a){var c,b=this;return 1!==b.touchObject.fingerCount||b.slideCount<=b.options.slidesToShow?(b.touchObject={},!1):(void 0!==a.originalEvent&&void 0!==a.originalEvent.touches&&(c=a.originalEvent.touches[0]),b.touchObject.startX=b.touchObject.curX=void 0!==c?c.pageX:a.clientX,b.touchObject.startY=b.touchObject.curY=void 0!==c?c.pageY:a.clientY,void(b.dragging=!0))},b.prototype.unfilterSlides=b.prototype.slickUnfilter=function(){var a=this;null!==a.$slidesCache&&(a.unload(),a.$slideTrack.children(this.options.slide).detach(),a.$slidesCache.appendTo(a.$slideTrack),a.reinit())},b.prototype.unload=function(){var b=this;a(".slick-cloned",b.$slider).remove(),b.$dots&&b.$dots.remove(),b.$prevArrow&&b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.remove(),b.$nextArrow&&b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.remove(),b.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},b.prototype.unslick=function(a){var b=this;b.$slider.trigger("unslick",[b,a]),b.destroy()},b.prototype.updateArrows=function(){var b,a=this;b=Math.floor(a.options.slidesToShow/2),a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&!a.options.infinite&&(a.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),a.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===a.currentSlide?(a.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),a.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):a.currentSlide>=a.slideCount-a.options.slidesToShow&&a.options.centerMode===!1?(a.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),a.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):a.currentSlide>=a.slideCount-1&&a.options.centerMode===!0&&(a.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),a.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},b.prototype.updateDots=function(){var a=this;null!==a.$dots&&(a.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),a.$dots.find("li").eq(Math.floor(a.currentSlide/a.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))},b.prototype.visibility=function(){var a=this;document[a.hidden]?(a.paused=!0,a.autoPlayClear()):a.options.autoplay===!0&&(a.paused=!1,a.autoPlay())},b.prototype.initADA=function(){var b=this;b.$slides.add(b.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),b.$slideTrack.attr("role","listbox"),b.$slides.not(b.$slideTrack.find(".slick-cloned")).each(function(c){a(this).attr({role:"option","aria-describedby":"slick-slide"+b.instanceUid+c})}),null!==b.$dots&&b.$dots.attr("role","tablist").find("li").each(function(c){a(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+b.instanceUid+c,id:"slick-slide"+b.instanceUid+c})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar"),b.activateADA()},b.prototype.activateADA=function(){var a=this,b=a.$slider.find("*").is(":focus");a.$slideTrack.find(".slick-active").attr({"aria-hidden":"false",tabindex:"0"}).find("a, input, button, select").attr({tabindex:"0"}),b&&a.$slideTrack.find(".slick-active").focus()},b.prototype.focusHandler=function(){var b=this;b.$slider.on("focus.slick blur.slick","*",function(c){c.stopImmediatePropagation();var d=a(this);setTimeout(function(){b.isPlay&&(d.is(":focus")?(b.autoPlayClear(),b.paused=!0):(b.paused=!1,b.autoPlay()))},0)})},a.fn.slick=function(){var g,a=this,c=arguments[0],d=Array.prototype.slice.call(arguments,1),e=a.length,f=0;for(f;e>f;f++)if("object"==typeof c||"undefined"==typeof c?a[f].slick=new b(a[f],c):g=a[f].slick[c].apply(a[f].slick,d),"undefined"!=typeof g)return g;return a}});
"use strict";!function(){function bindMapEvents(scope,eventsStr,googleObject,element){angular.forEach(eventsStr.split(" "),function(eventName){window.google.maps.event.addListener(googleObject,eventName,function(event){element.triggerHandler("map-"+eventName,event),scope.$$phase||scope.$apply()})})}function mapOverlayDirective(directiveName,events){app.directive(directiveName,[function(){return{restrict:"A",link:function(scope,elm,attrs){scope.$watch(attrs[directiveName],function(newObject){newObject&&bindMapEvents(scope,events,newObject,elm)})}}}])}var app=angular.module("ui.map",["ui.event"]);app.value("uiMapConfig",{}).directive("uiMap",["uiMapConfig","$parse",function(uiMapConfig,$parse){var mapEvents="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed",options=uiMapConfig||{};return{restrict:"A",link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions)),map=new window.google.maps.Map(elm[0],opts),model=$parse(attrs.uiMap);model.assign(scope,map),bindMapEvents(scope,mapEvents,map,elm)}}}]),app.value("uiMapInfoWindowConfig",{}).directive("uiMapInfoWindow",["uiMapInfoWindowConfig","$parse","$compile",function(uiMapInfoWindowConfig,$parse,$compile){var infoWindowEvents="closeclick content_change domready position_changed zindex_changed",options=uiMapInfoWindowConfig||{};return{link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions));opts.content=elm[0];var model=$parse(attrs.uiMapInfoWindow),infoWindow=model(scope);infoWindow||(infoWindow=new window.google.maps.InfoWindow(opts),model.assign(scope,infoWindow)),bindMapEvents(scope,infoWindowEvents,infoWindow,elm),elm.replaceWith("<div></div>");var _open=infoWindow.open;infoWindow.open=function(a1,a2,a3,a4,a5,a6){$compile(elm.contents())(scope),_open.call(infoWindow,a1,a2,a3,a4,a5,a6)}}}}]),mapOverlayDirective("uiMapMarker","animation_changed click clickable_changed cursor_changed dblclick drag dragend draggable_changed dragstart flat_changed icon_changed mousedown mouseout mouseover mouseup position_changed rightclick shadow_changed shape_changed title_changed visible_changed zindex_changed"),mapOverlayDirective("uiMapPolyline","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapPolygon","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapRectangle","bounds_changed click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapCircle","center_changed click dblclick mousedown mousemove mouseout mouseover mouseup radius_changed rightclick"),mapOverlayDirective("uiMapGroundOverlay","click dblclick")}();
var deps=[];try{angular.module("ngSanitize"),deps.push("ngSanitize")}catch(e){}try{angular.module("ui.sortable"),deps.push("ui.sortable")}catch(e){}try{angular.module("angularSpectrumColorpicker"),deps.push("angularSpectrumColorpicker")}catch(e){}angular.module("schemaForm",deps),angular.module("schemaForm").provider("sfPath",[function(){var sfPath={parse:ObjectPath.parse};1===angular.version.major&&angular.version.minor<3?sfPath.stringify=function(arr){return Array.isArray(arr)?arr.join("."):arr.toString()}:sfPath.stringify=ObjectPath.stringify,sfPath.normalize=function(data,quote){return sfPath.stringify(Array.isArray(data)?data:sfPath.parse(data),quote)},this.parse=sfPath.parse,this.stringify=sfPath.stringify,this.normalize=sfPath.normalize,this.$get=function(){return sfPath}}]),angular.module("schemaForm").factory("sfSelect",["sfPath",function(sfPath){var numRe=/^\d+$/;return function(projection,obj,valueToSet){obj||(obj=this);var parts="string"==typeof projection?sfPath.parse(projection):projection;if("undefined"!=typeof valueToSet&&1===parts.length)return obj[parts[0]]=valueToSet,obj;"undefined"!=typeof valueToSet&&"undefined"==typeof obj[parts[0]]&&(obj[parts[0]]=parts.length>2&&numRe.test(parts[1])?[]:{});for(var value=obj[parts[0]],i=1;i<parts.length;i++){if(""===parts[i])return void 0;if("undefined"!=typeof valueToSet){if(i===parts.length-1)return value[parts[i]]=valueToSet,valueToSet;var tmp=value[parts[i]];("undefined"==typeof tmp||null===tmp)&&(tmp=numRe.test(parts[i+1])?[]:{},value[parts[i]]=tmp),value=tmp}else value&&(value=value[parts[i]])}return value}}]),angular.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function($compileProvider,sfPathProvider){var defaultDecorator="",directives={},templateUrl=function(name,form){"sfDecorator"===name&&(name=defaultDecorator);for(var directive=directives[name],rules=directive.rules,i=0;i<rules.length;i++){var res=rules[i](form);if(res)return res}return directive.mappings[form.type]?directive.mappings[form.type]:directive.mappings["default"]},createDirective=function(name){$compileProvider.directive(name,["$parse","$compile","$http","$templateCache",function($parse,$compile,$http,$templateCache){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(scope,element,attrs,sfSchema){scope.showTitle=function(){return scope.form&&scope.form.notitle!==!0&&scope.form.title},scope.listToCheckboxValues=function(list){var values={};return angular.forEach(list,function(v){values[v]=!0}),values},scope.checkboxValuesToList=function(values){var lst=[];return angular.forEach(values,function(v,k){v&&lst.push(k)}),lst},scope.buttonClick=function($event,form){angular.isFunction(form.onClick)?form.onClick($event,form):angular.isString(form.onClick)&&(sfSchema?sfSchema.evalInParentScope(form.onClick,{$event:$event,form:form}):scope.$eval(form.onClick,{$event:$event,form:form}))},scope.evalExpr=function(expression,locals){return sfSchema?sfSchema.evalInParentScope(expression,locals):scope.$eval(expression,locals)},scope.evalInScope=function(expression,locals){return expression?scope.$eval(expression,locals):void 0},scope.errorMessage=function(schemaError){return scope.form.validationMessage?schemaError?angular.isString(scope.form.validationMessage)?scope.form.validationMessage:scope.form.validationMessage[schemaError.code]||scope.form.validationMessage["default"]:scope.form.validationMessage.number||scope.form.validationMessage["default"]||scope.form.validationMessage:schemaError?schemaError.message:"Not a number"};var once=scope.$watch(attrs.form,function(form){if(form){form.ngModelOptions=form.ngModelOptions||{},scope.form=form;var url=templateUrl(name,form);$http.get(url,{cache:$templateCache}).then(function(res){var key=form.key?sfPathProvider.stringify(form.key).replace(/"/g,"&quot;"):"",template=res.data.replace(/\$\$value\$\$/g,"model"+("["!==key[0]?".":"")+key);element.html(template),form.condition&&angular.forEach(element.children(),function(child){var ngIf=child.getAttribute("ng-if");child.setAttribute("ng-if",ngIf?"("+ngIf+') || (evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex }))':'evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex })')}),$compile(element.contents())(scope)}),once()}})}}}])},createManualDirective=function(type,templateUrl,transclude){transclude=angular.isDefined(transclude)?transclude:!1,$compileProvider.directive("sf"+angular.uppercase(type[0])+type.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:transclude,template:'<sf-decorator form="form"></sf-decorator>',link:function(scope,element,attrs){var watchThis={items:"c",titleMap:"c",schema:"c"},form={type:type},once=!0;angular.forEach(attrs,function(value,name){if("$"!==name[0]&&0!==name.indexOf("ng")&&"sfField"!==name){var updateForm=function(val){angular.isDefined(val)&&val!==form[name]&&(form[name]=val,once&&form.type&&(form.key||angular.isUndefined(attrs.key))&&(scope.form=form,once=!1))};"model"===name?scope.$watch(value,function(val){val&&scope.model!==val&&(scope.model=val)}):"c"===watchThis[name]?scope.$watchCollection(value,updateForm):attrs.$observe(name,updateForm)}})}}})};this.createDecorator=function(name,mappings,rules){directives[name]={mappings:mappings||{},rules:rules||[]},directives[defaultDecorator]||(defaultDecorator=name),createDirective(name)},this.createDirective=createManualDirective,this.createDirectives=function(mappings){angular.forEach(mappings,function(url,type){createManualDirective(type,url)})},this.directive=function(name){return name=name||defaultDecorator,directives[name]},this.addMapping=function(name,type,url){directives[name]&&(directives[name].mappings[type]=url)},this.$get=function(){return{directive:function(name){return directives[name]},defaultDecorator:defaultDecorator}},createDirective("sfDecorator")}]),angular.module("schemaForm").provider("schemaForm",["sfPathProvider",function(sfPathProvider){var enumToTitleMap=function(enm){var titleMap=[];return enm.forEach(function(name){titleMap.push({name:name,value:name})}),titleMap},canonicalTitleMap=function(titleMap,originalEnum){if(!angular.isArray(titleMap)){var canonical=[];return originalEnum?angular.forEach(originalEnum,function(value,index){canonical.push({name:titleMap[value],value:value})}):angular.forEach(titleMap,function(name,value){canonical.push({name:name,value:value})}),canonical}return titleMap},defaultFormDefinition=function(name,schema,options){var rules=defaults[schema.type];if(rules)for(var def,i=0;i<rules.length;i++)if(def=rules[i](name,schema,options))return def.schema["x-schema-form"]&&angular.isObject(def.schema["x-schema-form"])&&(def=angular.extend(def,def.schema["x-schema-form"])),def},stdFormObj=function(name,schema,options){options=options||{};var f=options.global&&options.global.formDefaults?angular.copy(options.global.formDefaults):{};return options.global&&options.global.supressPropertyTitles===!0?f.title=schema.title:f.title=schema.title||name,schema.description&&(f.description=schema.description),(options.required===!0||schema.required===!0)&&(f.required=!0),schema.maxLength&&(f.maxlength=schema.maxLength),schema.minLength&&(f.minlength=schema.maxLength),(schema.readOnly||schema.readonly)&&(f.readonly=!0),schema.minimum&&(f.minimum=schema.minimum+(schema.exclusiveMinimum?1:0)),schema.maximum&&(f.maximum=schema.maximum-(schema.exclusiveMaximum?1:0)),schema.validationMessage&&(f.validationMessage=schema.validationMessage),schema.enumNames&&(f.titleMap=canonicalTitleMap(schema.enumNames,schema["enum"])),f.schema=schema,f.ngModelOptions=f.ngModelOptions||{},f},text=function(name,schema,options){if("string"===schema.type&&!schema["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="text",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},number=function(name,schema,options){if("number"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="number",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},integer=function(name,schema,options){if("integer"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="number",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},checkbox=function(name,schema,options){if("boolean"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="checkbox",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},select=function(name,schema,options){if("string"===schema.type&&schema["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="select",f.titleMap||(f.titleMap=enumToTitleMap(schema["enum"])),options.lookup[sfPathProvider.stringify(options.path)]=f,f}},checkboxes=function(name,schema,options){if("array"===schema.type&&schema.items&&schema.items["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="checkboxes",f.titleMap||(f.titleMap=enumToTitleMap(schema.items["enum"])),options.lookup[sfPathProvider.stringify(options.path)]=f,f}},fieldset=function(name,schema,options){if("object"===schema.type){var f=stdFormObj(name,schema,options);return f.type="fieldset",f.items=[],options.lookup[sfPathProvider.stringify(options.path)]=f,angular.forEach(schema.properties,function(v,k){var path=options.path.slice();if(path.push(k),options.ignore[sfPathProvider.stringify(path)]!==!0){var required=schema.required&&-1!==schema.required.indexOf(k),def=defaultFormDefinition(k,v,{path:path,required:required||!1,lookup:options.lookup,ignore:options.ignore});def&&f.items.push(def)}}),f}},array=function(name,schema,options){if("array"===schema.type){var f=stdFormObj(name,schema,options);f.type="array",f.key=options.path,options.lookup[sfPathProvider.stringify(options.path)]=f;var required=schema.required&&-1!==schema.required.indexOf(options.path[options.path.length-1]),arrPath=options.path.slice();return arrPath.push(""),f.items=[defaultFormDefinition(name,schema.items,{path:arrPath,required:required||!1,lookup:options.lookup,ignore:options.ignore,global:options.global})],f}},defaults={string:[select,text],object:[fieldset],number:[number],integer:[integer],"boolean":[checkbox],array:[checkboxes,array]},postProcessFn=function(form){return form};this.defaults=defaults,this.stdFormObj=stdFormObj,this.defaultFormDefinition=defaultFormDefinition,this.postProcess=function(fn){postProcessFn=fn},this.appendRule=function(type,rule){defaults[type]||(defaults[type]=[]),defaults[type].push(rule)},this.prependRule=function(type,rule){defaults[type]||(defaults[type]=[]),defaults[type].unshift(rule)},this.createStandardForm=stdFormObj,this.$get=function(){var service={};return service.merge=function(schema,form,ignore,options,readonly){form=form||["*"],options=options||{},readonly=readonly||schema.readonly||schema.readOnly;var stdForm=service.defaults(schema,ignore,options),idx=form.indexOf("*");-1!==idx&&(form=form.slice(0,idx).concat(stdForm.form).concat(form.slice(idx+1)));var lookup=stdForm.lookup;return postProcessFn(form.map(function(obj){if("string"==typeof obj&&(obj={key:obj}),obj.key&&"string"==typeof obj.key&&(obj.key=sfPathProvider.parse(obj.key)),obj.titleMap&&(obj.titleMap=canonicalTitleMap(obj.titleMap)),obj.itemForm){obj.items=[];var str=sfPathProvider.stringify(obj.key),stdForm=lookup[str];angular.forEach(stdForm.items,function(item){var o=angular.copy(obj.itemForm);o.key=item.key,obj.items.push(o)})}if(obj.key){var strid=sfPathProvider.stringify(obj.key);lookup[strid]&&(obj=angular.extend(lookup[strid],obj))}return readonly===!0&&(obj.readonly=!0),obj.items&&(obj.items=service.merge(schema,obj.items,ignore,options,obj.readonly)),obj.tabs&&angular.forEach(obj.tabs,function(tab){tab.items=service.merge(schema,tab.items,ignore,options,obj.readonly)}),"checkbox"===obj.type&&angular.isUndefined(obj.schema["default"])&&(obj.schema["default"]=!1),obj}))},service.defaults=function(schema,ignore,globalOptions){var form=[],lookup={};if(ignore=ignore||{},globalOptions=globalOptions||{},"object"!==schema.type)throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return angular.forEach(schema.properties,function(v,k){if(ignore[k]!==!0){var required=schema.required&&-1!==schema.required.indexOf(k),def=defaultFormDefinition(k,v,{path:[k],lookup:lookup,ignore:ignore,required:required,global:globalOptions});def&&form.push(def)}}),{form:form,lookup:lookup}},service.traverseSchema=function(schema,fn,path,ignoreArrays){ignoreArrays=angular.isDefined(ignoreArrays)?ignoreArrays:!0,path=path||[];var traverse=function(schema,fn,path){if(fn(schema,path),angular.forEach(schema.properties,function(prop,name){var currentPath=path.slice();currentPath.push(name),traverse(prop,fn,currentPath)}),!ignoreArrays&&schema.items){var arrPath=path.slice();arrPath.push(""),traverse(schema.items,fn,arrPath)}};traverse(schema,fn,path||[])},service.traverseForm=function(form,fn){fn(form),angular.forEach(form.items,function(f){service.traverseForm(f,fn)}),form.tabs&&angular.forEach(form.tabs,function(tab){angular.forEach(tab.items,function(f){service.traverseForm(f,fn)})})},service}}]),angular.module("schemaForm").factory("sfValidator",[function(){var validator={};return validator.validate=function(form,value){if(!form)return{valid:!0};var schema=form.schema;if(!schema)return{valid:!0};""===value&&(value=void 0),"number"===form.type&&null===value&&(value=void 0);var wrap={type:"object",properties:{}},propName=form.key[form.key.length-1];wrap.properties[propName]=schema,form.required&&(wrap.required=[propName]);var valueWrap={};return angular.isDefined(value)&&(valueWrap[propName]=value),tv4.validateResult(valueWrap,wrap)},validator}]),angular.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator","sfPath",function(sfSelect,schemaForm,sfValidator,sfPath){var setIndex=function(index){return function(form){form.key&&(form.key[form.key.indexOf("")]=index)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(scope,element,attrs,ngModel){var formDefCache={},once=scope.$watch(attrs.sfArray,function(form){var list=sfSelect(form.key,scope.model);if(scope.$watch("model"+sfPath.normalize(form.key),function(){list=sfSelect(form.key,scope.model),scope.modelArray=list}),angular.isUndefined(list)&&(list=[],sfSelect(form.key,scope.model,list)),scope.modelArray=list,form.items){var subForm=form.items[0];form.items.length>1&&(subForm={type:"section",items:form.items.map(function(item){return item.ngModelOptions=form.ngModelOptions,angular.isUndefined(item.readonly)&&(item.readonly=form.readonly),item})})}if(scope.copyWithIndex=function(index){if(!formDefCache[index]&&subForm){var copy=angular.copy(subForm);copy.arrayIndex=index,schemaForm.traverseForm(copy,setIndex(index)),formDefCache[index]=copy}return formDefCache[index]},scope.appendToArray=function(){var len=list.length,copy=scope.copyWithIndex(len);if(schemaForm.traverseForm(copy,function(part){if(part.key){var def;angular.isDefined(part["default"])&&(def=part["default"]),angular.isDefined(part.schema)&&angular.isDefined(part.schema["default"])&&(def=part.schema["default"]),angular.isDefined(def)&&sfSelect(part.key,scope.model,def)}}),len===list.length){var dflt,type=sfSelect("schema.items.type",form);"object"===type?dflt={}:"array"===type&&(dflt=[]),list.push(dflt)}return scope.validateArray&&scope.validateArray(),list},scope.deleteFromArray=function(index){return list.splice(index,1),scope.validateArray&&scope.validateArray(),ngModel&&ngModel.$setDirty&&ngModel.$setDirty(),list},form.titleMap||form.startEmpty===!0||0!==list.length||scope.appendToArray(),form.titleMap&&form.titleMap.length>0){scope.titleMapValues=[];var updateTitleMapValues=function(arr){scope.titleMapValues=[],arr=arr||[],form.titleMap.forEach(function(item){scope.titleMapValues.push(-1!==arr.indexOf(item.value))})};updateTitleMapValues(scope.modelArray),scope.$watchCollection("modelArray",updateTitleMapValues),scope.$watchCollection("titleMapValues",function(vals){if(vals){for(var arr=scope.modelArray;arr.length>0;)arr.pop();form.titleMap.forEach(function(item,index){vals[index]&&arr.push(item.value)})}})}if(ngModel){var error;scope.validateArray=function(){var result=sfValidator.validate(form,scope.modelArray.length>0?scope.modelArray:void 0);result.valid!==!1||!result.error||""!==result.error.dataPath&&result.error.dataPath!=="/"+form.key[form.key.length-1]?ngModel.$setValidity("schema",!0):(ngModel.$setViewValue(scope.modelArray),error=result.error,ngModel.$setValidity("schema",!1))},scope.$on("schemaFormValidate",scope.validateArray),scope.hasSuccess=function(){return ngModel.$valid&&!ngModel.$pristine},scope.hasError=function(){return ngModel.$invalid},scope.schemaError=function(){return error}}once()})}}}]),angular.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(scope,element,attrs,ctrl){var form=scope.$eval(attrs.sfChanged);form&&form.onChange&&ctrl.$viewChangeListeners.push(function(){angular.isFunction(form.onChange)?form.onChange(ctrl.$modelValue,form):scope.evalExpr(form.onChange,{modelValue:ctrl.$modelValue,form:form})})}}}),angular.module("schemaForm").directive("sfSchema",["$compile","schemaForm","schemaFormDecorators","sfSelect","sfPath",function($compile,schemaForm,schemaFormDecorators,sfSelect,sfPath){var SNAKE_CASE_REGEXP=/[A-Z]/g,snakeCase=function(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})};return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel",options:"=sfOptions"},controller:["$scope",function($scope){this.evalInParentScope=function(expr,locals){return $scope.$parent.$eval(expr,locals)}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(scope,element,attrs,formCtrl,transclude){scope.formCtrl=formCtrl;var ignore={};transclude(scope,function(clone){if(clone.addClass("schema-form-ignore"),element.prepend(clone),element[0].querySelectorAll){var models=element[0].querySelectorAll("[ng-model]");if(models)for(var i=0;i<models.length;i++){var key=models[i].getAttribute("ng-model");ignore[key.substring(key.indexOf(".")+1)]=!0}}});var childScope,lastDigest={},render=function(schema,form){var merged=schemaForm.merge(schema,form,ignore,scope.options),frag=document.createDocumentFragment();childScope&&childScope.$destroy(),childScope=scope.$new(),childScope.schemaForm={form:merged,schema:schema},element.children(":not(.schema-form-ignore)").remove();for(var slots={},slotsFound=element[0].querySelectorAll("*[sf-insert-field]"),i=0;i<slotsFound.length;i++)slots[slotsFound[i].getAttribute("sf-insert-field")]=slotsFound[i];angular.forEach(merged,function(obj,i){var n=document.createElement(attrs.sfDecorator||snakeCase(schemaFormDecorators.defaultDecorator,"-"));if(n.setAttribute("form","schemaForm.form["+i+"]"),obj.key){var slot=slots[sfPath.stringify(obj.key)];if(slot){for(;slot.firstChild;)slot.removeChild(slot.firstChild);return void slot.appendChild(n)}}frag.appendChild(n)}),element[0].appendChild(frag),$compile(element.children())(childScope),schemaForm.traverseSchema(schema,function(prop,path){if(angular.isDefined(prop["default"])){var val=sfSelect(path,scope.model);angular.isUndefined(val)&&sfSelect(path,scope.model,prop["default"])}}),scope.$emit("sf-render-finished",element)};scope.$watch(function(){var schema=scope.schema,form=scope.initialForm||["*"];form&&schema&&schema.type&&(lastDigest.form!==form||lastDigest.schema!==schema)&&Object.keys(schema.properties).length>0&&(lastDigest.schema=schema,lastDigest.form=form,render(schema,form))}),scope.$on("schemaFormRedraw",function(){var schema=scope.schema,form=scope.initialForm||["*"];schema&&render(schema,form)})}}}]),angular.module("schemaForm").directive("schemaValidate",["sfValidator","sfSelect",function(sfValidator,sfSelect){return{restrict:"A",scope:!1,priority:1e3,require:"ngModel",link:function(scope,element,attrs,ngModel){scope.ngModel=ngModel;var error=null,getForm=function(){return form||(form=scope.$eval(attrs.schemaValidate)),form},form=getForm();form.copyValueTo&&ngModel.$viewChangeListeners.push(function(){var paths=form.copyValueTo;angular.forEach(paths,function(path){sfSelect(path,scope.model,ngModel.$modelValue)})}),ngModel.$validators?ngModel.$validators.schema=function(value){var result=sfValidator.validate(getForm(),value);return error=result.error,result.valid}:ngModel.$parsers.push(function(viewValue){if(form=getForm(),!form)return viewValue;var result=sfValidator.validate(form,viewValue);return result.valid?(ngModel.$setValidity("schema",!0),viewValue):(ngModel.$setValidity("schema",!1),void(error=result.error))}),scope.$on("schemaFormValidate",function(){ngModel.$validate?(ngModel.$validate(),ngModel.$invalid&&(ngModel.$dirty=!0,ngModel.$pristine=!1)):ngModel.$setViewValue(ngModel.$viewValue)}),scope.hasSuccess=function(){return ngModel.$valid&&(!ngModel.$pristine||!ngModel.$isEmpty(ngModel.$modelValue))},scope.hasError=function(){return ngModel.$invalid&&!ngModel.$pristine},scope.schemaError=function(){return error}}}}]);
angular.module("schemaForm").run(["$templateCache",function($templateCache){$templateCache.put("directives/decorators/bootstrap/actions-trcl.html",'<div class="btn-group schema-form-actions {{form.htmlClass}}" ng-transclude=""></div>'),$templateCache.put("directives/decorators/bootstrap/actions.html",'<div class="btn-group schema-form-actions {{form.htmlClass}}"><input ng-repeat-start="item in form.items" type="submit" class="btn {{ item.style || \'btn-default\' }} {{form.fieldHtmlClass}}" value="{{item.title}}" ng-if="item.type === \'submit\'"> <button ng-repeat-end="" class="btn {{ item.style || \'btn-default\' }} {{form.fieldHtmlClass}}" type="button" ng-disabled="form.readonly" ng-if="item.type !== \'submit\'" ng-click="buttonClick($event,item)">{{item.title}}</button></div>'),$templateCache.put("directives/decorators/bootstrap/array.html",'<div sf-array="form" class="schema-form-array {{form.htmlClass}}" ng-model="$$value$$" ng-model-options="form.ngModelOptions"><h3 ng-show="form.title && form.notitle !== true">{{ form.title }}</h3><ol class="list-group" ng-model="modelArray" ui-sortable=""><li class="list-group-item {{form.fieldHtmlClass}}" ng-repeat="item in modelArray track by $index"><button ng-hide="form.readonly" ng-click="deleteFromArray($index)" style="position: relative; z-index: 20;" type="button" class="close pull-right"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"></sf-decorator></li></ol><div class="clearfix" style="padding: 15px;"><button ng-hide="form.readonly || form.add === null" ng-click="appendToArray()" type="button" class="btn {{ form.style.add || \'btn-default\' }} pull-right"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</button></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/checkbox.html",'<div class="checkbox schema-form-checkbox {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label><input type="checkbox" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" class="{{form.fieldHtmlClass}}" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="form.title"></span></label><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/checkboxes.html",'<div sf-array="form" ng-model="$$value$$" class="form-group schema-form-checkboxes {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div class="checkbox" ng-repeat="val in titleMapValues track by $index"><label><input type="checkbox" ng-disabled="form.readonly" sf-changed="form" class="{{form.fieldHtmlClass}}" ng-model="titleMapValues[$index]" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="form.titleMap[$index].name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/default.html",'<div class="form-group schema-form-{{form.type}} {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }"><label class="control-label" ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-show="form.key" type="{{form.type}}" step="any" sf-changed="form" placeholder="{{form.placeholder}}" class="form-control {{form.fieldHtmlClass}}" id="{{form.key.slice(-1)[0]}}" ng-model-options="form.ngModelOptions" ng-model="$$value$$" ng-disabled="form.readonly" schema-validate="form" name="{{form.key.slice(-1)[0]}}" aria-describedby="{{form.key.slice(-1)[0] + \'Status\'}}"> <span ng-if="form.feedback !== false" class="form-control-feedback" ng-class="evalInScope(form.feedback) || {\'glyphicon\': true, \'glyphicon-ok\': hasSuccess(), \'glyphicon-remove\': hasError() }" aria-hidden="true"></span> <span ng-if="hasError() || hasSuccess()" id="{{form.key.slice(-1)[0] + \'Status\'}}" class="sr-only">{{ hasSuccess() ? \'(success)\' : \'(error)\' }}</span><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/fieldset-trcl.html",'<fieldset ng-disabled="form.readonly" class="schema-form-fieldset {{form.htmlClass}}"><legend ng-show="form.title">{{ form.title }}</legend><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div><div ng-transclude=""></div></fieldset>'),$templateCache.put("directives/decorators/bootstrap/fieldset.html",'<fieldset ng-disabled="form.readonly" class="schema-form-fieldset {{form.htmlClass}}"><legend ng-show="form.title">{{ form.title }}</legend><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div><sf-decorator ng-repeat="item in form.items" form="item"></sf-decorator></fieldset>'),$templateCache.put("directives/decorators/bootstrap/help.html",'<div class="helpvalue schema-form-helpvalue {{form.htmlClass}}" ng-bind-html="form.helpvalue"></div>'),$templateCache.put("directives/decorators/bootstrap/radio-buttons.html",'<div class="form-group schema-form-radiobuttons {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><div><label class="control-label" ng-show="showTitle()">{{form.title}}</label></div><div class="btn-group"><label class="btn {{ (item.value === $$value$$) ? form.style.selected || \'btn-default\' : form.style.unselected || \'btn-default\'; }}" ng-class="{ active: item.value === $$value$$ }" ng-repeat="item in form.titleMap"><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" style="display: none;" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/radios-inline.html",'<div class="form-group schema-form-radios-inline {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div><label class="radio-inline" ng-repeat="item in form.titleMap"><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/radios.html",'<div class="form-group schema-form-radios {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div class="radio" ng-repeat="item in form.titleMap"><label><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/readonly.html",'<div class="form-group"><label ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-if="form.type !== \'textarea\'" type="text" disabled="" class="form-control" id="{{form.key.slice(-1)[0]}}" value="{{$$value$$}}"> <textarea ng-if="form.type === \'textarea\'" disabled="" class="form-control">{{$$value$$}}</textarea><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/section.html",'<div class="schema-form-section {{form.htmlClass}}"><sf-decorator ng-repeat="item in form.items" form="item"></sf-decorator></div>'),$templateCache.put("directives/decorators/bootstrap/select.html",'<div class="form-group {{form.htmlClass}} schema-form-select" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><select ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-disabled="form.readonly" sf-changed="form" class="form-control {{form.fieldHtmlClass}}" schema-validate="form" ng-options="item.value as item.name for item in form.titleMap" name="{{form.key.slice(-1)[0]}}"></select><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/submit.html",'<div class="form-group schema-form-submit {{form.htmlClass}}"><input type="submit" class="btn {{ form.style || \'btn-primary\' }} {{form.fieldHtmlClass}}" value="{{form.title}}" ng-disabled="form.readonly" ng-if="form.type === \'submit\'"> <button class="btn {{ form.style || \'btn-default\' }}" type="button" ng-click="buttonClick($event,form)" ng-disabled="form.readonly" ng-if="form.type !== \'submit\'">{{form.title}}</button></div>'),$templateCache.put("directives/decorators/bootstrap/tabarray.html",'<div sf-array="form" ng-init="selected = { tab: 0 }" class="clearfix schema-form-tabarray schema-form-tabarray-{{form.tabType || \'left\'}} {{form.htmlClass}}"><div ng-if="!form.tabType || form.tabType !== \'right\'" ng-class="{\'col-xs-3\': !form.tabType || form.tabType === \'left\'}"><ul class="nav nav-tabs" ng-class="{ \'tabs-left\': !form.tabType || form.tabType === \'left\'}"><li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{evalExpr(form.title,{\'$index\':$index, value: item}) || $index}}</a></li><li ng-hide="form.readonly" ng-click="$event.preventDefault() || (selected.tab = appendToArray().length - 1)"><a href="#"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</a></li></ul></div><div ng-class="{\'col-xs-9\': !form.tabType || form.tabType === \'left\' || form.tabType === \'right\'}"><div class="tab-content {{form.fieldHtmlClass}}"><div class="tab-pane clearfix" ng-repeat="item in modelArray track by $index" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"><sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"></sf-decorator><button ng-hide="form.readonly" ng-click="selected.tab = deleteFromArray($index).length - 1" type="button" class="btn {{ form.style.remove || \'btn-default\' }} pull-right"><i class="glyphicon glyphicon-trash"></i> {{ form.remove || \'Remove\'}}</button></div></div></div><div ng-if="form.tabType === \'right\'" class="col-xs-3"><ul class="nav nav-tabs tabs-right"><li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{evalExpr(form.title,{\'$index\':$index, value: item}) || $index}}</a></li><li ng-hide="form.readonly" ng-click="$event.preventDefault() || appendToArray()"><a href="#"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</a></li></ul></div></div>'),$templateCache.put("directives/decorators/bootstrap/tabs.html",'<div ng-init="selected = { tab: 0 }" class="schema-form-tabs {{form.htmlClass}}"><ul class="nav nav-tabs"><li ng-repeat="tab in form.tabs" ng-disabled="form.readonly" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{ tab.title }}</a></li></ul><div class="tab-content {{form.fieldHtmlClass}}"><div class="tab-pane" ng-disabled="form.readonly" ng-repeat="tab in form.tabs" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"><bootstrap-decorator ng-repeat="item in tab.items" form="item"></bootstrap-decorator></div></div></div>'),$templateCache.put("directives/decorators/bootstrap/textarea.html",'<div class="form-group has-feedback {{form.htmlClass}} schema-form-textarea" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <textarea class="form-control {{form.fieldHtmlClass}}" id="{{form.key.slice(-1)[0]}}" sf-changed="form" placeholder="{{form.placeholder}}" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" name="{{form.key.slice(-1)[0]}}"></textarea> <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span></div>')}]),angular.module("schemaForm").config(["schemaFormDecoratorsProvider",function(decoratorsProvider){var base="directives/decorators/bootstrap/";decoratorsProvider.createDecorator("bootstrapDecorator",{textarea:base+"textarea.html",fieldset:base+"fieldset.html",array:base+"array.html",tabarray:base+"tabarray.html",tabs:base+"tabs.html",section:base+"section.html",conditional:base+"section.html",actions:base+"actions.html",select:base+"select.html",checkbox:base+"checkbox.html",checkboxes:base+"checkboxes.html",number:base+"default.html",password:base+"default.html",submit:base+"submit.html",button:base+"submit.html",radios:base+"radios.html","radios-inline":base+"radios-inline.html",radiobuttons:base+"radio-buttons.html",help:base+"help.html","default":base+"default.html"},[]),decoratorsProvider.createDirectives({textarea:base+"textarea.html",select:base+"select.html",checkbox:base+"checkbox.html",checkboxes:base+"checkboxes.html",number:base+"default.html",submit:base+"submit.html",button:base+"submit.html",text:base+"default.html",date:base+"default.html",password:base+"default.html",datepicker:base+"datepicker.html",input:base+"default.html",radios:base+"radios.html","radios-inline":base+"radios-inline.html",radiobuttons:base+"radio-buttons.html"})}]).directive("sfFieldset",function(){return{transclude:!0,scope:!0,templateUrl:"directives/decorators/bootstrap/fieldset-trcl.html",link:function(scope,element,attrs){scope.title=scope.$eval(attrs.title)}}});
!function(a){"use strict";var b=a.module("angularSpectrumColorpicker",[]);!function(){b.directive("spectrumColorpicker",function(){return{restrict:"E",require:"ngModel",scope:{fallbackValue:"=",disabled:"=?",format:"=?",options:"=?",triggerId:"@?",onChange:"&?",onShow:"&?",onHide:"&?",onMove:"&?",onBeforeShow:"&?"},replace:!0,templateUrl:"directive.html",link:function(b,c,d,e){function f(a){var c=a;return c&&(c=a.toString(b.format)),c}function g(c){a.isFunction(b.onChange)&&b.onChange({color:c})}function h(c){var d=b.fallbackValue;c?d=f(c):a.isUndefined(b.fallbackValue)&&(d=c),e.$setViewValue(d),g(d)}var i=c.find("input"),j=function(a){b.$apply(function(){h(a)})},k=function(){return i.spectrum("toggle"),!1},l={color:e.$viewValue},m={};a.forEach({change:"onChange",move:"onMove",hide:"onHide",show:"onShow"},function(c,d){m[d]=function(d){return j(d),"change"!==c&&a.isFunction(b[c])?b[c]({color:f(d)}):void 0}}),a.isFunction(b.onBeforeShow)&&(m.beforeShow=function(a){return b.onBeforeShow({color:f(a)})});var n=a.extend({},l,b.options,m);b.triggerId&&a.element(document.body).on("click","#"+b.triggerId,k),e.$render=function(){i.spectrum("set",e.$viewValue||""),g(e.$viewValue)},n.color&&(i.spectrum("set",n.color||""),h(n.color)),i.spectrum(n),b.$on("$destroy",function(){b.triggerId&&a.element(document.body).off("click","#"+b.triggerId,k),i.spectrum("destroy")}),a.isDefined(n.disabled)&&(b.disabled=!!n.disabled),b.$watch("disabled",function(a){i.spectrum(a?"disable":"enable")})}}})}(),a.module("angularSpectrumColorpicker").run(["$templateCache",function(a){a.put("directive.html","<span><input class=input-small></span>")}])}(window.angular);
!function(window,angular,undefined){"use strict";(function(){angular.module("uiGmapgoogle-maps.providers",[]),angular.module("uiGmapgoogle-maps.wrapped",[]),angular.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),angular.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),angular.module("uiGmapgoogle-maps.directives.api.managers",[]),angular.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),angular.module("uiGmapgoogle-maps.directives.api.options.builders",[]),angular.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),angular.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),angular.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),angular.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),function(){angular.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function($q,uuid){var getScriptUrl,includeScript,isGoogleMapsLoaded,scriptId;return scriptId=void 0,getScriptUrl=function(options){return options.china?"http://maps.google.cn/maps/api/js?":"auto"===options.transport?"//maps.googleapis.com/maps/api/js?":options.transport+"://maps.googleapis.com/maps/api/js?"},includeScript=function(options){var omitOptions,query,script;return omitOptions=["transport","isGoogleMapsForWork","china"],options.isGoogleMapsForWork&&omitOptions.push("key"),query=_.map(_.omit(options,omitOptions),function(v,k){return k+"="+v}),scriptId&&document.getElementById(scriptId).remove(),query=query.join("&"),script=document.createElement("script"),script.id=scriptId="ui_gmap_map_load_"+uuid.generate(),script.type="text/javascript",script.src=getScriptUrl(options)+query,document.body.appendChild(script)},isGoogleMapsLoaded=function(){return angular.isDefined(window.google)&&angular.isDefined(window.google.maps)},{load:function(options){var deferred,randomizedFunctionName;return deferred=$q.defer(),isGoogleMapsLoaded()?(deferred.resolve(window.google.maps),deferred.promise):(randomizedFunctionName=options.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),window[randomizedFunctionName]=function(){window[randomizedFunctionName]=null,deferred.resolve(window.google.maps)},window.navigator.connection&&window.Connection&&window.navigator.connection.type===window.Connection.NONE?document.addEventListener("online",function(){return isGoogleMapsLoaded()?void 0:includeScript(options)}):includeScript(options),deferred.promise)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",sensor:"false"},this.configure=function(options){angular.extend(this.options,options)},this.$get=["uiGmapMapScriptLoader",function(_this){return function(loader){return loader.load(_this.options)}}(this)],this})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendGWin",function(){return{init:_.once(function(){return google||("undefined"!=typeof google&&null!==google?google.maps:void 0)||null!=google.maps.InfoWindow?(google.maps.InfoWindow.prototype._open=google.maps.InfoWindow.prototype.open,google.maps.InfoWindow.prototype._close=google.maps.InfoWindow.prototype.close,google.maps.InfoWindow.prototype._isOpen=!1,google.maps.InfoWindow.prototype.open=function(map,anchor,recurse){null==recurse&&(this._isOpen=!0,this._open(map,anchor,!0))},google.maps.InfoWindow.prototype.close=function(recurse){null==recurse&&(this._isOpen=!1,this._close(!0))},google.maps.InfoWindow.prototype.isOpen=function(val){return null==val&&(val=void 0),null==val?this._isOpen:this._isOpen=val},window.InfoBox&&(window.InfoBox.prototype._open=window.InfoBox.prototype.open,window.InfoBox.prototype._close=window.InfoBox.prototype.close,window.InfoBox.prototype._isOpen=!1,window.InfoBox.prototype.open=function(map,anchor){this._isOpen=!0,this._open(map,anchor)},window.InfoBox.prototype.close=function(){this._isOpen=!1,this._close()},window.InfoBox.prototype.isOpen=function(val){return null==val&&(val=void 0),null==val?this._isOpen:this._isOpen=val}),window.MarkerLabel_?window.MarkerLabel_.prototype.setContent=function(){var content;content=this.marker_.get("labelContent"),content&&!_.isEqual(this.oldContent,content)&&("undefined"==typeof(null!=content?content.nodeType:void 0)?(this.labelDiv_.innerHTML=content,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML,this.oldContent=content):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(content),content=content.cloneNode(!0),this.labelDiv_.innerHTML="",this.eventDiv_.appendChild(content),this.oldContent=content))}:void 0):void 0})}})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").service("uiGmapLodash",function(){return this.intersectionObjects=function(array1,array2,comparison){var res;return null==comparison&&(comparison=void 0),res=_.map(array1,function(_this){return function(obj1){return _.find(array2,function(obj2){return null!=comparison?comparison(obj1,obj2):_.isEqual(obj1,obj2)})}}(this)),_.filter(res,function(o){return null!=o})},this.containsObject=_.includeObject=function(obj,target,comparison){return null==comparison&&(comparison=void 0),null===obj?!1:_.any(obj,function(_this){return function(value){return null!=comparison?comparison(value,target):_.isEqual(value,target)}}(this))},this.differenceObjects=function(array1,array2,comparison){return null==comparison&&(comparison=void 0),_.filter(array1,function(_this){return function(value){return!_this.containsObject(array2,value,comparison)}}(this))},this.withoutObjects=this.differenceObjects,this.indexOfObject=function(array,item,comparison,isSorted){var i,length;if(null==array)return-1;if(i=0,length=array.length,isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;){if(null!=comparison){if(comparison(array[i],item))return i}else if(_.isEqual(array[i],item))return i;i++}return-1},this.isNullOrUndefined=function(thing){return _.isNull(thing||_.isUndefined(thing))},this})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").factory("uiGmapString",function(){return function(str){return this.contains=function(value,fromIndex){return-1!==str.indexOf(value,fromIndex)},this}})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmap_sync",[function(){return{fakePromise:function(){var _cb;return _cb=void 0,{then:function(cb){return _cb=cb},resolve:function(){return _cb.apply(void 0,arguments)}}}}}]).service("uiGmap_async",["$timeout","uiGmapPromise","uiGmapLogger","$q","uiGmapDataStructures","uiGmapGmapUtil",function($timeout,uiGmapPromise,$log,$q,uiGmapDataStructures,uiGmapGmapUtil){var ExposedPromise,PromiseQueueManager,SniffedPromise,_getArrayAndKeys,_getIterateeValue,defaultChunkSize,doChunk,doSkippPromise,each,errorObject,isInProgress,kickPromise,logTryCatch,managePromiseQueue,map,maybeCancelPromises,promiseStatus,promiseTypes,tryCatch;return promiseTypes=uiGmapPromise.promiseTypes,isInProgress=uiGmapPromise.isInProgress,promiseStatus=uiGmapPromise.promiseStatus,ExposedPromise=uiGmapPromise.ExposedPromise,SniffedPromise=uiGmapPromise.SniffedPromise,kickPromise=function(sniffedPromise,cancelCb){var promise;return promise=sniffedPromise.promise(),promise.promiseType=sniffedPromise.promiseType,promise.$$state&&$log.debug("promiseType: "+promise.promiseType+", state: "+promiseStatus(promise.$$state.status)),promise.cancelCb=cancelCb,promise},doSkippPromise=function(sniffedPromise,lastPromise){return sniffedPromise.promiseType===promiseTypes.create&&lastPromise.promiseType!==promiseTypes["delete"]&&lastPromise.promiseType!==promiseTypes.init?($log.debug("lastPromise.promiseType "+lastPromise.promiseType+", newPromiseType: "+sniffedPromise.promiseType+", SKIPPED MUST COME AFTER DELETE ONLY"),!0):!1},maybeCancelPromises=function(queue,sniffedPromise,lastPromise){var first;return sniffedPromise.promiseType===promiseTypes["delete"]&&lastPromise.promiseType!==promiseTypes["delete"]&&null!=lastPromise.cancelCb&&_.isFunction(lastPromise.cancelCb)&&isInProgress(lastPromise)&&($log.debug("promiseType: "+sniffedPromise.promiseType+", CANCELING LAST PROMISE type: "+lastPromise.promiseType),lastPromise.cancelCb("cancel safe"),first=queue.peek(),null!=first&&isInProgress(first))?first.hasOwnProperty("cancelCb")&&_.isFunction(first.cancelCb)?($log.debug("promiseType: "+first.promiseType+", CANCELING FIRST PROMISE type: "+first.promiseType),first.cancelCb("cancel safe")):$log.warn("first promise was not cancelable"):void 0},PromiseQueueManager=function(existingPiecesObj,sniffedPromise,cancelCb){var lastPromise,newPromise;if(existingPiecesObj.existingPieces){if(lastPromise=_.last(existingPiecesObj.existingPieces._content),doSkippPromise(sniffedPromise,lastPromise))return;return maybeCancelPromises(existingPiecesObj.existingPieces,sniffedPromise,lastPromise),newPromise=ExposedPromise(lastPromise["finally"](function(){return kickPromise(sniffedPromise,cancelCb)})),newPromise.cancelCb=cancelCb,newPromise.promiseType=sniffedPromise.promiseType,existingPiecesObj.existingPieces.enqueue(newPromise),lastPromise["finally"](function(){return existingPiecesObj.existingPieces.dequeue()})}return existingPiecesObj.existingPieces=new uiGmapDataStructures.Queue,existingPiecesObj.existingPieces.enqueue(kickPromise(sniffedPromise,cancelCb))},managePromiseQueue=function(objectToLock,promiseType,msg,cancelCb,fnPromise){var cancelLogger;return null==msg&&(msg=""),cancelLogger=function(msg){return $log.debug(msg+": "+msg),null!=cancelCb&&_.isFunction(cancelCb)?cancelCb(msg):void 0},PromiseQueueManager(objectToLock,SniffedPromise(fnPromise,promiseType),cancelLogger)},defaultChunkSize=80,errorObject={value:null},tryCatch=function(fn,ctx,args){var e;try{return fn.apply(ctx,args)}catch(_error){return e=_error,errorObject.value=e,errorObject}},logTryCatch=function(fn,ctx,deferred,args){var msg,result;return result=tryCatch(fn,ctx,args),result===errorObject&&(msg="error within chunking iterator: "+errorObject.value,$log.error(msg),deferred.reject(msg)),"cancel safe"===result?!1:!0},_getIterateeValue=function(collection,array,index){var _isArray,valOrKey;return _isArray=collection===array,valOrKey=array[index],_isArray?valOrKey:collection[valOrKey]},_getArrayAndKeys=function(collection,keys,bailOutCb,cb){var array;return angular.isArray(collection)?array=collection:(array=keys?keys:Object.keys(_.omit(collection,["length","forEach","map"])),keys=array),null==cb&&(cb=bailOutCb),angular.isArray(array)&&(void 0===array||(null!=array?array.length:void 0)<=0)&&cb!==bailOutCb?bailOutCb():cb(array,keys)},doChunk=function(collection,chunkSizeOrDontChunk,pauseMilli,chunkCb,pauseCb,overallD,index,_keys){return _getArrayAndKeys(collection,_keys,function(array,keys){var cnt,i,keepGoing,val;for(cnt=chunkSizeOrDontChunk&&chunkSizeOrDontChunk<array.length?chunkSizeOrDontChunk:array.length,i=index,keepGoing=!0;keepGoing&&cnt--&&i<(array?array.length:i+1);)val=_getIterateeValue(collection,array,i),keepGoing=angular.isFunction(val)?!0:logTryCatch(chunkCb,void 0,overallD,[val,i]),++i;if(array){if(!(keepGoing&&i<array.length))return overallD.resolve();if(index=i,chunkSizeOrDontChunk)return null!=pauseCb&&_.isFunction(pauseCb)&&logTryCatch(pauseCb,void 0,overallD,[]),$timeout(function(){return doChunk(collection,chunkSizeOrDontChunk,pauseMilli,chunkCb,pauseCb,overallD,index,keys)},pauseMilli,!1)}})},each=function(collection,chunk,chunkSizeOrDontChunk,pauseCb,index,pauseMilli,_keys){var error,overallD,ret;return null==chunkSizeOrDontChunk&&(chunkSizeOrDontChunk=defaultChunkSize),null==index&&(index=0),null==pauseMilli&&(pauseMilli=1),ret=void 0,overallD=uiGmapPromise.defer(),ret=overallD.promise,pauseMilli?_getArrayAndKeys(collection,_keys,function(){return overallD.resolve(),ret},function(array,keys){return doChunk(collection,chunkSizeOrDontChunk,pauseMilli,chunk,pauseCb,overallD,index,keys),ret}):(error="pause (delay) must be set from _async!",$log.error(error),overallD.reject(error),ret)},map=function(collection,iterator,chunkSizeOrDontChunk,pauseCb,index,pauseMilli,_keys){var results;return results=[],_getArrayAndKeys(collection,_keys,function(){return uiGmapPromise.resolve(results)},function(array,keys){return each(collection,function(o){return results.push(iterator(o))},chunkSizeOrDontChunk,pauseCb,index,pauseMilli,keys).then(function(){return results})})},{each:each,map:map,managePromiseQueue:managePromiseQueue,promiseLock:managePromiseQueue,defaultChunkSize:defaultChunkSize,chunkSizeFrom:function(fromSize,ret){return null==ret&&(ret=void 0),_.isNumber(fromSize)&&(ret=fromSize),(uiGmapGmapUtil.isFalse(fromSize)||fromSize===!1)&&(ret=!1),ret}}}])}.call(this),function(){var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapBaseObject",function(){var BaseObject,baseObjectKeywords;return baseObjectKeywords=["extended","included"],BaseObject=function(){function BaseObject(){}return BaseObject.extend=function(obj){var key,ref,value;for(key in obj)value=obj[key],indexOf.call(baseObjectKeywords,key)<0&&(this[key]=value);return null!=(ref=obj.extended)&&ref.apply(this),this},BaseObject.include=function(obj){var key,ref,value;for(key in obj)value=obj[key],indexOf.call(baseObjectKeywords,key)<0&&(this.prototype[key]=value);return null!=(ref=obj.included)&&ref.apply(this),this},BaseObject}()})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChildEvents",function(){return{onChildCreation:function(child){}}})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapCtrlHandle",["$q",function($q){var CtrlHandle;return CtrlHandle={handle:function($scope,$element){return $scope.$on("$destroy",function(){return CtrlHandle.handle($scope)}),$scope.deferred=$q.defer(),{getScope:function(){return $scope}}},mapPromise:function(scope,ctrl){var mapScope;return mapScope=ctrl.getScope(),mapScope.deferred.promise.then(function(map){return scope.map=map}),mapScope.deferred.promise}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function($log){var _getEventsObj,_hasEvents;return _hasEvents=function(obj){return angular.isDefined(obj.events)&&null!=obj.events&&angular.isObject(obj.events)},_getEventsObj=function(scope,model){return _hasEvents(scope)?scope:_hasEvents(model)?model:void 0},{setEvents:function(gObject,scope,model,ignores){var eventObj;return eventObj=_getEventsObj(scope,model),null!=eventObj?_.compact(_.map(eventObj.events,function(eventHandler,eventName){var doIgnore;return ignores&&(doIgnore=_(ignores).contains(eventName)),eventObj.events.hasOwnProperty(eventName)&&angular.isFunction(eventObj.events[eventName])&&!doIgnore?google.maps.event.addListener(gObject,eventName,function(){return scope.$evalAsync||(scope.$evalAsync=function(){}),scope.$evalAsync(eventHandler.apply(scope,[gObject,eventName,model,arguments]))}):void 0})):void 0},removeEvents:function(listeners){return listeners?listeners.forEach(function(l){return l?google.maps.event.removeListener(l):void 0}):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapFitHelper",["uiGmapLogger","uiGmap_async",function($log,_async){return{fit:function(gMarkers,gMap){var bounds,everSet;return gMap&&gMarkers&&gMarkers.length>0&&(bounds=new google.maps.LatLngBounds,everSet=!1,gMarkers.forEach(function(_this){return function(gMarker){return gMarker?(everSet||(everSet=!0),bounds.extend(gMarker.getPosition())):void 0}}(this)),everSet)?gMap.fitBounds(bounds):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(Logger,$compile){var _isFalse,_isTruthy,getCoords,getLatitude,getLongitude,validateCoords;return _isTruthy=function(value,bool,optionsArray){return value===bool||-1!==optionsArray.indexOf(value)},_isFalse=function(value){return _isTruthy(value,!1,["false","FALSE",0,"n","N","no","NO"])},getLatitude=function(value){return Array.isArray(value)&&2===value.length?value[1]:angular.isDefined(value.type)&&"Point"===value.type?value.coordinates[1]:value.latitude},getLongitude=function(value){return Array.isArray(value)&&2===value.length?value[0]:angular.isDefined(value.type)&&"Point"===value.type?value.coordinates[0]:value.longitude},getCoords=function(value){return value?Array.isArray(value)&&2===value.length?new google.maps.LatLng(value[1],value[0]):angular.isDefined(value.type)&&"Point"===value.type?new google.maps.LatLng(value.coordinates[1],value.coordinates[0]):new google.maps.LatLng(value.latitude,value.longitude):void 0},validateCoords=function(coords){if(angular.isUndefined(coords))return!1;if(_.isArray(coords)){if(2===coords.length)return!0}else if(null!=coords&&(null!=coords?coords.type:void 0)&&"Point"===coords.type&&_.isArray(coords.coordinates)&&2===coords.coordinates.length)return!0;return coords&&angular.isDefined((null!=coords?coords.latitude:void 0)&&angular.isDefined(null!=coords?coords.longitude:void 0))?!0:!1},{setCoordsFromEvent:function(prevValue,newLatLon){return prevValue?(Array.isArray(prevValue)&&2===prevValue.length?(prevValue[1]=newLatLon.lat(),prevValue[0]=newLatLon.lng()):angular.isDefined(prevValue.type)&&"Point"===prevValue.type?(prevValue.coordinates[1]=newLatLon.lat(),prevValue.coordinates[0]=newLatLon.lng()):(prevValue.latitude=newLatLon.lat(),prevValue.longitude=newLatLon.lng()),prevValue):void 0},getLabelPositionPoint:function(anchor){var xPos,yPos;return void 0===anchor?void 0:(anchor=/^([-\d\.]+)\s([-\d\.]+)$/.exec(anchor),xPos=parseFloat(anchor[1]),yPos=parseFloat(anchor[2]),null!=xPos&&null!=yPos?new google.maps.Point(xPos,yPos):void 0)},createWindowOptions:function(gMarker,scope,content,defaults){var options;return null!=content&&null!=defaults&&null!=$compile?(options=angular.extend({},defaults,{content:this.buildContent(scope,defaults,content),position:null!=defaults.position?defaults.position:angular.isObject(gMarker)?gMarker.getPosition():getCoords(scope.coords)}),null!=gMarker&&null==(null!=options?options.pixelOffset:void 0)&&(null==options.boxClass||(options.pixelOffset={height:0,width:-2})),options):defaults?defaults:(Logger.error("infoWindow defaults not defined"),content?void 0:Logger.error("infoWindow content not defined"))},buildContent:function(scope,defaults,content){var parsed,ret;return null!=defaults.content?ret=defaults.content:null!=$compile?(content=content.replace(/^\s+|\s+$/g,""),parsed=""===content?"":$compile(content)(scope),parsed.length>0&&(ret=parsed[0])):ret=content,ret},defaultDelay:50,isTrue:function(value){return _isTruthy(value,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:_isFalse,isFalsy:function(value){return _isTruthy(value,!1,[void 0,null])||_isFalse(value)},getCoords:getCoords,validateCoords:validateCoords,equalCoords:function(coord1,coord2){return getLatitude(coord1)===getLatitude(coord2)&&getLongitude(coord1)===getLongitude(coord2)},validatePath:function(path){var array,i,polygon,trackMaxVertices;if(i=0,angular.isUndefined(path.type)){if(!Array.isArray(path)||path.length<2)return!1;for(;i<path.length;){if(!(angular.isDefined(path[i].latitude)&&angular.isDefined(path[i].longitude)||"function"==typeof path[i].lat&&"function"==typeof path[i].lng))return!1;i++}return!0}if(angular.isUndefined(path.coordinates))return!1;if("Polygon"===path.type){if(path.coordinates[0].length<4)return!1;array=path.coordinates[0]}else if("MultiPolygon"===path.type){if(trackMaxVertices={max:0,index:0},_.forEach(path.coordinates,function(polygon,index){return polygon[0].length>this.max?(this.max=polygon[0].length,this.index=index):void 0},trackMaxVertices),polygon=path.coordinates[trackMaxVertices.index],array=polygon[0],array.length<4)return!1}else{if("LineString"!==path.type)return!1;if(path.coordinates.length<2)return!1;array=path.coordinates}for(;i<array.length;){if(2!==array[i].length)return!1;i++}return!0},convertPathPoints:function(path){var array,i,latlng,result,trackMaxVertices;if(i=0,result=new google.maps.MVCArray,angular.isUndefined(path.type))for(;i<path.length;)angular.isDefined(path[i].latitude)&&angular.isDefined(path[i].longitude)?latlng=new google.maps.LatLng(path[i].latitude,path[i].longitude):"function"==typeof path[i].lat&&"function"==typeof path[i].lng&&(latlng=path[i]),result.push(latlng),i++;else for("Polygon"===path.type?array=path.coordinates[0]:"MultiPolygon"===path.type?(trackMaxVertices={max:0,index:0},_.forEach(path.coordinates,function(polygon,index){return polygon[0].length>this.max?(this.max=polygon[0].length,this.index=index):void 0},trackMaxVertices),array=path.coordinates[trackMaxVertices.index][0]):"LineString"===path.type&&(array=path.coordinates);i<array.length;)result.push(new google.maps.LatLng(array[i][1],array[i][0])),i++;return result},extendMapBounds:function(map,points){var bounds,i;for(bounds=new google.maps.LatLngBounds,i=0;i<points.length;)bounds.extend(points.getAt(i)),i++;return map.fitBounds(bounds)},getPath:function(object,key){var obj;return null!=key&&_.isString(key)?(obj=object,_.each(key.split("."),function(value){return obj?obj=obj[value]:void 0}),obj):key},validateBoundPoints:function(bounds){return angular.isUndefined(bounds.sw.latitude)||angular.isUndefined(bounds.sw.longitude)||angular.isUndefined(bounds.ne.latitude)||angular.isUndefined(bounds.ne.longitude)?!1:!0},convertBoundPoints:function(bounds){var result;return result=new google.maps.LatLngBounds(new google.maps.LatLng(bounds.sw.latitude,bounds.sw.longitude),new google.maps.LatLng(bounds.ne.latitude,bounds.ne.longitude))},fitMapBounds:function(map,bounds){return map.fitBounds(bounds)}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapIsReady",["$q","$timeout",function($q,$timeout){var _checkIfReady,_ctr,_currentCheckNum,_maxCtrChecks,_promises,_proms;return _ctr=0,_proms=[],_currentCheckNum=1,_maxCtrChecks=50,_promises=function(){return $q.all(_proms)},_checkIfReady=function(deferred,expectedInstances){return $timeout(function(){return _currentCheckNum>=_maxCtrChecks&&deferred.reject("Your maps are not found we have checked the maximum amount of times. :)"),_currentCheckNum+=1,_ctr!==expectedInstances?_checkIfReady(deferred,expectedInstances):deferred.resolve(_promises())},100)},{spawn:function(){var d;return d=$q.defer(),_proms.push(d.promise),_ctr+=1,{instance:_ctr,deferred:d}},promises:_promises,instances:function(){return _ctr},promise:function(expectedInstances){var d;return null==expectedInstances&&(expectedInstances=1),d=$q.defer(),_checkIfReady(d,expectedInstances),d.promise},reset:function(){_ctr=0,_proms.length=0},decrement:function(){_ctr>0&&(_ctr-=1),_proms.length&&(_proms.length-=1)}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapLinked",["uiGmapBaseObject",function(BaseObject){var Linked;return Linked=function(superClass){function Linked(scope,element,attrs,ctrls){this.scope=scope,this.element=element,this.attrs=attrs,this.ctrls=ctrls}return extend(Linked,superClass),Linked}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["$log",function($log){var LEVELS,Logger,log,maybeExecLevel;return LEVELS={log:1,info:2,debug:3,warn:4,error:5,none:6},maybeExecLevel=function(level,current,fn){return level>=current?fn():void 0},log=function(logLevelFnName,msg){return null!=$log?$log[logLevelFnName](msg):console[logLevelFnName](msg)},new(Logger=function(){function Logger(){var logFns;this.doLog=!0,logFns={},["log","info","debug","warn","error"].forEach(function(_this){return function(level){return logFns[level]=function(msg){return _this.doLog?maybeExecLevel(LEVELS[level],_this.currentLevel,function(){return log(level,msg)}):void 0}}}(this)),this.LEVELS=LEVELS,this.currentLevel=LEVELS.error,this.log=logFns.log,this.info=logFns.info,this.debug=logFns.debug,this.warn=logFns.warn,this.error=logFns.error}return Logger.prototype.spawn=function(){return new Logger},Logger.prototype.setLog=function(someLogger){return $log=someLogger},Logger}())}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelKey",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapPromise","$q","$timeout",function(BaseObject,GmapUtil,uiGmapPromise,$q,$timeout){var ModelKey;return ModelKey=function(superClass){function ModelKey(scope1){this.scope=scope1,this.modelsLength=bind(this.modelsLength,this),this.updateChild=bind(this.updateChild,this),this.destroy=bind(this.destroy,this),this.onDestroy=bind(this.onDestroy,this),this.setChildScope=bind(this.setChildScope,this),this.getChanges=bind(this.getChanges,this),this.getProp=bind(this.getProp,this),this.setIdKey=bind(this.setIdKey,this),this.modelKeyComparison=bind(this.modelKeyComparison,this),ModelKey.__super__.constructor.call(this),this["interface"]={},this["interface"].scopeKeys=[],this.defaultIdKey="id",this.idKey=void 0}return extend(ModelKey,superClass),ModelKey.prototype.evalModelHandle=function(model,modelKey){return null!=model&&null!=modelKey?"self"===modelKey?model:(_.isFunction(modelKey)&&(modelKey=modelKey()),GmapUtil.getPath(model,modelKey)):void 0},ModelKey.prototype.modelKeyComparison=function(model1,model2){var hasCoords,isEqual,scope;if(hasCoords=_.contains(this["interface"].scopeKeys,"coords"),(hasCoords&&null!=this.scope.coords||!hasCoords)&&(scope=this.scope),null==scope)throw"No scope set!";return hasCoords&&(isEqual=GmapUtil.equalCoords(this.evalModelHandle(model1,scope.coords),this.evalModelHandle(model2,scope.coords)),!isEqual)?isEqual:isEqual=_.every(_.without(this["interface"].scopeKeys,"coords"),function(_this){return function(k){return _this.evalModelHandle(model1,scope[k])===_this.evalModelHandle(model2,scope[k])}}(this))},ModelKey.prototype.setIdKey=function(scope){return this.idKey=null!=scope.idKey?scope.idKey:this.defaultIdKey},ModelKey.prototype.setVal=function(model,key,newValue){var thingToSet;return thingToSet=this.modelOrKey(model,key),thingToSet=newValue,model},ModelKey.prototype.modelOrKey=function(model,key){return null!=key?"self"!==key?GmapUtil.getPath(model,key):model:void 0},ModelKey.prototype.getProp=function(propName,model){return this.modelOrKey(model,propName)},ModelKey.prototype.getChanges=function(now,prev,whitelistedProps){var c,changes,prop;whitelistedProps&&(prev=_.pick(prev,whitelistedProps),now=_.pick(now,whitelistedProps)),changes={},prop={},c={};for(prop in now)prev&&prev[prop]===now[prop]||(_.isArray(now[prop])?changes[prop]=now[prop]:_.isObject(now[prop])?(c=this.getChanges(now[prop],prev?prev[prop]:null),_.isEmpty(c)||(changes[prop]=c)):changes[prop]=now[prop]);return changes},ModelKey.prototype.scopeOrModelVal=function(key,scope,model,doWrap){var maybeWrap,modelKey,modelProp,scopeProp;return null==doWrap&&(doWrap=!1),maybeWrap=function(isScope,ret,doWrap){return null==doWrap&&(doWrap=!1),doWrap?{isScope:isScope,value:ret}:ret},scopeProp=scope[key],_.isFunction(scopeProp)?maybeWrap(!0,scopeProp(model),doWrap):_.isObject(scopeProp)?maybeWrap(!0,scopeProp,doWrap):_.isString(scopeProp)?(modelKey=scopeProp,modelProp=modelKey?"self"===modelKey?model:model[modelKey]:model[key],_.isFunction(modelProp)?maybeWrap(!1,modelProp(),doWrap):maybeWrap(!1,modelProp,doWrap)):maybeWrap(!0,scopeProp,doWrap)},ModelKey.prototype.setChildScope=function(keys,childScope,model){return _.each(keys,function(_this){return function(name){var isScopeObj,newValue;return isScopeObj=_this.scopeOrModelVal(name,childScope,model,!0),null!=(null!=isScopeObj?isScopeObj.value:void 0)&&(newValue=isScopeObj.value,newValue!==childScope[name])?childScope[name]=newValue:void 0}}(this)),childScope.model=model},ModelKey.prototype.onDestroy=function(scope){},ModelKey.prototype.destroy=function(manualOverride){var ref;return null==manualOverride&&(manualOverride=!1),null==this.scope||(null!=(ref=this.scope)?ref.$$destroyed:void 0)||!this.needToManualDestroy&&!manualOverride?this.clean():this.scope.$destroy()},ModelKey.prototype.updateChild=function(child,model){return null==model[this.idKey]?void this.$log.error("Model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):child.updateModel(model)},ModelKey.prototype.modelsLength=function(arrayOrObjModels){var len,toCheck;return null==arrayOrObjModels&&(arrayOrObjModels=void 0),len=0,toCheck=arrayOrObjModels?arrayOrObjModels:this.scope.models,null==toCheck?len:len=angular.isArray(toCheck)||null!=toCheck.length?toCheck.length:Object.keys(toCheck).length},ModelKey}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelsWatcher",["uiGmapLogger","uiGmap_async","$q","uiGmapPromise",function(Logger,_async,$q,uiGmapPromise){return{didQueueInitPromise:function(existingPiecesObj,scope){return 0===scope.models.length?(_async.promiseLock(existingPiecesObj,uiGmapPromise.promiseTypes.init,null,null,function(_this){return function(){return uiGmapPromise.resolve()}}(this)),!0):!1},figureOutState:function(idKey,scope,childObjects,comparison,callBack){var adds,children,mappedScopeModelIds,removals,updates;return adds=[],mappedScopeModelIds={},removals=[],updates=[],scope.models.forEach(function(m){var child;return null==m[idKey]?Logger.error(" id missing for model #{m.toString()},\ncan not use do comparison/insertion"):(mappedScopeModelIds[m[idKey]]={},null==childObjects.get(m[idKey])?adds.push(m):(child=childObjects.get(m[idKey]),comparison(m,child.clonedModel)?void 0:updates.push({model:m,child:child})))}),children=childObjects.values(),children.forEach(function(c){var id;return null==c?void Logger.error("child undefined in ModelsWatcher."):null==c.model?void Logger.error("child.model undefined in ModelsWatcher."):(id=c.model[idKey],null==mappedScopeModelIds[id]?removals.push(c):void 0)}),{adds:adds,removals:removals,updates:updates}}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapPromise",["$q","$timeout","uiGmapLogger",function($q,$timeout,$log){var ExposedPromise,SniffedPromise,defer,isInProgress,isResolved,promise,promiseStatus,promiseStatuses,promiseTypes,resolve,strPromiseStatuses;return promiseTypes={create:"create",update:"update","delete":"delete",init:"init"},promiseStatuses={IN_PROGRESS:0,RESOLVED:1,REJECTED:2},strPromiseStatuses=function(){var obj;return obj={},obj[""+promiseStatuses.IN_PROGRESS]="in-progress",obj[""+promiseStatuses.RESOLVED]="resolved",obj[""+promiseStatuses.REJECTED]="rejected",obj}(),isInProgress=function(promise){return promise.$$state?promise.$$state.status===promiseStatuses.IN_PROGRESS:promise.hasOwnProperty("$$v")?void 0:!0;
},isResolved=function(promise){return promise.$$state?promise.$$state.status===promiseStatuses.RESOLVED:promise.hasOwnProperty("$$v")?!0:void 0},promiseStatus=function(status){return strPromiseStatuses[status]||"done w error"},ExposedPromise=function(promise){var cancelDeferred,combined,wrapped;return cancelDeferred=$q.defer(),combined=$q.all([promise,cancelDeferred.promise]),wrapped=$q.defer(),promise.then(cancelDeferred.resolve,function(){},function(notify){return cancelDeferred.notify(notify),wrapped.notify(notify)}),combined.then(function(successes){return wrapped.resolve(successes[0]||successes[1])},function(error){return wrapped.reject(error)}),wrapped.promise.cancel=function(reason){return null==reason&&(reason="canceled"),cancelDeferred.reject(reason)},wrapped.promise.notify=function(msg){return null==msg&&(msg="cancel safe"),wrapped.notify(msg),promise.hasOwnProperty("notify")?promise.notify(msg):void 0},null!=promise.promiseType&&(wrapped.promise.promiseType=promise.promiseType),wrapped.promise},SniffedPromise=function(fnPromise,promiseType){return{promise:fnPromise,promiseType:promiseType}},defer=function(){return $q.defer()},resolve=function(){var d;return d=$q.defer(),d.resolve.apply(void 0,arguments),d.promise},promise=function(fnToWrap){var d;return _.isFunction(fnToWrap)?(d=$q.defer(),$timeout(function(){var result;return result=fnToWrap(),d.resolve(result)}),d.promise):void $log.error("uiGmapPromise.promise() only accepts functions")},{defer:defer,promise:promise,resolve:resolve,promiseTypes:promiseTypes,isInProgress:isInProgress,isResolved:isResolved,promiseStatus:promiseStatus,ExposedPromise:ExposedPromise,SniffedPromise:SniffedPromise}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropMap",function(){var PropMap;return PropMap=function(){function PropMap(){this.removeAll=bind(this.removeAll,this),this.slice=bind(this.slice,this),this.push=bind(this.push,this),this.keys=bind(this.keys,this),this.values=bind(this.values,this),this.remove=bind(this.remove,this),this.put=bind(this.put,this),this.stateChanged=bind(this.stateChanged,this),this.get=bind(this.get,this),this.length=0,this.dict={},this.didValsStateChange=!1,this.didKeysStateChange=!1,this.allVals=[],this.allKeys=[]}return PropMap.prototype.get=function(key){return this.dict[key]},PropMap.prototype.stateChanged=function(){return this.didValsStateChange=!0,this.didKeysStateChange=!0},PropMap.prototype.put=function(key,value){return null==this.get(key)&&this.length++,this.stateChanged(),this.dict[key]=value},PropMap.prototype.remove=function(key,isSafe){var value;return null==isSafe&&(isSafe=!1),isSafe&&!this.get(key)?void 0:(value=this.dict[key],delete this.dict[key],this.length--,this.stateChanged(),value)},PropMap.prototype.valuesOrKeys=function(str){var keys,vals;return null==str&&(str="Keys"),this["did"+str+"StateChange"]?(vals=[],keys=[],_.each(this.dict,function(v,k){return vals.push(v),keys.push(k)}),this.didKeysStateChange=!1,this.didValsStateChange=!1,this.allVals=vals,this.allKeys=keys,this["all"+str]):this["all"+str]},PropMap.prototype.values=function(){return this.valuesOrKeys("Vals")},PropMap.prototype.keys=function(){return this.valuesOrKeys()},PropMap.prototype.push=function(obj,key){return null==key&&(key="key"),this.put(obj[key],obj)},PropMap.prototype.slice=function(){return this.keys().map(function(_this){return function(k){return _this.remove(k)}}(this))},PropMap.prototype.removeAll=function(){return this.slice()},PropMap.prototype.each=function(cb){return _.each(this.dict,function(v,k){return cb(v)})},PropMap.prototype.map=function(cb){return _.map(this.dict,function(v,k){return cb(v)})},PropMap}()})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropertyAction",["uiGmapLogger",function(Logger){var PropertyAction;return PropertyAction=function(setterFn){return this.setIfChange=function(newVal,oldVal){var callingKey;return callingKey=this.exp,_.isEqual(oldVal,newVal)?void 0:setterFn(callingKey,newVal)},this.sic=this.setIfChange,this}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapClustererMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function($log,FitHelper,PropMap){var ClustererMarkerManager;return ClustererMarkerManager=function(){function ClustererMarkerManager(gMap,opt_markers,opt_options,opt_events){null==opt_markers&&(opt_markers={}),this.opt_options=null!=opt_options?opt_options:{},this.opt_events=opt_events,this.checkSync=bind(this.checkSync,this),this.getGMarkers=bind(this.getGMarkers,this),this.fit=bind(this.fit,this),this.destroy=bind(this.destroy,this),this.clear=bind(this.clear,this),this.draw=bind(this.draw,this),this.removeMany=bind(this.removeMany,this),this.remove=bind(this.remove,this),this.addMany=bind(this.addMany,this),this.update=bind(this.update,this),this.add=bind(this.add,this),this.type=ClustererMarkerManager.type,this.clusterer=new NgMapMarkerClusterer(gMap,opt_markers,this.opt_options),this.propMapGMarkers=new PropMap,this.attachEvents(this.opt_events,"opt_events"),this.clusterer.setIgnoreHidden(!0),this.noDrawOnSingleAddRemoves=!0,$log.info(this)}return ClustererMarkerManager.type="ClustererMarkerManager",ClustererMarkerManager.prototype.checkKey=function(gMarker){var msg;return null==gMarker.key?(msg="gMarker.key undefined and it is REQUIRED!!",$log.error(msg)):void 0},ClustererMarkerManager.prototype.add=function(gMarker){return this.checkKey(gMarker),this.clusterer.addMarker(gMarker,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.put(gMarker.key,gMarker),this.checkSync()},ClustererMarkerManager.prototype.update=function(gMarker){return this.remove(gMarker),this.add(gMarker)},ClustererMarkerManager.prototype.addMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.add(gMarker)}}(this))},ClustererMarkerManager.prototype.remove=function(gMarker){var exists;return this.checkKey(gMarker),exists=this.propMapGMarkers.get(gMarker.key),exists&&(this.clusterer.removeMarker(gMarker,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.remove(gMarker.key)),this.checkSync()},ClustererMarkerManager.prototype.removeMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.remove(gMarker)}}(this))},ClustererMarkerManager.prototype.draw=function(){return this.clusterer.repaint()},ClustererMarkerManager.prototype.clear=function(){return this.removeMany(this.getGMarkers()),this.clusterer.repaint()},ClustererMarkerManager.prototype.attachEvents=function(options,optionsName){var eventHandler,eventName,results;if(angular.isDefined(options)&&null!=options&&angular.isObject(options)){results=[];for(eventName in options)eventHandler=options[eventName],options.hasOwnProperty(eventName)&&angular.isFunction(options[eventName])?($log.info(optionsName+": Attaching event: "+eventName+" to clusterer"),results.push(google.maps.event.addListener(this.clusterer,eventName,options[eventName]))):results.push(void 0);return results}},ClustererMarkerManager.prototype.clearEvents=function(options,optionsName){var eventHandler,eventName,results;if(angular.isDefined(options)&&null!=options&&angular.isObject(options)){results=[];for(eventName in options)eventHandler=options[eventName],options.hasOwnProperty(eventName)&&angular.isFunction(options[eventName])?($log.info(optionsName+": Clearing event: "+eventName+" to clusterer"),results.push(google.maps.event.clearListeners(this.clusterer,eventName))):results.push(void 0);return results}},ClustererMarkerManager.prototype.destroy=function(){return this.clearEvents(this.opt_events,"opt_events"),this.clear()},ClustererMarkerManager.prototype.fit=function(){return FitHelper.fit(this.getGMarkers(),this.clusterer.getMap())},ClustererMarkerManager.prototype.getGMarkers=function(){return this.clusterer.getMarkers().values()},ClustererMarkerManager.prototype.checkSync=function(){},ClustererMarkerManager}()}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function(Logger,FitHelper,PropMap){var MarkerManager;return MarkerManager=function(){function MarkerManager(gMap,opt_markers,opt_options){this.getGMarkers=bind(this.getGMarkers,this),this.fit=bind(this.fit,this),this.handleOptDraw=bind(this.handleOptDraw,this),this.clear=bind(this.clear,this),this.draw=bind(this.draw,this),this.removeMany=bind(this.removeMany,this),this.remove=bind(this.remove,this),this.addMany=bind(this.addMany,this),this.update=bind(this.update,this),this.add=bind(this.add,this),this.type=MarkerManager.type,this.gMap=gMap,this.gMarkers=new PropMap,this.$log=Logger,this.$log.info(this)}return MarkerManager.type="MarkerManager",MarkerManager.prototype.add=function(gMarker,optDraw){var exists,msg;if(null==optDraw&&(optDraw=!0),null==gMarker.key)throw msg="gMarker.key undefined and it is REQUIRED!!",Logger.error(msg),msg;return exists=this.gMarkers.get(gMarker.key),exists?void 0:(this.handleOptDraw(gMarker,optDraw,!0),this.gMarkers.put(gMarker.key,gMarker))},MarkerManager.prototype.update=function(gMarker,optDraw){return null==optDraw&&(optDraw=!0),this.remove(gMarker,optDraw),this.add(gMarker,optDraw)},MarkerManager.prototype.addMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.add(gMarker)}}(this))},MarkerManager.prototype.remove=function(gMarker,optDraw){return null==optDraw&&(optDraw=!0),this.handleOptDraw(gMarker,optDraw,!1),this.gMarkers.get(gMarker.key)?this.gMarkers.remove(gMarker.key):void 0},MarkerManager.prototype.removeMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(marker){return _this.remove(marker)}}(this))},MarkerManager.prototype.draw=function(){var deletes;return deletes=[],this.gMarkers.each(function(_this){return function(gMarker){return gMarker.isDrawn?void 0:gMarker.doAdd?(gMarker.setMap(_this.gMap),gMarker.isDrawn=!0):deletes.push(gMarker)}}(this)),deletes.forEach(function(_this){return function(gMarker){return gMarker.isDrawn=!1,_this.remove(gMarker,!0)}}(this))},MarkerManager.prototype.clear=function(){return this.gMarkers.each(function(gMarker){return gMarker.setMap(null)}),delete this.gMarkers,this.gMarkers=new PropMap},MarkerManager.prototype.handleOptDraw=function(gMarker,optDraw,doAdd){return optDraw===!0?(doAdd?gMarker.setMap(this.gMap):gMarker.setMap(null),gMarker.isDrawn=!0):(gMarker.isDrawn=!1,gMarker.doAdd=doAdd)},MarkerManager.prototype.fit=function(){return FitHelper.fit(this.getGMarkers(),this.gMap)},MarkerManager.prototype.getGMarkers=function(){return this.gMarkers.values()},MarkerManager}()}])}.call(this),function(){angular.module("uiGmapgoogle-maps").factory("uiGmapadd-events",["$timeout",function($timeout){var addEvent,addEvents;return addEvent=function(target,eventName,handler){return google.maps.event.addListener(target,eventName,function(){return handler.apply(this,arguments),$timeout(function(){},!0)})},addEvents=function(target,eventName,handler){var remove;return handler?addEvent(target,eventName,handler):(remove=[],angular.forEach(eventName,function(_handler,key){return remove.push(addEvent(target,key,_handler))}),function(){return angular.forEach(remove,function(listener){return google.maps.event.removeListener(listener)}),remove=null})}}])}.call(this),function(){angular.module("uiGmapgoogle-maps").factory("uiGmaparray-sync",["uiGmapadd-events",function(mapEvents){return function(mapArray,scope,pathEval,pathChangedFn){var geojsonArray,geojsonHandlers,geojsonWatcher,isSetFromScope,legacyHandlers,legacyWatcher,mapArrayListener,scopePath,watchListener;return isSetFromScope=!1,scopePath=scope.$eval(pathEval),scope["static"]||(legacyHandlers={set_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index)))return value.lng&&value.lat?(scopePath[index].latitude=value.lat(),scopePath[index].longitude=value.lng()):scopePath[index]=value},insert_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index)))return value.lng&&value.lat?scopePath.splice(index,0,{latitude:value.lat(),longitude:value.lng()}):scopePath.splice(index,0,value)},remove_at:function(index){return isSetFromScope?void 0:scopePath.splice(index,1)}},"Polygon"===scopePath.type?geojsonArray=scopePath.coordinates[0]:"LineString"===scopePath.type&&(geojsonArray=scopePath.coordinates),geojsonHandlers={set_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index),value&&value.lng&&value.lat))return geojsonArray[index][1]=value.lat(),geojsonArray[index][0]=value.lng()},insert_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index),value&&value.lng&&value.lat))return geojsonArray.splice(index,0,[value.lng(),value.lat()])},remove_at:function(index){return isSetFromScope?void 0:geojsonArray.splice(index,1)}},mapArrayListener=mapEvents(mapArray,angular.isUndefined(scopePath.type)?legacyHandlers:geojsonHandlers)),legacyWatcher=function(newPath){var changed,i,l,newLength,newValue,oldArray,oldLength,oldValue;if(isSetFromScope=!0,oldArray=mapArray,changed=!1,newPath){for(i=0,oldLength=oldArray.getLength(),newLength=newPath.length,l=Math.min(oldLength,newLength),newValue=void 0;l>i;)oldValue=oldArray.getAt(i),newValue=newPath[i],"function"==typeof newValue.equals?newValue.equals(oldValue)||(oldArray.setAt(i,newValue),changed=!0):(oldValue.lat()!==newValue.latitude||oldValue.lng()!==newValue.longitude)&&(oldArray.setAt(i,new google.maps.LatLng(newValue.latitude,newValue.longitude)),changed=!0),i++;for(;newLength>i;)newValue=newPath[i],"function"==typeof newValue.lat&&"function"==typeof newValue.lng?oldArray.push(newValue):oldArray.push(new google.maps.LatLng(newValue.latitude,newValue.longitude)),changed=!0,i++;for(;oldLength>i;)oldArray.pop(),changed=!0,i++}return isSetFromScope=!1,changed?pathChangedFn(oldArray):void 0},geojsonWatcher=function(newPath){var array,changed,i,l,newLength,newValue,oldArray,oldLength,oldValue;if(isSetFromScope=!0,oldArray=mapArray,changed=!1,newPath){for("Polygon"===scopePath.type?array=newPath.coordinates[0]:"LineString"===scopePath.type&&(array=newPath.coordinates),i=0,oldLength=oldArray.getLength(),newLength=array.length,l=Math.min(oldLength,newLength),newValue=void 0;l>i;)oldValue=oldArray.getAt(i),newValue=array[i],(oldValue.lat()!==newValue[1]||oldValue.lng()!==newValue[0])&&(oldArray.setAt(i,new google.maps.LatLng(newValue[1],newValue[0])),changed=!0),i++;for(;newLength>i;)newValue=array[i],oldArray.push(new google.maps.LatLng(newValue[1],newValue[0])),changed=!0,i++;for(;oldLength>i;)oldArray.pop(),changed=!0,i++}return isSetFromScope=!1,changed?pathChangedFn(oldArray):void 0},scope["static"]||(watchListener=angular.isUndefined(scopePath.type)?scope.$watchCollection(pathEval,legacyWatcher):scope.$watch(pathEval,geojsonWatcher,!0)),function(){return mapArrayListener&&(mapArrayListener(),mapArrayListener=null),watchListener?(watchListener(),watchListener=null):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChromeFixes",["$timeout",function($timeout){return{maybeRepaint:function(el){return el?(el.style.opacity=.9,$timeout(function(){return el.style.opacity=1})):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps").service("uiGmapObjectIterators",function(){var _ignores,_iterators,_slapForEach,_slapMap;return _ignores=["length","forEach","map"],_iterators=[],_slapForEach=function(object){return object.forEach=function(cb){return _.each(_.omit(object,_ignores),function(val){return _.isFunction(val)?void 0:cb(val)})},object},_iterators.push(_slapForEach),_slapMap=function(object){return object.map=function(cb){return _.map(_.omit(object,_ignores),function(val){return _.isFunction(val)?void 0:cb(val)})},object},_iterators.push(_slapMap),{slapMap:_slapMap,slapForEach:_slapForEach,slapAll:function(object){return _iterators.forEach(function(it){return it(object)}),object}}})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.options.builders").service("uiGmapCommonOptionsBuilder",["uiGmapBaseObject","uiGmapLogger","uiGmapModelKey",function(BaseObject,$log,ModelKey){var CommonOptionsBuilder;return CommonOptionsBuilder=function(superClass){function CommonOptionsBuilder(){return this.watchProps=bind(this.watchProps,this),this.buildOpts=bind(this.buildOpts,this),CommonOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(CommonOptionsBuilder,superClass),CommonOptionsBuilder.prototype.props=["clickable","draggable","editable","visible",{prop:"stroke",isColl:!0}],CommonOptionsBuilder.prototype.getCorrectModel=function(scope){return angular.isDefined(null!=scope?scope.model:void 0)?scope.model:scope},CommonOptionsBuilder.prototype.buildOpts=function(customOpts,cachedEval,forEachOpts){var model,opts,stroke;return null==customOpts&&(customOpts={}),null==forEachOpts&&(forEachOpts={}),this.scope?this.map?(model=this.getCorrectModel(this.scope),stroke=this.scopeOrModelVal("stroke",this.scope,model),opts=angular.extend(customOpts,this.DEFAULTS,{map:this.map,strokeColor:null!=stroke?stroke.color:void 0,strokeOpacity:null!=stroke?stroke.opacity:void 0,strokeWeight:null!=stroke?stroke.weight:void 0}),angular.forEach(angular.extend(forEachOpts,{clickable:!0,draggable:!1,editable:!1,"static":!1,fit:!1,visible:!0,zIndex:0,icons:[]}),function(_this){return function(defaultValue,key){var val;return val=cachedEval?cachedEval[key]:_this.scopeOrModelVal(key,_this.scope,model),angular.isUndefined(val)?opts[key]=defaultValue:opts[key]=model[key]}}(this)),opts["static"]&&(opts.editable=!1),opts):void $log.error("this.map not defined in CommonOptionsBuilder can not buildOpts"):void $log.error("this.scope not defined in CommonOptionsBuilder can not buildOpts")},CommonOptionsBuilder.prototype.watchProps=function(props){return null==props&&(props=this.props),props.forEach(function(_this){return function(prop){return null!=_this.attrs[prop]||null!=_this.attrs[null!=prop?prop.prop:void 0]?(null!=prop?prop.isColl:void 0)?_this.scope.$watchCollection(prop.prop,_this.setMyOptions):_this.scope.$watch(prop,_this.setMyOptions):void 0}}(this))},CommonOptionsBuilder}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.options.builders").factory("uiGmapPolylineOptionsBuilder",["uiGmapCommonOptionsBuilder",function(CommonOptionsBuilder){var PolylineOptionsBuilder;return PolylineOptionsBuilder=function(superClass){function PolylineOptionsBuilder(){return PolylineOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(PolylineOptionsBuilder,superClass),PolylineOptionsBuilder.prototype.buildOpts=function(pathPoints,cachedEval){return PolylineOptionsBuilder.__super__.buildOpts.call(this,{path:pathPoints},cachedEval,{geodesic:!1})},PolylineOptionsBuilder}(CommonOptionsBuilder)}]).factory("uiGmapShapeOptionsBuilder",["uiGmapCommonOptionsBuilder",function(CommonOptionsBuilder){var ShapeOptionsBuilder;return ShapeOptionsBuilder=function(superClass){function ShapeOptionsBuilder(){return ShapeOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(ShapeOptionsBuilder,superClass),ShapeOptionsBuilder.prototype.buildOpts=function(customOpts,cachedEval,forEachOpts){var fill,model;return model=this.getCorrectModel(this.scope),fill=cachedEval?cachedEval.fill:this.scopeOrModelVal("fill",this.scope,model),customOpts=angular.extend(customOpts,{fillColor:null!=fill?fill.color:void 0,fillOpacity:null!=fill?fill.opacity:void 0}),ShapeOptionsBuilder.__super__.buildOpts.call(this,customOpts,cachedEval,forEachOpts)},ShapeOptionsBuilder}(CommonOptionsBuilder)}]).factory("uiGmapPolygonOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var PolygonOptionsBuilder;return PolygonOptionsBuilder=function(superClass){function PolygonOptionsBuilder(){return PolygonOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(PolygonOptionsBuilder,superClass),PolygonOptionsBuilder.prototype.buildOpts=function(pathPoints,cachedEval){return PolygonOptionsBuilder.__super__.buildOpts.call(this,{path:pathPoints},cachedEval,{geodesic:!1})},PolygonOptionsBuilder}(ShapeOptionsBuilder)}]).factory("uiGmapRectangleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var RectangleOptionsBuilder;return RectangleOptionsBuilder=function(superClass){function RectangleOptionsBuilder(){return RectangleOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(RectangleOptionsBuilder,superClass),RectangleOptionsBuilder.prototype.buildOpts=function(bounds,cachedEval){return RectangleOptionsBuilder.__super__.buildOpts.call(this,{bounds:bounds},cachedEval)},RectangleOptionsBuilder}(ShapeOptionsBuilder)}]).factory("uiGmapCircleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var CircleOptionsBuilder;return CircleOptionsBuilder=function(superClass){function CircleOptionsBuilder(){return CircleOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(CircleOptionsBuilder,superClass),CircleOptionsBuilder.prototype.buildOpts=function(center,radius,cachedEval){return CircleOptionsBuilder.__super__.buildOpts.call(this,{center:center,radius:radius},cachedEval)},CircleOptionsBuilder}(ShapeOptionsBuilder)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.options").service("uiGmapMarkerOptions",["uiGmapLogger","uiGmapGmapUtil",function($log,GmapUtil){return _.extend(GmapUtil,{createOptions:function(coords,icon,defaults,map){var opts;return null==defaults&&(defaults={}),opts=angular.extend({},defaults,{position:null!=defaults.position?defaults.position:GmapUtil.getCoords(coords),visible:null!=defaults.visible?defaults.visible:GmapUtil.validateCoords(coords)}),(null!=defaults.icon||null!=icon)&&(opts=angular.extend(opts,{icon:null!=defaults.icon?defaults.icon:icon})),null!=map&&(opts.map=map),opts},isLabel:function(options){return null==options?!1:null!=options.labelContent||null!=options.labelAnchor||null!=options.labelClass||null!=options.labelStyle||null!=options.labelVisible}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapBasePolyChildModel",["uiGmapLogger","$timeout","uiGmaparray-sync","uiGmapGmapUtil","uiGmapEventsHelper",function($log,$timeout,arraySync,GmapUtil,EventsHelper){return function(Builder,gFactory){var BasePolyChildModel;return BasePolyChildModel=function(superClass){function BasePolyChildModel(scope,attrs,map,defaults,model){var create;this.scope=scope,this.attrs=attrs,this.map=map,this.defaults=defaults,this.model=model,this.clean=bind(this.clean,this),this.clonedModel=_.clone(this.model,!0),this.isDragging=!1,this.internalEvents={dragend:function(_this){return function(){return _.defer(function(){return _this.isDragging=!1})}}(this),dragstart:function(_this){return function(){return _this.isDragging=!0}}(this)},create=function(_this){return function(){var maybeCachedEval,pathPoints;if(!_this.isDragging)return pathPoints=_this.convertPathPoints(_this.scope.path),null!=_this.gObject&&_this.clean(),null!=_this.scope.model&&(maybeCachedEval=_this.scope),pathPoints.length>0&&(_this.gObject=gFactory(_this.buildOpts(pathPoints,maybeCachedEval))),_this.gObject?(_this.scope.fit&&_this.extendMapBounds(_this.map,pathPoints),arraySync(_this.gObject.getPath(),_this.scope,"path",function(pathPoints){return _this.scope.fit?_this.extendMapBounds(_this.map,pathPoints):void 0}),angular.isDefined(_this.scope.events)&&angular.isObject(_this.scope.events)&&(_this.listeners=_this.model?EventsHelper.setEvents(_this.gObject,_this.scope,_this.model):EventsHelper.setEvents(_this.gObject,_this.scope,_this.scope)),_this.internalListeners=_this.model?EventsHelper.setEvents(_this.gObject,{events:_this.internalEvents},_this.model):EventsHelper.setEvents(_this.gObject,{events:_this.internalEvents},_this.scope)):void 0}}(this),create(),this.scope.$watch("path",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)&&_this.gObject?void 0:create()}}(this),!0),!this.scope["static"]&&angular.isDefined(this.scope.editable)&&this.scope.$watch("editable",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue?(newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setEditable(newValue):void 0):void 0}}(this),!0),angular.isDefined(this.scope.draggable)&&this.scope.$watch("draggable",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue?(newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setDraggable(newValue):void 0):void 0}}(this),!0),angular.isDefined(this.scope.visible)&&this.scope.$watch("visible",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&(newValue=!_this.isFalse(newValue)),null!=(ref=_this.gObject)?ref.setVisible(newValue):void 0}}(this),!0),angular.isDefined(this.scope.geodesic)&&this.scope.$watch("geodesic",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue?(newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.weight)&&this.scope.$watch("stroke.weight",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.color)&&this.scope.$watch("stroke.color",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.opacity)&&this.scope.$watch("stroke.opacity",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.icons)&&this.scope.$watch("icons",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),this.scope.$on("$destroy",function(_this){return function(){return _this.clean(),_this.scope=null}}(this)),angular.isDefined(this.scope.fill)&&angular.isDefined(this.scope.fill.color)&&this.scope.$watch("fill.color",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this)),angular.isDefined(this.scope.fill)&&angular.isDefined(this.scope.fill.opacity)&&this.scope.$watch("fill.opacity",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this)),angular.isDefined(this.scope.zIndex)&&this.scope.$watch("zIndex",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this))}return extend(BasePolyChildModel,superClass),BasePolyChildModel.include(GmapUtil),BasePolyChildModel.prototype.clean=function(){var ref;return EventsHelper.removeEvents(this.listeners),EventsHelper.removeEvents(this.internalListeners),null!=(ref=this.gObject)&&ref.setMap(null),this.gObject=null},BasePolyChildModel}(Builder)}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapDrawFreeHandChildModel",["uiGmapLogger","$q",function($log,$q){var drawFreeHand,freeHandMgr;return drawFreeHand=function(map,polys,enable){var move,poly;return poly=new google.maps.Polyline({map:map,clickable:!1}),move=google.maps.event.addListener(map,"mousemove",function(e){return poly.getPath().push(e.latLng)}),void google.maps.event.addListenerOnce(map,"mouseup",function(e){var path;return google.maps.event.removeListener(move),path=poly.getPath(),poly.setMap(null),polys.push(new google.maps.Polygon({map:map,path:path})),poly=null,google.maps.event.clearListeners(map.getDiv(),"mousedown"),enable()})},freeHandMgr=function(map1,defaultOptions){var disableMap,enable;return this.map=map1,defaultOptions||(defaultOptions={draggable:!0,zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0}),enable=function(_this){return function(){var ref;return null!=(ref=_this.deferred)&&ref.resolve(),_.defer(function(){return _this.map.setOptions(_.extend(_this.oldOptions,defaultOptions))})}}(this),disableMap=function(_this){return function(){return $log.info("disabling map move"),_this.oldOptions=map.getOptions(),_this.oldOptions.center=map.getCenter(),_this.map.setOptions({draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!1})}}(this),this.engage=function(_this){return function(polys1){return _this.polys=polys1,_this.deferred=$q.defer(),disableMap(),$log.info("DrawFreeHandChildModel is engaged (drawing)."),google.maps.event.addDomListener(_this.map.getDiv(),"mousedown",function(e){return drawFreeHand(_this.map,_this.polys,enable)}),_this.deferred.promise}}(this),this}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapMarkerChildModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger","uiGmapEventsHelper","uiGmapPropertyAction","uiGmapMarkerOptions","uiGmapIMarker","uiGmapMarkerManager","uiGmapPromise",function(ModelKey,GmapUtil,$log,EventsHelper,PropertyAction,MarkerOptions,IMarker,MarkerManager,uiGmapPromise){var MarkerChildModel;return MarkerChildModel=function(superClass){function MarkerChildModel(scope,model1,keys,gMap,defaults,doClick,gManager,doDrawSelf,trackModel,needRedraw){var action;this.model=model1,this.keys=keys,this.gMap=gMap,this.defaults=defaults,this.doClick=doClick,this.gManager=gManager,this.doDrawSelf=null!=doDrawSelf?doDrawSelf:!0,this.trackModel=null!=trackModel?trackModel:!0,this.needRedraw=null!=needRedraw?needRedraw:!1,this.internalEvents=bind(this.internalEvents,this),this.setLabelOptions=bind(this.setLabelOptions,this),this.setOptions=bind(this.setOptions,this),this.setIcon=bind(this.setIcon,this),
this.setCoords=bind(this.setCoords,this),this.isNotValid=bind(this.isNotValid,this),this.maybeSetScopeValue=bind(this.maybeSetScopeValue,this),this.createMarker=bind(this.createMarker,this),this.setMyScope=bind(this.setMyScope,this),this.updateModel=bind(this.updateModel,this),this.handleModelChanges=bind(this.handleModelChanges,this),this.destroy=bind(this.destroy,this),this.clonedModel=_.extend({},this.model),this.deferred=uiGmapPromise.defer(),_.each(this.keys,function(_this){return function(v,k){return _this[k+"Key"]=_.isFunction(_this.keys[k])?_this.keys[k]():_this.keys[k]}}(this)),this.idKey=this.idKeyKey||"id",null!=this.model[this.idKey]&&(this.id=this.model[this.idKey]),MarkerChildModel.__super__.constructor.call(this,scope),this.scope.getGMarker=function(_this){return function(){return _this.gObject}}(this),this.firstTime=!0,this.trackModel?(this.scope.model=this.model,this.scope.$watch("model",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.handleModelChanges(newValue,oldValue):void 0}}(this),!0)):(action=new PropertyAction(function(_this){return function(calledKey,newVal){return _this.firstTime?void 0:_this.setMyScope(calledKey,scope)}}(this),!1),_.each(this.keys,function(v,k){return scope.$watch(k,action.sic,!0)})),this.scope.$on("$destroy",function(_this){return function(){return destroy(_this)}}(this)),this.createMarker(this.model),$log.info(this)}var destroy;return extend(MarkerChildModel,superClass),MarkerChildModel.include(GmapUtil),MarkerChildModel.include(EventsHelper),MarkerChildModel.include(MarkerOptions),destroy=function(child){return null!=(null!=child?child.gObject:void 0)&&(child.removeEvents(child.externalListeners),child.removeEvents(child.internalListeners),null!=child?child.gObject:void 0)?(child.removeFromManager&&child.gManager.remove(child.gObject),child.gObject.setMap(null),child.gObject=null):void 0},MarkerChildModel.prototype.destroy=function(removeFromManager){return null==removeFromManager&&(removeFromManager=!0),this.removeFromManager=removeFromManager,this.scope.$destroy()},MarkerChildModel.prototype.handleModelChanges=function(newValue,oldValue){var changes,ctr,len;return changes=this.getChanges(newValue,oldValue,IMarker.keys),this.firstTime?void 0:(ctr=0,len=_.keys(changes).length,_.each(changes,function(_this){return function(v,k){var doDraw;return ctr+=1,doDraw=len===ctr,_this.setMyScope(k,newValue,oldValue,!1,!0,doDraw),_this.needRedraw=!0}}(this)))},MarkerChildModel.prototype.updateModel=function(model){return this.clonedModel=_.extend({},model),this.setMyScope("all",model,this.model)},MarkerChildModel.prototype.renderGMarker=function(doDraw,validCb){var coords;if(null==doDraw&&(doDraw=!0),coords=this.getProp(this.coordsKey,this.model),null!=coords){if(!this.validateCoords(coords))return void $log.debug("MarkerChild does not have coords yet. They may be defined later.");if(null!=validCb&&validCb(),doDraw&&this.gObject)return this.gManager.add(this.gObject)}else if(doDraw&&this.gObject)return this.gManager.remove(this.gObject)},MarkerChildModel.prototype.setMyScope=function(thingThatChanged,model,oldModel,isInit,doDraw){var justCreated;switch(null==oldModel&&(oldModel=void 0),null==isInit&&(isInit=!1),null==doDraw&&(doDraw=!0),null==model?model=this.model:this.model=model,this.gObject||(this.setOptions(this.scope,doDraw),justCreated=!0),thingThatChanged){case"all":return _.each(this.keys,function(_this){return function(v,k){return _this.setMyScope(k,model,oldModel,isInit,doDraw)}}(this));case"icon":return this.maybeSetScopeValue("icon",model,oldModel,this.iconKey,this.evalModelHandle,isInit,this.setIcon,doDraw);case"coords":return this.maybeSetScopeValue("coords",model,oldModel,this.coordsKey,this.evalModelHandle,isInit,this.setCoords,doDraw);case"options":if(!justCreated)return this.createMarker(model,oldModel,isInit,doDraw)}},MarkerChildModel.prototype.createMarker=function(model,oldModel,isInit,doDraw){return null==oldModel&&(oldModel=void 0),null==isInit&&(isInit=!1),null==doDraw&&(doDraw=!0),this.maybeSetScopeValue("options",model,oldModel,this.optionsKey,this.evalModelHandle,isInit,this.setOptions,doDraw),this.firstTime=!1},MarkerChildModel.prototype.maybeSetScopeValue=function(scopePropName,model,oldModel,modelKey,evaluate,isInit,gSetter,doDraw){return null==gSetter&&(gSetter=void 0),null==doDraw&&(doDraw=!0),null!=gSetter?gSetter(this.scope,doDraw):void 0},MarkerChildModel.doDrawSelf&&doDraw&&MarkerChildModel.gManager.draw(),MarkerChildModel.prototype.isNotValid=function(scope,doCheckGmarker){var hasIdenticalScopes,hasNoGmarker;return null==doCheckGmarker&&(doCheckGmarker=!0),hasNoGmarker=doCheckGmarker?void 0===this.gObject:!1,hasIdenticalScopes=this.trackModel?!1:scope.$id!==this.scope.$id,hasIdenticalScopes||hasNoGmarker},MarkerChildModel.prototype.setCoords=function(scope,doDraw){return null==doDraw&&(doDraw=!0),this.isNotValid(scope)||null==this.gObject?void 0:this.renderGMarker(doDraw,function(_this){return function(){var newGValue,newModelVal,oldGValue;return newModelVal=_this.getProp(_this.coordsKey,_this.model),newGValue=_this.getCoords(newModelVal),oldGValue=_this.gObject.getPosition(),null==oldGValue||null==newGValue||newGValue.lng()!==oldGValue.lng()||newGValue.lat()!==oldGValue.lat()?(_this.gObject.setPosition(newGValue),_this.gObject.setVisible(_this.validateCoords(newModelVal))):void 0}}(this))},MarkerChildModel.prototype.setIcon=function(scope,doDraw){return null==doDraw&&(doDraw=!0),this.isNotValid(scope)||null==this.gObject?void 0:this.renderGMarker(doDraw,function(_this){return function(){var coords,newValue,oldValue;return oldValue=_this.gObject.getIcon(),newValue=_this.getProp(_this.iconKey,_this.model),oldValue!==newValue?(_this.gObject.setIcon(newValue),coords=_this.getProp(_this.coordsKey,_this.model),_this.gObject.setPosition(_this.getCoords(coords)),_this.gObject.setVisible(_this.validateCoords(coords))):void 0}}(this))},MarkerChildModel.prototype.setOptions=function(scope,doDraw){var ref;if(null==doDraw&&(doDraw=!0),!this.isNotValid(scope,!1)){if(this.renderGMarker(doDraw,function(_this){return function(){var _options,coords,icon;return coords=_this.getProp(_this.coordsKey,_this.model),icon=_this.getProp(_this.iconKey,_this.model),_options=_this.getProp(_this.optionsKey,_this.model),_this.opts=_this.createOptions(coords,icon,_options),_this.isLabel(_this.gObject)!==_this.isLabel(_this.opts)&&null!=_this.gObject&&(_this.gManager.remove(_this.gObject),_this.gObject=void 0),null!=_this.gObject&&_this.gObject.setOptions(_this.setLabelOptions(_this.opts)),_this.gObject||(_this.isLabel(_this.opts)?_this.gObject=new MarkerWithLabel(_this.setLabelOptions(_this.opts)):_this.gObject=new google.maps.Marker(_this.opts),_.extend(_this.gObject,{model:_this.model})),_this.externalListeners&&_this.removeEvents(_this.externalListeners),_this.internalListeners&&_this.removeEvents(_this.internalListeners),_this.externalListeners=_this.setEvents(_this.gObject,_this.scope,_this.model,["dragend"]),_this.internalListeners=_this.setEvents(_this.gObject,{events:_this.internalEvents(),$evalAsync:function(){}},_this.model),null!=_this.id?_this.gObject.key=_this.id:void 0}}(this)),this.gObject&&(this.gObject.getMap()||this.gManager.type!==MarkerManager.type))this.deferred.resolve(this.gObject);else{if(!this.gObject)return this.deferred.reject("gObject is null");(null!=(ref=this.gObject)?ref.getMap():0)&&this.gManager.type===MarkerManager.type||($log.debug("gObject has no map yet"),this.deferred.resolve(this.gObject))}return this.model[this.fitKey]?this.gManager.fit():void 0}},MarkerChildModel.prototype.setLabelOptions=function(opts){return opts.labelAnchor=this.getLabelPositionPoint(opts.labelAnchor),opts},MarkerChildModel.prototype.internalEvents=function(){return{dragend:function(_this){return function(marker,eventName,model,mousearg){var events,modelToSet,newCoords;return modelToSet=_this.trackModel?_this.scope.model:_this.model,newCoords=_this.setCoordsFromEvent(_this.modelOrKey(modelToSet,_this.coordsKey),_this.gObject.getPosition()),modelToSet=_this.setVal(model,_this.coordsKey,newCoords),events=_this.scope.events,null!=(null!=events?events.dragend:void 0)&&events.dragend(marker,eventName,modelToSet,mousearg),_this.scope.$apply()}}(this),click:function(_this){return function(marker,eventName,model,mousearg){var click;return click=_.isFunction(_this.clickKey)?_this.clickKey:_this.getProp(_this.clickKey,_this.model),_this.doClick&&null!=click?_this.scope.$evalAsync(click(marker,eventName,_this.model,mousearg)):void 0}}(this)}},MarkerChildModel}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygonChildModel",["uiGmapBasePolyChildModel","uiGmapPolygonOptionsBuilder",function(BaseGen,Builder){var PolygonChildModel,base,gFactory;return gFactory=function(opts){return new google.maps.Polygon(opts)},base=new BaseGen(Builder,gFactory),PolygonChildModel=function(superClass){function PolygonChildModel(){return PolygonChildModel.__super__.constructor.apply(this,arguments)}return extend(PolygonChildModel,superClass),PolygonChildModel}(base)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylineChildModel",["uiGmapBasePolyChildModel","uiGmapPolylineOptionsBuilder",function(BaseGen,Builder){var PolylineChildModel,base,gFactory;return gFactory=function(opts){return new google.maps.Polyline(opts)},base=BaseGen(Builder,gFactory),PolylineChildModel=function(superClass){function PolylineChildModel(){return PolylineChildModel.__super__.constructor.apply(this,arguments)}return extend(PolylineChildModel,superClass),PolylineChildModel}(base)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapWindowChildModel",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapLogger","$compile","$http","$templateCache","uiGmapChromeFixes","uiGmapEventsHelper",function(BaseObject,GmapUtil,$log,$compile,$http,$templateCache,ChromeFixes,EventsHelper){var WindowChildModel;return WindowChildModel=function(superClass){function WindowChildModel(model1,scope1,opts,isIconVisibleOnClick,mapCtrl,markerScope,element,needToManualDestroy,markerIsVisibleAfterWindowClose){var maybeMarker;this.model=model1,this.scope=scope1,this.opts=opts,this.isIconVisibleOnClick=isIconVisibleOnClick,this.mapCtrl=mapCtrl,this.markerScope=markerScope,this.element=element,this.needToManualDestroy=null!=needToManualDestroy?needToManualDestroy:!1,this.markerIsVisibleAfterWindowClose=null!=markerIsVisibleAfterWindowClose?markerIsVisibleAfterWindowClose:!0,this.updateModel=bind(this.updateModel,this),this.destroy=bind(this.destroy,this),this.remove=bind(this.remove,this),this.getLatestPosition=bind(this.getLatestPosition,this),this.hideWindow=bind(this.hideWindow,this),this.showWindow=bind(this.showWindow,this),this.handleClick=bind(this.handleClick,this),this.watchOptions=bind(this.watchOptions,this),this.watchCoords=bind(this.watchCoords,this),this.createGWin=bind(this.createGWin,this),this.watchElement=bind(this.watchElement,this),this.watchAndDoShow=bind(this.watchAndDoShow,this),this.doShow=bind(this.doShow,this),this.clonedModel=_.clone(this.model,!0),this.getGmarker=function(){var ref,ref1;return null!=(null!=(ref=this.markerScope)?ref.getGMarker:void 0)&&null!=(ref1=this.markerScope)?ref1.getGMarker():void 0},this.listeners=[],this.createGWin(),maybeMarker=this.getGmarker(),null!=maybeMarker&&maybeMarker.setClickable(!0),this.watchElement(),this.watchOptions(),this.watchCoords(),this.watchAndDoShow(),this.scope.$on("$destroy",function(_this){return function(){return _this.destroy()}}(this)),$log.info(this)}return extend(WindowChildModel,superClass),WindowChildModel.include(GmapUtil),WindowChildModel.include(EventsHelper),WindowChildModel.prototype.doShow=function(wasOpen){return this.scope.show===!0||wasOpen?this.showWindow():this.hideWindow()},WindowChildModel.prototype.watchAndDoShow=function(){return null!=this.model.show&&(this.scope.show=this.model.show),this.scope.$watch("show",this.doShow,!0),this.doShow()},WindowChildModel.prototype.watchElement=function(){return this.scope.$watch(function(_this){return function(){var ref,wasOpen;if(_this.element||_this.html)return _this.html!==_this.element.html()&&_this.gObject?(null!=(ref=_this.opts)&&(ref.content=void 0),wasOpen=_this.gObject.isOpen(),_this.remove(),_this.createGWin(wasOpen)):void 0}}(this))},WindowChildModel.prototype.createGWin=function(isOpen){var _opts,defaults,maybeMarker,ref,ref1;return null==isOpen&&(isOpen=!1),maybeMarker=this.getGmarker(),defaults={},null!=this.opts&&(this.scope.coords&&(this.opts.position=this.getCoords(this.scope.coords)),defaults=this.opts),this.element&&(this.html=_.isObject(this.element)?this.element.html():this.element),_opts=this.scope.options?this.scope.options:defaults,this.opts=this.createWindowOptions(maybeMarker,this.markerScope||this.scope,this.html,_opts),null!=this.opts?(this.gObject||(this.opts.boxClass&&window.InfoBox&&"function"==typeof window.InfoBox?this.gObject=new window.InfoBox(this.opts):this.gObject=new google.maps.InfoWindow(this.opts),this.listeners.push(google.maps.event.addListener(this.gObject,"domready",function(){return ChromeFixes.maybeRepaint(this.content)})),this.listeners.push(google.maps.event.addListener(this.gObject,"closeclick",function(_this){return function(){return maybeMarker&&(maybeMarker.setAnimation(_this.oldMarkerAnimation),_this.markerIsVisibleAfterWindowClose&&_.delay(function(){return maybeMarker.setVisible(!1),maybeMarker.setVisible(_this.markerIsVisibleAfterWindowClose)},250)),_this.gObject.close(),_this.model.show=!1,null!=_this.scope.closeClick?_this.scope.$evalAsync(_this.scope.closeClick()):_this.scope.$evalAsync()}}(this)))),this.gObject.setContent(this.opts.content),this.handleClick((null!=(ref=this.scope)&&null!=(ref1=ref.options)?ref1.forceClick:void 0)||isOpen),this.doShow(this.gObject.isOpen())):void 0},WindowChildModel.prototype.watchCoords=function(){var scope;return scope=null!=this.markerScope?this.markerScope:this.scope,scope.$watch("coords",function(_this){return function(newValue,oldValue){var pos;if(newValue!==oldValue){if(null==newValue)_this.hideWindow();else if(!_this.validateCoords(newValue))return void $log.error("WindowChildMarker cannot render marker as scope.coords as no position on marker: "+JSON.stringify(_this.model));if(pos=_this.getCoords(newValue),_this.gObject.setPosition(pos),_this.opts)return _this.opts.position=pos}}}(this),!0)},WindowChildModel.prototype.watchOptions=function(){return this.scope.$watch("options",function(_this){return function(newValue,oldValue){if(newValue!==oldValue&&(_this.opts=newValue,null!=_this.gObject)){if(_this.gObject.setOptions(_this.opts),null!=_this.opts.visible&&_this.opts.visible)return _this.showWindow();if(null!=_this.opts.visible)return _this.hideWindow()}}}(this),!0)},WindowChildModel.prototype.handleClick=function(forceClick){var click,maybeMarker;if(null!=this.gObject)return maybeMarker=this.getGmarker(),click=function(_this){return function(){return null==_this.gObject&&_this.createGWin(),_this.showWindow(),null!=maybeMarker?(_this.initialMarkerVisibility=maybeMarker.getVisible(),_this.oldMarkerAnimation=maybeMarker.getAnimation(),maybeMarker.setVisible(_this.isIconVisibleOnClick)):void 0}}(this),forceClick&&click(),maybeMarker?this.listeners=this.listeners.concat(this.setEvents(maybeMarker,{events:{click:click}},this.model)):void 0},WindowChildModel.prototype.showWindow=function(){var compiled,show,templateScope;return null!=this.gObject?(show=function(_this){return function(){var isOpen,maybeMarker,pos;if(!_this.gObject.isOpen()){if(maybeMarker=_this.getGmarker(),null!=_this.gObject&&null!=_this.gObject.getPosition&&(pos=_this.gObject.getPosition()),maybeMarker&&(pos=maybeMarker.getPosition()),!pos)return;if(_this.gObject.open(_this.mapCtrl,maybeMarker),isOpen=_this.gObject.isOpen(),_this.model.show!==isOpen)return _this.model.show=isOpen}}}(this),this.scope.templateUrl?$http.get(this.scope.templateUrl,{cache:$templateCache}).then(function(_this){return function(content){var compiled,templateScope;return templateScope=_this.scope.$new(),angular.isDefined(_this.scope.templateParameter)&&(templateScope.parameter=_this.scope.templateParameter),compiled=$compile(content.data)(templateScope),_this.gObject.setContent(compiled[0]),show()}}(this)):this.scope.template?(templateScope=this.scope.$new(),angular.isDefined(this.scope.templateParameter)&&(templateScope.parameter=this.scope.templateParameter),compiled=$compile(this.scope.template)(templateScope),this.gObject.setContent(compiled[0]),show()):show()):void 0},WindowChildModel.prototype.hideWindow=function(){return null!=this.gObject&&this.gObject.isOpen()?this.gObject.close():void 0},WindowChildModel.prototype.getLatestPosition=function(overridePos){var maybeMarker;return maybeMarker=this.getGmarker(),null==this.gObject||null==maybeMarker||overridePos?overridePos?this.gObject.setPosition(overridePos):void 0:this.gObject.setPosition(maybeMarker.getPosition())},WindowChildModel.prototype.remove=function(){return this.hideWindow(),this.removeEvents(this.listeners),this.listeners.length=0,delete this.gObject,delete this.opts},WindowChildModel.prototype.destroy=function(manualOverride){var ref;return null==manualOverride&&(manualOverride=!1),this.remove(),null==this.scope||(null!=(ref=this.scope)?ref.$$destroyed:void 0)||!this.needToManualDestroy&&!manualOverride?void 0:this.scope.$destroy()},WindowChildModel.prototype.updateModel=function(model){return this.clonedModel=_.extend({},model),_.extend(this.model,this.clonedModel)},WindowChildModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapBasePolysParentModel",["$timeout","uiGmapLogger","uiGmapModelKey","uiGmapModelsWatcher","uiGmapPropMap","uiGmap_async","uiGmapPromise",function($timeout,$log,ModelKey,ModelsWatcher,PropMap,_async,uiGmapPromise){return function(IPoly,PolyChildModel,gObjectName){var BasePolysParentModel;return BasePolysParentModel=function(superClass){function BasePolysParentModel(scope,element,attrs,gMap1,defaults){this.element=element,this.attrs=attrs,this.gMap=gMap1,this.defaults=defaults,this.createChild=bind(this.createChild,this),this.pieceMeal=bind(this.pieceMeal,this),this.createAllNew=bind(this.createAllNew,this),this.watchIdKey=bind(this.watchIdKey,this),this.createChildScopes=bind(this.createChildScopes,this),this.watchDestroy=bind(this.watchDestroy,this),this.onDestroy=bind(this.onDestroy,this),this.rebuildAll=bind(this.rebuildAll,this),this.doINeedToWipe=bind(this.doINeedToWipe,this),this.watchModels=bind(this.watchModels,this),BasePolysParentModel.__super__.constructor.call(this,scope),this["interface"]=IPoly,this.$log=$log,this.plurals=new PropMap,_.each(IPoly.scopeKeys,function(_this){return function(name){return _this[name+"Key"]=void 0}}(this)),this.models=void 0,this.firstTime=!0,this.$log.info(this),this.createChildScopes()}return extend(BasePolysParentModel,superClass),BasePolysParentModel.include(ModelsWatcher),BasePolysParentModel.prototype.watchModels=function(scope){return scope.$watchCollection("models",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.doINeedToWipe(newValue)||scope.doRebuildAll?_this.rebuildAll(scope,!0,!0):_this.createChildScopes(!1):void 0}}(this))},BasePolysParentModel.prototype.doINeedToWipe=function(newValue){var newValueIsEmpty;return newValueIsEmpty=null!=newValue?0===newValue.length:!0,this.plurals.length>0&&newValueIsEmpty},BasePolysParentModel.prototype.rebuildAll=function(scope,doCreate,doDelete){return this.onDestroy(doDelete).then(function(_this){return function(){return doCreate?_this.createChildScopes():void 0}}(this))},BasePolysParentModel.prototype.onDestroy=function(scope){return BasePolysParentModel.__super__.onDestroy.call(this,this.scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.plurals.values(),function(child){return child.destroy(!0)},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){var ref;return null!=(ref=_this.plurals)?ref.removeAll():void 0})}}(this))},BasePolysParentModel.prototype.watchDestroy=function(scope){return scope.$on("$destroy",function(_this){return function(){return _this.rebuildAll(scope,!1,!0)}}(this))},BasePolysParentModel.prototype.createChildScopes=function(isCreatingFromScratch){return null==isCreatingFromScratch&&(isCreatingFromScratch=!0),angular.isUndefined(this.scope.models)?void this.$log.error("No models to create "+gObjectName+"s from! I Need direct models!"):null!=this.gMap&&null!=this.scope.models?(this.watchIdKey(this.scope),isCreatingFromScratch?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)):void 0},BasePolysParentModel.prototype.watchIdKey=function(scope){return this.setIdKey(scope),scope.$watch("idKey",function(_this){return function(newValue,oldValue){return newValue!==oldValue&&null==newValue?(_this.idKey=newValue,_this.rebuildAll(scope,!0,!0)):void 0}}(this))},BasePolysParentModel.prototype.createAllNew=function(scope,isArray){var maybeCanceled;return null==isArray&&(isArray=!1),this.models=scope.models,this.firstTime&&(this.watchModels(scope),this.watchDestroy(scope)),this.didQueueInitPromise(this,scope)?void 0:(maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){var child;return child=_this.createChild(model,_this.gMap),maybeCanceled&&($log.debug("createNew should fall through safely"),child.isEnabled=!1),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.firstTime=!1})}}(this)))},BasePolysParentModel.prototype.pieceMeal=function(scope,isArray){var maybeCanceled,payload;return null==isArray&&(isArray=!0),scope.$$destroyed?void 0:(maybeCanceled=null,payload=null,this.models=scope.models,null!=scope&&this.modelsLength()&&this.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,payload.updates.length&&$log.info("polygons updates: "+payload.updates.length+" will be missed"),_async.each(payload.removals,function(child){return null!=child?(child.destroy(),_this.plurals.remove(child.model[_this.idKey]),maybeCanceled):void 0},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){return maybeCanceled&&$log.debug("pieceMeal should fall through safely"),_this.createChild(modelToAdd,_this.gMap),maybeCanceled},_async.chunkSizeFrom(scope.chunk))})}}(this)):(this.inProgress=!1,this.rebuildAll(this.scope,!0,!0)))},BasePolysParentModel.prototype.createChild=function(model,gMap){var child,childScope;return childScope=this.scope.$new(!1),this.setChildScope(IPoly.scopeKeys,childScope,model),childScope.$watch("model",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.setChildScope(childScope,newValue):void 0}}(this),!0),childScope["static"]=this.scope["static"],child=new PolyChildModel(childScope,this.attrs,gMap,this.defaults,model),null==model[this.idKey]?void this.$log.error(gObjectName+" model has no id to assign a child to.\nThis is required for performance. Please assign id,\nor redirect id to a different key."):(this.plurals.put(model[this.idKey],child),child)},BasePolysParentModel}(ModelKey)}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapCircleParentModel",["uiGmapLogger","$timeout","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapCircleOptionsBuilder",function($log,$timeout,GmapUtil,EventsHelper,Builder){var CircleParentModel;return CircleParentModel=function(superClass){function CircleParentModel(scope,element,attrs,map,DEFAULTS){var clean,gObject,lastRadius;this.attrs=attrs,this.map=map,this.DEFAULTS=DEFAULTS,this.scope=scope,lastRadius=null,clean=function(_this){return function(){return lastRadius=null,null!=_this.listeners?(_this.removeEvents(_this.listeners),_this.listeners=void 0):void 0}}(this),gObject=new google.maps.Circle(this.buildOpts(GmapUtil.getCoords(scope.center),scope.radius)),this.setMyOptions=function(_this){return function(newVals,oldVals){return _.isEqual(newVals,oldVals)?void 0:gObject.setOptions(_this.buildOpts(GmapUtil.getCoords(scope.center),scope.radius))}}(this),this.props=this.props.concat([{prop:"center",isColl:!0},{prop:"fill",isColl:!0},"radius","zIndex"]),this.watchProps(),clean(),this.listeners=this.setEvents(gObject,scope,scope,["radius_changed"]),null!=this.listeners&&this.listeners.push(google.maps.event.addListener(gObject,"radius_changed",function(){var newRadius,work;return newRadius=gObject.getRadius(),newRadius!==lastRadius?(lastRadius=newRadius,work=function(){var ref,ref1;return newRadius!==scope.radius&&(scope.radius=newRadius),(null!=(ref=scope.events)?ref.radius_changed:void 0)&&_.isFunction(null!=(ref1=scope.events)?ref1.radius_changed:void 0)?scope.events.radius_changed(gObject,"radius_changed",scope,arguments):void 0},angular.mock?work():scope.$evalAsync(function(){return work()})):void 0})),null!=this.listeners&&this.listeners.push(google.maps.event.addListener(gObject,"center_changed",function(){return scope.$evalAsync(function(){return angular.isDefined(scope.center.type)?(scope.center.coordinates[1]=gObject.getCenter().lat(),scope.center.coordinates[0]=gObject.getCenter().lng()):(scope.center.latitude=gObject.getCenter().lat(),scope.center.longitude=gObject.getCenter().lng())})})),scope.$on("$destroy",function(_this){return function(){return clean(),gObject.setMap(null)}}(this)),$log.info(this)}return extend(CircleParentModel,superClass),CircleParentModel.include(GmapUtil),CircleParentModel.include(EventsHelper),CircleParentModel}(Builder)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapDrawingManagerParentModel",["uiGmapLogger","$timeout","uiGmapBaseObject","uiGmapEventsHelper",function($log,$timeout,BaseObject,EventsHelper){var DrawingManagerParentModel;return DrawingManagerParentModel=function(superClass){function DrawingManagerParentModel(scope,element,attrs,map){var gObject,listeners;this.scope=scope,this.attrs=attrs,this.map=map,gObject=new google.maps.drawing.DrawingManager(this.scope.options),gObject.setMap(this.map),listeners=void 0,null!=this.scope.control&&(this.scope.control.getDrawingManager=function(){return gObject}),!this.scope["static"]&&this.scope.options&&this.scope.$watch("options",function(newValue){return null!=gObject?gObject.setOptions(newValue):void 0},!0),null!=this.scope.events&&(listeners=this.setEvents(gObject,this.scope,this.scope),this.scope.$watch("events",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:(null!=listeners&&_this.removeEvents(listeners),listeners=_this.setEvents(gObject,_this.scope,_this.scope))}}(this))),this.scope.$on("$destroy",function(_this){return function(){return null!=listeners&&_this.removeEvents(listeners),gObject.setMap(null),gObject=null}}(this))}return extend(DrawingManagerParentModel,superClass),DrawingManagerParentModel.include(EventsHelper),DrawingManagerParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIMarkerParentModel",["uiGmapModelKey","uiGmapLogger",function(ModelKey,Logger){var IMarkerParentModel;return IMarkerParentModel=function(superClass){function IMarkerParentModel(scope1,element,attrs,map){if(this.scope=scope1,this.element=element,this.attrs=attrs,this.map=map,this.onWatch=bind(this.onWatch,this),this.watch=bind(this.watch,this),this.validateScope=bind(this.validateScope,this),IMarkerParentModel.__super__.constructor.call(this,this.scope),this.$log=Logger,!this.validateScope(this.scope))throw new String("Unable to construct IMarkerParentModel due to invalid scope");this.doClick=angular.isDefined(this.attrs.click),null!=this.scope.options&&(this.DEFAULTS=this.scope.options),this.watch("coords",this.scope),this.watch("icon",this.scope),this.watch("options",this.scope),this.scope.$on("$destroy",function(_this){return function(){return _this.onDestroy(_this.scope)}}(this))}return extend(IMarkerParentModel,superClass),IMarkerParentModel.prototype.DEFAULTS={},IMarkerParentModel.prototype.validateScope=function(scope){var ret;return null==scope?(this.$log.error(this.constructor.name+": invalid scope used"),!1):(ret=null!=scope.coords,ret?ret:(this.$log.error(this.constructor.name+": no valid coords attribute found"),!1))},IMarkerParentModel.prototype.watch=function(propNameToWatch,scope,equalityCheck){return null==equalityCheck&&(equalityCheck=!0),scope.$watch(propNameToWatch,function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:_this.onWatch(propNameToWatch,scope,newValue,oldValue)}}(this),equalityCheck)},IMarkerParentModel.prototype.onWatch=function(propNameToWatch,scope,newValue,oldValue){},IMarkerParentModel}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIWindowParentModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger",function(ModelKey,GmapUtil,Logger){
var IWindowParentModel;return IWindowParentModel=function(superClass){function IWindowParentModel(scope,element,attrs,ctrls,$timeout,$compile,$http,$templateCache){IWindowParentModel.__super__.constructor.call(this,scope),this.$log=Logger,this.$timeout=$timeout,this.$compile=$compile,this.$http=$http,this.$templateCache=$templateCache,this.DEFAULTS={},null!=scope.options&&(this.DEFAULTS=scope.options)}return extend(IWindowParentModel,superClass),IWindowParentModel.include(GmapUtil),IWindowParentModel.prototype.getItem=function(scope,modelsPropToIterate,index){return"models"===modelsPropToIterate?scope[modelsPropToIterate][index]:scope[modelsPropToIterate].get(index)},IWindowParentModel}(ModelKey)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapLayerParentModel",["uiGmapBaseObject","uiGmapLogger","$timeout",function(BaseObject,Logger,$timeout){var LayerParentModel;return LayerParentModel=function(superClass){function LayerParentModel(scope,element,attrs,gMap,onLayerCreated,$log){return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.onLayerCreated=null!=onLayerCreated?onLayerCreated:void 0,this.$log=null!=$log?$log:Logger,this.createGoogleLayer=bind(this.createGoogleLayer,this),null==this.attrs.type?void this.$log.info("type attribute for the layer directive is mandatory. Layer creation aborted!!"):(this.createGoogleLayer(),this.doShow=!0,angular.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.gObject.setMap(this.gMap),this.scope.$watch("show",function(_this){return function(newValue,oldValue){return newValue!==oldValue?(_this.doShow=newValue,newValue?_this.gObject.setMap(_this.gMap):_this.gObject.setMap(null)):void 0}}(this),!0),this.scope.$watch("options",function(_this){return function(newValue,oldValue){return newValue!==oldValue?(_this.gObject.setMap(null),_this.gObject=null,_this.createGoogleLayer()):void 0}}(this),!0),void this.scope.$on("$destroy",function(_this){return function(){return _this.gObject.setMap(null)}}(this)))}return extend(LayerParentModel,superClass),LayerParentModel.prototype.createGoogleLayer=function(){var base;return null==this.attrs.options?this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type]:new google.maps[this.attrs.namespace][this.attrs.type]:this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type](this.scope.options):new google.maps[this.attrs.namespace][this.attrs.type](this.scope.options),null!=this.gObject&&null!=this.onLayerCreated&&"function"==typeof(base=this.onLayerCreated(this.scope,this.gObject))?base(this.gObject):void 0},LayerParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMapTypeParentModel",["uiGmapBaseObject","uiGmapLogger",function(BaseObject,Logger){var MapTypeParentModel;return MapTypeParentModel=function(superClass){function MapTypeParentModel(scope,element,attrs,gMap,$log){return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.$log=null!=$log?$log:Logger,this.hideOverlay=bind(this.hideOverlay,this),this.showOverlay=bind(this.showOverlay,this),this.refreshMapType=bind(this.refreshMapType,this),this.createMapType=bind(this.createMapType,this),null==this.attrs.options?void this.$log.info("options attribute for the map-type directive is mandatory. Map type creation aborted!!"):(this.id=this.gMap.overlayMapTypesCount=this.gMap.overlayMapTypesCount+1||0,this.doShow=!0,this.createMapType(),angular.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.showOverlay(),this.scope.$watch("show",function(_this){return function(newValue,oldValue){return newValue!==oldValue?(_this.doShow=newValue,newValue?_this.showOverlay():_this.hideOverlay()):void 0}}(this),!0),this.scope.$watch("options",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:_this.refreshMapType()}}(this),!0),angular.isDefined(this.attrs.refresh)&&this.scope.$watch("refresh",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:_this.refreshMapType()}}(this),!0),void this.scope.$on("$destroy",function(_this){return function(){return _this.hideOverlay(),_this.mapType=null}}(this)))}return extend(MapTypeParentModel,superClass),MapTypeParentModel.prototype.createMapType=function(){if(null!=this.scope.options.getTile)this.mapType=this.scope.options;else{if(null==this.scope.options.getTileUrl)return void this.$log.info("options should provide either getTile or getTileUrl methods. Map type creation aborted!!");this.mapType=new google.maps.ImageMapType(this.scope.options)}return this.attrs.id&&this.scope.id&&(this.gMap.mapTypes.set(this.scope.id,this.mapType),angular.isDefined(this.attrs.show)||(this.doShow=!1)),this.mapType.layerId=this.id},MapTypeParentModel.prototype.refreshMapType=function(){return this.hideOverlay(),this.mapType=null,this.createMapType(),this.doShow&&null!=this.gMap?this.showOverlay():void 0},MapTypeParentModel.prototype.showOverlay=function(){return this.gMap.overlayMapTypes.push(this.mapType)},MapTypeParentModel.prototype.hideOverlay=function(){var found;return found=!1,this.gMap.overlayMapTypes.forEach(function(_this){return function(mapType,index){found||mapType.layerId!==_this.id||(found=!0,_this.gMap.overlayMapTypes.removeAt(index))}}(this))},MapTypeParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMarkersParentModel",["uiGmapIMarkerParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapMarkerChildModel","uiGmap_async","uiGmapClustererMarkerManager","uiGmapMarkerManager","$timeout","uiGmapIMarker","uiGmapPromise","uiGmapGmapUtil","uiGmapLogger",function(IMarkerParentModel,ModelsWatcher,PropMap,MarkerChildModel,_async,ClustererMarkerManager,MarkerManager,$timeout,IMarker,uiGmapPromise,GmapUtil,$log){var MarkersParentModel,_setPlurals;return _setPlurals=function(val,objToSet){return objToSet.plurals=new PropMap,objToSet.scope.plurals=objToSet.plurals,objToSet},MarkersParentModel=function(superClass){function MarkersParentModel(scope,element,attrs,map){this.onDestroy=bind(this.onDestroy,this),this.newChildMarker=bind(this.newChildMarker,this),this.pieceMeal=bind(this.pieceMeal,this),this.rebuildAll=bind(this.rebuildAll,this),this.createAllNew=bind(this.createAllNew,this),this.createChildScopes=bind(this.createChildScopes,this),this.validateScope=bind(this.validateScope,this),this.onWatch=bind(this.onWatch,this);var self;MarkersParentModel.__super__.constructor.call(this,scope,element,attrs,map),this["interface"]=IMarker,self=this,_setPlurals(new PropMap,this),this.scope.pluralsUpdate={updateCtr:0},this.$log.info(this),this.doRebuildAll=null!=this.scope.doRebuildAll?this.scope.doRebuildAll:!1,this.setIdKey(this.scope),this.scope.$watch("doRebuildAll",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.doRebuildAll=newValue:void 0}}(this)),this.modelsLength()||(this.modelsRendered=!1),this.scope.$watch("models",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue)||!_this.modelsRendered){if(0===newValue.length&&0===oldValue.length)return;return _this.modelsRendered=!0,_this.onWatch("models",_this.scope,newValue,oldValue)}}}(this),!this.isTrue(attrs.modelsbyref)),this.watch("doCluster",this.scope),this.watch("clusterOptions",this.scope),this.watch("clusterEvents",this.scope),this.watch("fit",this.scope),this.watch("idKey",this.scope),this.gManager=void 0,this.createAllNew(this.scope)}return extend(MarkersParentModel,superClass),MarkersParentModel.include(GmapUtil),MarkersParentModel.include(ModelsWatcher),MarkersParentModel.prototype.onWatch=function(propNameToWatch,scope,newValue,oldValue){return"idKey"===propNameToWatch&&newValue!==oldValue&&(this.idKey=newValue),this.doRebuildAll||"doCluster"===propNameToWatch?this.rebuildAll(scope):this.pieceMeal(scope)},MarkersParentModel.prototype.validateScope=function(scope){var modelsNotDefined;return modelsNotDefined=angular.isUndefined(scope.models)||void 0===scope.models,modelsNotDefined&&this.$log.error(this.constructor.name+": no valid models attribute found"),MarkersParentModel.__super__.validateScope.call(this,scope)||modelsNotDefined},MarkersParentModel.prototype.createChildScopes=function(isCreatingFromScratch){return null!=this.gMap&&null!=this.scope.models?isCreatingFromScratch?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1):void 0},MarkersParentModel.prototype.createAllNew=function(scope){var maybeCanceled,ref,ref1,ref2,self;return null!=this.gManager&&(this.gManager.clear(),delete this.gManager),scope.doCluster?(scope.clusterEvents&&(self=this,this.origClusterEvents?angular.extend(scope.clusterEvents,this.origClusterEvents):this.origClusterEvents={click:null!=(ref=scope.clusterEvents)?ref.click:void 0,mouseout:null!=(ref1=scope.clusterEvents)?ref1.mouseout:void 0,mouseover:null!=(ref2=scope.clusterEvents)?ref2.mouseover:void 0},angular.extend(scope.clusterEvents,{click:function(cluster){return self.maybeExecMappedEvent(cluster,"click")},mouseout:function(cluster){return self.maybeExecMappedEvent(cluster,"mouseout")},mouseover:function(cluster){return self.maybeExecMappedEvent(cluster,"mouseover")}})),this.gManager=new ClustererMarkerManager(this.map,void 0,scope.clusterOptions,scope.clusterEvents)):this.gManager=new MarkerManager(this.map),this.didQueueInitPromise(this,scope)?void 0:(maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){return _this.newChildMarker(model,scope),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.modelsRendered=!0,scope.fit&&_this.gManager.fit(),_this.gManager.draw(),_this.scope.pluralsUpdate.updateCtr+=1},_async.chunkSizeFrom(scope.chunk))}}(this)))},MarkersParentModel.prototype.rebuildAll=function(scope){var ref;if(scope.doRebuild||void 0===scope.doRebuild)return(null!=(ref=this.scope.plurals)?ref.length:void 0)?this.onDestroy(scope).then(function(_this){return function(){return _this.createAllNew(scope)}}(this)):this.createAllNew(scope)},MarkersParentModel.prototype.pieceMeal=function(scope){var maybeCanceled,payload;if(!scope.$$destroyed)return maybeCanceled=null,payload=null,this.modelsLength()&&this.scope.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.scope.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,_async.each(payload.removals,function(child){return null!=child?(null!=child.destroy&&child.destroy(),_this.scope.plurals.remove(child.id),maybeCanceled):void 0},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){return _this.newChildMarker(modelToAdd,scope),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.updates,function(update){return _this.updateChild(update.child,update.model),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return(payload.adds.length>0||payload.removals.length>0||payload.updates.length>0)&&(scope.plurals=_this.scope.plurals,scope.fit&&_this.gManager.fit(),_this.gManager.draw()),_this.scope.pluralsUpdate.updateCtr+=1})}}(this)):(this.inProgress=!1,this.rebuildAll(scope))},MarkersParentModel.prototype.newChildMarker=function(model,scope){var child,childScope,doDrawSelf,keys;return null==model[this.idKey]?void this.$log.error("Marker model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.$log.info("child",child,"markers",this.scope.plurals),childScope=scope.$new(!0),childScope.events=scope.events,keys={},IMarker.scopeKeys.forEach(function(k){return keys[k]=scope[k]}),child=new MarkerChildModel(childScope,model,keys,this.map,this.DEFAULTS,this.doClick,this.gManager,doDrawSelf=!1),this.scope.plurals.put(model[this.idKey],child),child)},MarkersParentModel.prototype.onDestroy=function(scope){return MarkersParentModel.__super__.onDestroy.call(this,scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.scope.plurals.values(),function(model){return null!=model?model.destroy(!1):void 0},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){return null!=_this.gManager&&_this.gManager.clear(),_this.plurals.removeAll(),_this.plurals!==_this.scope.plurals&&console.error("plurals out of sync for MarkersParentModel"),_this.scope.pluralsUpdate.updateCtr+=1})}}(this))},MarkersParentModel.prototype.maybeExecMappedEvent=function(cluster,fnName){var pair,ref;return _.isFunction(null!=(ref=this.scope.clusterEvents)?ref[fnName]:void 0)&&(pair=this.mapClusterToPlurals(cluster),this.origClusterEvents[fnName])?this.origClusterEvents[fnName](pair.cluster,pair.mapped):void 0},MarkersParentModel.prototype.mapClusterToPlurals=function(cluster){var mapped;return mapped=cluster.getMarkers().map(function(_this){return function(g){return _this.scope.plurals.get(g.key).model}}(this)),{cluster:cluster,mapped:mapped}},MarkersParentModel.prototype.getItem=function(scope,modelsPropToIterate,index){return"models"===modelsPropToIterate?scope[modelsPropToIterate][index]:scope[modelsPropToIterate].get(index)},MarkersParentModel}(IMarkerParentModel)}])}.call(this),function(){["Polygon","Polyline"].forEach(function(name){return angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmap"+name+"sParentModel",["uiGmapBasePolysParentModel","uiGmap"+name+"ChildModel","uiGmapI"+name,function(BasePolysParentModel,ChildModel,IPoly){return BasePolysParentModel(IPoly,ChildModel,name)}])})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapRectangleParentModel",["uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapRectangleOptionsBuilder",function($log,GmapUtil,EventsHelper,Builder){var RectangleParentModel;return RectangleParentModel=function(superClass){function RectangleParentModel(scope,element,attrs,map,DEFAULTS){var bounds,clear,createBounds,dragging,fit,gObject,init,listeners,myListeners,settingBoundsFromScope,updateBounds;this.scope=scope,this.attrs=attrs,this.map=map,this.DEFAULTS=DEFAULTS,bounds=void 0,dragging=!1,myListeners=[],listeners=void 0,fit=function(_this){return function(){return _this.isTrue(_this.attrs.fit)?_this.fitMapBounds(_this.map,bounds):void 0}}(this),createBounds=function(_this){return function(){var ref,ref1,ref2;return null!=_this.scope.bounds&&null!=(null!=(ref=_this.scope.bounds)?ref.sw:void 0)&&null!=(null!=(ref1=_this.scope.bounds)?ref1.ne:void 0)&&_this.validateBoundPoints(_this.scope.bounds)?(bounds=_this.convertBoundPoints(_this.scope.bounds),$log.info("new new bounds created: "+JSON.stringify(bounds))):null!=_this.scope.bounds.getNorthEast&&null!=_this.scope.bounds.getSouthWest?bounds=_this.scope.bounds:null!=_this.scope.bounds?$log.error("Invalid bounds for newValue: "+JSON.stringify(null!=(ref2=_this.scope)?ref2.bounds:void 0)):void 0}}(this),createBounds(),gObject=new google.maps.Rectangle(this.buildOpts(bounds)),$log.info("gObject (rectangle) created: "+gObject),settingBoundsFromScope=!1,updateBounds=function(_this){return function(){var b,ne,sw;return b=gObject.getBounds(),ne=b.getNorthEast(),sw=b.getSouthWest(),settingBoundsFromScope?void 0:_this.scope.$evalAsync(function(s){return null!=s.bounds&&null!=s.bounds.sw&&null!=s.bounds.ne&&(s.bounds.ne={latitude:ne.lat(),longitude:ne.lng()},s.bounds.sw={latitude:sw.lat(),longitude:sw.lng()}),null!=s.bounds.getNorthEast&&null!=s.bounds.getSouthWest?s.bounds=b:void 0})}}(this),init=function(_this){return function(){return fit(),_this.removeEvents(myListeners),myListeners.push(google.maps.event.addListener(gObject,"dragstart",function(){return dragging=!0})),myListeners.push(google.maps.event.addListener(gObject,"dragend",function(){return dragging=!1,updateBounds()})),myListeners.push(google.maps.event.addListener(gObject,"bounds_changed",function(){return dragging?void 0:updateBounds()}))}}(this),clear=function(_this){return function(){return _this.removeEvents(myListeners),null!=listeners&&_this.removeEvents(listeners),gObject.setMap(null)}}(this),null!=bounds&&init(),this.scope.$watch("bounds",function(newValue,oldValue){var isNew;if(!(_.isEqual(newValue,oldValue)&&null!=bounds||dragging))return settingBoundsFromScope=!0,null==newValue?void clear():(null==bounds?isNew=!0:fit(),createBounds(),gObject.setBounds(bounds),settingBoundsFromScope=!1,isNew&&null!=bounds?init():void 0)},!0),this.setMyOptions=function(_this){return function(newVals,oldVals){return _.isEqual(newVals,oldVals)||null==bounds||null==newVals?void 0:gObject.setOptions(_this.buildOpts(bounds))}}(this),this.props.push("bounds"),this.watchProps(this.props),null!=this.attrs.events&&(listeners=this.setEvents(gObject,this.scope,this.scope),this.scope.$watch("events",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:(null!=listeners&&_this.removeEvents(listeners),listeners=_this.setEvents(gObject,_this.scope,_this.scope))}}(this))),this.scope.$on("$destroy",function(_this){return function(){return clear()}}(this)),$log.info(this)}return extend(RectangleParentModel,superClass),RectangleParentModel.include(GmapUtil),RectangleParentModel.include(EventsHelper),RectangleParentModel}(Builder)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapSearchBoxParentModel",["uiGmapBaseObject","uiGmapLogger","uiGmapEventsHelper","$timeout","$http","$templateCache",function(BaseObject,Logger,EventsHelper,$timeout,$http,$templateCache){var SearchBoxParentModel;return SearchBoxParentModel=function(superClass){function SearchBoxParentModel(scope,element,attrs,gMap,ctrlPosition,template,$log){var controlDiv;return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.ctrlPosition=ctrlPosition,this.template=template,this.$log=null!=$log?$log:Logger,this.setVisibility=bind(this.setVisibility,this),this.getBounds=bind(this.getBounds,this),this.setBounds=bind(this.setBounds,this),this.createSearchBox=bind(this.createSearchBox,this),this.addToParentDiv=bind(this.addToParentDiv,this),this.addAsMapControl=bind(this.addAsMapControl,this),this.init=bind(this.init,this),null==this.attrs.template?void this.$log.error("template attribute for the search-box directive is mandatory. Places Search Box creation aborted!!"):(angular.isUndefined(this.scope.options)&&(this.scope.options={},this.scope.options.visible=!0),angular.isUndefined(this.scope.options.visible)&&(this.scope.options.visible=!0),angular.isUndefined(this.scope.options.autocomplete)&&(this.scope.options.autocomplete=!1),this.visible=this.scope.options.visible,this.autocomplete=this.scope.options.autocomplete,controlDiv=angular.element("<div></div>"),controlDiv.append(this.template),this.input=controlDiv.find("input")[0],void this.init())}return extend(SearchBoxParentModel,superClass),SearchBoxParentModel.include(EventsHelper),SearchBoxParentModel.prototype.init=function(){return this.createSearchBox(),this.scope.$watch("options",function(_this){return function(newValue,oldValue){return angular.isObject(newValue)&&(null!=newValue.bounds&&_this.setBounds(newValue.bounds),null!=newValue.visible&&_this.visible!==newValue.visible)?_this.setVisibility(newValue.visible):void 0}}(this),!0),null!=this.attrs.parentdiv?this.addToParentDiv():this.addAsMapControl(),this.autocomplete?this.listener=google.maps.event.addListener(this.gObject,"place_changed",function(_this){return function(){return _this.places=_this.gObject.getPlace()}}(this)):this.listener=google.maps.event.addListener(this.gObject,"places_changed",function(_this){return function(){return _this.places=_this.gObject.getPlaces()}}(this)),this.listeners=this.setEvents(this.gObject,this.scope,this.scope),this.$log.info(this),this.scope.$on("$destroy",function(_this){return function(){return _this.gObject=null}}(this))},SearchBoxParentModel.prototype.addAsMapControl=function(){return this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input)},SearchBoxParentModel.prototype.addToParentDiv=function(){return this.parentDiv=angular.element(document.getElementById(this.scope.parentdiv)),this.parentDiv.append(this.input)},SearchBoxParentModel.prototype.createSearchBox=function(){return this.autocomplete?this.gObject=new google.maps.places.Autocomplete(this.input,this.scope.options):this.gObject=new google.maps.places.SearchBox(this.input,this.scope.options)},SearchBoxParentModel.prototype.setBounds=function(bounds){if(angular.isUndefined(bounds.isEmpty))this.$log.error("Error: SearchBoxParentModel setBounds. Bounds not an instance of LatLngBounds.");else if(bounds.isEmpty()===!1&&null!=this.gObject)return this.gObject.setBounds(bounds)},SearchBoxParentModel.prototype.getBounds=function(){return this.gObject.getBounds()},SearchBoxParentModel.prototype.setVisibility=function(val){return null!=this.attrs.parentdiv?val===!1?this.parentDiv.addClass("ng-hide"):this.parentDiv.removeClass("ng-hide"):val===!1?this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].clear():this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input),this.visible=val},SearchBoxParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapWindowsParentModel",["uiGmapIWindowParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapWindowChildModel","uiGmapLinked","uiGmap_async","uiGmapLogger","$timeout","$compile","$http","$templateCache","$interpolate","uiGmapPromise","uiGmapIWindow","uiGmapGmapUtil",function(IWindowParentModel,ModelsWatcher,PropMap,WindowChildModel,Linked,_async,$log,$timeout,$compile,$http,$templateCache,$interpolate,uiGmapPromise,IWindow,GmapUtil){var WindowsParentModel;return WindowsParentModel=function(superClass){function WindowsParentModel(scope,element,attrs,ctrls,gMap1,markersScope){this.gMap=gMap1,this.markersScope=markersScope,this.modelKeyComparison=bind(this.modelKeyComparison,this),this.interpolateContent=bind(this.interpolateContent,this),this.setChildScope=bind(this.setChildScope,this),this.createWindow=bind(this.createWindow,this),this.setContentKeys=bind(this.setContentKeys,this),this.pieceMeal=bind(this.pieceMeal,this),this.createAllNew=bind(this.createAllNew,this),this.watchIdKey=bind(this.watchIdKey,this),this.createChildScopes=bind(this.createChildScopes,this),this.watchOurScope=bind(this.watchOurScope,this),this.watchDestroy=bind(this.watchDestroy,this),this.onDestroy=bind(this.onDestroy,this),this.rebuildAll=bind(this.rebuildAll,this),this.doINeedToWipe=bind(this.doINeedToWipe,this),this.watchModels=bind(this.watchModels,this),this.go=bind(this.go,this),WindowsParentModel.__super__.constructor.call(this,scope,element,attrs,ctrls,$timeout,$compile,$http,$templateCache),this["interface"]=IWindow,this.plurals=new PropMap,_.each(IWindow.scopeKeys,function(_this){return function(name){return _this[name+"Key"]=void 0}}(this)),this.linked=new Linked(scope,element,attrs,ctrls),this.contentKeys=void 0,this.isIconVisibleOnClick=void 0,this.firstTime=!0,this.firstWatchModels=!0,this.$log.info(self),this.parentScope=void 0,this.go(scope)}return extend(WindowsParentModel,superClass),WindowsParentModel.include(ModelsWatcher),WindowsParentModel.prototype.go=function(scope){return this.watchOurScope(scope),this.doRebuildAll=null!=this.scope.doRebuildAll?this.scope.doRebuildAll:!1,scope.$watch("doRebuildAll",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.doRebuildAll=newValue:void 0}}(this)),this.createChildScopes()},WindowsParentModel.prototype.watchModels=function(scope){var itemToWatch;return itemToWatch=null!=this.markersScope?"pluralsUpdate":"models",scope.$watch(itemToWatch,function(_this){return function(newValue,oldValue){var doScratch;return!_.isEqual(newValue,oldValue)||_this.firstWatchModels?(_this.firstWatchModels=!1,_this.doRebuildAll||_this.doINeedToWipe(scope.models)?_this.rebuildAll(scope,!0,!0):(doScratch=0===_this.plurals.length,null!=_this.existingPieces?_.last(_this.existingPieces._content).then(function(){return _this.createChildScopes(doScratch)}):_this.createChildScopes(doScratch))):void 0}}(this),!0)},WindowsParentModel.prototype.doINeedToWipe=function(newValue){var newValueIsEmpty;return newValueIsEmpty=null!=newValue?0===newValue.length:!0,this.plurals.length>0&&newValueIsEmpty},WindowsParentModel.prototype.rebuildAll=function(scope,doCreate,doDelete){return this.onDestroy(doDelete).then(function(_this){return function(){return doCreate?_this.createChildScopes():void 0}}(this))},WindowsParentModel.prototype.onDestroy=function(scope){return WindowsParentModel.__super__.onDestroy.call(this,this.scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.plurals.values(),function(child){return child.destroy()},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){var ref;return null!=(ref=_this.plurals)?ref.removeAll():void 0})}}(this))},WindowsParentModel.prototype.watchDestroy=function(scope){return scope.$on("$destroy",function(_this){return function(){return _this.firstWatchModels=!0,_this.firstTime=!0,_this.rebuildAll(scope,!1,!0)}}(this))},WindowsParentModel.prototype.watchOurScope=function(scope){return _.each(IWindow.scopeKeys,function(_this){return function(name){var nameKey;return nameKey=name+"Key",_this[nameKey]="function"==typeof scope[name]?scope[name]():scope[name]}}(this))},WindowsParentModel.prototype.createChildScopes=function(isCreatingFromScratch){var modelsNotDefined,ref,ref1;return null==isCreatingFromScratch&&(isCreatingFromScratch=!0),this.isIconVisibleOnClick=!0,angular.isDefined(this.linked.attrs.isiconvisibleonclick)&&(this.isIconVisibleOnClick=this.linked.scope.isIconVisibleOnClick),modelsNotDefined=angular.isUndefined(this.linked.scope.models),!modelsNotDefined||void 0!==this.markersScope&&void 0!==(null!=(ref=this.markersScope)?ref.plurals:void 0)&&void 0!==(null!=(ref1=this.markersScope)?ref1.models:void 0)?null!=this.gMap?null!=this.linked.scope.models?(this.watchIdKey(this.linked.scope),isCreatingFromScratch?this.createAllNew(this.linked.scope,!1):this.pieceMeal(this.linked.scope,!1)):(this.parentScope=this.markersScope,this.watchIdKey(this.parentScope),isCreatingFromScratch?this.createAllNew(this.markersScope,!0,"plurals",!1):this.pieceMeal(this.markersScope,!0,"plurals",!1)):void 0:void this.$log.error("No models to create windows from! Need direct models or models derived from markers!")},WindowsParentModel.prototype.watchIdKey=function(scope){return this.setIdKey(scope),scope.$watch("idKey",function(_this){return function(newValue,oldValue){return newValue!==oldValue&&null==newValue?(_this.idKey=newValue,_this.rebuildAll(scope,!0,!0)):void 0}}(this))},WindowsParentModel.prototype.createAllNew=function(scope,hasGMarker,modelsPropToIterate,isArray){var maybeCanceled;return null==modelsPropToIterate&&(modelsPropToIterate="models"),null==isArray&&(isArray=!1),this.firstTime&&(this.watchModels(scope),this.watchDestroy(scope)),this.setContentKeys(scope.models),this.didQueueInitPromise(this,scope)?void 0:(maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){var gMarker,ref;return gMarker=hasGMarker&&null!=(ref=_this.getItem(scope,modelsPropToIterate,model[_this.idKey]))?ref.gObject:void 0,maybeCanceled||(!gMarker&&_this.markersScope&&$log.error("Unable to get gMarker from markersScope!"),_this.createWindow(model,gMarker,_this.gMap)),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.firstTime=!1})}}(this)))},WindowsParentModel.prototype.pieceMeal=function(scope,hasGMarker,modelsPropToIterate,isArray){var maybeCanceled,payload;return null==modelsPropToIterate&&(modelsPropToIterate="models"),null==isArray&&(isArray=!0),scope.$$destroyed?void 0:(maybeCanceled=null,payload=null,null!=scope&&this.modelsLength()&&this.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,_async.each(payload.removals,function(child){return null!=child?(_this.plurals.remove(child.id),null!=child.destroy&&child.destroy(!0),maybeCanceled):void 0},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){var gMarker,ref;if(gMarker=null!=(ref=_this.getItem(scope,modelsPropToIterate,modelToAdd[_this.idKey]))?ref.gObject:void 0,!gMarker)throw"Gmarker undefined";return _this.createWindow(modelToAdd,gMarker,_this.gMap),maybeCanceled})}).then(function(){return _async.each(payload.updates,function(update){return _this.updateChild(update.child,update.model),maybeCanceled},_async.chunkSizeFrom(scope.chunk))})}}(this)):($log.debug("pieceMeal: rebuildAll"),this.rebuildAll(this.scope,!0,!0)))},WindowsParentModel.prototype.setContentKeys=function(models){return this.modelsLength(models)?this.contentKeys=Object.keys(models[0]):void 0},
WindowsParentModel.prototype.createWindow=function(model,gMarker,gMap){var child,childScope,fakeElement,opts,ref,ref1;return childScope=this.linked.scope.$new(!1),this.setChildScope(childScope,model),childScope.$watch("model",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.setChildScope(childScope,newValue):void 0}}(this),!0),fakeElement={html:function(_this){return function(){return _this.interpolateContent(_this.linked.element.html(),model)}}(this)},this.DEFAULTS=this.scopeOrModelVal(this.optionsKey,this.scope,model)||{},opts=this.createWindowOptions(gMarker,childScope,fakeElement.html(),this.DEFAULTS),child=new WindowChildModel(model,childScope,opts,this.isIconVisibleOnClick,gMap,null!=(ref=this.markersScope)&&null!=(ref1=ref.plurals.get(model[this.idKey]))?ref1.scope:void 0,fakeElement,!1,!0),null==model[this.idKey]?void this.$log.error("Window model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.plurals.put(model[this.idKey],child),child)},WindowsParentModel.prototype.setChildScope=function(childScope,model){return _.each(IWindow.scopeKeys,function(_this){return function(name){var nameKey,newValue;return nameKey=name+"Key",newValue="self"===_this[nameKey]?model:model[_this[nameKey]],newValue!==childScope[name]?childScope[name]=newValue:void 0}}(this)),childScope.model=model},WindowsParentModel.prototype.interpolateContent=function(content,model){var exp,i,interpModel,key,len,ref;if(void 0!==this.contentKeys&&0!==this.contentKeys.length){for(exp=$interpolate(content),interpModel={},ref=this.contentKeys,i=0,len=ref.length;len>i;i++)key=ref[i],interpModel[key]=model[key];return exp(interpModel)}},WindowsParentModel.prototype.modelKeyComparison=function(model1,model2){var isEqual,scope;if(scope=null!=this.scope.coords?this.scope:this.parentScope,null==scope)throw"No scope or parentScope set!";return(isEqual=GmapUtil.equalCoords(this.evalModelHandle(model1,scope.coords),this.evalModelHandle(model2,scope.coords)))?isEqual=_.every(_.without(this["interface"].scopeKeys,"coords"),function(_this){return function(k){return _this.evalModelHandle(model1,scope[k])===_this.evalModelHandle(model2,scope[k])}}(this)):isEqual},WindowsParentModel}(IWindowParentModel)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapCircle",["uiGmapICircle","uiGmapCircleParentModel",function(ICircle,CircleParentModel){return _.extend(ICircle,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new CircleParentModel(scope,element,attrs,map)}}(this))}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapControl",["uiGmapIControl","$http","$templateCache","$compile","$controller","uiGmapGoogleMapApi",function(IControl,$http,$templateCache,$compile,$controller,GoogleMapApi){var Control;return Control=function(superClass){function Control(){this.link=bind(this.link,this),Control.__super__.constructor.call(this)}return extend(Control,superClass),Control.prototype.link=function(scope,element,attrs,ctrl){return GoogleMapApi.then(function(_this){return function(maps){var index,position;return angular.isUndefined(scope.template)?void _this.$log.error("mapControl: could not find a valid template property"):(index=angular.isDefined(scope.index&&!isNaN(parseInt(scope.index)))?parseInt(scope.index):void 0,position=angular.isDefined(scope.position)?scope.position.toUpperCase().replace(/-/g,"_"):"TOP_CENTER",maps.ControlPosition[position]?IControl.mapPromise(scope,ctrl).then(function(map){var control,controlDiv;return control=void 0,controlDiv=angular.element("<div></div>"),$http.get(scope.template,{cache:$templateCache}).success(function(template){var templateCtrl,templateScope;return templateScope=scope.$new(),controlDiv.append(template),angular.isDefined(scope.controller)&&(templateCtrl=$controller(scope.controller,{$scope:templateScope}),controlDiv.children().data("$ngControllerController",templateCtrl)),control=$compile(controlDiv.children())(templateScope),index?control[0].index=index:void 0}).error(function(error){return _this.$log.error("mapControl: template could not be found")}).then(function(){return map.controls[google.maps.ControlPosition[position]].push(control[0])})}):void _this.$log.error("mapControl: invalid position property"))}}(this))},Control}(IControl)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapDragZoom",["uiGmapCtrlHandle","uiGmapPropertyAction",function(CtrlHandle,PropertyAction){return{restrict:"EMA",transclude:!0,template:'<div class="angular-google-map-dragzoom" ng-transclude style="display: none"></div>',require:"^uiGmapGoogleMap",scope:{keyboardkey:"=",options:"=",spec:"="},controller:["$scope","$element",function($scope,$element){return $scope.ctrlType="uiGmapDragZoom",_.extend(this,CtrlHandle.handle($scope,$element))}],link:function(scope,element,attrs,ctrl){return CtrlHandle.mapPromise(scope,ctrl).then(function(map){var enableKeyDragZoom,setKeyAction,setOptionsAction;return enableKeyDragZoom=function(opts){return map.enableKeyDragZoom(opts),scope.spec?scope.spec.enableKeyDragZoom(opts):void 0},setKeyAction=new PropertyAction(function(key,newVal){return newVal?enableKeyDragZoom({key:newVal}):enableKeyDragZoom()}),setOptionsAction=new PropertyAction(function(key,newVal){return newVal?enableKeyDragZoom(newVal):void 0}),scope.$watch("keyboardkey",setKeyAction.sic),setKeyAction.sic(scope.keyboardkey),scope.$watch("options",setOptionsAction.sic),setOptionsAction.sic(scope.options)})}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapDrawingManager",["uiGmapIDrawingManager","uiGmapDrawingManagerParentModel",function(IDrawingManager,DrawingManagerParentModel){return _.extend(IDrawingManager,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(map){return new DrawingManagerParentModel(scope,element,attrs,map)})}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapApiFreeDrawPolygons",["uiGmapLogger","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapDrawFreeHandChildModel","uiGmapLodash",function($log,BaseObject,CtrlHandle,DrawFreeHandChildModel,uiGmapLodash){var FreeDrawPolygons;return FreeDrawPolygons=function(superClass){function FreeDrawPolygons(){return this.link=bind(this.link,this),FreeDrawPolygons.__super__.constructor.apply(this,arguments)}return extend(FreeDrawPolygons,superClass),FreeDrawPolygons.include(CtrlHandle),FreeDrawPolygons.prototype.restrict="EMA",FreeDrawPolygons.prototype.replace=!0,FreeDrawPolygons.prototype.require="^uiGmapGoogleMap",FreeDrawPolygons.prototype.scope={polygons:"=",draw:"=",revertmapoptions:"="},FreeDrawPolygons.prototype.link=function(scope,element,attrs,ctrl){return this.mapPromise(scope,ctrl).then(function(_this){return function(map){var freeHand,listener;return scope.polygons?_.isArray(scope.polygons)?(freeHand=new DrawFreeHandChildModel(map,scope.revertmapoptions),listener=void 0,scope.draw=function(){return"function"==typeof listener&&listener(),freeHand.engage(scope.polygons).then(function(){var firstTime;return firstTime=!0,listener=scope.$watchCollection("polygons",function(newValue,oldValue){var removals;return firstTime||newValue===oldValue?void(firstTime=!1):(removals=uiGmapLodash.differenceObjects(oldValue,newValue),removals.forEach(function(p){return p.setMap(null)}))})})}):$log.error("Free Draw Polygons must be of type Array!"):$log.error("No polygons to bind to!")}}(this))},FreeDrawPolygons}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapICircle",[function(){var DEFAULTS;return DEFAULTS={},{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{center:"=center",radius:"=radius",stroke:"=stroke",fill:"=fill",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=icons",visible:"=",events:"=",zIndex:"=zindex"}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIControl",["uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(BaseObject,Logger,CtrlHandle){var IControl;return IControl=function(superClass){function IControl(){this.restrict="EA",this.replace=!0,this.require="^uiGmapGoogleMap",this.scope={template:"@template",position:"@position",controller:"@controller",index:"@index"},this.$log=Logger}return extend(IControl,superClass),IControl.extend(CtrlHandle),IControl.prototype.link=function(scope,element,attrs,ctrl){throw new Exception("Not implemented!!")},IControl}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapIDrawingManager",[function(){return{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{"static":"@",control:"=",options:"=",events:"="}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIMarker",["uiGmapBaseObject","uiGmapCtrlHandle",function(BaseObject,CtrlHandle){var IMarker;return IMarker=function(superClass){function IMarker(){this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.replace=!0,this.scope=_.extend(this.scope||{},IMarker.scope)}return extend(IMarker,superClass),IMarker.scope={coords:"=coords",icon:"=icon",click:"&click",options:"=options",events:"=events",fit:"=fit",idKey:"=idkey",control:"=control"},IMarker.scopeKeys=_.keys(IMarker.scope),IMarker.keys=IMarker.scopeKeys,IMarker.extend(CtrlHandle),IMarker}(BaseObject)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolygon",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(GmapUtil,BaseObject,Logger,CtrlHandle){var IPolygon;return IPolygon=function(superClass){function IPolygon(){}return extend(IPolygon,superClass),IPolygon.scope={path:"=path",stroke:"=stroke",clickable:"=",draggable:"=",editable:"=",geodesic:"=",fill:"=",icons:"=icons",visible:"=","static":"=",events:"=",zIndex:"=zindex",fit:"=",control:"=control"},IPolygon.scopeKeys=_.keys(IPolygon.scope),IPolygon.include(GmapUtil),IPolygon.extend(CtrlHandle),IPolygon.prototype.restrict="EMA",IPolygon.prototype.replace=!0,IPolygon.prototype.require="^uiGmapGoogleMap",IPolygon.prototype.scope=IPolygon.scope,IPolygon.prototype.DEFAULTS={},IPolygon.prototype.$log=Logger,IPolygon}(BaseObject)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolyline",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(GmapUtil,BaseObject,Logger,CtrlHandle){var IPolyline;return IPolyline=function(superClass){function IPolyline(){}return extend(IPolyline,superClass),IPolyline.scope={path:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=",visible:"=","static":"=",fit:"=",events:"=",zIndex:"=zindex"},IPolyline.scopeKeys=_.keys(IPolyline.scope),IPolyline.include(GmapUtil),IPolyline.extend(CtrlHandle),IPolyline.prototype.restrict="EMA",IPolyline.prototype.replace=!0,IPolyline.prototype.require="^uiGmapGoogleMap",IPolyline.prototype.scope=IPolyline.scope,IPolyline.prototype.DEFAULTS={},IPolyline.prototype.$log=Logger,IPolyline}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapIRectangle",[function(){var DEFAULTS;return DEFAULTS={},{restrict:"EMA",require:"^uiGmapGoogleMap",replace:!0,scope:{bounds:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",fill:"=",visible:"=",events:"="}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIWindow",["uiGmapBaseObject","uiGmapChildEvents","uiGmapCtrlHandle",function(BaseObject,ChildEvents,CtrlHandle){var IWindow;return IWindow=function(superClass){function IWindow(){this.restrict="EMA",this.template=void 0,this.transclude=!0,this.priority=-100,this.require="^uiGmapGoogleMap",this.replace=!0,this.scope=_.extend(this.scope||{},IWindow.scope)}return extend(IWindow,superClass),IWindow.scope={coords:"=coords",template:"=template",templateUrl:"=templateurl",templateParameter:"=templateparameter",isIconVisibleOnClick:"=isiconvisibleonclick",closeClick:"&closeclick",options:"=options",control:"=control",show:"=show"},IWindow.scopeKeys=_.keys(IWindow.scope),IWindow.include(ChildEvents),IWindow.extend(CtrlHandle),IWindow}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMap",["$timeout","$q","uiGmapLogger","uiGmapGmapUtil","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapIsReady","uiGmapuuid","uiGmapExtendGWin","uiGmapExtendMarkerClusterer","uiGmapGoogleMapsUtilV3","uiGmapGoogleMapApi","uiGmapEventsHelper",function($timeout,$q,$log,GmapUtil,BaseObject,CtrlHandle,IsReady,uuid,ExtendGWin,ExtendMarkerClusterer,GoogleMapsUtilV3,GoogleMapApi,EventsHelper){var DEFAULTS,Map,initializeItems;return DEFAULTS=void 0,initializeItems=[GoogleMapsUtilV3,ExtendGWin,ExtendMarkerClusterer],Map=function(superClass){function Map(){this.link=bind(this.link,this);var ctrlFn,self;ctrlFn=function($scope){var ctrlObj,retCtrl;return retCtrl=void 0,$scope.$on("$destroy",function(){return IsReady.decrement()}),ctrlObj=CtrlHandle.handle($scope),$scope.ctrlType="Map",$scope.deferred.promise.then(function(){return initializeItems.forEach(function(i){return i.init()})}),ctrlObj.getMap=function(){return $scope.map},retCtrl=_.extend(this,ctrlObj)},this.controller=["$scope",ctrlFn],self=this}return extend(Map,superClass),Map.include(GmapUtil),Map.prototype.restrict="EMA",Map.prototype.transclude=!0,Map.prototype.replace=!1,Map.prototype.template='<div class="angular-google-map"><div class="angular-google-map-container"></div><div ng-transclude style="display: none"></div></div>',Map.prototype.scope={center:"=",zoom:"=",dragging:"=",control:"=",options:"=",events:"=",eventOpts:"=",styles:"=",bounds:"=",update:"="},Map.prototype.link=function(scope,element,attrs){var listeners,unbindCenterWatch;return listeners=[],scope.$on("$destroy",function(){return EventsHelper.removeEvents(listeners)}),scope.idleAndZoomChanged=!1,null==scope.center?void(unbindCenterWatch=scope.$watch("center",function(_this){return function(){return scope.center?(unbindCenterWatch(),_this.link(scope,element,attrs)):void 0}}(this))):GoogleMapApi.then(function(_this){return function(maps){var _gMap,customListeners,disabledEvents,dragging,el,eventName,getEventHandler,mapOptions,maybeHookToEvent,opts,ref,resolveSpawned,settingFromDirective,spawned,type,updateCenter,zoomPromise;if(DEFAULTS={mapTypeId:maps.MapTypeId.ROADMAP},spawned=IsReady.spawn(),resolveSpawned=function(){return spawned.deferred.resolve({instance:spawned.instance,map:_gMap})},!_this.validateCoords(scope.center))return void $log.error("angular-google-maps: could not find a valid center property");if(!angular.isDefined(scope.zoom))return void $log.error("angular-google-maps: map zoom property not set");if(el=angular.element(element),el.addClass("angular-google-map"),opts={options:{}},attrs.options&&(opts.options=scope.options),attrs.styles&&(opts.styles=scope.styles),attrs.type&&(type=attrs.type.toUpperCase(),google.maps.MapTypeId.hasOwnProperty(type)?opts.mapTypeId=google.maps.MapTypeId[attrs.type.toUpperCase()]:$log.error("angular-google-maps: invalid map type '"+attrs.type+"'")),mapOptions=angular.extend({},DEFAULTS,opts,{center:_this.getCoords(scope.center),zoom:scope.zoom,bounds:scope.bounds}),_gMap=new google.maps.Map(el.find("div")[1],mapOptions),_gMap.uiGmap_id=uuid.generate(),dragging=!1,listeners.push(google.maps.event.addListenerOnce(_gMap,"idle",function(){return scope.deferred.resolve(_gMap),resolveSpawned()})),disabledEvents=attrs.events&&null!=(null!=(ref=scope.events)?ref.blacklist:void 0)?scope.events.blacklist:[],_.isString(disabledEvents)&&(disabledEvents=[disabledEvents]),maybeHookToEvent=function(eventName,fn,prefn){return _.contains(disabledEvents,eventName)?void 0:(prefn&&prefn(),listeners.push(google.maps.event.addListener(_gMap,eventName,function(){var ref1;return(null!=(ref1=scope.update)?ref1.lazy:void 0)?void 0:fn()})))},_.contains(disabledEvents,"all")||(maybeHookToEvent("dragstart",function(){return dragging=!0,scope.$evalAsync(function(s){return null!=s.dragging?s.dragging=dragging:void 0})}),maybeHookToEvent("dragend",function(){return dragging=!1,scope.$evalAsync(function(s){return null!=s.dragging?s.dragging=dragging:void 0})}),updateCenter=function(c,s){if(null==c&&(c=_gMap.center),null==s&&(s=scope),!_.contains(disabledEvents,"center"))if(angular.isDefined(s.center.type)){if(s.center.coordinates[1]!==c.lat()&&(s.center.coordinates[1]=c.lat()),s.center.coordinates[0]!==c.lng())return s.center.coordinates[0]=c.lng()}else if(s.center.latitude!==c.lat()&&(s.center.latitude=c.lat()),s.center.longitude!==c.lng())return s.center.longitude=c.lng()},settingFromDirective=!1,maybeHookToEvent("idle",function(){var b,ne,sw;return b=_gMap.getBounds(),ne=b.getNorthEast(),sw=b.getSouthWest(),settingFromDirective=!0,scope.$evalAsync(function(s){return updateCenter(),null===s.bounds||s.bounds===undefined||void 0===s.bounds||_.contains(disabledEvents,"bounds")||(s.bounds.northeast={latitude:ne.lat(),longitude:ne.lng()},s.bounds.southwest={latitude:sw.lat(),longitude:sw.lng()}),_.contains(disabledEvents,"zoom")||(s.zoom=_gMap.zoom,scope.idleAndZoomChanged=!scope.idleAndZoomChanged),settingFromDirective=!1})})),angular.isDefined(scope.events)&&null!==scope.events&&angular.isObject(scope.events)){getEventHandler=function(eventName){return function(){return scope.events[eventName].apply(scope,[_gMap,eventName,arguments])}},customListeners=[];for(eventName in scope.events)scope.events.hasOwnProperty(eventName)&&angular.isFunction(scope.events[eventName])&&customListeners.push(google.maps.event.addListener(_gMap,eventName,getEventHandler(eventName)));listeners.concat(customListeners)}return _gMap.getOptions=function(){return mapOptions},scope.map=_gMap,null!=attrs.control&&null!=scope.control&&(scope.control.refresh=function(maybeCoords){var coords,ref1,ref2;if(null!=_gMap)return null!=("undefined"!=typeof google&&null!==google&&null!=(ref1=google.maps)&&null!=(ref2=ref1.event)?ref2.trigger:void 0)&&null!=_gMap&&google.maps.event.trigger(_gMap,"resize"),null!=(null!=maybeCoords?maybeCoords.latitude:void 0)&&null!=(null!=maybeCoords?maybeCoords.longitude:void 0)?(coords=_this.getCoords(maybeCoords),_this.isTrue(attrs.pan)?_gMap.panTo(coords):_gMap.setCenter(coords)):void 0},scope.control.getGMap=function(){return _gMap},scope.control.getMapOptions=function(){return mapOptions},scope.control.getCustomEventListeners=function(){return customListeners},scope.control.removeEvents=function(yourListeners){return EventsHelper.removeEvents(yourListeners)}),scope.$watch("center",function(newValue,oldValue){var coords,settingCenterFromScope;if(newValue!==oldValue&&!settingFromDirective&&(coords=_this.getCoords(scope.center),coords.lat()!==_gMap.center.lat()||coords.lng()!==_gMap.center.lng()))return settingCenterFromScope=!0,dragging||(_this.validateCoords(newValue)||$log.error("Invalid center for newValue: "+JSON.stringify(newValue)),_this.isTrue(attrs.pan)&&scope.zoom===_gMap.zoom?_gMap.panTo(coords):_gMap.setCenter(coords)),settingCenterFromScope=!1},!0),zoomPromise=null,scope.$watch("zoom",function(newValue,oldValue){var ref1,ref2,settingZoomFromScope;if(null!=newValue&&!_.isEqual(newValue,oldValue)&&(null!=_gMap?_gMap.getZoom():void 0)!==(null!=scope?scope.zoom:void 0)&&!settingFromDirective)return settingZoomFromScope=!0,null!=zoomPromise&&$timeout.cancel(zoomPromise),zoomPromise=$timeout(function(){return _gMap.setZoom(newValue),settingZoomFromScope=!1},(null!=(ref1=scope.eventOpts)&&null!=(ref2=ref1.debounce)?ref2.zoomMs:void 0)+20,!1)}),scope.$watch("bounds",function(newValue,oldValue){var bounds,ne,ref1,ref2,ref3,ref4,sw;if(newValue!==oldValue)return null==(null!=newValue&&null!=(ref1=newValue.northeast)?ref1.latitude:void 0)||null==(null!=newValue&&null!=(ref2=newValue.northeast)?ref2.longitude:void 0)||null==(null!=newValue&&null!=(ref3=newValue.southwest)?ref3.latitude:void 0)||null==(null!=newValue&&null!=(ref4=newValue.southwest)?ref4.longitude:void 0)?void $log.error("Invalid map bounds for new value: "+JSON.stringify(newValue)):(ne=new google.maps.LatLng(newValue.northeast.latitude,newValue.northeast.longitude),sw=new google.maps.LatLng(newValue.southwest.latitude,newValue.southwest.longitude),bounds=new google.maps.LatLngBounds(sw,ne),_gMap.fitBounds(bounds))}),["options","styles"].forEach(function(toWatch){return scope.$watch(toWatch,function(newValue,oldValue){var watchItem;return watchItem=this.exp,_.isEqual(newValue,oldValue)?void 0:("options"===watchItem?opts.options=newValue:opts.options[watchItem]=newValue,null!=_gMap?_gMap.setOptions(opts):void 0)},!0)})}}(this))},Map}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarker",["uiGmapIMarker","uiGmapMarkerChildModel","uiGmapMarkerManager","uiGmapLogger",function(IMarker,MarkerChildModel,MarkerManager,$log){var Marker;return Marker=function(superClass){function Marker(){this.link=bind(this.link,this),Marker.__super__.constructor.call(this),this.template='<span class="angular-google-map-marker" ng-transclude></span>',$log.info(this)}return extend(Marker,superClass),Marker.prototype.controller=["$scope","$element",function($scope,$element){return $scope.ctrlType="Marker",_.extend(this,IMarker.handle($scope,$element))}],Marker.prototype.link=function(scope,element,attrs,ctrl){var mapPromise;return mapPromise=IMarker.mapPromise(scope,ctrl),mapPromise.then(function(_this){return function(map){var doClick,doDrawSelf,gManager,keys,m,trackModel;return gManager=new MarkerManager(map),keys=_.object(IMarker.keys,IMarker.keys),m=new MarkerChildModel(scope,scope,keys,map,{},doClick=!0,gManager,doDrawSelf=!1,trackModel=!1),m.deferred.promise.then(function(gMarker){return scope.deferred.resolve(gMarker)}),null!=scope.control?scope.control.getGMarkers=gManager.getGMarkers:void 0}}(this)),scope.$on("$destroy",function(_this){return function(){var gManager;return"undefined"!=typeof gManager&&null!==gManager&&gManager.clear(),gManager=null}}(this))},Marker}(IMarker)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarkers",["uiGmapIMarker","uiGmapPlural","uiGmapMarkersParentModel","uiGmap_sync","uiGmapLogger",function(IMarker,Plural,MarkersParentModel,_sync,$log){var Markers;return Markers=function(superClass){function Markers(){Markers.__super__.constructor.call(this),this.template='<span class="angular-google-map-markers" ng-transclude></span>',Plural.extend(this,{doCluster:"=docluster",clusterOptions:"=clusteroptions",clusterEvents:"=clusterevents",modelsByRef:"=modelsbyref"}),$log.info(this)}return extend(Markers,superClass),Markers.prototype.controller=["$scope","$element",function($scope,$element){return $scope.ctrlType="Markers",_.extend(this,IMarker.handle($scope,$element))}],Markers.prototype.link=function(scope,element,attrs,ctrl){var parentModel,ready;return parentModel=void 0,ready=function(){return scope.deferred.resolve()},IMarker.mapPromise(scope,ctrl).then(function(map){var mapScope;return mapScope=ctrl.getScope(),mapScope.$watch("idleAndZoomChanged",function(){return _.defer(parentModel.gManager.draw)}),parentModel=new MarkersParentModel(scope,element,attrs,map),Plural.link(scope,parentModel),null!=scope.control&&(scope.control.getGMarkers=function(){var ref;return null!=(ref=parentModel.gManager)?ref.getGMarkers():void 0},scope.control.getChildMarkers=function(){return parentModel.plurals}),_.last(parentModel.existingPieces._content).then(function(){return ready()})})},Markers}(IMarker)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapPlural",[function(){var _initControl;return _initControl=function(scope,parent){return null!=scope.control?(scope.control.updateModels=function(models){return scope.models=models,parent.createChildScopes(!1)},scope.control.newModels=function(models){return scope.models=models,parent.rebuildAll(scope,!0,!0)},scope.control.clean=function(){return parent.rebuildAll(scope,!1,!0)},scope.control.getPlurals=function(){return parent.plurals},scope.control.getManager=function(){return parent.gManager},scope.control.hasManager=function(){return null!=parent.gManager==!0},scope.control.managerDraw=function(){var ref;return scope.control.hasManager()&&null!=(ref=scope.control.getManager())?ref.draw():void 0}):void 0},{extend:function(obj,obj2){return _.extend(obj.scope||{},obj2||{},{idKey:"=idkey",doRebuildAll:"=dorebuildall",models:"=models",chunk:"=chunk",cleanchunk:"=cleanchunk",control:"=control"})},link:function(scope,parent){return _initControl(scope,parent)}}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygon",["uiGmapIPolygon","$timeout","uiGmaparray-sync","uiGmapPolygonChildModel",function(IPolygon,$timeout,arraySync,PolygonChild){var Polygon;return Polygon=function(superClass){function Polygon(){return this.link=bind(this.link,this),Polygon.__super__.constructor.apply(this,arguments)}return extend(Polygon,superClass),Polygon.prototype.link=function(scope,element,attrs,mapCtrl){var children,promise;return children=[],promise=IPolygon.mapPromise(scope,mapCtrl),null!=scope.control&&(scope.control.getInstance=this,scope.control.polygons=children,scope.control.promise=promise),promise.then(function(_this){return function(map){return children.push(new PolygonChild(scope,attrs,map,_this.DEFAULTS))}}(this))},Polygon}(IPolygon)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygons",["uiGmapIPolygon","$timeout","uiGmaparray-sync","uiGmapPolygonsParentModel","uiGmapPlural",function(Interface,$timeout,arraySync,ParentModel,Plural){var Polygons;return Polygons=function(superClass){function Polygons(){this.link=bind(this.link,this),Polygons.__super__.constructor.call(this),Plural.extend(this),this.$log.info(this)}return extend(Polygons,superClass),Polygons.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path)&&_this.$log.warn("polygons: no valid path attribute found"),scope.models||_this.$log.warn("polygons: no models found to create from"),Plural.link(scope,new ParentModel(scope,element,attrs,map,_this.DEFAULTS))}}(this))},Polygons}(Interface)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolyline",["uiGmapIPolyline","$timeout","uiGmaparray-sync","uiGmapPolylineChildModel",function(IPolyline,$timeout,arraySync,PolylineChildModel){var Polyline;return Polyline=function(superClass){function Polyline(){return this.link=bind(this.link,this),Polyline.__super__.constructor.apply(this,arguments)}return extend(Polyline,superClass),Polyline.prototype.link=function(scope,element,attrs,mapCtrl){return IPolyline.mapPromise(scope,mapCtrl).then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path||!_this.validatePath(scope.path))&&_this.$log.warn("polyline: no valid path attribute found"),new PolylineChildModel(scope,attrs,map,_this.DEFAULTS)}}(this))},Polyline}(IPolyline)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylines",["uiGmapIPolyline","$timeout","uiGmaparray-sync","uiGmapPolylinesParentModel","uiGmapPlural",function(IPolyline,$timeout,arraySync,PolylinesParentModel,Plural){
var Polylines;return Polylines=function(superClass){function Polylines(){this.link=bind(this.link,this),Polylines.__super__.constructor.call(this),Plural.extend(this),this.$log.info(this)}return extend(Polylines,superClass),Polylines.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path)&&_this.$log.warn("polylines: no valid path attribute found"),scope.models||_this.$log.warn("polylines: no models found to create from"),Plural.link(scope,new PolylinesParentModel(scope,element,attrs,map,_this.DEFAULTS))}}(this))},Polylines}(IPolyline)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapRectangle",["uiGmapLogger","uiGmapGmapUtil","uiGmapIRectangle","uiGmapRectangleParentModel",function($log,GmapUtil,IRectangle,RectangleParentModel){return _.extend(IRectangle,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new RectangleParentModel(scope,element,attrs,map)}}(this))}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindow",["uiGmapIWindow","uiGmapGmapUtil","uiGmapWindowChildModel","uiGmapLodash","uiGmapLogger",function(IWindow,GmapUtil,WindowChildModel,uiGmapLodash,$log){var Window;return Window=function(superClass){function Window(){this.link=bind(this.link,this),Window.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarker"],this.template='<span class="angular-google-maps-window" ng-transclude></span>',$log.debug(this),this.childWindows=[]}return extend(Window,superClass),Window.include(GmapUtil),Window.prototype.link=function(scope,element,attrs,ctrls){var markerCtrl,markerScope;return markerCtrl=ctrls.length>1&&null!=ctrls[1]?ctrls[1]:void 0,markerScope=null!=markerCtrl?markerCtrl.getScope():void 0,this.mapPromise=IWindow.mapPromise(scope,ctrls[0]),this.mapPromise.then(function(_this){return function(mapCtrl){var isIconVisibleOnClick;return isIconVisibleOnClick=!0,angular.isDefined(attrs.isiconvisibleonclick)&&(isIconVisibleOnClick=scope.isIconVisibleOnClick),markerCtrl?markerScope.deferred.promise.then(function(gMarker){return _this.init(scope,element,isIconVisibleOnClick,mapCtrl,markerScope)}):void _this.init(scope,element,isIconVisibleOnClick,mapCtrl)}}(this))},Window.prototype.init=function(scope,element,isIconVisibleOnClick,mapCtrl,markerScope){var childWindow,defaults,gMarker,hasScopeCoords,opts;return defaults=null!=scope.options?scope.options:{},hasScopeCoords=null!=scope&&this.validateCoords(scope.coords),null!=(null!=markerScope?markerScope.getGMarker:void 0)&&(gMarker=markerScope.getGMarker()),opts=hasScopeCoords?this.createWindowOptions(gMarker,scope,element.html(),defaults):defaults,null!=mapCtrl&&(childWindow=new WindowChildModel({},scope,opts,isIconVisibleOnClick,mapCtrl,markerScope,element),this.childWindows.push(childWindow),scope.$on("$destroy",function(_this){return function(){return _this.childWindows=uiGmapLodash.withoutObjects(_this.childWindows,[childWindow],function(child1,child2){return child1.scope.$id===child2.scope.$id}),_this.childWindows.length=0}}(this))),null!=scope.control&&(scope.control.getGWindows=function(_this){return function(){return _this.childWindows.map(function(child){return child.gObject})}}(this),scope.control.getChildWindows=function(_this){return function(){return _this.childWindows}}(this),scope.control.getPlurals=scope.control.getChildWindows,scope.control.showWindow=function(_this){return function(){return _this.childWindows.map(function(child){return child.showWindow()})}}(this),scope.control.hideWindow=function(_this){return function(){return _this.childWindows.map(function(child){return child.hideWindow()})}}(this)),null!=this.onChildCreation&&null!=childWindow?this.onChildCreation(childWindow):void 0},Window}(IWindow)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindows",["uiGmapIWindow","uiGmapPlural","uiGmapWindowsParentModel","uiGmapPromise","uiGmapLogger",function(IWindow,Plural,WindowsParentModel,uiGmapPromise,$log){var Windows;return Windows=function(superClass){function Windows(){this.init=bind(this.init,this),this.link=bind(this.link,this),Windows.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarkers"],this.template='<span class="angular-google-maps-windows" ng-transclude></span>',Plural.extend(this),$log.debug(this)}return extend(Windows,superClass),Windows.prototype.link=function(scope,element,attrs,ctrls){var mapScope,markerCtrl,markerScope;return mapScope=ctrls[0].getScope(),markerCtrl=ctrls.length>1&&null!=ctrls[1]?ctrls[1]:void 0,markerScope=null!=markerCtrl?markerCtrl.getScope():void 0,mapScope.deferred.promise.then(function(_this){return function(map){var promise,ref;return promise=(null!=markerScope&&null!=(ref=markerScope.deferred)?ref.promise:void 0)||uiGmapPromise.resolve(),promise.then(function(){var pieces,ref1;return pieces=null!=(ref1=_this.parentModel)?ref1.existingPieces:void 0,pieces?pieces.then(function(){return _this.init(scope,element,attrs,ctrls,map,markerScope)}):_this.init(scope,element,attrs,ctrls,map,markerScope)})}}(this))},Windows.prototype.init=function(scope,element,attrs,ctrls,map,additionalScope){var parentModel;return parentModel=new WindowsParentModel(scope,element,attrs,ctrls,map,additionalScope),Plural.link(scope,parentModel),null!=scope.control?(scope.control.getGWindows=function(_this){return function(){return parentModel.plurals.map(function(child){return child.gObject})}}(this),scope.control.getChildWindows=function(_this){return function(){return parentModel.plurals}}(this)):void 0},Windows}(IWindow)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapGoogleMap",["uiGmapMap",function(Map){return new Map}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMarker",["$timeout","uiGmapMarker",function($timeout,Marker){return new Marker($timeout)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMarkers",["$timeout","uiGmapMarkers",function($timeout,Markers){return new Markers($timeout)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolygon",["uiGmapPolygon",function(Polygon){return new Polygon}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapCircle",["uiGmapCircle",function(Circle){return Circle}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolyline",["uiGmapPolyline",function(Polyline){return new Polyline}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolylines",["uiGmapPolylines",function(Polylines){return new Polylines}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapRectangle",["uiGmapLogger","uiGmapRectangle",function($log,Rectangle){return Rectangle}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapWindow",["$timeout","$compile","$http","$templateCache","uiGmapWindow",function($timeout,$compile,$http,$templateCache,Window){return new Window($timeout,$compile,$http,$templateCache)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapWindows",["$timeout","$compile","$http","$templateCache","$interpolate","uiGmapWindows",function($timeout,$compile,$http,$templateCache,$interpolate,Windows){return new Windows($timeout,$compile,$http,$templateCache,$interpolate)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapLayer",["$timeout","uiGmapLogger","uiGmapLayerParentModel",function($timeout,Logger,LayerParentModel){var Layer;return new(Layer=function(){function Layer(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-layer' ng-transclude></span>",this.replace=!0,this.scope={show:"=show",type:"=type",namespace:"=namespace",options:"=options",onCreated:"&oncreated"}}return Layer.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return null!=scope.onCreated?new LayerParentModel(scope,element,attrs,map,scope.onCreated):new LayerParentModel(scope,element,attrs,map)}}(this))},Layer}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMapControl",["uiGmapControl",function(Control){return new Control}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapDragZoom",["uiGmapDragZoom",function(DragZoom){return DragZoom}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapDrawingManager",["uiGmapDrawingManager",function(DrawingManager){return DrawingManager}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapFreeDrawPolygons",["uiGmapApiFreeDrawPolygons",function(FreeDrawPolygons){return new FreeDrawPolygons}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapMapType",["$timeout","uiGmapLogger","uiGmapMapTypeParentModel",function($timeout,Logger,MapTypeParentModel){var MapType;return new(MapType=function(){function MapType(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template='<span class="angular-google-map-layer" ng-transclude></span>',this.replace=!0,this.scope={show:"=show",options:"=options",refresh:"=refresh",id:"@"}}return MapType.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new MapTypeParentModel(scope,element,attrs,map)}}(this))},MapType}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolygons",["uiGmapPolygons",function(Polygons){return new Polygons}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapSearchBox",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapSearchBoxParentModel","$http","$templateCache","$compile",function(GoogleMapApi,Logger,SearchBoxParentModel,$http,$templateCache,$compile){var SearchBox;return new(SearchBox=function(){function SearchBox(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-search' ng-transclude></span>",this.replace=!0,this.scope={template:"=template",events:"=events",position:"=?position",options:"=?options",parentdiv:"=?parentdiv",ngModel:"=?"}}return SearchBox.prototype.require="ngModel",SearchBox.prototype.link=function(scope,element,attrs,mapCtrl){return GoogleMapApi.then(function(_this){return function(maps){return $http.get(scope.template,{cache:$templateCache}).success(function(template){return angular.isUndefined(scope.events)?void _this.$log.error("searchBox: the events property is required"):mapCtrl.getScope().deferred.promise.then(function(map){var ctrlPosition;return ctrlPosition=angular.isDefined(scope.position)?scope.position.toUpperCase().replace(/-/g,"_"):"TOP_LEFT",maps.ControlPosition[ctrlPosition]?new SearchBoxParentModel(scope,element,attrs,map,ctrlPosition,$compile(template)(scope)):void _this.$log.error("searchBox: invalid position property")})})}}(this))},SearchBox}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapShow",["$animate","uiGmapLogger",function($animate,$log){return{scope:{uiGmapShow:"=",uiGmapAfterShow:"&",uiGmapAfterHide:"&"},link:function(scope,element){var angular_post_1_3_handle,angular_pre_1_3_handle,handle;return angular_post_1_3_handle=function(animateAction,cb){return $animate[animateAction](element,"ng-hide").then(function(){return cb()})},angular_pre_1_3_handle=function(animateAction,cb){return $animate[animateAction](element,"ng-hide",cb)},handle=function(animateAction,cb){return angular.version.major>1?$log.error("uiGmapShow is not supported for Angular Major greater than 1.\nYour Major is "+angular.version.major+'"'):1===angular.version.major&&angular.version.minor<3?angular_pre_1_3_handle(animateAction,cb):angular_post_1_3_handle(animateAction,cb)},scope.$watch("uiGmapShow",function(show){return show&&handle("removeClass",scope.uiGmapAfterShow),show?void 0:handle("addClass",scope.uiGmapAfterHide)})}}}])}.call(this),angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function UUID(){}return UUID.generate=function(){var a=UUID._gri,b=UUID._ha;return b(a(32),8)+"-"+b(a(16),4)+"-"+b(16384|a(12),4)+"-"+b(32768|a(14),4)+"-"+b(a(48),12)},UUID._gri=function(a){return 0>a?NaN:30>=a?0|Math.random()*(1<<a):53>=a?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<a-30)):NaN},UUID._ha=function(a,b){for(var c=a.toString(16),d=b-c.length,e="0";d>0;d>>>=1,e+=e)1&d&&(c=e+c);return c},UUID}),angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapGoogleMapsUtilV3",function(){return{init:_.once(function(){function InfoBox(opt_opts){opt_opts=opt_opts||{},google.maps.OverlayView.apply(this,arguments),this.content_=opt_opts.content||"",this.disableAutoPan_=opt_opts.disableAutoPan||!1,this.maxWidth_=opt_opts.maxWidth||0,this.pixelOffset_=opt_opts.pixelOffset||new google.maps.Size(0,0),this.position_=opt_opts.position||new google.maps.LatLng(0,0),this.zIndex_=opt_opts.zIndex||null,this.boxClass_=opt_opts.boxClass||"infoBox",this.boxStyle_=opt_opts.boxStyle||{},this.closeBoxMargin_=opt_opts.closeBoxMargin||"2px",this.closeBoxURL_=opt_opts.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===opt_opts.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=opt_opts.infoBoxClearance||new google.maps.Size(1,1),"undefined"==typeof opt_opts.visible&&("undefined"==typeof opt_opts.isHidden?opt_opts.visible=!0:opt_opts.visible=!opt_opts.isHidden),this.isHidden_=!opt_opts.visible,this.alignBottom_=opt_opts.alignBottom||!1,this.pane_=opt_opts.pane||"floatPane",this.enableEventPropagation_=opt_opts.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}function ClusterIcon(cluster,styles){cluster.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.cluster_=cluster,this.className_=cluster.getMarkerClusterer().getClusterClass(),this.styles_=styles,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(cluster.getMap())}function Cluster(mc){this.markerClusterer_=mc,this.map_=mc.getMap(),this.gridSize_=mc.getGridSize(),this.minClusterSize_=mc.getMinimumClusterSize(),this.averageCenter_=mc.getAverageCenter(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,mc.getStyles())}function MarkerClusterer(map,opt_markers,opt_options){this.extend(MarkerClusterer,google.maps.OverlayView),opt_markers=opt_markers||[],opt_options=opt_options||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=opt_options.gridSize||60,this.minClusterSize_=opt_options.minimumClusterSize||2,this.maxZoom_=opt_options.maxZoom||null,this.styles_=opt_options.styles||[],this.title_=opt_options.title||"",this.zoomOnClick_=!0,opt_options.zoomOnClick!==undefined&&(this.zoomOnClick_=opt_options.zoomOnClick),this.averageCenter_=!1,opt_options.averageCenter!==undefined&&(this.averageCenter_=opt_options.averageCenter),this.ignoreHidden_=!1,opt_options.ignoreHidden!==undefined&&(this.ignoreHidden_=opt_options.ignoreHidden),this.enableRetinaIcons_=!1,opt_options.enableRetinaIcons!==undefined&&(this.enableRetinaIcons_=opt_options.enableRetinaIcons),this.imagePath_=opt_options.imagePath||MarkerClusterer.IMAGE_PATH,this.imageExtension_=opt_options.imageExtension||MarkerClusterer.IMAGE_EXTENSION,this.imageSizes_=opt_options.imageSizes||MarkerClusterer.IMAGE_SIZES,this.calculator_=opt_options.calculator||MarkerClusterer.CALCULATOR,this.batchSize_=opt_options.batchSize||MarkerClusterer.BATCH_SIZE,this.batchSizeIE_=opt_options.batchSizeIE||MarkerClusterer.BATCH_SIZE_IE,this.clusterClass_=opt_options.clusterClass||"cluster",-1!==navigator.userAgent.toLowerCase().indexOf("msie")&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(opt_markers,!0),this.setMap(map)}function inherits(childCtor,parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype,childCtor.superClass_=parentCtor.prototype,childCtor.prototype=new tempCtor,childCtor.prototype.constructor=childCtor}function MarkerLabel_(marker,crossURL,handCursorURL){this.marker_=marker,this.handCursorURL_=marker.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=MarkerLabel_.getSharedCross(crossURL)}function MarkerWithLabel(opt_options){opt_options=opt_options||{},opt_options.labelContent=opt_options.labelContent||"",opt_options.labelAnchor=opt_options.labelAnchor||new google.maps.Point(0,0),opt_options.labelClass=opt_options.labelClass||"markerLabels",opt_options.labelStyle=opt_options.labelStyle||{},opt_options.labelInBackground=opt_options.labelInBackground||!1,"undefined"==typeof opt_options.labelVisible&&(opt_options.labelVisible=!0),"undefined"==typeof opt_options.raiseOnDrag&&(opt_options.raiseOnDrag=!0),"undefined"==typeof opt_options.clickable&&(opt_options.clickable=!0),"undefined"==typeof opt_options.draggable&&(opt_options.draggable=!1),"undefined"==typeof opt_options.optimized&&(opt_options.optimized=!1),opt_options.crossImage=opt_options.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",opt_options.handCursor=opt_options.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",opt_options.optimized=!1,this.label=new MarkerLabel_(this,opt_options.crossImage,opt_options.handCursor),google.maps.Marker.apply(this,arguments)}function RichMarker(opt_options){var options=opt_options||{};this.ready_=!1,this.dragging_=!1,opt_options.visible==undefined&&(opt_options.visible=!0),opt_options.shadow==undefined&&(opt_options.shadow="7px -3px 5px rgba(88,88,88,0.7)"),opt_options.anchor==undefined&&(opt_options.anchor=RichMarkerPosition.BOTTOM),this.setValues(options)}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var i,events,bw,me=this,cancelHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},ignoreHandler=function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault(),me.enableEventPropagation_||cancelHandler(e)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(bw=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-bw.left-bw.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],events=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],i=0;i<events.length;i++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,events[i],cancelHandler));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(e){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",ignoreHandler),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var img="";return""!==this.closeBoxURL_&&(img="<img",img+=" src='"+this.closeBoxURL_+"'",img+=" align=right",img+=" style='",img+=" position: relative;",img+=" cursor: pointer;",img+=" margin: "+this.closeBoxMargin_+";",img+="'>"),img},InfoBox.prototype.addClickHandler_=function(){var closeBox;""!==this.closeBoxURL_?(closeBox=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(closeBox,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var me=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(me,"closeclick"),me.close()}},InfoBox.prototype.panBox_=function(disablePan){var map,bounds,xOffset=0,yOffset=0;if(!disablePan&&(map=this.getMap(),map instanceof google.maps.Map)){map.getBounds().contains(this.position_)||map.setCenter(this.position_),bounds=map.getBounds();var mapDiv=map.getDiv(),mapWidth=mapDiv.offsetWidth,mapHeight=mapDiv.offsetHeight,iwOffsetX=this.pixelOffset_.width,iwOffsetY=this.pixelOffset_.height,iwWidth=this.div_.offsetWidth,iwHeight=this.div_.offsetHeight,padX=this.infoBoxClearance_.width,padY=this.infoBoxClearance_.height,pixPosition=this.getProjection().fromLatLngToContainerPixel(this.position_);if(pixPosition.x<-iwOffsetX+padX?xOffset=pixPosition.x+iwOffsetX-padX:pixPosition.x+iwWidth+iwOffsetX+padX>mapWidth&&(xOffset=pixPosition.x+iwWidth+iwOffsetX+padX-mapWidth),this.alignBottom_?pixPosition.y<-iwOffsetY+padY+iwHeight?yOffset=pixPosition.y+iwOffsetY-padY-iwHeight:pixPosition.y+iwOffsetY+padY>mapHeight&&(yOffset=pixPosition.y+iwOffsetY+padY-mapHeight):pixPosition.y<-iwOffsetY+padY?yOffset=pixPosition.y+iwOffsetY-padY:pixPosition.y+iwHeight+iwOffsetY+padY>mapHeight&&(yOffset=pixPosition.y+iwHeight+iwOffsetY+padY-mapHeight),0!==xOffset||0!==yOffset){map.getCenter();map.panBy(xOffset,yOffset)}}},InfoBox.prototype.setBoxStyle_=function(){var i,boxStyle;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",boxStyle=this.boxStyle_;for(i in boxStyle)boxStyle.hasOwnProperty(i)&&(this.div_.style[i]=boxStyle[i]);this.div_.style.WebkitTransform="translateZ(0)","undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var computedStyle,bw={top:0,bottom:0,left:0,right:0},box=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(computedStyle=box.ownerDocument.defaultView.getComputedStyle(box,""),computedStyle&&(bw.top=parseInt(computedStyle.borderTopWidth,10)||0,bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0,bw.left=parseInt(computedStyle.borderLeftWidth,10)||0,bw.right=parseInt(computedStyle.borderRightWidth,10)||0)):document.documentElement.currentStyle&&box.currentStyle&&(bw.top=parseInt(box.currentStyle.borderTopWidth,10)||0,bw.bottom=parseInt(box.currentStyle.borderBottomWidth,10)||0,bw.left=parseInt(box.currentStyle.borderLeftWidth,10)||0,bw.right=parseInt(box.currentStyle.borderRightWidth,10)||0),bw},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var pixPosition=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=pixPosition.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(pixPosition.y+this.pixelOffset_.height)+"px":this.div_.style.top=pixPosition.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},InfoBox.prototype.setOptions=function(opt_opts){"undefined"!=typeof opt_opts.boxClass&&(this.boxClass_=opt_opts.boxClass,this.setBoxStyle_()),"undefined"!=typeof opt_opts.boxStyle&&(this.boxStyle_=opt_opts.boxStyle,this.setBoxStyle_()),"undefined"!=typeof opt_opts.content&&this.setContent(opt_opts.content),"undefined"!=typeof opt_opts.disableAutoPan&&(this.disableAutoPan_=opt_opts.disableAutoPan),"undefined"!=typeof opt_opts.maxWidth&&(this.maxWidth_=opt_opts.maxWidth),"undefined"!=typeof opt_opts.pixelOffset&&(this.pixelOffset_=opt_opts.pixelOffset),"undefined"!=typeof opt_opts.alignBottom&&(this.alignBottom_=opt_opts.alignBottom),"undefined"!=typeof opt_opts.position&&this.setPosition(opt_opts.position),"undefined"!=typeof opt_opts.zIndex&&this.setZIndex(opt_opts.zIndex),"undefined"!=typeof opt_opts.closeBoxMargin&&(this.closeBoxMargin_=opt_opts.closeBoxMargin),"undefined"!=typeof opt_opts.closeBoxURL&&(this.closeBoxURL_=opt_opts.closeBoxURL),"undefined"!=typeof opt_opts.infoBoxClearance&&(this.infoBoxClearance_=opt_opts.infoBoxClearance),"undefined"!=typeof opt_opts.isHidden&&(this.isHidden_=opt_opts.isHidden),"undefined"!=typeof opt_opts.visible&&(this.isHidden_=!opt_opts.visible),"undefined"!=typeof opt_opts.enableEventPropagation&&(this.enableEventPropagation_=opt_opts.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(content){this.content_=content,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof content.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+content:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(content)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof content.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+content:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(content))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(latlng){this.position_=latlng,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(index){this.zIndex_=index,this.div_&&(this.div_.style.zIndex=index),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.setVisible=function(isVisible){this.isHidden_=!isVisible,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.getVisible=function(){var isVisible;return isVisible="undefined"==typeof this.getMap()||null===this.getMap()?!1:!this.isHidden_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(map,anchor){var me=this;anchor&&(this.position_=anchor.getPosition(),this.moveListener_=google.maps.event.addListener(anchor,"position_changed",function(){me.setPosition(this.getPosition())})),this.setMap(map),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var i;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(i=0;i<this.eventListeners_.length;i++)google.maps.event.removeListener(this.eventListeners_[i]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},function(){function DragZoom(map,opt_zoomOpts){var me=this,ov=new google.maps.OverlayView;ov.onAdd=function(){me.init_(map,opt_zoomOpts)},ov.draw=function(){},ov.onRemove=function(){},ov.setMap(map),this.prjov_=ov}var toPixels=function(widthValue){var px;switch(widthValue){case"thin":px="2px";break;case"medium":px="4px";break;case"thick":px="6px";break;default:px=widthValue}return px},getBorderWidths=function(h){var computedStyle,bw={};if(document.defaultView&&document.defaultView.getComputedStyle){if(computedStyle=h.ownerDocument.defaultView.getComputedStyle(h,""))return bw.top=parseInt(computedStyle.borderTopWidth,10)||0,bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0,bw.left=parseInt(computedStyle.borderLeftWidth,10)||0,bw.right=parseInt(computedStyle.borderRightWidth,10)||0,bw}else if(document.documentElement.currentStyle&&h.currentStyle)return bw.top=parseInt(toPixels(h.currentStyle.borderTopWidth),10)||0,bw.bottom=parseInt(toPixels(h.currentStyle.borderBottomWidth),10)||0,bw.left=parseInt(toPixels(h.currentStyle.borderLeftWidth),10)||0,bw.right=parseInt(toPixels(h.currentStyle.borderRightWidth),10)||0,bw;return bw.top=parseInt(h.style["border-top-width"],10)||0,bw.bottom=parseInt(h.style["border-bottom-width"],10)||0,bw.left=parseInt(h.style["border-left-width"],10)||0,bw.right=parseInt(h.style["border-right-width"],10)||0,bw},scroll={x:0,y:0},getScrollValue=function(e){scroll.x="undefined"!=typeof document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,scroll.y="undefined"!=typeof document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop};getScrollValue();var getMousePosition=function(e){var posX=0,posY=0;return e=e||window.event,"undefined"!=typeof e.pageX?(posX=e.pageX,posY=e.pageY):"undefined"!=typeof e.clientX&&(posX=e.clientX+scroll.x,posY=e.clientY+scroll.y),{left:posX,top:posY}},getElementPosition=function(h){for(var posX=h.offsetLeft,posY=h.offsetTop,parent=h.offsetParent;null!==parent;){parent!==document.body&&parent!==document.documentElement&&(posX-=parent.scrollLeft,posY-=parent.scrollTop);var m=parent,moffx=m.offsetLeft,moffy=m.offsetTop;if(!moffx&&!moffy&&window.getComputedStyle){var matrix=document.defaultView.getComputedStyle(m,null).MozTransform||document.defaultView.getComputedStyle(m,null).WebkitTransform;if(matrix&&"string"==typeof matrix){var parms=matrix.split(",");moffx+=parseInt(parms[4],10)||0,moffy+=parseInt(parms[5],10)||0}}posX+=moffx,posY+=moffy,parent=parent.offsetParent}return{left:posX,top:posY}},setVals=function(obj,vals){if(obj&&vals)for(var x in vals)vals.hasOwnProperty(x)&&(obj[x]=vals[x]);return obj},setOpacity=function(h,op){"undefined"!=typeof op&&(h.style.opacity=op),"undefined"!=typeof h.style.opacity&&""!==h.style.opacity&&(h.style.filter="alpha(opacity="+100*h.style.opacity+")")};DragZoom.prototype.init_=function(map,opt_zoomOpts){var i,me=this;for(this.map_=map,opt_zoomOpts=opt_zoomOpts||{},this.key_=opt_zoomOpts.key||"shift",
this.key_=this.key_.toLowerCase(),this.borderWidths_=getBorderWidths(this.map_.getDiv()),this.veilDiv_=[],i=0;4>i;i++)this.veilDiv_[i]=document.createElement("div"),this.veilDiv_[i].onselectstart=function(){return!1},setVals(this.veilDiv_[i].style,{backgroundColor:"gray",opacity:.25,cursor:"crosshair"}),setVals(this.veilDiv_[i].style,opt_zoomOpts.paneStyle),setVals(this.veilDiv_[i].style,opt_zoomOpts.veilStyle),setVals(this.veilDiv_[i].style,{position:"absolute",overflow:"hidden",display:"none"}),"shift"===this.key_&&(this.veilDiv_[i].style.MozUserSelect="none"),setOpacity(this.veilDiv_[i]),"transparent"===this.veilDiv_[i].style.backgroundColor&&(this.veilDiv_[i].style.backgroundColor="white",setOpacity(this.veilDiv_[i],0)),this.map_.getDiv().appendChild(this.veilDiv_[i]);this.noZoom_=opt_zoomOpts.noZoom||!1,this.visualEnabled_=opt_zoomOpts.visualEnabled||!1,this.visualClass_=opt_zoomOpts.visualClass||"",this.visualPosition_=opt_zoomOpts.visualPosition||google.maps.ControlPosition.LEFT_TOP,this.visualPositionOffset_=opt_zoomOpts.visualPositionOffset||new google.maps.Size(35,0),this.visualPositionIndex_=opt_zoomOpts.visualPositionIndex||null,this.visualSprite_=opt_zoomOpts.visualSprite||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/mapfiles/ftr/controls/dragzoom_btn.png",this.visualSize_=opt_zoomOpts.visualSize||new google.maps.Size(20,20),this.visualTips_=opt_zoomOpts.visualTips||{},this.visualTips_.off=this.visualTips_.off||"Turn on drag zoom mode",this.visualTips_.on=this.visualTips_.on||"Turn off drag zoom mode",this.boxDiv_=document.createElement("div"),setVals(this.boxDiv_.style,{border:"4px solid #736AFF"}),setVals(this.boxDiv_.style,opt_zoomOpts.boxStyle),setVals(this.boxDiv_.style,{position:"absolute",display:"none"}),setOpacity(this.boxDiv_),this.map_.getDiv().appendChild(this.boxDiv_),this.boxBorderWidths_=getBorderWidths(this.boxDiv_),this.listeners_=[google.maps.event.addDomListener(document,"keydown",function(e){me.onKeyDown_(e)}),google.maps.event.addDomListener(document,"keyup",function(e){me.onKeyUp_(e)}),google.maps.event.addDomListener(this.veilDiv_[0],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[1],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[2],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[3],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(document,"mousedown",function(e){me.onMouseDownDocument_(e)}),google.maps.event.addDomListener(document,"mousemove",function(e){me.onMouseMove_(e)}),google.maps.event.addDomListener(document,"mouseup",function(e){me.onMouseUp_(e)}),google.maps.event.addDomListener(window,"scroll",getScrollValue)],this.hotKeyDown_=!1,this.mouseDown_=!1,this.dragging_=!1,this.startPt_=null,this.endPt_=null,this.mapWidth_=null,this.mapHeight_=null,this.mousePosn_=null,this.mapPosn_=null,this.visualEnabled_&&(this.buttonDiv_=this.initControl_(this.visualPositionOffset_),null!==this.visualPositionIndex_&&(this.buttonDiv_.index=this.visualPositionIndex_),this.map_.controls[this.visualPosition_].push(this.buttonDiv_),this.controlIndex_=this.map_.controls[this.visualPosition_].length-1)},DragZoom.prototype.initControl_=function(offset){var control,image,me=this;return control=document.createElement("div"),control.className=this.visualClass_,control.style.position="relative",control.style.overflow="hidden",control.style.height=this.visualSize_.height+"px",control.style.width=this.visualSize_.width+"px",control.title=this.visualTips_.off,image=document.createElement("img"),image.src=this.visualSprite_,image.style.position="absolute",image.style.left=-(2*this.visualSize_.width)+"px",image.style.top="0px",control.appendChild(image),control.onclick=function(e){me.hotKeyDown_=!me.hotKeyDown_,me.hotKeyDown_?(me.buttonDiv_.firstChild.style.left=-(0*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.on,me.activatedByControl_=!0,google.maps.event.trigger(me,"activate")):(me.buttonDiv_.firstChild.style.left=-(2*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.off,google.maps.event.trigger(me,"deactivate")),me.onMouseMove_(e)},control.onmouseover=function(){me.buttonDiv_.firstChild.style.left=-(1*me.visualSize_.width)+"px"},control.onmouseout=function(){me.hotKeyDown_?(me.buttonDiv_.firstChild.style.left=-(0*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.on):(me.buttonDiv_.firstChild.style.left=-(2*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.off)},control.ondragstart=function(){return!1},setVals(control.style,{cursor:"pointer",marginTop:offset.height+"px",marginLeft:offset.width+"px"}),control},DragZoom.prototype.isHotKeyDown_=function(e){var isHot;if(e=e||window.event,isHot=e.shiftKey&&"shift"===this.key_||e.altKey&&"alt"===this.key_||e.ctrlKey&&"ctrl"===this.key_,!isHot)switch(e.keyCode){case 16:"shift"===this.key_&&(isHot=!0);break;case 17:"ctrl"===this.key_&&(isHot=!0);break;case 18:"alt"===this.key_&&(isHot=!0)}return isHot},DragZoom.prototype.isMouseOnMap_=function(){var mousePosn=this.mousePosn_;if(mousePosn){var mapPosn=this.mapPosn_,mapDiv=this.map_.getDiv();return mousePosn.left>mapPosn.left&&mousePosn.left<mapPosn.left+mapDiv.offsetWidth&&mousePosn.top>mapPosn.top&&mousePosn.top<mapPosn.top+mapDiv.offsetHeight}return!1},DragZoom.prototype.setVeilVisibility_=function(){var i;if(this.map_&&this.hotKeyDown_&&this.isMouseOnMap_()){var mapDiv=this.map_.getDiv();if(this.mapWidth_=mapDiv.offsetWidth-(this.borderWidths_.left+this.borderWidths_.right),this.mapHeight_=mapDiv.offsetHeight-(this.borderWidths_.top+this.borderWidths_.bottom),this.activatedByControl_){var left=parseInt(this.buttonDiv_.style.left,10)+this.visualPositionOffset_.width,top=parseInt(this.buttonDiv_.style.top,10)+this.visualPositionOffset_.height,width=this.visualSize_.width,height=this.visualSize_.height;for(this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=left+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=left+width+"px",this.veilDiv_[1].style.width=this.mapWidth_-(left+width)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=left+"px",this.veilDiv_[2].style.width=width+"px",this.veilDiv_[2].style.height=top+"px",this.veilDiv_[3].style.top=top+height+"px",this.veilDiv_[3].style.left=left+"px",this.veilDiv_[3].style.width=width+"px",this.veilDiv_[3].style.height=this.mapHeight_-(top+height)+"px",i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="block"}else{for(this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.width=this.mapWidth_+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",i=1;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.width="0px",this.veilDiv_[i].style.height="0px";for(i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="block"}}else for(i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="none"},DragZoom.prototype.onKeyDown_=function(e){this.map_&&!this.hotKeyDown_&&this.isHotKeyDown_(e)&&(this.mapPosn_=getElementPosition(this.map_.getDiv()),this.hotKeyDown_=!0,this.activatedByControl_=!1,this.setVeilVisibility_(),google.maps.event.trigger(this,"activate"))},DragZoom.prototype.getMousePoint_=function(e){var mousePosn=getMousePosition(e),p=new google.maps.Point;return p.x=mousePosn.left-this.mapPosn_.left-this.borderWidths_.left,p.y=mousePosn.top-this.mapPosn_.top-this.borderWidths_.top,p.x=Math.min(p.x,this.mapWidth_),p.y=Math.min(p.y,this.mapHeight_),p.x=Math.max(p.x,0),p.y=Math.max(p.y,0),p},DragZoom.prototype.onMouseDown_=function(e){if(this.map_&&this.hotKeyDown_){this.mapPosn_=getElementPosition(this.map_.getDiv()),this.dragging_=!0,this.startPt_=this.endPt_=this.getMousePoint_(e),this.boxDiv_.style.width=this.boxDiv_.style.height="0px";var prj=this.prjov_.getProjection(),latlng=prj.fromContainerPixelToLatLng(this.startPt_);google.maps.event.trigger(this,"dragstart",latlng)}},DragZoom.prototype.onMouseDownDocument_=function(e){this.mouseDown_=!0},DragZoom.prototype.onMouseMove_=function(e){if(this.mousePosn_=getMousePosition(e),this.dragging_){this.endPt_=this.getMousePoint_(e);var left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),boxWidth=Math.max(0,width-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)),boxHeight=Math.max(0,height-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom));this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=left+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=left+width+"px",this.veilDiv_[1].style.width=this.mapWidth_-(left+width)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=left+"px",this.veilDiv_[2].style.width=width+"px",this.veilDiv_[2].style.height=top+"px",this.veilDiv_[3].style.top=top+height+"px",this.veilDiv_[3].style.left=left+"px",this.veilDiv_[3].style.width=width+"px",this.veilDiv_[3].style.height=this.mapHeight_-(top+height)+"px",this.boxDiv_.style.top=top+"px",this.boxDiv_.style.left=left+"px",this.boxDiv_.style.width=boxWidth+"px",this.boxDiv_.style.height=boxHeight+"px",this.boxDiv_.style.display="block",google.maps.event.trigger(this,"drag",new google.maps.Point(left,top+height),new google.maps.Point(left+width,top),this.prjov_.getProjection())}else this.mouseDown_||(this.mapPosn_=getElementPosition(this.map_.getDiv()),this.setVeilVisibility_())},DragZoom.prototype.onMouseUp_=function(e){var z,me=this;if(this.mouseDown_=!1,this.dragging_){if(this.getMousePoint_(e).x===this.startPt_.x&&this.getMousePoint_(e).y===this.startPt_.y)return void this.onKeyUp_(e);var left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),kGoogleCenteringBug=!0;kGoogleCenteringBug&&(left+=this.borderWidths_.left,top+=this.borderWidths_.top);var prj=this.prjov_.getProjection(),sw=prj.fromContainerPixelToLatLng(new google.maps.Point(left,top+height)),ne=prj.fromContainerPixelToLatLng(new google.maps.Point(left+width,top)),bnds=new google.maps.LatLngBounds(sw,ne);if(this.noZoom_)this.boxDiv_.style.display="none";else{z=this.map_.getZoom(),this.map_.fitBounds(bnds),this.map_.getZoom()<z&&this.map_.setZoom(z);var swPt=prj.fromLatLngToContainerPixel(sw),nePt=prj.fromLatLngToContainerPixel(ne);kGoogleCenteringBug&&(swPt.x-=this.borderWidths_.left,swPt.y-=this.borderWidths_.top,nePt.x-=this.borderWidths_.left,nePt.y-=this.borderWidths_.top),this.boxDiv_.style.left=swPt.x+"px",this.boxDiv_.style.top=nePt.y+"px",this.boxDiv_.style.width=Math.abs(nePt.x-swPt.x)-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)+"px",this.boxDiv_.style.height=Math.abs(nePt.y-swPt.y)-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom)+"px",setTimeout(function(){me.boxDiv_.style.display="none"},1e3)}this.dragging_=!1,this.onMouseMove_(e),google.maps.event.trigger(this,"dragend",bnds),this.isHotKeyDown_(e)||this.onKeyUp_(e)}},DragZoom.prototype.onKeyUp_=function(e){var i,left,top,width,height,prj,sw,ne,bnds=null;if(this.map_&&this.hotKeyDown_){for(this.hotKeyDown_=!1,this.dragging_&&(this.boxDiv_.style.display="none",this.dragging_=!1,left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),prj=this.prjov_.getProjection(),sw=prj.fromContainerPixelToLatLng(new google.maps.Point(left,top+height)),ne=prj.fromContainerPixelToLatLng(new google.maps.Point(left+width,top)),bnds=new google.maps.LatLngBounds(sw,ne)),i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="none";this.visualEnabled_&&(this.buttonDiv_.firstChild.style.left=-(2*this.visualSize_.width)+"px",this.buttonDiv_.title=this.visualTips_.off,this.buttonDiv_.style.display=""),google.maps.event.trigger(this,"deactivate",bnds)}},google.maps.Map.prototype.enableKeyDragZoom=function(opt_zoomOpts){this.dragZoom_=new DragZoom(this,opt_zoomOpts)},google.maps.Map.prototype.disableKeyDragZoom=function(){var i,d=this.dragZoom_;if(d){for(i=0;i<d.listeners_.length;++i)google.maps.event.removeListener(d.listeners_[i]);for(this.getDiv().removeChild(d.boxDiv_),i=0;i<d.veilDiv_.length;i++)this.getDiv().removeChild(d.veilDiv_[i]);d.visualEnabled_&&this.controls[d.visualPosition_].removeAt(d.controlIndex_),d.prjov_.setMap(null),this.dragZoom_=null}},google.maps.Map.prototype.keyDragZoomEnabled=function(){return null!==this.dragZoom_},google.maps.Map.prototype.getDragZoomObject=function(){return this.dragZoom_}}(),ClusterIcon.prototype.onAdd=function(){var cMouseDownInCluster,cDraggingMapByCluster,cClusterIcon=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){cDraggingMapByCluster=cMouseDownInCluster}),google.maps.event.addDomListener(this.div_,"mousedown",function(){cMouseDownInCluster=!0,cDraggingMapByCluster=!1}),google.maps.event.addDomListener(this.div_,"click",function(e){if(cMouseDownInCluster=!1,!cDraggingMapByCluster){var theBounds,mz,mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"click",cClusterIcon.cluster_),google.maps.event.trigger(mc,"clusterclick",cClusterIcon.cluster_),mc.getZoomOnClick()&&(mz=mc.getMaxZoom(),theBounds=cClusterIcon.cluster_.getBounds(),mc.getMap().fitBounds(theBounds),setTimeout(function(){mc.getMap().fitBounds(theBounds),null!==mz&&mc.getMap().getZoom()>mz&&mc.getMap().setZoom(mz+1)},100)),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseover",cClusterIcon.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseout",cClusterIcon.cluster_)})},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.draw=function(){if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.top=pos.y+"px",this.div_.style.left=pos.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",this.cluster_.getMarkerClusterer().enableRetinaIcons_||(img+="clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);"),img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.useStyle=function(sums){this.sums_=sums;var index=Math.max(0,sums.index-1);index=Math.min(this.styles_.length-1,index);var style=this.styles_[index];this.url_=style.url,this.height_=style.height,this.width_=style.width,this.anchorText_=style.anchorText||[0,0],this.anchorIcon_=style.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=style.textColor||"black",this.textSize_=style.textSize||11,this.textDecoration_=style.textDecoration||"none",this.fontWeight_=style.fontWeight||"bold",this.fontStyle_=style.fontStyle||"normal",this.fontFamily_=style.fontFamily||"Arial,sans-serif",this.backgroundPosition_=style.backgroundPosition||"0 0"},ClusterIcon.prototype.setCenter=function(center){this.center_=center},ClusterIcon.prototype.createCss=function(pos){var style=[];return style.push("cursor: pointer;"),style.push("position: absolute; top: "+pos.y+"px; left: "+pos.x+"px;"),style.push("width: "+this.width_+"px; height: "+this.height_+"px;"),style.join("")},ClusterIcon.prototype.getPosFromLatLng_=function(latlng){var pos=this.getProjection().fromLatLngToDivPixel(latlng);return pos.x-=this.anchorIcon_[1],pos.y-=this.anchorIcon_[0],pos.x=parseInt(pos.x,10),pos.y=parseInt(pos.y,10),pos},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){var i,bounds=new google.maps.LatLngBounds(this.center_,this.center_),markers=this.getMarkers();for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());return bounds},Cluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},Cluster.prototype.addMarker=function(marker){var i,mCount,mz;if(this.isMarkerAlreadyAdded_(marker))return!1;if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();if(marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount<this.minClusterSize_)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount===this.minClusterSize_)for(i=0;mCount>i;i++)this.markers_[i].setMap(null);else marker.setMap(null);return this.updateIcon_(),!0},Cluster.prototype.isMarkerInClusterBounds=function(marker){return this.bounds_.contains(marker.getPosition())},Cluster.prototype.calculateBounds_=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(bounds)},Cluster.prototype.updateIcon_=function(){var mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom();if(null!==mz&&this.map_.getZoom()>mz)return void this.clusterIcon_.hide();if(mCount<this.minClusterSize_)return void this.clusterIcon_.hide();var numStyles=this.markerClusterer_.getStyles().length,sums=this.markerClusterer_.getCalculator()(this.markers_,numStyles);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(sums),this.clusterIcon_.show()},Cluster.prototype.isMarkerAlreadyAdded_=function(marker){var i;if(this.markers_.indexOf)return-1!==this.markers_.indexOf(marker);for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i])return!0;return!1},MarkerClusterer.prototype.onAdd=function(){var cMarkerClusterer=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){cMarkerClusterer.resetViewport_(!1),(this.getZoom()===(this.get("minZoom")||0)||this.getZoom()===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){cMarkerClusterer.redraw_()})]},MarkerClusterer.prototype.onRemove=function(){var i;for(i=0;i<this.markers_.length;i++)this.markers_[i].getMap()!==this.activeMap_&&this.markers_[i].setMap(this.activeMap_);for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){var i,size;if(!(this.styles_.length>0))for(i=0;i<this.imageSizes_.length;i++)size=this.imageSizes_[i],this.styles_.push({url:this.imagePath_+(i+1)+"."+this.imageExtension_,height:size,width:size})},MarkerClusterer.prototype.fitMapToMarkers=function(){var i,markers=this.getMarkers(),bounds=new google.maps.LatLngBounds;for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());this.getMap().fitBounds(bounds)},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(gridSize){this.gridSize_=gridSize},MarkerClusterer.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinimumClusterSize=function(minimumClusterSize){this.minClusterSize_=minimumClusterSize},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.setMaxZoom=function(maxZoom){this.maxZoom_=maxZoom},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.setStyles=function(styles){this.styles_=styles},MarkerClusterer.prototype.getTitle=function(){return this.title_},MarkerClusterer.prototype.setTitle=function(title){this.title_=title},MarkerClusterer.prototype.getZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.setZoomOnClick=function(zoomOnClick){this.zoomOnClick_=zoomOnClick},MarkerClusterer.prototype.getAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.setAverageCenter=function(averageCenter){this.averageCenter_=averageCenter},MarkerClusterer.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},MarkerClusterer.prototype.setIgnoreHidden=function(ignoreHidden){this.ignoreHidden_=ignoreHidden},MarkerClusterer.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},MarkerClusterer.prototype.setEnableRetinaIcons=function(enableRetinaIcons){this.enableRetinaIcons_=enableRetinaIcons},MarkerClusterer.prototype.getImageExtension=function(){return this.imageExtension_},MarkerClusterer.prototype.setImageExtension=function(imageExtension){this.imageExtension_=imageExtension},MarkerClusterer.prototype.getImagePath=function(){return this.imagePath_},MarkerClusterer.prototype.setImagePath=function(imagePath){this.imagePath_=imagePath},MarkerClusterer.prototype.getImageSizes=function(){return this.imageSizes_},MarkerClusterer.prototype.setImageSizes=function(imageSizes){this.imageSizes_=imageSizes},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.setCalculator=function(calculator){this.calculator_=calculator},MarkerClusterer.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},MarkerClusterer.prototype.setBatchSizeIE=function(batchSizeIE){this.batchSizeIE_=batchSizeIE},MarkerClusterer.prototype.getClusterClass=function(){return this.clusterClass_},MarkerClusterer.prototype.setClusterClass=function(clusterClass){this.clusterClass_=clusterClass},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.getClusters=function(){return this.clusters_},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.addMarker=function(marker,opt_nodraw){this.pushMarkerTo_(marker),opt_nodraw||this.redraw_()},MarkerClusterer.prototype.addMarkers=function(markers,opt_nodraw){var key;for(key in markers)markers.hasOwnProperty(key)&&this.pushMarkerTo_(markers[key]);opt_nodraw||this.redraw_()},MarkerClusterer.prototype.pushMarkerTo_=function(marker){if(marker.getDraggable()){var cMarkerClusterer=this;google.maps.event.addListener(marker,"dragend",function(){cMarkerClusterer.ready_&&(this.isAdded=!1,cMarkerClusterer.repaint())})}marker.isAdded=!1,this.markers_.push(marker)},MarkerClusterer.prototype.removeMarker=function(marker,opt_nodraw){var removed=this.removeMarker_(marker);return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarkers=function(markers,opt_nodraw){var i,r,removed=!1;for(i=0;i<markers.length;i++)r=this.removeMarker_(markers[i]),removed=removed||r;return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarker_=function(marker){var i,index=-1;if(this.markers_.indexOf)index=this.markers_.indexOf(marker);else for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i]){index=i;break}return-1===index?!1:(marker.setMap(null),this.markers_.splice(index,1),!0)},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},MarkerClusterer.prototype.repaint=function(){var oldClusters=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var i;for(i=0;i<oldClusters.length;i++)oldClusters[i].remove()},0)},MarkerClusterer.prototype.getExtendedBounds=function(bounds){var projection=this.getProjection(),tr=new google.maps.LatLng(bounds.getNorthEast().lat(),bounds.getNorthEast().lng()),bl=new google.maps.LatLng(bounds.getSouthWest().lat(),bounds.getSouthWest().lng()),trPix=projection.fromLatLngToDivPixel(tr);trPix.x+=this.gridSize_,trPix.y-=this.gridSize_;var blPix=projection.fromLatLngToDivPixel(bl);blPix.x-=this.gridSize_,blPix.y+=this.gridSize_;var ne=projection.fromDivPixelToLatLng(trPix),sw=projection.fromDivPixelToLatLng(blPix);return bounds.extend(ne),bounds.extend(sw),bounds},MarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},MarkerClusterer.prototype.resetViewport_=function(opt_hide){var i,marker;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.markers_.length;i++)marker=this.markers_[i],marker.isAdded=!1,opt_hide&&marker.setMap(null)},MarkerClusterer.prototype.distanceBetweenPoints_=function(p1,p2){var R=6371,dLat=(p2.lat()-p1.lat())*Math.PI/180,dLon=(p2.lng()-p1.lng())*Math.PI/180,a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(p1.lat()*Math.PI/180)*Math.cos(p2.lat()*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c;return d},MarkerClusterer.prototype.isMarkerInBounds_=function(marker,bounds){return bounds.contains(marker.getPosition())},MarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),distance>d&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new Cluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},MarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length);for(i=iFirst;iLast>i;i++)marker=this.markers_[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);iLast<this.markers_.length?this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},MarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)this.prototype[property]=object.prototype[property];return this}.apply(obj1,[obj2])},MarkerClusterer.CALCULATOR=function(markers,numStyles){for(var index=0,title="",count=markers.length.toString(),dv=count;0!==dv;)dv=parseInt(dv/10,10),index++;return index=Math.min(index,numStyles),{text:count,index:index,title:title}},MarkerClusterer.BATCH_SIZE=2e3,MarkerClusterer.BATCH_SIZE_IE=500,MarkerClusterer.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90],inherits(MarkerLabel_,google.maps.OverlayView),MarkerLabel_.getSharedCross=function(crossURL){var div;return"undefined"==typeof MarkerLabel_.getSharedCross.crossDiv&&(div=document.createElement("img"),div.style.cssText="position: absolute; z-index: 1000002; display: none;",div.style.marginLeft="-8px",div.style.marginTop="-9px",div.src=crossURL,MarkerLabel_.getSharedCross.crossDiv=div),MarkerLabel_.getSharedCross.crossDiv},MarkerLabel_.prototype.onAdd=function(){var cSavedZIndex,cLatOffset,cLngOffset,cIgnoreClick,cRaiseEnabled,cStartPosition,cStartCenter,me=this,cMouseIsDown=!1,cDraggingLabel=!1,cRaiseOffset=20,cDraggingCursor="url("+this.handCursorURL_+")",cAbortEvent=function(e){e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},cStopBounce=function(){me.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof MarkerLabel_.getSharedCross.processed&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(me.marker_,"mouseover",e))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(e){!me.marker_.getDraggable()&&!me.marker_.getClickable()||cDraggingLabel||(this.style.cursor=me.marker_.getCursor(),google.maps.event.trigger(me.marker_,"mouseout",e))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(e){cDraggingLabel=!1,me.marker_.getDraggable()&&(cMouseIsDown=!0,this.style.cursor=cDraggingCursor),(me.marker_.getDraggable()||me.marker_.getClickable())&&(google.maps.event.trigger(me.marker_,"mousedown",e),cAbortEvent(e))}),google.maps.event.addDomListener(document,"mouseup",function(mEvent){var position;if(cMouseIsDown&&(cMouseIsDown=!1,me.eventDiv_.style.cursor="pointer",google.maps.event.trigger(me.marker_,"mouseup",mEvent)),cDraggingLabel){if(cRaiseEnabled){position=me.getProjection().fromLatLngToDivPixel(me.marker_.getPosition()),position.y+=cRaiseOffset,me.marker_.setPosition(me.getProjection().fromDivPixelToLatLng(position));try{me.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(cStopBounce,1406)}catch(e){}}me.crossDiv_.style.display="none",me.marker_.setZIndex(cSavedZIndex),cIgnoreClick=!0,cDraggingLabel=!1,mEvent.latLng=me.marker_.getPosition(),google.maps.event.trigger(me.marker_,"dragend",mEvent);
}}),google.maps.event.addListener(me.marker_.getMap(),"mousemove",function(mEvent){var position;cMouseIsDown&&(cDraggingLabel?(mEvent.latLng=new google.maps.LatLng(mEvent.latLng.lat()-cLatOffset,mEvent.latLng.lng()-cLngOffset),position=me.getProjection().fromLatLngToDivPixel(mEvent.latLng),cRaiseEnabled&&(me.crossDiv_.style.left=position.x+"px",me.crossDiv_.style.top=position.y+"px",me.crossDiv_.style.display="",position.y-=cRaiseOffset),me.marker_.setPosition(me.getProjection().fromDivPixelToLatLng(position)),cRaiseEnabled&&(me.eventDiv_.style.top=position.y+cRaiseOffset+"px"),google.maps.event.trigger(me.marker_,"drag",mEvent)):(cLatOffset=mEvent.latLng.lat()-me.marker_.getPosition().lat(),cLngOffset=mEvent.latLng.lng()-me.marker_.getPosition().lng(),cSavedZIndex=me.marker_.getZIndex(),cStartPosition=me.marker_.getPosition(),cStartCenter=me.marker_.getMap().getCenter(),cRaiseEnabled=me.marker_.get("raiseOnDrag"),cDraggingLabel=!0,me.marker_.setZIndex(1e6),mEvent.latLng=me.marker_.getPosition(),google.maps.event.trigger(me.marker_,"dragstart",mEvent)))}),google.maps.event.addDomListener(document,"keydown",function(e){cDraggingLabel&&27===e.keyCode&&(cRaiseEnabled=!1,me.marker_.setPosition(cStartPosition),me.marker_.getMap().setCenter(cStartCenter),google.maps.event.trigger(document,"mouseup",e))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(cIgnoreClick?cIgnoreClick=!1:(google.maps.event.trigger(me.marker_,"click",e),cAbortEvent(e)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(google.maps.event.trigger(me.marker_,"dblclick",e),cAbortEvent(e))}),google.maps.event.addListener(this.marker_,"dragstart",function(mEvent){cDraggingLabel||(cRaiseEnabled=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(mEvent){cDraggingLabel||cRaiseEnabled&&(me.setPosition(cRaiseOffset),me.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(mEvent){cDraggingLabel||cRaiseEnabled&&me.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){me.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){me.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){me.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){me.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){me.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){me.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){me.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){me.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){me.setStyles()})]},MarkerLabel_.prototype.onRemove=function(){var i;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i])},MarkerLabel_.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},MarkerLabel_.prototype.setContent=function(){var content=this.marker_.get("labelContent");"undefined"==typeof content.nodeType?(this.labelDiv_.innerHTML=content,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(content),content=content.cloneNode(!0),this.eventDiv_.innerHTML="",this.eventDiv_.appendChild(content))},MarkerLabel_.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""},MarkerLabel_.prototype.setStyles=function(){var i,labelStyle;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",labelStyle=this.marker_.get("labelStyle");for(i in labelStyle)labelStyle.hasOwnProperty(i)&&(this.labelDiv_.style[i]=labelStyle[i],this.eventDiv_.style[i]=labelStyle[i]);this.setMandatoryStyles()},MarkerLabel_.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"',this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},MarkerLabel_.prototype.setAnchor=function(){var anchor=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-anchor.x+"px",this.labelDiv_.style.marginTop=-anchor.y+"px",this.eventDiv_.style.marginLeft=-anchor.x+"px",this.eventDiv_.style.marginTop=-anchor.y+"px"},MarkerLabel_.prototype.setPosition=function(yOffset){var position=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof yOffset&&(yOffset=0),this.labelDiv_.style.left=Math.round(position.x)+"px",this.labelDiv_.style.top=Math.round(position.y-yOffset)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},MarkerLabel_.prototype.setZIndex=function(){var zAdjust=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+zAdjust,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+zAdjust,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},MarkerLabel_.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none",this.eventDiv_.style.display=this.labelDiv_.style.display},inherits(MarkerWithLabel,google.maps.Marker),MarkerWithLabel.prototype.setMap=function(theMap){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(theMap)},RichMarker.prototype=new google.maps.OverlayView,window.RichMarker=RichMarker,RichMarker.prototype.getVisible=function(){return this.get("visible")},RichMarker.prototype.getVisible=RichMarker.prototype.getVisible,RichMarker.prototype.setVisible=function(visible){this.set("visible",visible)},RichMarker.prototype.setVisible=RichMarker.prototype.setVisible,RichMarker.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},RichMarker.prototype.visible_changed=RichMarker.prototype.visible_changed,RichMarker.prototype.setFlat=function(flat){this.set("flat",!!flat)},RichMarker.prototype.setFlat=RichMarker.prototype.setFlat,RichMarker.prototype.getFlat=function(){return this.get("flat")},RichMarker.prototype.getFlat=RichMarker.prototype.getFlat,RichMarker.prototype.getWidth=function(){return this.get("width")},RichMarker.prototype.getWidth=RichMarker.prototype.getWidth,RichMarker.prototype.getHeight=function(){return this.get("height")},RichMarker.prototype.getHeight=RichMarker.prototype.getHeight,RichMarker.prototype.setShadow=function(shadow){this.set("shadow",shadow),this.flat_changed()},RichMarker.prototype.setShadow=RichMarker.prototype.setShadow,RichMarker.prototype.getShadow=function(){return this.get("shadow")},RichMarker.prototype.getShadow=RichMarker.prototype.getShadow,RichMarker.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},RichMarker.prototype.flat_changed=RichMarker.prototype.flat_changed,RichMarker.prototype.setZIndex=function(index){this.set("zIndex",index)},RichMarker.prototype.setZIndex=RichMarker.prototype.setZIndex,RichMarker.prototype.getZIndex=function(){return this.get("zIndex")},RichMarker.prototype.getZIndex=RichMarker.prototype.getZIndex,RichMarker.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},RichMarker.prototype.zIndex_changed=RichMarker.prototype.zIndex_changed,RichMarker.prototype.getDraggable=function(){return this.get("draggable")},RichMarker.prototype.getDraggable=RichMarker.prototype.getDraggable,RichMarker.prototype.setDraggable=function(draggable){this.set("draggable",!!draggable)},RichMarker.prototype.setDraggable=RichMarker.prototype.setDraggable,RichMarker.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},RichMarker.prototype.draggable_changed=RichMarker.prototype.draggable_changed,RichMarker.prototype.getPosition=function(){return this.get("position")},RichMarker.prototype.getPosition=RichMarker.prototype.getPosition,RichMarker.prototype.setPosition=function(position){this.set("position",position)},RichMarker.prototype.setPosition=RichMarker.prototype.setPosition,RichMarker.prototype.position_changed=function(){this.draw()},RichMarker.prototype.position_changed=RichMarker.prototype.position_changed,RichMarker.prototype.getAnchor=function(){return this.get("anchor")},RichMarker.prototype.getAnchor=RichMarker.prototype.getAnchor,RichMarker.prototype.setAnchor=function(anchor){this.set("anchor",anchor)},RichMarker.prototype.setAnchor=RichMarker.prototype.setAnchor,RichMarker.prototype.anchor_changed=function(){this.draw()},RichMarker.prototype.anchor_changed=RichMarker.prototype.anchor_changed,RichMarker.prototype.htmlToDocumentFragment_=function(htmlString){var tempDiv=document.createElement("DIV");if(tempDiv.innerHTML=htmlString,1==tempDiv.childNodes.length)return tempDiv.removeChild(tempDiv.firstChild);for(var fragment=document.createDocumentFragment();tempDiv.firstChild;)fragment.appendChild(tempDiv.firstChild);return fragment},RichMarker.prototype.removeChildren_=function(node){if(node)for(var child;child=node.firstChild;)node.removeChild(child)},RichMarker.prototype.setContent=function(content){this.set("content",content)},RichMarker.prototype.setContent=RichMarker.prototype.setContent,RichMarker.prototype.getContent=function(){return this.get("content")},RichMarker.prototype.getContent=RichMarker.prototype.getContent,RichMarker.prototype.content_changed=function(){if(this.markerContent_){this.removeChildren_(this.markerContent_);var content=this.getContent();if(content){"string"==typeof content&&(content=content.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),content=this.htmlToDocumentFragment_(content)),this.markerContent_.appendChild(content);for(var image,that=this,images=this.markerContent_.getElementsByTagName("IMG"),i=0;image=images[i];i++)google.maps.event.addDomListener(image,"mousedown",function(e){that.getDraggable()&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1)}),google.maps.event.addDomListener(image,"load",function(){that.draw()});google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},RichMarker.prototype.content_changed=RichMarker.prototype.content_changed,RichMarker.prototype.setCursor_=function(whichCursor){if(this.ready_){var cursor="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"==whichCursor&&(cursor="-moz-grabbing"),"dragready"==whichCursor&&(cursor="-moz-grab"),"draggable"==whichCursor&&(cursor="pointer")):(("dragging"==whichCursor||"dragready"==whichCursor)&&(cursor="move"),"draggable"==whichCursor&&(cursor="pointer")),this.markerWrapper_.style.cursor!=cursor&&(this.markerWrapper_.style.cursor=cursor)}},RichMarker.prototype.startDrag=function(e){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var map=this.getMap();this.mapDraggable_=map.get("draggable"),map.set("draggable",!1),this.mouseX_=e.clientX,this.mouseY_=e.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},RichMarker.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},RichMarker.prototype.drag=function(e){if(!this.getDraggable()||!this.dragging_)return void this.stopDrag();var dx=this.mouseX_-e.clientX,dy=this.mouseY_-e.clientY;this.mouseX_=e.clientX,this.mouseY_=e.clientY;var left=parseInt(this.markerWrapper_.style.left,10)-dx,top=parseInt(this.markerWrapper_.style.top,10)-dy;this.markerWrapper_.style.left=left+"px",this.markerWrapper_.style.top=top+"px";var offset=this.getOffset_(),point=new google.maps.Point(left-offset.width,top-offset.height),projection=this.getProjection();this.setPosition(projection.fromDivPixelToLatLng(point)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},RichMarker.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},RichMarker.prototype.addDragging_=function(node){if(node){var that=this;this.draggableListener_=google.maps.event.addDomListener(node,"mousedown",function(e){that.startDrag(e)}),this.setCursor_("draggable")}},RichMarker.prototype.addDraggingListeners_=function(){var that=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(e){that.drag(e)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){that.stopDrag(),that.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(e){that.drag(e)},!0),google.maps.event.addDomListener(window,"mouseup",function(){that.stopDrag()},!0)]},RichMarker.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var listener,i=0;listener=this.draggingListeners_[i];i++)google.maps.event.removeListener(listener);this.draggingListeners_.length=0}},RichMarker.prototype.getOffset_=function(){var anchor=this.getAnchor();if("object"==typeof anchor)return anchor;var offset=new google.maps.Size(0,0);if(!this.markerContent_)return offset;var width=this.markerContent_.offsetWidth,height=this.markerContent_.offsetHeight;switch(anchor){case RichMarkerPosition.TOP_LEFT:break;case RichMarkerPosition.TOP:offset.width=-width/2;break;case RichMarkerPosition.TOP_RIGHT:offset.width=-width;break;case RichMarkerPosition.LEFT:offset.height=-height/2;break;case RichMarkerPosition.MIDDLE:offset.width=-width/2,offset.height=-height/2;break;case RichMarkerPosition.RIGHT:offset.width=-width,offset.height=-height/2;break;case RichMarkerPosition.BOTTOM_LEFT:offset.height=-height;break;case RichMarkerPosition.BOTTOM:offset.width=-width/2,offset.height=-height;break;case RichMarkerPosition.BOTTOM_RIGHT:offset.width=-width,offset.height=-height}return offset},RichMarker.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var that=this;google.maps.event.addDomListener(this.markerContent_,"click",function(e){google.maps.event.trigger(that,"click")}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(e){google.maps.event.trigger(that,"mouseover")}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(e){google.maps.event.trigger(that,"mouseout")})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var panes=this.getPanes();panes&&panes.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},RichMarker.prototype.onAdd=RichMarker.prototype.onAdd,RichMarker.prototype.draw=function(){if(this.ready_&&!this.dragging_){var projection=this.getProjection();if(projection){var latLng=this.get("position"),pos=projection.fromLatLngToDivPixel(latLng),offset=this.getOffset_();this.markerWrapper_.style.top=pos.y+offset.height+"px",this.markerWrapper_.style.left=pos.x+offset.width+"px";var height=this.markerContent_.offsetHeight,width=this.markerContent_.offsetWidth;width!=this.get("width")&&this.set("width",width),height!=this.get("height")&&this.set("height",height)}}},RichMarker.prototype.draw=RichMarker.prototype.draw,RichMarker.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},RichMarker.prototype.onRemove=RichMarker.prototype.onRemove;var RichMarkerPosition={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=RichMarkerPosition,window.InfoBox=InfoBox,window.Cluster=Cluster,window.ClusterIcon=ClusterIcon,window.MarkerClusterer=MarkerClusterer,window.MarkerLabel_=MarkerLabel_,window.MarkerWithLabel=MarkerWithLabel})}}),function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapDataStructures",function(){return{Graph:__webpack_require__(1).Graph,Queue:__webpack_require__(1).Queue}})},function(module,exports,__webpack_require__){(function(){module.exports={Graph:__webpack_require__(2),Heap:__webpack_require__(3),LinkedList:__webpack_require__(4),Map:__webpack_require__(5),Queue:__webpack_require__(6),RedBlackTree:__webpack_require__(7),Trie:__webpack_require__(8)}}).call(this)},function(module,exports,__webpack_require__){(function(){var Graph,__hasProp={}.hasOwnProperty;Graph=function(){function Graph(){this._nodes={},this.nodeSize=0,this.edgeSize=0}return Graph.prototype.addNode=function(id){return this._nodes[id]?void 0:(this.nodeSize++,this._nodes[id]={_outEdges:{},_inEdges:{}})},Graph.prototype.getNode=function(id){return this._nodes[id]},Graph.prototype.removeNode=function(id){var inEdgeId,nodeToRemove,outEdgeId,_ref,_ref1;if(nodeToRemove=this._nodes[id]){_ref=nodeToRemove._outEdges;for(outEdgeId in _ref)__hasProp.call(_ref,outEdgeId)&&this.removeEdge(id,outEdgeId);_ref1=nodeToRemove._inEdges;for(inEdgeId in _ref1)__hasProp.call(_ref1,inEdgeId)&&this.removeEdge(inEdgeId,id);return this.nodeSize--,delete this._nodes[id],nodeToRemove}},Graph.prototype.addEdge=function(fromId,toId,weight){var edgeToAdd,fromNode,toNode;return null==weight&&(weight=1),!this.getEdge(fromId,toId)&&(fromNode=this._nodes[fromId],toNode=this._nodes[toId],fromNode&&toNode)?(edgeToAdd={weight:weight},fromNode._outEdges[toId]=edgeToAdd,toNode._inEdges[fromId]=edgeToAdd,this.edgeSize++,edgeToAdd):void 0},Graph.prototype.getEdge=function(fromId,toId){var fromNode,toNode;return fromNode=this._nodes[fromId],toNode=this._nodes[toId],fromNode&&toNode?fromNode._outEdges[toId]:void 0},Graph.prototype.removeEdge=function(fromId,toId){var edgeToDelete,fromNode,toNode;return fromNode=this._nodes[fromId],toNode=this._nodes[toId],(edgeToDelete=this.getEdge(fromId,toId))?(delete fromNode._outEdges[toId],delete toNode._inEdges[fromId],this.edgeSize--,edgeToDelete):void 0},Graph.prototype.getInEdgesOf=function(nodeId){var fromId,inEdges,toNode,_ref;toNode=this._nodes[nodeId],inEdges=[],_ref=null!=toNode?toNode._inEdges:void 0;for(fromId in _ref)__hasProp.call(_ref,fromId)&&inEdges.push(this.getEdge(fromId,nodeId));return inEdges},Graph.prototype.getOutEdgesOf=function(nodeId){var fromNode,outEdges,toId,_ref;fromNode=this._nodes[nodeId],outEdges=[],_ref=null!=fromNode?fromNode._outEdges:void 0;for(toId in _ref)__hasProp.call(_ref,toId)&&outEdges.push(this.getEdge(nodeId,toId));return outEdges},Graph.prototype.getAllEdgesOf=function(nodeId){var i,inEdges,outEdges,selfEdge,_i,_ref,_ref1;if(inEdges=this.getInEdgesOf(nodeId),outEdges=this.getOutEdgesOf(nodeId),0===inEdges.length)return outEdges;for(selfEdge=this.getEdge(nodeId,nodeId),i=_i=0,_ref=inEdges.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)if(inEdges[i]===selfEdge){_ref1=[inEdges[inEdges.length-1],inEdges[i]],inEdges[i]=_ref1[0],inEdges[inEdges.length-1]=_ref1[1],inEdges.pop();break}return inEdges.concat(outEdges)},Graph.prototype.forEachNode=function(operation){var nodeId,nodeObject,_ref;_ref=this._nodes;for(nodeId in _ref)__hasProp.call(_ref,nodeId)&&(nodeObject=_ref[nodeId],operation(nodeObject,nodeId))},Graph.prototype.forEachEdge=function(operation){var edgeObject,nodeId,nodeObject,toId,_ref,_ref1;_ref=this._nodes;for(nodeId in _ref)if(__hasProp.call(_ref,nodeId)){nodeObject=_ref[nodeId],_ref1=nodeObject._outEdges;for(toId in _ref1)__hasProp.call(_ref1,toId)&&(edgeObject=_ref1[toId],operation(edgeObject))}},Graph}(),module.exports=Graph}).call(this)},function(module,exports,__webpack_require__){(function(){var Heap,_leftChild,_parent,_rightChild;Heap=function(){function Heap(dataToHeapify){var i,item,_i,_j,_len,_ref;for(null==dataToHeapify&&(dataToHeapify=[]),this._data=[void 0],_i=0,_len=dataToHeapify.length;_len>_i;_i++)item=dataToHeapify[_i],null!=item&&this._data.push(item);if(this._data.length>1)for(i=_j=2,_ref=this._data.length;_ref>=2?_ref>_j:_j>_ref;i=_ref>=2?++_j:--_j)this._upHeap(i);this.size=this._data.length-1}return Heap.prototype.add=function(value){return null!=value?(this._data.push(value),this._upHeap(this._data.length-1),this.size++,value):void 0},Heap.prototype.removeMin=function(){var min;if(1!==this._data.length)return this.size--,2===this._data.length?this._data.pop():(min=this._data[1],this._data[1]=this._data.pop(),this._downHeap(),min)},Heap.prototype.peekMin=function(){return this._data[1]},Heap.prototype._upHeap=function(index){var valueHolder,_ref;for(valueHolder=this._data[index];this._data[index]<this._data[_parent(index)]&&index>1;)_ref=[this._data[_parent(index)],this._data[index]],this._data[index]=_ref[0],this._data[_parent(index)]=_ref[1],index=_parent(index)},Heap.prototype._downHeap=function(){var currentIndex,smallerChildIndex,_ref;for(currentIndex=1;_leftChild(currentIndex<this._data.length)&&(smallerChildIndex=_leftChild(currentIndex),smallerChildIndex<this._data.length-1&&this._data[_rightChild(currentIndex)]<this._data[smallerChildIndex]&&(smallerChildIndex=_rightChild(currentIndex)),this._data[smallerChildIndex]<this._data[currentIndex]);)_ref=[this._data[currentIndex],this._data[smallerChildIndex]],this._data[smallerChildIndex]=_ref[0],this._data[currentIndex]=_ref[1],currentIndex=smallerChildIndex},Heap}(),_parent=function(index){return index>>1},_leftChild=function(index){return index<<1},_rightChild=function(index){return(index<<1)+1},module.exports=Heap}).call(this)},function(module,exports,__webpack_require__){(function(){var LinkedList;LinkedList=function(){function LinkedList(valuesToAdd){var value,_i,_len;for(null==valuesToAdd&&(valuesToAdd=[]),this.head={prev:void 0,value:void 0,next:void 0},this.tail={prev:void 0,value:void 0,next:void 0},this.size=0,_i=0,_len=valuesToAdd.length;_len>_i;_i++)value=valuesToAdd[_i],this.add(value)}return LinkedList.prototype.at=function(position){var currentNode,i,_i,_j,_ref;if(-this.size<=position&&position<this.size){if(position=this._adjust(position),2*position<this.size)for(currentNode=this.head,i=_i=1;position>=_i;i=_i+=1)currentNode=currentNode.next;else for(currentNode=this.tail,i=_j=1,_ref=this.size-position-1;_ref>=_j;i=_j+=1)currentNode=currentNode.prev;return currentNode}},LinkedList.prototype.add=function(value,position){var currentNode,nodeToAdd,_ref,_ref1,_ref2;return null==position&&(position=this.size),-this.size<=position&&position<=this.size?(nodeToAdd={value:value},position=this._adjust(position),0===this.size?this.head=nodeToAdd:0===position?(_ref=[nodeToAdd,this.head,nodeToAdd],this.head.prev=_ref[0],nodeToAdd.next=_ref[1],this.head=_ref[2]):(currentNode=this.at(position-1),_ref1=[currentNode.next,nodeToAdd,nodeToAdd,currentNode],nodeToAdd.next=_ref1[0],null!=(_ref2=currentNode.next)?_ref2.prev=_ref1[1]:void 0,currentNode.next=_ref1[2],nodeToAdd.prev=_ref1[3]),position===this.size&&(this.tail=nodeToAdd),this.size++,value):void 0},LinkedList.prototype.removeAt=function(position){var currentNode,valueToReturn,_ref;return null==position&&(position=this.size-1),-this.size<=position&&position<this.size&&0!==this.size?(position=this._adjust(position),1===this.size?(valueToReturn=this.head.value,this.head.value=this.tail.value=void 0):0===position?(valueToReturn=this.head.value,this.head=this.head.next,this.head.prev=void 0):(currentNode=this.at(position),valueToReturn=currentNode.value,currentNode.prev.next=currentNode.next,null!=(_ref=currentNode.next)&&(_ref.prev=currentNode.prev),position===this.size-1&&(this.tail=currentNode.prev)),this.size--,valueToReturn):void 0},LinkedList.prototype.remove=function(value){var currentNode;if(null!=value){for(currentNode=this.head;currentNode&&currentNode.value!==value;)currentNode=currentNode.next;if(currentNode)return 1===this.size?this.head.value=this.tail.value=void 0:currentNode===this.head?(this.head=this.head.next,this.head.prev=void 0):currentNode===this.tail?(this.tail=this.tail.prev,this.tail.next=void 0):(currentNode.prev.next=currentNode.next,currentNode.next.prev=currentNode.prev),this.size--,value}},LinkedList.prototype.indexOf=function(value,startingPosition){var currentNode,position;if(null==startingPosition&&(startingPosition=0),null==this.head.value&&!this.head.next||startingPosition>=this.size)return-1;for(startingPosition=Math.max(0,this._adjust(startingPosition)),currentNode=this.at(startingPosition),position=startingPosition;currentNode&&currentNode.value!==value;)currentNode=currentNode.next,position++;return position===this.size?-1:position},LinkedList.prototype._adjust=function(position){return 0>position?this.size+position:position},LinkedList}(),module.exports=LinkedList}).call(this)},function(module,exports,__webpack_require__){(function(){var Map,SPECIAL_TYPE_KEY_PREFIX,_extractDataType,_isSpecialType,__hasProp={}.hasOwnProperty;SPECIAL_TYPE_KEY_PREFIX="_mapId_",Map=function(){function Map(objectToMap){var key,value;this._content={},this._itemId=0,this._id=Map._newMapId(),this.size=0;for(key in objectToMap)__hasProp.call(objectToMap,key)&&(value=objectToMap[key],this.set(key,value))}return Map._mapIdTracker=0,Map._newMapId=function(){return this._mapIdTracker++},Map.prototype.hash=function(key,makeHash){var propertyForMap,type;return null==makeHash&&(makeHash=!1),type=_extractDataType(key),_isSpecialType(key)?(propertyForMap=SPECIAL_TYPE_KEY_PREFIX+this._id,makeHash&&!key[propertyForMap]&&(key[propertyForMap]=this._itemId++),propertyForMap+"_"+key[propertyForMap]):type+"_"+key},Map.prototype.set=function(key,value){return this.has(key)||this.size++,this._content[this.hash(key,!0)]=[value,key],value},Map.prototype.get=function(key){var _ref;return null!=(_ref=this._content[this.hash(key)])?_ref[0]:void 0},Map.prototype.has=function(key){return this.hash(key)in this._content},Map.prototype["delete"]=function(key){var hashedKey;return hashedKey=this.hash(key),hashedKey in this._content?(delete this._content[hashedKey],_isSpecialType(key)&&delete key[SPECIAL_TYPE_KEY_PREFIX+this._id],this.size--,!0):!1},Map.prototype.forEach=function(operation){var key,value,_ref;_ref=this._content;for(key in _ref)__hasProp.call(_ref,key)&&(value=_ref[key],operation(value[1],value[0]))},Map}(),_isSpecialType=function(key){var simpleHashableTypes,simpleType,type,_i,_len;for(simpleHashableTypes=["Boolean","Number","String","Undefined","Null","RegExp","Function"],type=_extractDataType(key),_i=0,_len=simpleHashableTypes.length;_len>_i;_i++)if(simpleType=simpleHashableTypes[_i],type===simpleType)return!1;return!0},_extractDataType=function(type){return Object.prototype.toString.apply(type).match(/\[object (.+)\]/)[1]},module.exports=Map}).call(this)},function(module,exports,__webpack_require__){(function(){var Queue;Queue=function(){function Queue(initialArray){null==initialArray&&(initialArray=[]),this._content=initialArray,this._dequeueIndex=0,this.size=this._content.length}return Queue.prototype.enqueue=function(item){return this.size++,this._content.push(item),item},Queue.prototype.dequeue=function(){var itemToDequeue;if(0!==this.size)return this.size--,itemToDequeue=this._content[this._dequeueIndex],this._dequeueIndex++,2*this._dequeueIndex>this._content.length&&(this._content=this._content.slice(this._dequeueIndex),this._dequeueIndex=0),itemToDequeue},Queue.prototype.peek=function(){return this._content[this._dequeueIndex]},Queue}(),module.exports=Queue}).call(this)},function(module,exports,__webpack_require__){(function(){var BLACK,NODE_FOUND,NODE_TOO_BIG,NODE_TOO_SMALL,RED,RedBlackTree,STOP_SEARCHING,_findNode,_grandParentOf,_isLeft,_leftOrRight,_peekMaxNode,_peekMinNode,_siblingOf,_uncleOf;NODE_FOUND=0,NODE_TOO_BIG=1,NODE_TOO_SMALL=2,STOP_SEARCHING=3,RED=1,BLACK=2,RedBlackTree=function(){function RedBlackTree(valuesToAdd){var value,_i,_len;for(null==valuesToAdd&&(valuesToAdd=[]),this._root,this.size=0,_i=0,_len=valuesToAdd.length;_len>_i;_i++)value=valuesToAdd[_i],null!=value&&this.add(value)}return RedBlackTree.prototype.add=function(value){var currentNode,foundNode,nodeToInsert,_ref;if(null!=value){if(this.size++,nodeToInsert={value:value,_color:RED},this._root){if(foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?node._left?NODE_TOO_BIG:(nodeToInsert._parent=node,node._left=nodeToInsert,STOP_SEARCHING):node._right?NODE_TOO_SMALL:(nodeToInsert._parent=node,node._right=nodeToInsert,STOP_SEARCHING)}),null!=foundNode)return}else this._root=nodeToInsert;for(currentNode=nodeToInsert;;){if(currentNode===this._root){currentNode._color=BLACK;break}if(currentNode._parent._color===BLACK)break;{if((null!=(_ref=_uncleOf(currentNode))?_ref._color:void 0)!==RED){!_isLeft(currentNode)&&_isLeft(currentNode._parent)?(this._rotateLeft(currentNode._parent),currentNode=currentNode._left):_isLeft(currentNode)&&!_isLeft(currentNode._parent)&&(this._rotateRight(currentNode._parent),currentNode=currentNode._right),currentNode._parent._color=BLACK,_grandParentOf(currentNode)._color=RED,_isLeft(currentNode)?this._rotateRight(_grandParentOf(currentNode)):this._rotateLeft(_grandParentOf(currentNode));break}currentNode._parent._color=BLACK,_uncleOf(currentNode)._color=BLACK,_grandParentOf(currentNode)._color=RED,currentNode=_grandParentOf(currentNode)}}return value}},RedBlackTree.prototype.has=function(value){var foundNode;return foundNode=_findNode(this._root,function(node){
return value===node.value?NODE_FOUND:value<node.value?NODE_TOO_BIG:NODE_TOO_SMALL}),foundNode?!0:!1},RedBlackTree.prototype.peekMin=function(){var _ref;return null!=(_ref=_peekMinNode(this._root))?_ref.value:void 0},RedBlackTree.prototype.peekMax=function(){var _ref;return null!=(_ref=_peekMaxNode(this._root))?_ref.value:void 0},RedBlackTree.prototype.remove=function(value){var foundNode;return(foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?NODE_TOO_BIG:NODE_TOO_SMALL}))?(this._removeNode(this._root,foundNode),this.size--,value):void 0},RedBlackTree.prototype.removeMin=function(){var nodeToRemove,valueToReturn;return(nodeToRemove=_peekMinNode(this._root))?(valueToReturn=nodeToRemove.value,this._removeNode(this._root,nodeToRemove),valueToReturn):void 0},RedBlackTree.prototype.removeMax=function(){var nodeToRemove,valueToReturn;return(nodeToRemove=_peekMaxNode(this._root))?(valueToReturn=nodeToRemove.value,this._removeNode(this._root,nodeToRemove),valueToReturn):void 0},RedBlackTree.prototype._removeNode=function(root,node){var sibling,successor,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(node._left&&node._right&&(successor=_peekMinNode(node._right),node.value=successor.value,node=successor),successor=node._left||node._right,successor||(successor={color:BLACK,_right:void 0,_left:void 0,isLeaf:!0}),successor._parent=node._parent,null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=successor),node._color===BLACK)if(successor._color===RED)successor._color=BLACK,successor._parent||(this._root=successor);else for(;;){if(!successor._parent){successor.isLeaf?this._root=void 0:this._root=successor;break}if(sibling=_siblingOf(successor),(null!=sibling?sibling._color:void 0)===RED&&(successor._parent._color=RED,sibling._color=BLACK,_isLeft(successor)?this._rotateLeft(successor._parent):this._rotateRight(successor._parent)),sibling=_siblingOf(successor),successor._parent._color!==BLACK||sibling&&(sibling._color!==BLACK||sibling._left&&sibling._left._color!==BLACK||sibling._right&&sibling._right._color!==BLACK)){if(!(successor._parent._color!==RED||sibling&&(sibling._color!==BLACK||sibling._left&&(null!=(_ref1=sibling._left)?_ref1._color:void 0)!==BLACK||sibling._right&&(null!=(_ref2=sibling._right)?_ref2._color:void 0)!==BLACK))){null!=sibling&&(sibling._color=RED),successor._parent._color=BLACK;break}if((null!=sibling?sibling._color:void 0)===BLACK){!_isLeft(successor)||sibling._right&&sibling._right._color!==BLACK||(null!=(_ref3=sibling._left)?_ref3._color:void 0)!==RED?_isLeft(successor)||sibling._left&&sibling._left._color!==BLACK||(null!=(_ref5=sibling._right)?_ref5._color:void 0)!==RED||(sibling._color=RED,null!=(_ref6=sibling._right)&&(_ref6._color=BLACK),this._rotateLeft(sibling)):(sibling._color=RED,null!=(_ref4=sibling._left)&&(_ref4._color=BLACK),this._rotateRight(sibling));break}sibling=_siblingOf(successor),sibling._color=successor._parent._color,_isLeft(successor)?(sibling._right._color=BLACK,this._rotateRight(successor._parent)):(sibling._left._color=BLACK,this._rotateLeft(successor._parent))}else null!=sibling&&(sibling._color=RED),successor.isLeaf&&(successor._parent[_leftOrRight(successor)]=void 0),successor=successor._parent}return successor.isLeaf&&null!=(_ref7=successor._parent)?_ref7[_leftOrRight(successor)]=void 0:void 0},RedBlackTree.prototype._rotateLeft=function(node){var _ref,_ref1;return null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=node._right),node._right._parent=node._parent,node._parent=node._right,node._right=node._right._left,node._parent._left=node,null!=(_ref1=node._right)&&(_ref1._parent=node),null==node._parent._parent?this._root=node._parent:void 0},RedBlackTree.prototype._rotateRight=function(node){var _ref,_ref1;return null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=node._left),node._left._parent=node._parent,node._parent=node._left,node._left=node._left._right,node._parent._right=node,null!=(_ref1=node._left)&&(_ref1._parent=node),null==node._parent._parent?this._root=node._parent:void 0},RedBlackTree}(),_isLeft=function(node){return node===node._parent._left},_leftOrRight=function(node){return _isLeft(node)?"_left":"_right"},_findNode=function(startingNode,comparator){var comparisonResult,currentNode,foundNode;for(currentNode=startingNode,foundNode=void 0;currentNode;){if(comparisonResult=comparator(currentNode),comparisonResult===NODE_FOUND){foundNode=currentNode;break}if(comparisonResult===NODE_TOO_BIG)currentNode=currentNode._left;else if(comparisonResult===NODE_TOO_SMALL)currentNode=currentNode._right;else if(comparisonResult===STOP_SEARCHING)break}return foundNode},_peekMinNode=function(startingNode){return _findNode(startingNode,function(node){return node._left?NODE_TOO_BIG:NODE_FOUND})},_peekMaxNode=function(startingNode){return _findNode(startingNode,function(node){return node._right?NODE_TOO_SMALL:NODE_FOUND})},_grandParentOf=function(node){var _ref;return null!=(_ref=node._parent)?_ref._parent:void 0},_uncleOf=function(node){return _grandParentOf(node)?_isLeft(node._parent)?_grandParentOf(node)._right:_grandParentOf(node)._left:void 0},_siblingOf=function(node){return _isLeft(node)?node._parent._right:node._parent._left},module.exports=RedBlackTree}).call(this)},function(module,exports,__webpack_require__){(function(){var Queue,Trie,WORD_END,_hasAtLeastNChildren,__hasProp={}.hasOwnProperty;Queue=__webpack_require__(6),WORD_END="end",Trie=function(){function Trie(words){var word,_i,_len;for(null==words&&(words=[]),this._root={},this.size=0,_i=0,_len=words.length;_len>_i;_i++)word=words[_i],this.add(word)}return Trie.prototype.add=function(word){var currentNode,letter,_i,_len;if(null!=word){for(this.size++,currentNode=this._root,_i=0,_len=word.length;_len>_i;_i++)letter=word[_i],null==currentNode[letter]&&(currentNode[letter]={}),currentNode=currentNode[letter];return currentNode[WORD_END]=!0,word}},Trie.prototype.has=function(word){var currentNode,letter,_i,_len;if(null==word)return!1;for(currentNode=this._root,_i=0,_len=word.length;_len>_i;_i++){if(letter=word[_i],null==currentNode[letter])return!1;currentNode=currentNode[letter]}return currentNode[WORD_END]?!0:!1},Trie.prototype.longestPrefixOf=function(word){var currentNode,letter,prefix,_i,_len;if(null==word)return"";for(currentNode=this._root,prefix="",_i=0,_len=word.length;_len>_i&&(letter=word[_i],null!=currentNode[letter]);_i++)prefix+=letter,currentNode=currentNode[letter];return prefix},Trie.prototype.wordsWithPrefix=function(prefix){var accumulatedLetters,currentNode,letter,node,queue,subNode,words,_i,_len,_ref;if(null==prefix)return[];for(null!=prefix||(prefix=""),words=[],currentNode=this._root,_i=0,_len=prefix.length;_len>_i;_i++)if(letter=prefix[_i],currentNode=currentNode[letter],null==currentNode)return[];for(queue=new Queue,queue.enqueue([currentNode,""]);0!==queue.size;){_ref=queue.dequeue(),node=_ref[0],accumulatedLetters=_ref[1],node[WORD_END]&&words.push(prefix+accumulatedLetters);for(letter in node)__hasProp.call(node,letter)&&(subNode=node[letter],queue.enqueue([subNode,accumulatedLetters+letter]))}return words},Trie.prototype.remove=function(word){var currentNode,i,letter,prefix,_i,_j,_len,_ref;if(null!=word){for(currentNode=this._root,prefix=[],_i=0,_len=word.length;_len>_i;_i++){if(letter=word[_i],null==currentNode[letter])return;currentNode=currentNode[letter],prefix.push([letter,currentNode])}if(currentNode[WORD_END]){if(this.size--,delete currentNode[WORD_END],_hasAtLeastNChildren(currentNode,1))return word;for(i=_j=_ref=prefix.length-1;(1>=_ref?1>=_j:_j>=1)&&!_hasAtLeastNChildren(prefix[i][1],1);i=1>=_ref?++_j:--_j)delete prefix[i-1][1][prefix[i][0]];return _hasAtLeastNChildren(this._root[prefix[0][0]],1)||delete this._root[prefix[0][0]],word}}},Trie}(),_hasAtLeastNChildren=function(node,n){var child,childCount;if(0===n)return!0;childCount=0;for(child in node)if(__hasProp.call(node,child)&&(childCount++,childCount>=n))return!0;return!1},module.exports=Trie}).call(this)}]),angular.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendMarkerClusterer",["uiGmapLodash","uiGmapPropMap",function(uiGmapLodash,PropMap){return{init:_.once(function(){(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.NgMapCluster=function(_super){function NgMapCluster(opts){NgMapCluster.__super__.constructor.call(this,opts),this.markers_=new PropMap}return __extends(NgMapCluster,_super),NgMapCluster.prototype.addMarker=function(marker){var mCount,mz;if(this.isMarkerAlreadyAdded_(marker)){var oldMarker=this.markers_.get(marker.key);if(oldMarker.getPosition().lat()==marker.getPosition().lat()&&oldMarker.getPosition().lon()==marker.getPosition().lon())return!1}if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();return marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz?marker.getMap()!==this.map_&&marker.setMap(this.map_):mCount<this.minClusterSize_?marker.getMap()!==this.map_&&marker.setMap(this.map_):mCount===this.minClusterSize_?this.markers_.each(function(m){m.setMap(null)}):marker.setMap(null),!0},NgMapCluster.prototype.isMarkerAlreadyAdded_=function(marker){return uiGmapLodash.isNullOrUndefined(this.markers_.get(marker.key))},NgMapCluster.prototype.getBounds=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);return this.getMarkers().each(function(m){bounds.extend(m.getPosition())}),bounds},NgMapCluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=new PropMap,delete this.markers_},NgMapCluster}(Cluster),window.NgMapMarkerClusterer=function(_super){function NgMapMarkerClusterer(map,opt_markers,opt_options){NgMapMarkerClusterer.__super__.constructor.call(this,map,opt_markers,opt_options),this.markers_=new PropMap}return __extends(NgMapMarkerClusterer,_super),NgMapMarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=new PropMap},NgMapMarkerClusterer.prototype.removeMarker_=function(marker){return this.markers_.get(marker.key)?(marker.setMap(null),this.markers_.remove(marker.key),!0):!1},NgMapMarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length),_ms=this.markers_.values();for(i=iFirst;iLast>i;i++)marker=_ms[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);if(iLast<this.markers_.length)this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0);else{for(i=0;i<this.clusters_.length;i++)this.clusters_[i].updateIcon_();delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this)}}},NgMapMarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),distance>d&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new NgMapCluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},NgMapMarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},NgMapMarkerClusterer.prototype.resetViewport_=function(opt_hide){var i;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();this.clusters_=[],this.markers_.each(function(marker){marker.isAdded=!1,opt_hide&&marker.setMap(null)})},NgMapMarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)"constructor"!==property&&(this.prototype[property]=object.prototype[property]);return this}.apply(obj1,[obj2])},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",img+=this.cluster_.getMarkerClusterer().enableRetinaIcons_?"width: "+this.width_+"px;height: "+this.height_+"px;":"clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);",img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},NgMapMarkerClusterer}(MarkerClusterer)}).call(this)})}}])}(window,angular);
!function(a){var b=function(){window.asyncWebshims||(window.asyncWebshims={cfg:[],ready:[]})},c=function(){window.jQuery&&(a(jQuery),a=function(){return window.webshims})};window.webshims={setOptions:function(){b(),window.asyncWebshims.cfg.push(arguments)},ready:function(){b(),window.asyncWebshims.ready.push(arguments)},activeLang:function(a){b(),window.asyncWebshims.lang=a},polyfill:function(a){b(),window.asyncWebshims.polyfill=a},_curScript:function(){var a,b,c,d,e,f=document.currentScript;if(!f){try{throw new Error("")}catch(g){for(c=(g.sourceURL||g.stack||"").split("\n"),e=/(?:fil|htt|wid|abo|app|res)(.)+/i,b=0;b<c.length;b++)if(d=c[b].match(e)){c=d[0].replace(/[\:\s\(]+[\d\:\)\(\s]+$/,"");break}}for(a=document.scripts||document.getElementsByTagName("script"),b=0;b<a.length&&(!a[b].getAttribute("src")||(f=a[b],"interactive"!=a[b].readyState&&c!=a[b].src));b++);}return f}()},window.webshim=window.webshims,window.webshims.timer=setInterval(c,0),c(),"function"==typeof define&&define.amd&&define("polyfiller",["jquery"],a)}(function(a){"use strict";function b(a){return document.createElement(a)}var c,d,e=window.navigator,f=window.webshims,g="dom-support",h=a.event.special,i=a([]),j=window.asyncWebshims,k={},l=window.Object,m=function(a){return a+"\n//# sourceURL="+this.url},n=function(a){return q.enhanceAuto||"auto"!=a?a:!1},o={matchmedia:"matchMedia",xhr2:"filereader",promise:"es6",URL:"url"},p="capture"in b("input");clearInterval(f.timer),k.advancedObjectProperties=k.objectAccessor=k.ES5=!!("create"in l&&"seal"in l),!k.ES5||"toJSON"in Date.prototype||(k.ES5=!1),d=a.support.hrefNormalized===!1?f._curScript.getAttribute("src",4):f._curScript.src,d=d.split("?")[0].slice(0,d.lastIndexOf("/")+1)+"shims/",a.extend(f,{version:"1.15.10",cfg:{enhanceAuto:window.Audio&&(!window.matchMedia||matchMedia("(min-device-width: 721px)").matches),waitReady:!0,loadStyles:!0,wsdoc:document,wspopover:{appendTo:"auto",hideOnBlur:!0},ajax:{crossDomain:!0},loadScript:function(b,c){a.ajax(a.extend({},q.ajax,{url:b,success:c,dataType:"script",cache:!0,global:!1,dataFilter:m}))},basePath:d},support:k,bugs:{},modules:{},features:{},featureList:[],setOptions:function(b,c){"string"==typeof b&&arguments.length>1?q[b]=a.isPlainObject(c)?a.extend(!0,q[b]||{},c):c:"object"==typeof b&&a.extend(!0,q,b)},_getAutoEnhance:n,addPolyfill:function(b,c){c=c||{};var d=c.f||b;r[d]||(r[d]=[],f.featureList.push(d),q[d]={}),r[d].push(b),c.options=a.extend(q[d],c.options),y(b,c),c.methodNames&&a.each(c.methodNames,function(a,b){f.addMethodName(b)})},polyfill:function(){return function(a){return a||(a=f.featureList),"string"==typeof a&&(a=a.split(" ")),f._polyfill(a)}}(),_polyfill:function(b){var d,e,f=[];c.run||(d=-1!==a.inArray("forms-ext",b),c(),e=d&&!v["form-number-date-ui"].test()||!p&&-1!==a.inArray("mediacapture",b),d&&-1==a.inArray("forms",b)&&b.push("forms"),q.loadStyles&&w.loadCSS("styles/shim"+(e?"-ext":"")+".css")),q.waitReady&&(a.readyWait++,t(b,function(){a.ready(!0)})),a.each(b,function(a,b){return b=o[b]||b,r[b]?(b!==r[b][0]&&t(r[b],function(){s(b,!0)}),void(f=f.concat(r[b]))):void s(b,!0)}),x(f),a.each(b,function(a,b){var c=q[b];c&&("mediaelement"==b&&(c.replaceUI=n(c.replaceUI))&&c.plugins.unshift("mediacontrols"),c.plugins&&c.plugins.length&&x(q[b].plugins))})},reTest:function(){var b,c=function(c,d){var e=v[d],f=d+"Ready";!e||e.loaded||(e.test&&a.isFunction(e.test)?e.test([]):e.test)||(h[f]&&delete h[f],r[e.f],b.push(d))};return function(d){"string"==typeof d&&(d=d.split(" ")),b=[],a.each(d,c),x(b)}}(),isReady:function(b,c){if(b+="Ready",c){if(h[b]&&h[b].add)return!0;h[b]=a.extend(h[b]||{},{add:function(a){a.handler.call(this,b)}}),a(document).triggerHandler(b)}return!(!h[b]||!h[b].add)||!1},ready:function(b,c){var d=arguments[2];if("string"==typeof b&&(b=b.split(" ")),d||(b=a.map(a.grep(b,function(a){return!s(a)}),function(a){return a+"Ready"})),!b.length)return void c(a,f,window,document);var e=b.shift(),g=function(){t(b,c,!0)};a(document).one(e,g)},capturingEvents:function(b,c){document.addEventListener&&("string"==typeof b&&(b=[b]),a.each(b,function(b,d){var e=function(b){return b=a.event.fix(b),c&&f.capturingEventPrevented&&f.capturingEventPrevented(b),a.event.dispatch.call(this,b)};h[d]=h[d]||{},h[d].setup||h[d].teardown||a.extend(h[d],{setup:function(){this.addEventListener(d,e,!0)},teardown:function(){this.removeEventListener(d,e,!0)}})}))},register:function(b,c){var d=v[b];if(!d)return void f.error("can't find module: "+b);d.loaded=!0;var e=function(){c(a,f,window,document,void 0,d.options),s(b,!0)};d.d&&d.d.length?t(d.d,e):e()},c:{},loader:{addModule:function(b,c){v[b]=c,c.name=c.name||b,c.c||(c.c=[]),a.each(c.c,function(a,c){f.c[c]||(f.c[c]=[]),f.c[c].push(b)})},loadList:function(){var b=[],c=function(c,d){"string"==typeof d&&(d=[d]),a.merge(b,d),w.loadScript(c,!1,d)},d=function(c,d){if(s(c)||-1!=a.inArray(c,b))return!0;var e,f=v[c];return f?(e=f.test&&a.isFunction(f.test)?f.test(d):f.test,e?(s(c,!0),!0):!1):!0},e=function(b,c){if(b.d&&b.d.length){var e=function(b,e){d(e,c)||-1!=a.inArray(e,c)||c.push(e)};a.each(b.d,function(b,c){v[c]?v[c].loaded||e(b,c):r[c]&&(a.each(r[c],e),t(r[c],function(){s(c,!0)}))}),b.noAutoCallback||(b.noAutoCallback=!0)}};return function(g){var h,i,j,k,l=[],m=function(d,e){return k=e,a.each(f.c[e],function(c,d){return-1==a.inArray(d,l)||-1!=a.inArray(d,b)?(k=!1,!1):void 0}),k?(c("combos/"+k,f.c[k]),!1):void 0};for(i=0;i<g.length;i++)h=v[g[i]],h&&!d(h.name,g)&&(h.css&&q.loadStyles&&w.loadCSS(h.css),h.loadInit&&h.loadInit(),e(h,g),h.loaded||l.push(h.name),h.loaded=!0);for(i=0,j=l.length;j>i;i++)k=!1,h=l[i],-1==a.inArray(h,b)&&("noCombo"!=q.debug&&a.each(v[h].c,m),k||c(v[h].src||h,h))}}(),makePath:function(a){return-1!=a.indexOf("//")||0===a.indexOf("/")?a:(-1==a.indexOf(".")&&(a+=".js"),q.addCacheBuster&&(a+=q.addCacheBuster),q.basePath+a)},loadCSS:function(){var b,c={};return function(d){d=this.makePath(d),c[d]||(b=b||a("link, style")[0]||a("script")[0],c[d]=1,a('<link rel="stylesheet" />').insertBefore(b).attr({href:d}))}}(),loadScript:function(){var b={};return function(c,d,e,f){if(f||(c=w.makePath(c)),!b[c]){var g=function(){d&&d(),e&&("string"==typeof e&&(e=e.split(" ")),a.each(e,function(a,b){v[b]&&(v[b].afterLoad&&v[b].afterLoad(),s(v[b].noAutoCallback?b+"FileLoaded":b,!0))}))};b[c]=1,q.loadScript(c,g,a.noop)}}}()}});var q=f.cfg,r=f.features,s=f.isReady,t=f.ready,u=f.addPolyfill,v=f.modules,w=f.loader,x=w.loadList,y=w.addModule,z=f.bugs,A=[],B={warn:1,error:1},C=a.fn,D=b("video");f.addMethodName=function(a){a=a.split(":");var b=a[1];1==a.length?(b=a[0],a=a[0]):a=a[0],C[a]=function(){return this.callProp(b,arguments)}},C.callProp=function(b,c){var d;return c||(c=[]),this.each(function(){var e=a.prop(this,b);if(e&&e.apply){if(d=e.apply(this,c),void 0!==d)return!1}else f.warn(b+" is not a method of "+this)}),void 0!==d?d:this},f.activeLang=function(){"language"in e||(e.language=e.browserLanguage||"");var b=a.attr(document.documentElement,"lang")||e.language;return t("webshimLocalization",function(){f.activeLang(b)}),function(a){if(a)if("string"==typeof a)b=a;else if("object"==typeof a){var c=arguments,d=this;t("webshimLocalization",function(){f.activeLang.apply(d,c)})}return b}}(),f.errorLog=[],a.each(["log","error","warn","info"],function(a,b){f[b]=function(a){(B[b]&&q.debug!==!1||q.debug)&&(f.errorLog.push(a),window.console&&console.log&&console[console[b]?b:"log"](a))}}),function(){a.isDOMReady=a.isReady;var b=function(){a.isDOMReady=!0,s("DOM",!0),setTimeout(function(){s("WINDOWLOAD",!0)},9999)};c=function(){if(!c.run){if(!a.isDOMReady&&q.waitReady){var d=a.ready;a.ready=function(a){return a!==!0&&document.body&&b(),d.apply(this,arguments)},a.ready.promise=d.promise}q.readyEvt?a(document).one(q.readyEvt,b):a(b)}c.run=!0},a(window).on("load",function(){b(),setTimeout(function(){s("WINDOWLOAD",!0)},9)});var d=[],e=function(){1==this.nodeType&&f.triggerDomUpdate(this)};a.extend(f,{addReady:function(a){var b=function(b,c){f.ready("DOM",function(){a(b,c)})};d.push(b),q.wsdoc&&b(q.wsdoc,i)},triggerDomUpdate:function(b){if(!b||!b.nodeType)return void(b&&b.jquery&&b.each(function(){f.triggerDomUpdate(this)}));var c=b.nodeType;if(1==c||9==c){var e=b!==document?a(b):i;a.each(d,function(a,c){c(b,e)})}}}),C.clonePolyfill=C.clone,C.htmlPolyfill=function(b){if(!arguments.length)return a(this.clonePolyfill()).html();var c=C.html.call(this,b);return c===this&&a.isDOMReady&&this.each(e),c},C.jProp=function(){return this.pushStack(a(C.prop.apply(this,arguments)||[]))},a.each(["after","before","append","prepend","replaceWith"],function(b,c){C[c+"Polyfill"]=function(b){return b=a(b),C[c].call(this,b),a.isDOMReady&&b.each(e),this}}),a.each(["insertAfter","insertBefore","appendTo","prependTo","replaceAll"],function(b,c){C[c.replace(/[A-Z]/,function(a){return"Polyfill"+a})]=function(){return C[c].apply(this,arguments),a.isDOMReady&&f.triggerDomUpdate(this),this}}),C.updatePolyfill=function(){return a.isDOMReady&&f.triggerDomUpdate(this),this},a.each(["getNativeElement","getShadowElement","getShadowFocusElement"],function(a,b){C[b]=function(){return this.pushStack(this)}})}(),l.create&&(f.objectCreate=function(b,c,d){var e=l.create(b);return d&&(e.options=a.extend(!0,{},e.options||{},d),d=e.options),e._create&&a.isFunction(e._create)&&e._create(d),e}),y("swfmini",{test:function(){return window.swfobject&&!window.swfmini&&(window.swfmini=window.swfobject),"swfmini"in window},c:[16,7,2,8,1,12,23]}),v.swfmini.test(),y("sizzle",{test:a.expr.filters}),u("es5",{test:!(!k.ES5||!Function.prototype.bind),d:["sizzle"]}),u("dom-extend",{f:g,noAutoCallback:!0,d:["es5"],c:[16,7,2,15,30,3,8,4,9,10,25,31,34]}),b("picture"),u("picture",{test:"picturefill"in window||!!window.HTMLPictureElement||"respimage"in window,d:["matchMedia"],c:[18],loadInit:function(){s("picture",!0)}}),u("matchMedia",{test:!(!window.matchMedia||!matchMedia("all").addListener),c:[18]}),u("sticky",{test:-1!=(a(b("b")).attr("style","position: -webkit-sticky; position: sticky").css("position")||"").indexOf("sticky"),d:["es5","matchMedia"]}),u("es6",{test:!!(Math.imul&&Number.MIN_SAFE_INTEGER&&l.is&&window.Promise&&Promise.all),d:["es5"]}),u("geolocation",{test:"geolocation"in e,options:{destroyWrite:!0},c:[21]}),function(){u("canvas",{src:"excanvas",test:"getContext"in b("canvas"),options:{type:"flash"},noAutoCallback:!0,loadInit:function(){var a=this.options.type;!a||-1===a.indexOf("flash")||v.swfmini.test()&&!swfmini.hasFlashPlayerVersion("9.0.0")||(this.src="flash"==a?"FlashCanvas/flashcanvas":"FlashCanvasPro/flashcanvas")},methodNames:["getContext"],d:[g]})}();var E="getUserMedia"in e;u("usermedia-core",{f:"usermedia",test:E&&window.URL,d:["url",g]}),u("usermedia-shim",{f:"usermedia",test:!!(E||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia),d:["url","mediaelement",g]}),u("mediacapture",{test:p,d:["swfmini","usermedia",g,"filereader","forms","canvas"]}),function(){var c,d,h="form-shim-extend",i="formvalidation",j="form-number-date-api",l=!1,m=!1,o=!1,p={},r=b("progress"),s=b("output"),t=function(){var d,f,g="1(",j=b("input");if(f=a('<fieldset><textarea required="" /></fieldset>')[0],k.inputtypes=p,a.each(["range","date","datetime-local","month","color","number"],function(a,b){j.setAttribute("type",b),p[b]=j.type==b&&(j.value=g)&&j.value!=g}),k.datalist=!!("options"in b("datalist")&&window.HTMLDataListElement),k[i]="checkValidity"in j,k.fieldsetelements="elements"in f,k.fieldsetdisabled="disabled"in f){try{f.querySelector(":invalid")&&(f.disabled=!0,d=!f.querySelector(":invalid")&&f.querySelector(":disabled"))}catch(n){}k.fieldsetdisabled=!!d}if(k[i]&&(m=!(k.fieldsetdisabled&&k.fieldsetelements&&"value"in r&&"value"in s),o=m&&/Android/i.test(e.userAgent),l=window.opera||z.bustedValidity||m||!k.datalist,!l&&p.number)){l=!0;try{j.type="number",j.value="",j.stepUp(),l="1"!=j.value}catch(q){}}return z.bustedValidity=l,c=k[i]&&!l?"form-native-extend":h,t=a.noop,!1},w=function(b){var c=!0;return b._types||(b._types=b.types.split(" ")),a.each(b._types,function(a,b){return b in p&&!p[b]?(c=!1,!1):void 0}),c};f.validationMessages=f.validityMessages={langSrc:"i18n/formcfg-",availableLangs:"ar bg ca cs el es fa fi fr he hi hu it ja lt nl no pl pt pt-BR pt-PT ru sv zh-CN zh-TW".split(" ")},f.formcfg=a.extend({},f.validationMessages),f.inputTypes={},u("form-core",{f:"forms",test:t,d:["es5"],options:{placeholderType:"value",messagePopover:{},list:{popover:{constrainWidth:!0}},iVal:{sel:".ws-validate",handleBubble:"hide",recheckDelay:400}},methodNames:["setCustomValidity","checkValidity","setSelectionRange"],c:[16,7,2,8,1,15,30,3,31]}),d=q.forms,u("form-native-extend",{f:"forms",test:function(b){return t(),!k[i]||l||-1==a.inArray(j,b||[])||v[j].test()},d:["form-core",g,"form-message"],c:[6,5,14,29]}),u(h,{f:"forms",test:function(){return t(),k[i]&&!l},d:["form-core",g,"sizzle"],c:[16,15,28]}),u(h+"2",{f:"forms",test:function(){return t(),k[i]&&!m},d:[h],c:[27]}),u("form-message",{f:"forms",test:function(a){return t(),!(d.customMessages||!k[i]||l||!v[c].test(a))},d:[g],c:[16,7,15,30,3,8,4,14,28]}),u(j,{f:"forms-ext",options:{types:"date time range number"},test:function(){t();var a=!l;return a&&(a=w(this.options)),a},methodNames:["stepUp","stepDown"],d:["forms",g],c:[6,5,17,14,28,29,33]}),y("range-ui",{options:{},noAutoCallback:!0,test:function(){return!!C.rangeUI},d:["es5"],c:[6,5,9,10,17,11]}),u("form-number-date-ui",{f:"forms-ext",test:function(){var a=this.options;return a.replaceUI=n(a.replaceUI),t(),!a.replaceUI&&o&&(a.replaceUI=!0),!a.replaceUI&&w(a)},d:["forms",g,j,"range-ui"],options:{widgets:{calculateWidth:!0,animate:!0}},c:[6,5,9,10,17,11]}),u("form-datalist",{f:"forms",test:function(){return t(),o&&(d.customDatalist=!0),k.datalist&&!d.fD},d:["form-core",g],c:[16,7,6,2,9,15,30,31,28,33]})}();var F="FileReader"in window&&"FormData"in window;return u("filereader-xhr",{f:"filereader",test:F,d:[g,"swfmini"],c:[25,27]}),u("canvas-blob",{f:"filereader",methodNames:["toBlob"],test:!(F&&!b("canvas").toBlob)}),u("details",{test:"open"in b("details"),d:[g],options:{text:"Details"},c:[21,22]}),u("url",{test:function(){var a=!1;try{a=new URL("b","http://a"),a=!(!a.searchParams||"http://a/b"!=a.href)}catch(b){}return a},d:["es5"]}),function(){f.mediaelement={};var c=b("track");if(k.mediaelement="canPlayType"in D,k.texttrackapi="addTextTrack"in D,k.track="kind"in c,b("audio"),!(z.track=!k.texttrackapi))try{z.track=!("oncuechange"in D.addTextTrack("metadata"))}catch(d){}u("mediaelement-core",{f:"mediaelement",noAutoCallback:!0,options:{jme:{},plugins:[],vars:{},params:{},attrs:{},changeSWF:a.noop},methodNames:["play","pause","canPlayType","mediaLoad:load"],d:["swfmini"],c:[16,7,2,8,1,12,13,23]}),u("mediaelement-jaris",{f:"mediaelement",d:["mediaelement-core",g],test:function(){var a=this.options;return!k.mediaelement||f.mediaelement.loadSwf?!1:(a.preferFlash&&!v.swfmini.test()&&(a.preferFlash=!1),!(a.preferFlash&&swfmini.hasFlashPlayerVersion("11.3")))},c:[21,25]}),u("track",{options:{positionDisplay:!0,override:z.track},test:function(){var a=this.options;return a.override=n(a.override),!a.override&&!z.track},d:["mediaelement",g],methodNames:["addTextTrack"],c:[21,12,13,22,34]}),y("jmebase",{src:"jme/base",c:[98,99,97]}),a.each([["mediacontrols",{c:[98,99],css:"jme/controls.css"}],["playlist",{c:[98,97]}],["alternate-media"]],function(b,c){y(c[0],a.extend({src:"jme/"+c[0],d:["jmebase"]},c[1]))}),y("track-ui",{d:["track",g]})}(),u("feature-dummy",{test:!0,loaded:!0,c:A}),f.$=a,a.webshims=f,a.webshim=webshim,f.callAsync=function(){f.callAsync=a.noop,j&&(j.cfg&&(j.cfg.length||(j.cfg=[[j.cfg]]),a.each(j.cfg,function(a,b){f.setOptions.apply(f,b)})),j.ready&&a.each(j.ready,function(a,b){f.ready.apply(f,b)}),j.lang&&f.activeLang(j.lang),"polyfill"in j&&f.polyfill(j.polyfill)),f.isReady("jquery",!0)},f.callAsync(),f});
!function(angular,analytics){"use strict";var angulartics=window.angulartics||(window.angulartics={});angulartics.waitForVendorCount=0,angulartics.waitForVendorApi=function(objectName,delay,containsField,registerFn,onTimeout){onTimeout||angulartics.waitForVendorCount++,registerFn||(registerFn=containsField,containsField=void 0),!Object.prototype.hasOwnProperty.call(window,objectName)||void 0!==containsField&&void 0===window[objectName][containsField]?setTimeout(function(){angulartics.waitForVendorApi(objectName,delay,containsField,registerFn,!0)},delay):(angulartics.waitForVendorCount--,registerFn(window[objectName]))},angular.module("angulartics",[]).provider("$analytics",function(){var settings={pageTracking:{autoTrackFirstPage:!0,autoTrackVirtualPages:!0,trackRelativePath:!1,autoBasePath:!1,basePath:""},eventTracking:{},bufferFlushDelay:1e3,developerMode:!1},knownHandlers=["pageTrack","eventTrack","setAlias","setUsername","setUserProperties","setUserPropertiesOnce","setSuperProperties","setSuperPropertiesOnce"],cache={},handlers={},bufferedHandler=function(handlerName){return function(){angulartics.waitForVendorCount&&(cache[handlerName]||(cache[handlerName]=[]),cache[handlerName].push(arguments))}},updateHandlers=function(handlerName,fn){return handlers[handlerName]||(handlers[handlerName]=[]),handlers[handlerName].push(fn),function(){var handlerArgs=arguments;angular.forEach(handlers[handlerName],function(handler){handler.apply(this,handlerArgs)},this)}},api={settings:settings},onTimeout=function(fn,delay){delay?setTimeout(fn,delay):fn()},provider={$get:function(){return api},api:api,settings:settings,virtualPageviews:function(value){this.settings.pageTracking.autoTrackVirtualPages=value},firstPageview:function(value){this.settings.pageTracking.autoTrackFirstPage=value},withBase:function(value){this.settings.pageTracking.basePath=value?angular.element(document).find("base").attr("href"):""},withAutoBase:function(value){this.settings.pageTracking.autoBasePath=value},developerMode:function(value){this.settings.developerMode=value}},register=function(handlerName,fn){api[handlerName]=updateHandlers(handlerName,fn);var handlerSettings=settings[handlerName],handlerDelay=handlerSettings?handlerSettings.bufferFlushDelay:null,delay=null!==handlerDelay?handlerDelay:settings.bufferFlushDelay;angular.forEach(cache[handlerName],function(args,index){onTimeout(function(){fn.apply(this,args)},index*delay)})},capitalize=function(input){return input.replace(/^./,function(match){return match.toUpperCase()})},installHandlerRegisterFunction=function(handlerName){var registerName="register"+capitalize(handlerName);provider[registerName]=function(fn){register(handlerName,fn)},api[handlerName]=updateHandlers(handlerName,bufferedHandler(handlerName))};return angular.forEach(knownHandlers,installHandlerRegisterFunction),provider}).run(["$rootScope","$window","$analytics","$injector",function($rootScope,$window,$analytics,$injector){$analytics.settings.pageTracking.autoTrackFirstPage&&$injector.invoke(["$location",function($location){var noRoutesOrStates=!0;if($injector.has("$route")){var $route=$injector.get("$route");for(var route in $route.routes){noRoutesOrStates=!1;break}}else if($injector.has("$state")){var $state=$injector.get("$state");for(var state in $state.get()){noRoutesOrStates=!1;break}}if(noRoutesOrStates)if($analytics.settings.pageTracking.autoBasePath&&($analytics.settings.pageTracking.basePath=$window.location.pathname),$analytics.settings.pageTracking.trackRelativePath){var url=$analytics.settings.pageTracking.basePath+$location.url();$analytics.pageTrack(url,$location)}else $analytics.pageTrack($location.absUrl(),$location)}]),$analytics.settings.pageTracking.autoTrackVirtualPages&&$injector.invoke(["$location",function($location){$analytics.settings.pageTracking.autoBasePath&&($analytics.settings.pageTracking.basePath=$window.location.pathname+"#"),$injector.has("$route")&&$rootScope.$on("$routeChangeSuccess",function(event,current){if(!current||!(current.$$route||current).redirectTo){var url=$analytics.settings.pageTracking.basePath+$location.url();$analytics.pageTrack(url,$location)}}),$injector.has("$state")&&$rootScope.$on("$stateChangeSuccess",function(event,current){var url=$analytics.settings.pageTracking.basePath+$location.url();$analytics.pageTrack(url,$location)})}]),$analytics.settings.developerMode&&angular.forEach($analytics,function(attr,name){"function"==typeof attr&&($analytics[name]=function(){})})}]).directive("analyticsOn",["$analytics",function($analytics){function isCommand(element){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(element.tagName.toLowerCase()+":"+(element.type||""))>=0}function inferEventType(element){return isCommand(element),"click"}function inferEventName(element){return isCommand(element)?element.innerText||element.value:element.id||element.name||element.tagName}function isProperty(name){return"analytics"===name.substr(0,9)&&-1===["On","Event","If","Properties","EventType"].indexOf(name.substr(9))}function propertyName(name){var s=name.slice(9);return"undefined"!=typeof s&&null!==s&&s.length>0?s.substring(0,1).toLowerCase()+s.substring(1):s}return{restrict:"A",link:function($scope,$element,$attrs){var eventType=$attrs.analyticsOn||inferEventType($element[0]),trackingData={};angular.forEach($attrs.$attr,function(attr,name){isProperty(name)&&(trackingData[propertyName(name)]=$attrs[name],$attrs.$observe(name,function(value){trackingData[propertyName(name)]=value}))}),angular.element($element[0]).bind(eventType,function($event){var eventName=$attrs.analyticsEvent||inferEventName($element[0]);trackingData.eventType=$event.type,(!$attrs.analyticsIf||$scope.$eval($attrs.analyticsIf))&&($attrs.analyticsProperties&&angular.extend(trackingData,$scope.$eval($attrs.analyticsProperties)),$analytics.eventTrack(eventName,trackingData))})}}}])}(angular);
!function(angular){"use strict";angular.module("angulartics.adobe.analytics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.trackRelativePath=!0,$analyticsProvider.registerPageTrack(function(path){window.s&&s.t({pageName:path})}),$analyticsProvider.registerEventTrack(function(action){window.s&&action&&("DOWNLOAD"===action.toUpperCase()?s.tl(this,"d",action):"EXIT"===action.toUpperCase()?s.tl(this,"e",action):s.tl(this,"o",action))})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.chartbeat",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("pSUPERFLY",500,function(pSUPERFLY){$analyticsProvider.registerPageTrack(function(path){pSUPERFLY.virtualPage(path)})}),$analyticsProvider.registerEventTrack(function(){console.warn("Chartbeat doesn't support event tracking -- silently ignored.")})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.clicky",["angulartics"]).config(["$analyticsProvider","$documentProvider",function($analyticsProvider,$documentProvider){function registerEvents(clicky){clickyApi=clicky,clickyApi&&($analyticsProvider.registerPageTrack(pageTrack),$analyticsProvider.registerEventTrack(eventTrack))}function pageTrack(path,properties){var title=properties.title||$document[0].title,type=validateType(properties.type);clickyApi.log(path,title,type)}function eventTrack(action,properties){var goalId,revenue,noQueue,title,type;angular.isDefined(properties.goal)?(goalId=properties.goal,revenue=validateNumber(properties.revenue)?properties.revenue:void 0,noQueue=!!properties.noQueue,clickyApi.goal(goalId,revenue,noQueue)):(type=validateType(properties.type)===properties.type?properties.type:"click",title=properties.title||properties.value,clickyApi.log(action,title,type))}function validateType(type){var TYPE_ENUM=["click","download","outbound","pageview"];return TYPE_ENUM.indexOf(type)>=0?type:"pageview"}function validateNumber(number){return"number"==typeof number&&isFinite(number)}var clickyApi,$document=$documentProvider.$get;$analyticsProvider.settings.trackRelativePath=!0,angulartics.waitForVendorApi("clicky",100,registerEvents)}])}(angular);
!function(angular){"use strict";angular.module("angulartics.cnzz",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){window._czc=_czc||[],_czc.push(["_setAutoPageview",!1]),$analyticsProvider.registerPageTrack(function(path){_czc.push(["_trackPageview",path])}),$analyticsProvider.registerEventTrack(function(action,prop){_czc.push(["_trackEvent",prop.category,action,prop.label,prop.value,prop.nodeid])})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.flurry",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){}),$analyticsProvider.registerEventTrack(function(action,properties){FlurryAgent.logEvent(action,properties)})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.google.analytics.cordova",["angulartics"]).provider("googleAnalyticsCordova",function(){var GoogleAnalyticsCordova=["$q","$log","ready","debug","trackingId","period",function($q,$log,ready,debug,trackingId,period){function success(){debug&&$log.info(arguments)}function failure(err){debug&&$log.error(err)}var deferred=$q.defer(),deviceReady=!1;window.addEventListener("deviceReady",function(){deviceReady=!0,deferred.resolve()}),setTimeout(function(){deviceReady||deferred.resolve()},3e3),this.init=function(){return deferred.promise.then(function(){var analytics=window.plugins&&window.plugins.gaPlugin;analytics?analytics.init(function(){ready(analytics,success,failure)},failure,trackingId,period||10):debug&&$log.error("Google Analytics for Cordova is not available")})}}];return{$get:["$injector",function($injector){return $injector.instantiate(GoogleAnalyticsCordova,{ready:this._ready||angular.noop,debug:this.debug,trackingId:this.trackingId,period:this.period})}],ready:function(fn){this._ready=fn}}}).config(["$analyticsProvider","googleAnalyticsCordovaProvider",function($analyticsProvider,googleAnalyticsCordovaProvider){googleAnalyticsCordovaProvider.ready(function(analytics,success,failure){$analyticsProvider.registerPageTrack(function(path){analytics.trackPage(success,failure,path)}),$analyticsProvider.registerEventTrack(function(action,properties){analytics.trackEvent(success,failure,properties.category,action,properties.label,properties.value)})})}]).run(["googleAnalyticsCordova",function(googleAnalyticsCordova){googleAnalyticsCordova.init()}])}(angular);
!function(angular){"use strict";angular.module("angulartics.google.analytics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.trackRelativePath=!0,$analyticsProvider.settings.ga={additionalAccountNames:void 0,userId:null},$analyticsProvider.registerPageTrack(function(path){window._gaq&&(_gaq.push(["_trackPageview",path]),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){_gaq.push([accountName+"._trackPageview",path])})),window.ga&&($analyticsProvider.settings.ga.userId&&ga("set","&uid",$analyticsProvider.settings.ga.userId),ga("send","pageview",path),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){ga(accountName+".send","pageview",path)}))}),$analyticsProvider.registerEventTrack(function(action,properties){if(properties&&properties.category||(properties=properties||{},properties.category="Event"),properties.value){var parsed=parseInt(properties.value,10);properties.value=isNaN(parsed)?0:parsed}if(window.ga){for(var eventOptions={eventCategory:properties.category,eventAction:action,eventLabel:properties.label,eventValue:properties.value,nonInteraction:properties.noninteraction,page:properties.page||window.location.hash.substring(1),userId:$analyticsProvider.settings.ga.userId},idx=1;20>=idx;idx++)properties["dimension"+idx.toString()]&&(eventOptions["dimension"+idx.toString()]=properties["dimension"+idx.toString()]),properties["metric"+idx.toString()]&&(eventOptions["metric"+idx.toString()]=properties["metric"+idx.toString()]);ga("send","event",eventOptions),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){ga(accountName+".send","event",eventOptions)})}else window._gaq&&_gaq.push(["_trackEvent",properties.category,action,properties.label,properties.value,properties.noninteraction])}),$analyticsProvider.registerSetUsername(function(userId){$analyticsProvider.settings.ga.userId=userId})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.google.tagmanager",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){var dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push({event:"content-view","content-name":path})}),$analyticsProvider.registerEventTrack(function(action,properties){var dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push({event:"interaction",target:properties.category,action:action,"target-properties":properties.label,value:properties.value,"interaction-type":properties.noninteraction})})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.kissmetrics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){"undefined"==typeof _kmq?window._kmq=[]:window._kmq=_kmq,$analyticsProvider.registerPageTrack(function(path){window._kmq.push(["record","Pageview",{Page:path}])}),$analyticsProvider.registerEventTrack(function(action,properties){window._kmq.push(["record",action,properties])}),$analyticsProvider.registerSetUsername(function(uuid){window._kmq.push(["identify",uuid])}),$analyticsProvider.registerSetUserProperties(function(properties){window._kmq.push(["set",properties])})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.mixpanel",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetUsername(function(userId){mixpanel.identify(userId)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetAlias(function(userId){mixpanel.alias(userId)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetSuperPropertiesOnce(function(properties){mixpanel.register_once(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetSuperProperties(function(properties){mixpanel.register(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetUserPropertiesOnce(function(properties){mixpanel.people.set_once(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetUserProperties(function(properties){mixpanel.people.set(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerPageTrack(function(path){mixpanel.track("Page Viewed",{page:path})})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerEventTrack(function(action,properties){mixpanel.track(action,properties)})})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.piwik",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.trackRelativePath=!0,$analyticsProvider.registerPageTrack(function(path){window._paq&&(_paq.push(["setCustomUrl",path]),_paq.push(["trackPageView"]))}),$analyticsProvider.registerEventTrack(function(action,properties){if(properties.value){var parsed=parseInt(properties.value,10);properties.value=isNaN(parsed)?0:parsed}window._paq&&_paq.push(["trackEvent",properties.category,action,properties.label,properties.value])})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.scroll",["angulartics"]).directive("analyticsOn",["$analytics",function($analytics){function isProperty(name){return"scrollby"===name.substr(0,8)}function cast(value){return["","true","false"].indexOf(value)>-1?"true"===value.replace("","true"):value}return{restrict:"A",priority:5,scope:!1,link:function($scope,$element,$attrs){if("scrollby"===$attrs.analyticsOn){var properties={continuous:!1,triggerOnce:!0};angular.forEach($attrs.$attr,function(attr,name){isProperty(attr)&&(properties[name.slice(8,9).toLowerCase()+name.slice(9)]=cast($attrs[name]))}),$element.waypoint(function(){$element.triggerHandler("scrollby")},properties)}}}}])}(angular);
!function(angular){"use strict";angular.module("angulartics.segment.io",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){try{analytics.page(path)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerEventTrack(function(event,properties,options,callback){try{analytics.track(event,properties,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetUserProperties(function(userId,traits,options,callback){try{analytics.identify(userId,traits,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetUserPropertiesOnce(function(userId,traits,options,callback){try{analytics.identify(userId,traits,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetAlias(function(userId,previousId,options,callback){try{analytics.alias(userId,previousId,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.splunk",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){var errorFunction=function(){throw"Define sp "},_getSp=function(){return window.sp||{pageview:errorFunction,track:errorFunction}};$analyticsProvider.registerPageTrack(function(path){_getSp().pageview(path)}),$analyticsProvider.registerEventTrack(function(action,properties){_getSp().track(action,properties)})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.woopra",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){woopra.track("pv",{url:path})}),$analyticsProvider.registerEventTrack(function(action,properties){woopra.track(action,properties)}),$analyticsProvider.registerSetUsername(function(email){woopra.identify("email",email).push()}),$analyticsProvider.registerSetUserProperties(function(properties){properties.email&&woopra.identify(properties).push()})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.marketo",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("Munchkin",500,"sKey",function(Munchkin){$analyticsProvider.registerPageTrack(function(path){Munchkin.munchkinFunction("visitWebPage",{url:path})})}),angulartics.waitForVendorApi("Munchkin",500,"sKey",function(Munchkin){$analyticsProvider.registerEventTrack(function(action,properties){if(void 0!==properties.path){var params=[];for(var prop in properties)"path"!==prop&&params.push(prop+"="+properties[prop]);"CLICK"==action.toUpperCase()&&Munchkin.munchkinFunction("clickLink",{href:properties.path}),Munchkin.munchkinFunction("visitWebPage",{url:properties.path,params:params.join("&")})}})});var associateLead=function(properties){void 0!==properties.email&&(email=properties.email,email_sha=sha1(Munckin.sKey+email),properties.Email=properties.email,Munchkin.munchkinFunction("associateLead",properties,email_sha))};angulartics.waitForVendorApi("Munchkin",500,function(Munchkin){$analyticsProvider.registerSetUsername(function(userId){/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/.test(userId)&&associateLead({Email:userId})})}),angulartics.waitForVendorApi("Munchkin",500,function(Munchkin){$analyticsProvider.registerSetUserProperties(function(properties){associateLead(properties)})}),angulartics.waitForVendorApi("Munchkin",500,function(Munchkin){$analyticsProvider.registerSetUserPropertiesOnce(function(properties){associateLead(properties)})})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.intercom",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerSetUsername(function(userId){window.Intercom&&window.Intercom("update",{user_id:userId})}),$analyticsProvider.registerEventTrack(function(action,properties){window.Intercom&&window.Intercom("trackEvent",action,properties)})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.inspectlet",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){var pageTrackArray=[];pageTrackArray.push("virtualPage"),path&&pageTrackArray.push({url:path}),__insp.push(pageTrackArray)}),$analyticsProvider.registerEventTrack(function(action,properties){if("identify"==action||"tagSession"==action){properties.category&&delete properties.category;var eventTrackArray=[];eventTrackArray.push(action),eventTrackArray.push(properties),__insp.push(eventTrackArray)}})}])}(angular);
!function(angular){"use strict";angular.module("angulartics.newrelic.insights",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("newrelic",100,function(newrelic){$analyticsProvider.registerEventTrack(function(action,properties){newrelic.addPageAction(action,properties)}),$analyticsProvider.registerSetUsername(function(name){newrelic.setCustomAttribute("username",name)}),$analyticsProvider.registerSetAlias(function(name){newrelic.setCustomAttribute("alias",name)}),$analyticsProvider.registerSetUserProperties(function(properties){angular.forEach(properties,function(value,key){newrelic.setCustomAttribute(key,value)})})})}])}(angular);
"use strict";angular.module("slick",[]).directive("slick",["$timeout",function($timeout){return{restrict:"AEC",scope:{initOnload:"@",data:"=",currentIndex:"=",accessibility:"@",adaptiveHeight:"@",arrows:"@",asNavFor:"@",appendArrows:"@",appendDots:"@",autoplay:"@",autoplaySpeed:"@",centerMode:"@",centerPadding:"@",cssEase:"@",customPaging:"&",dots:"@",draggable:"@",easing:"@",fade:"@",focusOnSelect:"@",infinite:"@",initialSlide:"@",lazyLoad:"@",onBeforeChange:"&",onAfterChange:"&",onInit:"&",onReInit:"&",onSetPosition:"&",pauseOnHover:"@",pauseOnDotsHover:"@",responsive:"=",rtl:"@",slide:"@",slidesToShow:"@",slidesToScroll:"@",speed:"@",swipe:"@",swipeToSlide:"@",touchMove:"@",touchThreshold:"@",useCSS:"@",variableWidth:"@",vertical:"@",prevArrow:"@",nextArrow:"@"},link:function(scope,element,attrs){var destroySlick,initializeSlick,isInitialized;return destroySlick=function(){return $timeout(function(){var slider;return slider=$(element),slider.slick("unslick"),slider.find(".slick-list").remove(),slider})},initializeSlick=function(){return $timeout(function(){var currentIndex,customPaging,slider;return slider=$(element),null!=scope.currentIndex&&(currentIndex=scope.currentIndex),customPaging=function(slick,index){return scope.customPaging({slick:slick,index:index})},slider.slick({accessibility:"false"!==scope.accessibility,adaptiveHeight:"true"===scope.adaptiveHeight,arrows:"false"!==scope.arrows,asNavFor:scope.asNavFor?scope.asNavFor:void 0,appendArrows:scope.appendArrows?$(scope.appendArrows):$(element),appendDots:scope.appendDots?$(scope.appendDots):$(element),autoplay:"true"===scope.autoplay,autoplaySpeed:null!=scope.autoplaySpeed?parseInt(scope.autoplaySpeed,10):3e3,centerMode:"true"===scope.centerMode,centerPadding:scope.centerPadding||"50px",cssEase:scope.cssEase||"ease",customPaging:attrs.customPaging?customPaging:void 0,dots:"true"===scope.dots,draggable:"false"!==scope.draggable,easing:scope.easing||"linear",fade:"true"===scope.fade,focusOnSelect:"true"===scope.focusOnSelect,infinite:"false"!==scope.infinite,initialSlide:scope.initialSlide||0,lazyLoad:scope.lazyLoad||"ondemand",beforeChange:attrs.onBeforeChange?scope.onBeforeChange:void 0,onReInit:attrs.onReInit?scope.onReInit:void 0,onSetPosition:attrs.onSetPosition?scope.onSetPosition:void 0,pauseOnHover:"false"!==scope.pauseOnHover,responsive:scope.responsive||void 0,rtl:"true"===scope.rtl,slide:scope.slide||"div",slidesToShow:null!=scope.slidesToShow?parseInt(scope.slidesToShow,10):1,slidesToScroll:null!=scope.slidesToScroll?parseInt(scope.slidesToScroll,10):1,speed:null!=scope.speed?parseInt(scope.speed,10):300,swipe:"false"!==scope.swipe,swipeToSlide:"true"===scope.swipeToSlide,touchMove:"false"!==scope.touchMove,touchThreshold:scope.touchThreshold?parseInt(scope.touchThreshold,10):5,useCSS:"false"!==scope.useCSS,variableWidth:"true"===scope.variableWidth,vertical:"true"===scope.vertical,prevArrow:scope.prevArrow?$(scope.prevArrow):void 0,nextArrow:scope.nextArrow?$(scope.nextArrow):void 0}),slider.on("init",function(sl){return attrs.onInit&&scope.onInit(),null!=currentIndex?sl.slideHandler(currentIndex):void 0}),slider.on("reInit",function(sl){return attrs.onReInit?scope.onReInit():void 0}),slider.on("setPosition",function(sl){return attrs.onSetPosition?scope.onSetPosition():void 0}),slider.on("swipe",function(sl){return attrs.onSwipe?scope.onSwipe():void 0}),slider.on("afterChange",function(event,slick,currentSlide,nextSlide){return scope.onAfterChange&&scope.onAfterChange(),null!=currentIndex?scope.$apply(function(){return currentIndex=currentSlide,scope.currentIndex=currentSlide}):void 0}),slider.on("beforeChange",function(sl){return attrs.onBeforeChange?scope.onBeforeChange():void 0}),slider.on("breakpoint",function(sl){return attrs.onBreakpoint?scope.onBreakpoint():void 0}),slider.on("destroy",function(sl){return attrs.onDestroy?scope.onDestroy():void 0}),slider.on("edge",function(sl){return attrs.onEdge?scope.onEdge():void 0}),scope.$watch("currentIndex",function(newVal,oldVal){return null!=currentIndex&&null!=newVal&&newVal!==currentIndex?slider.slick("slickGoTo",newVal):void 0})})},scope.initOnload?(isInitialized=!1,scope.$watch("data",function(newVal,oldVal){return null!=newVal?(isInitialized&&destroySlick(),initializeSlick(),isInitialized=!0):void 0})):initializeSlick()}}}]);
function getURIparam(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(window.location.href);return null==results?"":results[1]}(function(){"use strict";var app;app=angular.module("BB",["BB.Controllers","BB.Filters","BB.Models","BB.Services","BB.Directives","ngStorage","angular-hal","ui.bootstrap","ngSanitize","ui.map","ui.router.util","ngLocalData","ngAnimate","angular-data.DSCacheFactory","angularFileUpload","schemaForm","ngStorage","uiGmapgoogle-maps","angular.filter","ui-rangeSlider","ngCookies","slick","pascalprecht.translate","vcRecaptcha"]),app.value("AppConfig",{appId:"f6b16c23",appKey:"f0bc4f65f4fbfe7b4b3b7264b655f5eb"}),window.use_no_conflict?(window.bbjq=$.noConflict(),app.value("$bbug",jQuery.noConflict(!0))):app.value("$bbug",jQuery),app.constant("UriTemplate",window.UriTemplate),app.config(function($locationProvider,$httpProvider,$provide,ie8HttpBackendProvider){var int,lowercase,msie;return $httpProvider.defaults.headers.common={"App-Id":"f6b16c23","App-Key":"f0bc4f65f4fbfe7b4b3b7264b655f5eb"},int=function(str){return parseInt(str,10)},lowercase=function(string){return angular.isString(string)?string.toLowerCase():string},msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),msie&&10>msie?$provide.provider({$httpBackend:ie8HttpBackendProvider}):void 0}),app.run(function($rootScope,$log,DebugUtilsService,FormDataStoreService,$bbug,$document,$sessionStorage,AppConfig){return $rootScope.$log=$log,$rootScope.$setIfUndefined=FormDataStoreService.setIfUndefined,$rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=$sessionStorage.getItem("host"),$bbug.support.opacity===!1?(document.createElement("header"),document.createElement("nav"),document.createElement("section"),document.createElement("footer")):void 0}),angular.module("BB.Services",["ngResource","ngSanitize","ngLocalData"]),angular.module("BB.Controllers",["ngLocalData","ngSanitize"]),angular.module("BB.Directives",[]),angular.module("BB.Filters",[]),angular.module("BB.Models",[]),window.bookingbug={logout:function(options){var logout_opts;return options||(options={}),options.reload!==!1&&(options.reload=!0),logout_opts={app_id:"f6b16c23",app_key:"f0bc4f65f4fbfe7b4b3b7264b655f5eb"},options.root&&(logout_opts.root=options.root),angular.injector(["BB.Services","BB.Models","ng"]).get("LoginService").logout(logout_opts),options.reload?window.location.reload():void 0}},moment.locale("en",{longDateFormat:{LLLL:"dddd Do MMMM[,] h.mma"}})}).call(this),angular.module("BB.Services").provider("ie8HttpBackend",function(){function ieCreateHttpBackend($browser,XHR,$browserDefer,callbacks,rawDocument,locationProtocol,msie,xhr){function completeRequest(callback,status,response,headersString){var url=url||$browser.url(),URL_MATCH=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,protocol=(url.match(URL_MATCH)||["",locationProtocol])[1];status="file"==protocol?response?200:404:status,status=1223==status?204:status,callback(status,response,headersString),$browser.$$completeOutstandingRequest(angular.noop)}if(!msie||msie>9)return null;var getHostName=function(path){var a=document.createElement("a");return a.href=path,a.hostname},isLocalCall=function(reqUrl){var reqHost=getHostName(reqUrl),localHost=getHostName($browser.url());return""==reqHost?!0:(patt=new RegExp(localHost+"$","i"),patt.test(reqHost))},pmHandler=function(method,url,post,callback,headers,timeout,withCredentials){var win=$('[name="'+getHostName(url)+'"]')[0].id;pm({target:window.frames[win],type:"xhrRequest",data:{headers:headers,method:method,data:post,url:url},success:function(respObj){headers="Content-Type: "+respObj.contentType,respObj.authToken&&(headers+="\r\nAuth-Token: "+respObj.authToken),completeRequest(callback,respObj.statusCode.status,respObj.responseText,headers)},error:function(data){completeRequest(callback,500,"Error","Content-Type: text/plain")}})};return function(method,url,post,callback,headers,timeout,withCredentials){$browser.$$incOutstandingRequestCount(),url=url||$browser.url(),isLocalCall(url)?xhr(method,url,post,callback,headers,timeout,withCredentials):pmHandler(method,url,post,callback,headers,timeout,withCredentials),timeout>0&&$browserDefer(function(){status=-1,xdr.abort()},timeout)}}function int(str){return parseInt(str,10)}function createXhr(method){if(8>=msie&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument,locationProtocol,msie){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),8>=msie&&(script.onreadystatechange=function(){isString(script.readyState)&&/loaded|complete/.test(script.readyState)&&(script.onreadystatechange=null,callback({type:"load"}))}),rawDocument.body.appendChild(script),callback}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),status=1223===status?204:status,statusText=statusText||"",callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(angular.noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=angular.noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),angular.forEach(headers,function(value,key){angular.isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null,statusText="";status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),status===ABORTED&&10>msie||(statusText=xhr.statusText),completeRequest(callback,status||xhr.status,response,responseHeaders,statusText)}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}this.$get=["$browser","$window","$document","$sniffer",function($browser,$window,$document,$sniffer){var msie=$sniffer.msie,params=[$browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0],$window.location.protocol.replace(":",""),msie],param4ie=params.concat([createHttpBackend.apply(this,params)]);return ieCreateHttpBackend&&ieCreateHttpBackend.apply(this,param4ie)||createHttpBackend.apply(this,params)}];var lowercase=function(string){return angular.isString(string)?string.toLowerCase():string},msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]);isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1]));var lowercase=function(string){return angular.isString(string)?string.toLowerCase():string}});var NO_JQUERY={};!function(window,$,undefined){if(!("console"in window)){var c=window.console={};c.log=c.warn=c.error=c.debug=function(){}}$===NO_JQUERY&&($={fn:{},extend:function(){for(var a=arguments[0],i=1,len=arguments.length;len>i;i++){var b=arguments[i];for(var prop in b)a[prop]=b[prop]}return a}}),$.fn.pm=function(){return console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])"),this},$.pm=window.pm=function(options){pm.send(options)},$.pm.bind=window.pm.bind=function(type,fn,origin,hash,async_reply){pm.bind(type,fn,origin,hash,async_reply===!0)},$.pm.unbind=window.pm.unbind=function(type,fn){pm.unbind(type,fn)},$.pm.origin=window.pm.origin=null,$.pm.poll=window.pm.poll=200;var pm={send:function(options){var o=$.extend({},pm.defaults,options),target=o.target;if(!o.target)return void console.warn("postmessage target window required");if(!o.type)return void console.warn("postmessage type required");var msg={data:o.data,type:o.type};o.success&&(msg.callback=pm._callback(o.success)),o.error&&(msg.errback=pm._callback(o.error)),"postMessage"in target&&!o.hash?(pm._bind(),target.postMessage(JSON.stringify(msg),o.origin||"*")):(pm.hash._bind(),pm.hash.send(o,msg))},bind:function(type,fn,origin,hash,async_reply){pm._replyBind(type,fn,origin,hash,async_reply)},_replyBind:function(type,fn,origin,hash,isCallback){"postMessage"in window&&!hash?pm._bind():pm.hash._bind();var l=pm.data("listeners.postmessage");l||(l={},pm.data("listeners.postmessage",l));var fns=l[type];fns||(fns=[],l[type]=fns),fns.push({fn:fn,callback:isCallback,origin:origin||$.pm.origin})},unbind:function(type,fn){var l=pm.data("listeners.postmessage");if(l)if(type)if(fn){var fns=l[type];if(fns){for(var m=[],i=0,len=fns.length;len>i;i++){var o=fns[i];o.fn!==fn&&m.push(o)}l[type]=m}}else delete l[type];else for(var i in l)delete l[i]},data:function(k,v){return v===undefined?pm._data[k]:(pm._data[k]=v,v)},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var r=[],i=0;32>i;i++)r[i]=pm._CHARS[0|32*Math.random()];return r.join("")},_callback:function(fn){var cbs=pm.data("callbacks.postmessage");cbs||(cbs={},pm.data("callbacks.postmessage",cbs));var r=pm._random();return cbs[r]=fn,r},_bind:function(){pm.data("listening.postmessage")||(window.addEventListener?window.addEventListener("message",pm._dispatch,!1):window.attachEvent&&window.attachEvent("onmessage",pm._dispatch),pm.data("listening.postmessage",1))},_dispatch:function(e){function sendReply(data){msg.callback&&pm.send({target:e.source,data:data,type:msg.callback})}try{var msg=JSON.parse(e.data)}catch(ex){return void console.warn("postmessage data invalid json: ",ex)}if(!msg.type)return void console.warn("postmessage message type required");var cbs=pm.data("callbacks.postmessage")||{},cb=cbs[msg.type];if(cb)cb(msg.data);else for(var l=pm.data("listeners.postmessage")||{},fns=l[msg.type]||[],i=0,len=fns.length;len>i;i++){var o=fns[i];if(o.origin&&"*"!==o.origin&&e.origin!==o.origin){if(console.warn("postmessage message origin mismatch",e.origin,o.origin),msg.errback){var error={message:"postmessage origin mismatch",origin:[e.origin,o.origin]};pm.send({target:e.source,data:error,type:msg.errback})}}else try{o.callback?o.fn(msg.data,sendReply,e):sendReply(o.fn(msg.data,e))}catch(ex){if(!msg.errback)throw ex;pm.send({target:e.source,data:ex,type:msg.errback})}}}};pm.hash={send:function(options,msg){var target_window=options.target,target_url=options.url;if(!target_url)return void console.warn("postmessage target window url is required");target_url=pm.hash._url(target_url);var source_window,source_url=pm.hash._url(window.location.href);if(window==target_window.parent)source_window="parent";else try{for(var i=0,len=parent.frames.length;len>i;i++){var f=parent.frames[i];if(f==window){source_window=i;break}}}catch(ex){source_window=window.name}if(null==source_window)return void console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list");var hashmessage={"x-requested-with":"postmessage",source:{name:source_window,url:source_url},postmessage:msg},hash_id="#x-postmessage-id="+pm._random();target_window.location=target_url+hash_id+encodeURIComponent(JSON.stringify(hashmessage))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){pm.data("polling.postmessage")||(setInterval(function(){var hash=""+window.location.hash,m=pm.hash._regex.exec(hash);if(m){var id=m[1];pm.hash._last!==id&&(pm.hash._last=id,pm.hash._dispatch(hash.substring(pm.hash._regex_len)))}},$.pm.poll||200),pm.data("polling.postmessage",1))},_dispatch:function(hash){function sendReply(data){msg.callback&&pm.send({target:source_window,data:data,type:msg.callback,hash:!0,url:hash.source.url})}if(hash){try{if(hash=JSON.parse(decodeURIComponent(hash)),!("postmessage"===hash["x-requested-with"]&&hash.source&&null!=hash.source.name&&hash.source.url&&hash.postmessage))return}catch(ex){return}var msg=hash.postmessage,cbs=pm.data("callbacks.postmessage")||{},cb=cbs[msg.type];if(cb)cb(msg.data);else{var source_window;source_window="parent"===hash.source.name?window.parent:window.frames[hash.source.name];for(var l=pm.data("listeners.postmessage")||{},fns=l[msg.type]||[],i=0,len=fns.length;len>i;i++){var o=fns[i];if(o.origin){var origin=/https?\:\/\/[^\/]*/.exec(hash.source.url)[0];if("*"!==o.origin&&origin!==o.origin){if(console.warn("postmessage message origin mismatch",origin,o.origin),msg.errback){var error={message:"postmessage origin mismatch",origin:[origin,o.origin]};pm.send({target:source_window,data:error,type:msg.errback,hash:!0,url:hash.source.url})}continue}}try{o.callback?o.fn(msg.data,sendReply):sendReply(o.fn(msg.data))}catch(ex){if(!msg.errback)throw ex;pm.send({target:source_window,data:ex,type:msg.errback,hash:!0,url:hash.source.url})}}}}},_url:function(url){return(""+url).replace(/#.*$/,"")}},$.extend(pm,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})}(this,"undefined"==typeof jQuery?NO_JQUERY:jQuery),"JSON"in window&&window.JSON||(JSON={}),function(){function f(n){return 10>n?"0"+n:n}function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;length>i;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;length>i;i+=1)k=rep[i],"string"==typeof k&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;space>i;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){angular.module("schemaForm").config(function(schemaFormProvider,schemaFormDecoratorsProvider,sfPathProvider){var datetimepicker,timepicker;return timepicker=function(name,schema,options){var f;return"string"===schema.type&&"time"===schema.format?(f=schemaFormProvider.stdFormObj(name,schema,options),f.key=options.path,f.type="timepicker",options.lookup[sfPathProvider.stringify(options.path)]=f,f):void 0},schemaFormProvider.defaults.string.unshift(timepicker),datetimepicker=function(name,schema,options){var f;return"string"===schema.type&&"datetime"===schema.format?(f=schemaFormProvider.stdFormObj(name,schema,options),f.key=options.path,f.type="datetime",options.lookup[sfPathProvider.stringify(options.path)]=f,f):void 0},schemaFormProvider.defaults.string.unshift(datetimepicker),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","time","bootstrap_ui_time_form.html"),schemaFormDecoratorsProvider.createDirective("time","bootstrap_ui_time_form.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","datetime","bootstrap_ui_datetime_form.html"),schemaFormDecoratorsProvider.createDirective("datetime","bootstrap_ui_datetime_form.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","price","price_form.html"),schemaFormDecoratorsProvider.createDirective("price","price_form.html")})}.call(this),function(){window.Collection=function(){function Collection(){}return Collection}(),window.Collection.Base=function(){function Base(res,items,params){var clean_params,key,m,n,val;this.res=res,this.items=items,this.params=params,this.callbacks=[],clean_params={};for(key in params)val=params[key],null!=val&&(null!=val.id?clean_params[key+"_id"]=val.id:clean_params[key]=val);if(this.jparams=JSON.stringify(clean_params),res)for(n in res)m=res[n],this[n]=m}return Base.prototype.checkItem=function(item){var call,existingItem,i,index,j,k,len1,len2,len3,ref,ref1,ref2,results;if(!this.matchesParams(item))return this.deleteItem(item),!0;for(ref=this.items,index=i=0,len1=ref.length;len1>i;index=++i)if(existingItem=ref[index],item.self===existingItem.self){for(this.items[index]=item,ref1=this.callbacks,j=0,len2=ref1.length;len2>j;j++)call=ref1[j],call[1](item,"update");return!0}for(this.items.push(item),ref2=this.callbacks,results=[],k=0,len3=ref2.length;len3>k;k++)call=ref2[k],results.push(call[1](item,"add"));return results},Base.prototype.deleteItem=function(item){var call,i,len,len1,ref,results;if(len=this.items.length,this.items=this.items.filter(function(x){return x.self!==item.self}),this.items.length!==len){for(ref=this.callbacks,results=[],i=0,len1=ref.length;len1>i;i++)call=ref[i],results.push(call[1](item,"delete"));return results}},Base.prototype.getItems=function(){return this.items},Base.prototype.addCallback=function(obj,fn){var call,i,len1,ref;for(ref=this.callbacks,i=0,len1=ref.length;len1>i;i++)if(call=ref[i],call[0]===obj)return;return this.callbacks.push([obj,fn])},Base.prototype.matchesParams=function(item){return!0},Base}(),window.BaseCollections=function(){function BaseCollections(){this.collections=[]}return BaseCollections.prototype.count=function(){return this.collections.length},BaseCollections.prototype.add=function(col){return this.collections.push(col)},BaseCollections.prototype.checkItems=function(item){var col,i,len1,ref,results;for(ref=this.collections,results=[],i=0,len1=ref.length;len1>i;i++)col=ref[i],results.push(col.checkItem(item));return results},BaseCollections.prototype.deleteItems=function(item){var col,i,len1,ref,results;for(ref=this.collections,results=[],i=0,len1=ref.length;len1>i;i++)col=ref[i],results.push(col.deleteItem(item));return results},BaseCollections.prototype.find=function(prms){var clean_params,col,i,jprms,key,len1,ref,val;clean_params={};for(key in prms)val=prms[key],null!=val&&(null!=val.id?clean_params[key+"_id"]=val.id:clean_params[key]=val);for(jprms=JSON.stringify(clean_params),ref=this.collections,i=0,len1=ref.length;len1>i;i++)if(col=ref[i],jprms===col.jparams)return col},BaseCollections}()}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;window.Collection.Day=function(superClass){function Day(){return Day.__super__.constructor.apply(this,arguments)}return extend(Day,superClass),Day.prototype.checkItem=function(item){return Day.__super__.checkItem.apply(this,arguments)},Day}(window.Collection.Base),angular.module("BB.Services").provider("DayCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;window.Collection.Space=function(superClass){function Space(){return Space.__super__.constructor.apply(this,arguments)}return extend(Space,superClass),Space.prototype.checkItem=function(item){return Space.__super__.checkItem.apply(this,arguments)},Space}(window.Collection.Base),angular.module("BB.Services").provider("SpaceCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbAccordianRangeGroup",function(){return{restrict:"AE",replace:!0,scope:!0,require:"^?bbTimeRangeStacked",controller:"AccordianRangeGroup",link:function(scope,element,attrs,ctrl){return scope.options=scope.$eval(attrs.bbAccordianRangeGroup)||{},scope.options.using_stacked_items=null!=ctrl}}}),angular.module("BB.Controllers").controller("AccordianRangeGroup",function($scope,$attrs,$rootScope,$q,FormDataStoreService){var hasAvailability,setData,updateAvailability;return $scope.controller="public.controllers.AccordianRangeGroup",$scope.collaspe_when_time_selected=!0,$rootScope.connection_started.then(function(){return $scope.options&&$scope.options.range?$scope.init($scope.options.range[0],$scope.options.range[1],$scope.options):void 0}),$scope.setFormDataStoreId=function(id){return FormDataStoreService.init("AccordianRangeGroup"+id,$scope,[])},$scope.init=function(start_time,end_time,options){return $scope.setRange(start_time,end_time),$scope.collaspe_when_time_selected=options&&!options.collaspe_when_time_selected?!1:!0},$scope.setRange=function(start_time,end_time){return $scope.options||($scope.options=$scope.$eval($attrs.bbAccordianRangeGroup)||{}),$scope.start_time=start_time,$scope.end_time=end_time,setData()},setData=function(){var i,key,len,ref,ref1,slot;if($scope.accordian_slots=[],$scope.is_open=$scope.is_open||!1,$scope.has_availability=$scope.has_availability||!1,$scope.is_selected=$scope.is_selected||!1,$scope.options&&$scope.options.slots?$scope.source_slots=$scope.options.slots:$scope.day&&$scope.day.slots?$scope.source_slots=$scope.day.slots:$scope.source_slots=null,$scope.source_slots){if(angular.isArray($scope.source_slots))for(ref=$scope.source_slots,i=0,len=ref.length;len>i;i++)slot=ref[i],slot.time>=$scope.start_time&&slot.time<$scope.end_time&&$scope.accordian_slots.push(slot);else{ref1=$scope.source_slots;for(key in ref1)slot=ref1[key],slot.time>=$scope.start_time&&slot.time<$scope.end_time&&$scope.accordian_slots.push(slot)}return updateAvailability()}},updateAvailability=function(day,slot){var i,len,ref;if($scope.selected_slot=null,$scope.accordian_slots&&($scope.has_availability=hasAvailability()),day&&slot)day.date.isSame($scope.day.date)&&slot.time>=$scope.start_time&&slot.time<$scope.end_time&&($scope.selected_slot=slot);else for(ref=$scope.accordian_slots,i=0,len=ref.length;len>i;i++)if(slot=ref[i],slot.selected){$scope.selected_slot=slot;break}if($scope.selected_slot){if($scope.hideHeading=!0,$scope.is_selected=!0,$scope.collaspe_when_time_selected)return $scope.is_open=!1}else if($scope.is_selected=!1,$scope.collaspe_when_time_selected)return $scope.is_open=!1},hasAvailability=function(){var i,len,ref,slot;if(!$scope.accordian_slots)return!1;for(ref=$scope.accordian_slots,i=0,len=ref.length;len>i;i++)if(slot=ref[i],slot.availability()>0)return!0;return!1},$scope.$on("slotChanged",function(event,day,slot){return day&&slot?updateAvailability(day,slot):updateAvailability()}),$scope.$on("dataReloaded",function(event,earliest_slot){return setData()})})}.call(this),function(){angular.module("BB.Directives").directive("bbAddresses",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"AddressList"}}),angular.module("BB.Controllers").controller("AddressList",function($scope,$rootScope,$filter,$sniffer,AddressListService,FormDataStoreService){return $scope.controller="public.controllers.AddressList",$scope.manual_postcode_entry=!1,FormDataStoreService.init("AddressList",$scope,["show_complete_address"]),$rootScope.connection_started.then(function(_this){return function(){return $scope.client.postcode&&!$scope.bb.postcode&&($scope.bb.postcode=$scope.client.postcode),$scope.client.postcode&&$scope.bb.postcode&&$scope.client.postcode===$scope.bb.postcode&&!$scope.bb.address1&&($scope.bb.address1=$scope.client.address1,$scope.bb.address2=$scope.client.address2,$scope.bb.address3=$scope.client.address3,$scope.bb.address4=$scope.client.address4,$scope.bb.address5=$scope.client.address5),$scope.manual_postcode_entry=$scope.bb.postcode?!1:!0,$scope.show_complete_address=$scope.bb.address1?!0:!1,$scope.postcode_submitted?void 0:($scope.findByPostcode(),$scope.postcode_submitted=!1)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.findByPostcode=function(){return $scope.postcode_submitted=!0,$scope.bb.postcode?($scope.notLoaded($scope),AddressListService.query({company:$scope.bb.company,post_code:$scope.bb.postcode}).then(function(response){var addressArr,newaddr;addressArr=angular.isArray(response)?_.map(response,function(item,i){return{address:item.partialAddress,moniker:item.moniker}}):[{address:response.partialAddress,moniker:response.moniker}],1===addressArr.length&&$sniffer.msie&&(newaddr=[],newaddr.push(addressArr[0]),newaddr.push({address:""}),addressArr=newaddr),$scope.addresses=addressArr,$scope.bb.address=addressArr[0],$scope.client.address=addressArr[0],$scope.setLoaded($scope)},function(err){return $scope.show_complete_address=!0,$scope.postcode_submitted=!0,$scope.setLoaded($scope)})):void 0},$scope.showCompleteAddress=function(){return $scope.show_complete_address=!0,$scope.postcode_submitted=!1,$scope.bb.address&&$scope.bb.address.moniker?($scope.notLoaded($scope),AddressListService.getAddress({company:$scope.bb.company,id:$scope.bb.address.moniker}).then(function(response){var address,address2,address3,addressLine2,building_number,house_number,streetName;address=response,house_number="","string"==typeof address.buildingNumber?house_number=address.buildingNumber:null==address.buildingNumber&&(house_number=address.buildingName),"string"==typeof address.streetName?(streetName=address.streetName?address.streetName:"",$scope.bb.address1=house_number+" "+streetName):(addressLine2=address.addressLine2?address.addressLine2:"",$scope.bb.address1=house_number+" "+addressLine2),address.buildingName&&null==address.buildingNumber&&($scope.bb.address1=house_number,$scope.bb.address2=address.streetName,null!=address.county&&($scope.bb.address4=address.county)),"string"==typeof address.buildingNumber&&"string"==typeof address.buildingName&&"string"==typeof address.streetName&&(streetName=address.streetName?address.streetName:"",$scope.bb.address1=address.buildingName,$scope.bb.address2=address.buildingNumber+" "+streetName),null!=address.buildingName&&address.buildingName.match(/(^[^0-9]+$)/)&&(building_number=address.buildingNumber?address.buildingNumber:"",$scope.bb.address1=address.buildingName+" "+building_number,$scope.bb.address2=address.streetName),null==address.buildingNumber&&null==address.streetName&&($scope.bb.address1=address.buildingName,$scope.bb.address2=address.addressLine3,$scope.bb.address4=address.town),null!=address.companyName&&($scope.bb.address1=address.companyName,null==address.buildingNumber&&null==address.streetName?$scope.bb.address2=address.addressLine3:null==address.buildingNumber?(address2=address.buildingName?address.buildingName+", "+address.streetName:address.streetName,$scope.bb.address2=address2):null==address.buildingName&&null==address.addressLine2?$scope.bb.address2=address.buildingNumber+", "+address.streetName:$scope.bb.address2=address.buildingName,$scope.bb.address3=address.buildingName,address3=address.addressLine3&&null!=address.buildingNumber?address.addressLine3:null==address.addressLine2&&null!=address.buildingNumber?address.buildingNumber+" "+address.streetName:null==address.addressLine2&&null==address.buildingNumber&&null!=address.buildingName?address.addressLine3:"",$scope.bb.address3=address3,$scope.bb.address4=address.town,$scope.bb.address5="",$scope.bb.postcode=address.postCode),null==address.buildingName&&null==address.companyName&&null==address.county?(address2=null==address.addressLine2&&null==address.companyName?address.addressLine3:address.addressLine2,$scope.bb.address2=address2):null==address.buildingName&&null==address.companyName&&($scope.bb.address2=address.addressLine3),null!=address.buildingName&&null!=address.streetName&&null==address.companyName&&null!=address.addressLine3?null==address.addressLine3?$scope.bb.address3=address.buildingName:$scope.bb.address3=address.addressLine3:null==address.buildingName&&null==address.companyName&&null!=address.addressLine2?$scope.bb.address3=address.addressLine3:null==address.buildingName&&null!=address.streetName&&null==address.addressLine3&&($scope.bb.address3=address.addressLine3),$scope.bb.address4=address.town,null!=address.county&&($scope.bb.address5=address.county),$scope.setLoaded($scope)},function(err){return $scope.show_complete_address=!0,$scope.postcode_submitted=!1,$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong");
})):void 0},$scope.setManualPostcodeEntry=function(value){return $scope.manual_postcode_entry=value},$scope.$on("client_details:reset_search",function(event){return $scope.bb.address1=null,$scope.bb.address2=null,$scope.bb.address3=null,$scope.bb.address4=null,$scope.bb.address5=null,$scope.show_complete_address=!1,$scope.postcode_submitted=!1,$scope.bb.address=$scope.addresses[0]})})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbWidget",function(PathSvc,$http,$log,$templateCache,$compile,$q,AppConfig,$timeout,$bbug){var appendCustomPartials,getTemplate,renderTemplate,setupPusher,updatePartials;return getTemplate=function(template){var fromTemplateCache,partial,src;return partial=template?template:"main",fromTemplateCache=$templateCache.get(partial),fromTemplateCache?fromTemplateCache:(src=PathSvc.directivePartial(partial).$$unwrapTrustedValue(),$http.get(src,{cache:$templateCache}).then(function(response){return response.data}))},updatePartials=function(scope,element,prms){var i,j,len,ref;for(ref=element.children(),j=0,len=ref.length;len>j;j++)i=ref[j],$bbug(i).hasClass("custom_partial")&&$bbug(i).remove();return appendCustomPartials(scope,element,prms).then(function(){return scope.$broadcast("refreshPage")})},setupPusher=function(scope,element,prms){return $timeout(function(){return scope.pusher=new Pusher("c8d8cea659cc46060608"),scope.pusher_channel=scope.pusher.subscribe("widget_"+prms.design_id),scope.pusher_channel.bind("update",function(data){return updatePartials(scope,element,prms)})})},appendCustomPartials=function(scope,element,prms){var defer;return defer=$q.defer(),$http.get(prms.custom_partial_url).then(function(custom_templates){return $compile(custom_templates.data)(scope,function(custom,scope){var non_style,style,tag;return custom.addClass("custom_partial"),style=function(){var j,len,results;for(results=[],j=0,len=custom.length;len>j;j++)tag=custom[j],"STYLE"===tag.tagName&&results.push(tag);return results}(),non_style=function(){var j,len,results;for(results=[],j=0,len=custom.length;len>j;j++)tag=custom[j],"STYLE"!==tag.tagName&&results.push(tag);return results}(),$bbug("#widget_"+prms.design_id).html(non_style),element.append(style),scope.bb.path_setup=!0,defer.resolve(style)})}),defer.promise},renderTemplate=function(scope,element,design_mode,template){return $q.when(getTemplate(template)).then(function(template){return element.html(template).show(),design_mode&&element.append("<style widget_css scoped></style>"),$compile(element.contents())(scope)})},{restrict:"A",scope:{client:"=?",apiUrl:"@?",useParent:"="},transclude:!0,controller:"BBCtrl",link:function(scope,element,attrs,controller,transclude){var evaluator,init_params,prms;return null!=attrs.member&&(scope.client=attrs.member),evaluator=scope,scope.useParent&&null!=scope.$parent&&(evaluator=scope.$parent),init_params=evaluator.$eval(attrs.bbWidget),scope.initWidget(init_params),prms=scope.bb,prms.custom_partial_url&&(prms.design_id=prms.custom_partial_url.match(/^.*\/(.*?)$/)[1],$bbug("[ng-app='BB']").append("<div id='widget_"+prms.design_id+"'></div>")),scope.bb.partial_url&&(init_params.partial_url?AppConfig.partial_url=init_params.partial_url:AppConfig.partial_url=scope.bb.partial_url),transclude(scope,function(_this){return function(clone){return scope.has_content=clone.length>1||1===clone.length&&(!clone[0].wholeText||/\S/.test(clone[0].wholeText)),scope.has_content?prms.custom_partial_url?(appendCustomPartials(scope,element,prms),prms.update_design&&setupPusher(scope,element,prms),scope.$on("refreshPage",function(){return scope.showPage(scope.bb.current_page)})):(element.html(clone).show(),prms.design_mode&&element.append("<style widget_css scoped></style>"),$compile(element.contents())(scope)):(prms.custom_partial_url?appendCustomPartials(scope,element,prms).then(function(style){return $q.when(getTemplate()).then(function(template){return element.html(template).show(),$compile(element.contents())(scope),element.append(style),prms.update_design?setupPusher(scope,element,prms):void 0})}):prms.template?renderTemplate(scope,element,prms.design_mode,prms.template):renderTemplate(scope,element,prms.design_mode),scope.$on("refreshPage",function(){return renderTemplate(scope,element,prms.design_mode)}))}}(this))}}}),angular.module("BB.Controllers").controller("bbContentController",function($scope){return $scope.controller="public.controllers.bbContentController",$scope.initPage=function(_this){return function(){return $scope.setPageLoaded(),$scope.setLoadingPage(!1)}}(this)}),angular.module("BB.Controllers").controller("BBCtrl",function($scope,$location,$rootScope,halClient,$window,$http,$localCache,$q,$timeout,BasketService,LoginService,AlertService,$sce,$element,$compile,$sniffer,$modal,$log,BBModel,BBWidget,SSOService,ErrorService,AppConfig,QueryStringService,QuestionService,LocaleService,PurchaseService,$sessionStorage,$bbug,SettingsService,UriTemplate){var base,base1,con_started,first_call,restoreBasket,setupDefaults,widget_started;return $scope.cid="BBCtrl",$scope.controller="public.controllers.BBCtrl",$scope.bb=new BBWidget,AppConfig.uid=$scope.bb.uid,$scope.qs=QueryStringService,$scope.apiUrl&&($scope.bb||($scope.bb={}),$scope.bb.api_url=$scope.apiUrl),$rootScope.bb&&$rootScope.bb.api_url&&($scope.bb.api_url=$rootScope.bb.api_url,$rootScope.bb.partial_url?$scope.bb.partial_url=$rootScope.bb.partial_url:$scope.bb.partial_url=""),80!==$location.port()&&443!==$location.port()?(base=$scope.bb).api_url||(base.api_url=$location.protocol()+"://"+$location.host()+":"+$location.port()):(base1=$scope.bb).api_url||(base1.api_url=$location.protocol()+"://"+$location.host()),$scope.bb.stacked_items=[],first_call=!0,con_started=$q.defer(),$rootScope.connection_started=con_started.promise,widget_started=$q.defer(),$rootScope.widget_started=widget_started.promise,moment.locale([LocaleService,"en"]),$rootScope.Route={Company:0,Category:1,Service:2,Person:3,Resource:4,Duration:5,Date:6,Time:7,Client:8,Summary:9,Basket:10,Checkout:11,Slot:12,Event:13},$scope.Route=$rootScope.Route,$compile("<span bb-display-mode></span>")($scope,function(_this){return function(cloned,scope){return $bbug($element).append(cloned)}}(this)),$scope.set_company=function(_this){return function(prms){return $scope.initWidget(prms)}}(this),$scope.initWidget=function(_this){return function(prms){var url;if(null==prms&&(prms={}),_this.$init_prms=prms,con_started=$q.defer(),$rootScope.connection_started=con_started.promise,!$sniffer.msie||$sniffer.msie>9||!first_call)$scope.initWidget2();else{if($scope.bb.api_url&&(url=document.createElement("a"),url.href=$scope.bb.api_url,""===url.host||url.host===$location.host()||url.host===$location.host()+":"+$location.port()))return void $scope.initWidget2();$rootScope.iframe_proxy_ready?$scope.initWidget2():$scope.$on("iframe_proxy_ready",function(event,args){return args.iframe_proxy_ready?$scope.initWidget2():void 0})}}}(this),$scope.initWidget2=function(_this){return function(){var aff_promise,comp_category_id,comp_promise,comp_url,company_id,embed_params,get_total,k,match,params,prms,ref,setup_promises,setup_promises2,sso_admin_login,sso_member_login,total_id,v;if($scope.init_widget_started=!0,prms=_this.$init_prms,prms.query){ref=prms.query;for(k in ref)v=ref[k],prms[k]=QueryStringService(v)}return prms.custom_partial_url?($scope.bb.custom_partial_url=prms.custom_partial_url,$scope.bb.partial_id=prms.custom_partial_url.substring(prms.custom_partial_url.lastIndexOf("/")+1),prms.update_design&&($scope.bb.update_design=prms.update_design)):prms.design_mode&&($scope.bb.design_mode=prms.design_mode),company_id=$scope.bb.company_id,prms.company_id&&(company_id=prms.company_id),prms.affiliate_id&&($scope.bb.affiliate_id=prms.affiliate_id,$rootScope.affiliate_id=prms.affiliate_id),prms.api_url&&($scope.bb.api_url=prms.api_url),prms.partial_url&&($scope.bb.partial_url=prms.partial_url),prms.page_suffix&&($scope.bb.page_suffix=prms.page_suffix),prms.admin&&($scope.bb.isAdmin=prms.admin),prms.auth_token&&$sessionStorage.setItem("auth_token",prms.auth_token),$scope.bb.app_id=1,$scope.bb.app_key=1,$scope.bb.clear_basket=!0,prms.basket&&($scope.bb.clear_basket=!1),prms.clear_basket===!1&&($scope.bb.clear_basket=!1),($window.bb_setup||prms.client)&&(prms.clear_member||(prms.clear_member=!0)),$scope.bb.client_defaults=prms.client||{},prms.client_defaults&&prms.client_defaults.membership_ref&&($scope.bb.client_defaults.membership_ref=prms.client_defaults.membership_ref),$scope.bb.client_defaults&&$scope.bb.client_defaults.name&&(match=$scope.bb.client_defaults.name.match(/^(\S+)(?:\s(\S+))?/),match&&($scope.bb.client_defaults.first_name=match[1],null!=match[2]&&($scope.bb.client_defaults.last_name=match[2]))),prms.clear_member&&($scope.bb.clear_member=prms.clear_member,$sessionStorage.removeItem("login")),prms.app_id&&($scope.bb.app_id=prms.app_id),prms.app_key&&($scope.bb.app_key=prms.app_key),prms.item_defaults?($scope.bb.original_item_defaults=prms.item_defaults,$scope.bb.item_defaults=angular.copy($scope.bb.original_item_defaults)):$scope.bb.original_item_defaults&&($scope.bb.item_defaults=angular.copy($scope.bb.original_item_defaults)),prms.route_format&&($scope.bb.setRouteFormat(prms.route_format),$scope.bb_route_init&&$scope.bb_route_init()),prms.locale&&moment.locale(prms.locale),prms.hide===!0?$scope.hide_page=!0:$scope.hide_page=!1,prms.custom_partial_url||($scope.bb.path_setup=!0),prms.reserve_without_questions&&($scope.bb.reserve_without_questions=prms.reserve_without_questions),prms.extra_setup&&($scope.bb.extra_setup=prms.extra_setup,prms.extra_setup.step&&($scope.bb.starting_step_number=parseInt(prms.extra_setup.step)),prms.extra_setup.return_url&&($scope.bb.return_url=prms.extra_setup.return_url),prms.extra_setup.destination&&($scope.bb.destination=prms.extra_setup.destination)),prms.template&&($scope.bb.template=prms.template),prms.i18n&&SettingsService.enableInternationalizaton(),prms.private_note&&($scope.bb.private_note=prms.private_note),prms.qudini_booking_id&&($scope.bb.qudini_booking_id=prms.qudini_booking_id),prms.scroll_offset&&SettingsService.setScrollOffset(prms.scroll_offset),_this.waiting_for_conn_started_def=$q.defer(),$scope.waiting_for_conn_started=_this.waiting_for_conn_started_def.promise,company_id||$scope.bb.affiliate_id?$scope.waiting_for_conn_started=$rootScope.connection_started:_this.waiting_for_conn_started_def.resolve(),widget_started.resolve(),setup_promises2=[],setup_promises=[],$scope.bb.affiliate_id&&(aff_promise=halClient.$get($scope.bb.api_url+"/api/v1/affiliates/"+$scope.bb.affiliate_id),setup_promises.push(aff_promise),aff_promise.then(function(affiliate){var comp_p,comp_promise;return $scope.bb.$wait_for_routing&&setup_promises2.push($scope.bb.$wait_for_routing.promise),$scope.setAffiliate(new BBModel.Affiliate(affiliate)),$scope.bb.item_defaults.affiliate=$scope.affiliate,prms.company_ref?(comp_p=$q.defer(),comp_promise=$scope.affiliate.getCompanyByRef(prms.company_ref),setup_promises2.push(comp_p.promise),comp_promise.then(function(company){return $scope.setCompany(company,prms.keep_basket).then(function(val){return comp_p.resolve(val)},function(err){return comp_p.reject(err)})},function(err){return comp_p.reject(err)})):void 0})),company_id&&(prms.embed&&(embed_params=prms.embed),embed_params||(embed_params=null),comp_category_id=null,null!=$scope.bb.item_defaults.category&&(comp_category_id=null!=$scope.bb.item_defaults.category.id?$scope.bb.item_defaults.category.id:$scope.bb.item_defaults.category),comp_url=new UriTemplate($scope.bb.api_url+"/api/v1/company/{company_id}{?embed,category_id}").fillFromObject({company_id:company_id,category_id:comp_category_id,embed:embed_params}),comp_promise=halClient.$get(comp_url),setup_promises.push(comp_promise),comp_promise.then(function(company){var child,comp,cprom,parent_company;return $scope.bb.$wait_for_routing&&setup_promises2.push($scope.bb.$wait_for_routing.promise),comp=new BBModel.Company(company),cprom=$q.defer(),setup_promises2.push(cprom.promise),child=null,comp.companies&&$scope.bb.item_defaults.company&&(child=comp.findChildCompany($scope.bb.item_defaults.company)),child?(parent_company=comp,halClient.$get($scope.bb.api_url+"/api/v1/company/"+child.id).then(function(company){return comp=new BBModel.Company(company),setupDefaults(comp.id),$scope.bb.parent_company=parent_company,$scope.setCompany(comp,prms.keep_basket).then(function(){return cprom.resolve()},function(err){return cprom.reject()})},function(err){return cprom.reject()})):(setupDefaults(comp.id),$scope.setCompany(comp,prms.keep_basket).then(function(){return cprom.resolve()},function(err){return cprom.reject()}))}),prms.member_sso&&(params={company_id:company_id,root:$scope.bb.api_url,member_sso:prms.member_sso},sso_member_login=SSOService.memberLogin(params).then(function(client){return $scope.setClient(client)}),setup_promises.push(sso_member_login)),prms.admin_sso&&(params={company_id:prms.parent_company_id?prms.parent_company_id:company_id,root:$scope.bb.api_url,admin_sso:prms.admin_sso},sso_admin_login=SSOService.adminLogin(params).then(function(admin){return $scope.bb.admin=admin}),setup_promises.push(sso_admin_login)),total_id=QueryStringService("total_id"),total_id&&(params={purchase_id:total_id,url_root:$scope.bb.api_url},get_total=PurchaseService.query(params).then(function(total){return $scope.bb.total=total,total.paid>0?$scope.bb.payment_status="complete":void 0}),setup_promises.push(get_total))),$scope.isLoaded=!1,$q.all(setup_promises).then(function(){return $q.all(setup_promises2).then(function(){var base2,clear_prom,def_clear;return $scope.bb.basket||(base2=$scope.bb).basket||(base2.basket=new BBModel.Basket(null,$scope.bb)),$scope.client||$scope.clearClient(),def_clear=$q.defer(),clear_prom=def_clear.promise,$scope.bb.current_item?def_clear.resolve():clear_prom=$scope.clearBasketItem(),clear_prom.then(function(){var page;return $scope.client_details||($scope.client_details=new BBModel.ClientDetails),$scope.bb.stacked_items||($scope.bb.stacked_items=[]),!$scope.bb.company&&!$scope.bb.affiliate||(con_started.resolve(),$scope.done_starting=!0,prms.no_route)?void 0:(page=null,first_call&&$bbug.isEmptyObject($scope.bb.routeSteps)&&(page=$scope.bb.firstStep),prms.first_page&&(page=prms.first_page),first_call=!1,$scope.decideNextPage(page))})},function(err){return con_started.reject("Failed to start widget"),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return con_started.reject("Failed to start widget"),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),setupDefaults=function(_this){return function(company_id){var category,clinic,def,event,event_group,k,person,ref,resource,service,v;if(def=$q.defer(),first_call||$scope.bb.orginal_company_id&&$scope.bb.orginal_company_id!==company_id){if($scope.bb.orginal_company_id=company_id,$scope.bb.default_setup_promises=[],$scope.bb.item_defaults.query){ref=$scope.bb.item_defaults.query;for(k in ref)v=ref[k],$scope.bb.item_defaults[k]=QueryStringService(v)}$scope.bb.item_defaults.resource&&(resource=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/resources/"+$scope.bb.item_defaults.resource),$scope.bb.default_setup_promises.push(resource),resource.then(function(res){return $scope.bb.item_defaults.resource=new BBModel.Resource(res)})),$scope.bb.item_defaults.person&&(person=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/people/"+$scope.bb.item_defaults.person),$scope.bb.default_setup_promises.push(person),person.then(function(res){return $scope.bb.item_defaults.person=new BBModel.Person(res)})),$scope.bb.item_defaults.person_ref&&(person=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/people/find_by_ref/"+$scope.bb.item_defaults.person_ref),$scope.bb.default_setup_promises.push(person),person.then(function(res){return $scope.bb.item_defaults.person=new BBModel.Person(res)})),$scope.bb.item_defaults.service&&(service=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/services/"+$scope.bb.item_defaults.service),$scope.bb.default_setup_promises.push(service),service.then(function(res){return $scope.bb.item_defaults.service=new BBModel.Service(res)})),$scope.bb.item_defaults.service_ref&&(service=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/services?api_ref="+$scope.bb.item_defaults.service_ref),$scope.bb.default_setup_promises.push(service),service.then(function(res){return $scope.bb.item_defaults.service=new BBModel.Service(res)})),$scope.bb.item_defaults.event_group&&(event_group=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/event_groups/"+$scope.bb.item_defaults.event_group),$scope.bb.default_setup_promises.push(event_group),event_group.then(function(res){return $scope.bb.item_defaults.event_group=new BBModel.EventGroup(res)})),$scope.bb.item_defaults.event&&(event=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/events/"+$scope.bb.item_defaults.event),$scope.bb.default_setup_promises.push(event),event.then(function(res){return $scope.bb.item_defaults.event=new BBModel.Event(res)})),$scope.bb.item_defaults.category&&(category=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/categories/"+$scope.bb.item_defaults.category),$scope.bb.default_setup_promises.push(category),category.then(function(res){return $scope.bb.item_defaults.category=new BBModel.Category(res)})),$scope.bb.item_defaults.clinic&&(clinic=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/clinics/"+$scope.bb.item_defaults.clinic),$scope.bb.default_setup_promises.push(clinic),clinic.then(function(res){return $scope.bb.item_defaults.clinic=new BBModel.Clinic(res)})),$scope.bb.item_defaults.duration&&($scope.bb.item_defaults.duration=parseInt($scope.bb.item_defaults.duration)),$q.all($scope.bb.default_setup_promises)["finally"](function(){return def.resolve()})}else def.resolve();return def.promise}}(this),$scope.setLoadingPage=function(_this){return function(val){return $scope.loading_page=val}}(this),$scope.isLoadingPage=function(_this){return function(){return $scope.loading_page}}(this),$scope.$on("$locationChangeStart",function(_this){return function(event){var step;if($scope.bb.routeFormat)return $scope.bb.routing||(step=$scope.bb.matchURLToStep(),step&&$scope.loadStep(step)),$scope.bb.routing=!1}}(this)),$scope.showPage=function(_this){return function(route,dont_record_page){return $scope.bb.updateRoute(route),$scope.jumped=!1,$scope.isLoadingPage()?void 0:($window._gaq&&$window._gaq.push(["_trackPageview",route]),$scope.setLoadingPage(!0),$scope.bb.current_page===route?($scope.bb_main="",setTimeout(function(){return $scope.bb_main=$sce.trustAsResourceUrl($scope.bb.pageURL(route)),$scope.$apply()},0)):(AlertService.clear(),$scope.bb.current_page=route,dont_record_page||$scope.bb.recordCurrentPage(),$scope.notLoaded($scope),$scope.bb_main=$sce.trustAsResourceUrl($scope.bb.pageURL(route))),$rootScope.$broadcast("page:loaded"))}}(this),$scope.jumpToPage=function(_this){return function(route){return $scope.current_page=route,$scope.jumped=!0,$scope.bb_main=$sce.trustAsResourceUrl($scope.partial_url+route+$scope.page_suffix)}}(this),$scope.clearPage=function(){return $scope.bb_main=""},$scope.getPartial=function(file){return $scope.bb.pageURL(file)},$scope.setPageLoaded=function(){return $scope.setLoaded($scope)},$scope.setPageRoute=function(_this){return function(route){return $scope.bb.current_page_route=route,$scope.bb.routeSteps&&$scope.bb.routeSteps[route]?($scope.showPage($scope.bb.routeSteps[route]),!0):!1}}(this),$scope.decideNextPage=function(route){if(route){if("none"===route)return;if(!$scope.bb.total||"complete"!==$scope.bb.payment_status)return $scope.showPage(route);$scope.showPage("confirmation")}if($scope.bb.nextSteps&&$scope.bb.current_page&&$scope.bb.nextSteps[$scope.bb.current_page]&&!$scope.bb.routeSteps)return $scope.showPage($scope.bb.nextSteps[$scope.bb.current_page]);if(!$scope.client.valid()&&LoginService.isLoggedIn()&&($scope.client=new BBModel.Client(LoginService.member()._data)),$scope.bb.company&&$scope.bb.company.companies||!$scope.bb.company&&$scope.affiliate){if($scope.setPageRoute($rootScope.Route.Company))return;return $scope.showPage("company_list")}if($scope.bb.total&&"complete"===$scope.bb.payment_status)return $scope.showPage("confirmation");if($scope.bb.total&&"pending"===$scope.bb.payment_status)return $scope.showPage("payment");if($scope.bb.company.$has("event_groups")&&!$scope.bb.current_item.event_group&&!$scope.bb.current_item.service&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal||$scope.bb.company.$has("events")&&$scope.bb.current_item.event_group&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Event))return;return $scope.showPage("event_list")}if(!(!$scope.bb.company.$has("events")||!$scope.bb.current_item.event||$scope.bb.current_item.num_book||$scope.bb.current_item.tickets&&$scope.bb.current_item.tickets.qty||$scope.bb.current_item.product||$scope.bb.current_item.deal))return $scope.showPage("event");if($scope.bb.company.$has("services")&&!$scope.bb.current_item.service&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Service))return;return $scope.showPage("service_list")}if($scope.bb.company.$has("resources")&&!$scope.bb.current_item.resource&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Resource))return;return $scope.showPage("resource_list")}if($scope.bb.company.$has("people")&&!$scope.bb.current_item.person&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Person))return;return $scope.showPage("person_list")}if(!($scope.bb.current_item.duration||null!=$scope.bb.current_item.event||$scope.bb.current_item.product||$scope.bb.current_item.deal)){if($scope.setPageRoute($rootScope.Route.Duration))return;return $scope.showPage("duration_list")}if($scope.bb.current_item.days_link&&!$scope.bb.current_item.date&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.deal){if($scope.bb.company.$has("slots")){if($scope.setPageRoute($rootScope.Route.Slot))return;return $scope.showPage("slot_list")}if($scope.setPageRoute($rootScope.Route.Date))return;return $scope.showPage("day")}if(!(!$scope.bb.current_item.days_link||$scope.bb.current_item.time||null!=$scope.bb.current_item.event||$scope.bb.current_item.service&&"day"===$scope.bb.current_item.service.duration_unit||$scope.bb.current_item.deal)){if($scope.setPageRoute($rootScope.Route.Time))return;return $scope.showPage("time")}if(!(!$scope.bb.moving_booking||$scope.bb.current_item.ready&&$scope.bb.current_item.move_done))return $scope.showPage("check_move");if(!$scope.client.valid()){if($scope.setPageRoute($rootScope.Route.Client))return;return $scope.bb.isAdmin?$scope.showPage("client_admin"):$scope.showPage("client")}if(!($scope.bb.basket.readyToCheckout()&&$scope.bb.current_item.ready||!$scope.bb.current_item.item_details)&&$scope.bb.current_item.item_details.hasQuestions){if($scope.setPageRoute($rootScope.Route.Summary))return;return $scope.bb.isAdmin?$scope.showPage("check_items_admin"):$scope.showPage("check_items")}if($scope.bb.usingBasket&&(!$scope.bb.confirmCheckout||$scope.bb.company_settings.has_vouchers||$scope.bb.company.$has("coupon"))){if($scope.setPageRoute($rootScope.Route.Basket))return;return $scope.showPage("basket")}if($scope.bb.moving_booking&&$scope.bb.basket.readyToCheckout())return $scope.showPage("purchase");if($scope.bb.basket.readyToCheckout()&&null===$scope.bb.payment_status&&!$scope.bb.basket.waiting_for_checkout){if($scope.setPageRoute($rootScope.Route.Checkout))return;return $scope.showPage("checkout")}return"complete"===$scope.bb.payment_status?$scope.showPage("confirmation"):void 0},$scope.showCheckout=function(){return $scope.bb.current_item.ready},$scope.addItemToBasket=function(){var add_defer;if(add_defer=$q.defer(),$scope.bb.current_item.submitted||$scope.bb.moving_booking){if($scope.bb.current_item.submitted)return $scope.bb.current_item.submitted;add_defer.resolve()}else $scope.moveToBasket(),$scope.bb.current_item.submitted=$scope.updateBasket(),$scope.bb.current_item.submitted.then(function(basket){return add_defer.resolve(basket)},function(err){return 409===err.status&&($scope.bb.current_item.person=null,$scope.bb.current_item.resource=null,$scope.bb.current_item.setTime(null),$scope.bb.current_item.service&&$scope.bb.current_item.setService($scope.bb.current_item.service)),$scope.bb.current_item.submitted=null,add_defer.reject(err)});return add_defer.promise},$scope.updateBasket=function(){var add_defer,params;return add_defer=$q.defer(),params={member_id:$scope.client.id,member:$scope.client,items:$scope.bb.basket.items,bb:$scope.bb},BasketService.updateBasket($scope.bb.company,params).then(function(basket){var item,j,len,ref;for(ref=basket.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.storeDefaults($scope.bb.item_defaults),item.reserve_without_questions=$scope.bb.reserve_without_questions;return halClient.clearCache("time_data"),halClient.clearCache("events"),basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.setBasketItem(basket.items[0]),$scope.bb.current_item?add_defer.resolve(basket):$scope.clearBasketItem().then(function(){return add_defer.resolve(basket)})},function(err){var error_modal;return add_defer.reject(err),409===err.status?(halClient.clearCache("time_data"),halClient.clearCache("events"),$scope.bb.current_item.person=null,$scope.bb.current_item.selected_person=null,error_modal=$modal.open({templateUrl:$scope.getPartial("_error_modal"),controller:function($scope,$modalInstance){return $scope.message=ErrorService.getError("ITEM_NO_LONGER_AVAILABLE").msg,$scope.ok=function(){return $modalInstance.close()}}}),error_modal.result["finally"](function(){if(!$scope.bb.nextSteps)return $scope.decideNextPage();if($scope.setPageRoute($rootScope.Route.Date));else if(!$scope.setPageRoute($rootScope.Route.Event))return $scope.loadPreviousStep()})):void 0}),add_defer.promise},$scope.emptyBasket=function(){return!$scope.bb.basket.items||$scope.bb.basket.items&&0===$scope.bb.basket.items.length?void 0:BasketService.empty($scope.bb).then(function(basket){return $scope.bb.current_item.id&&delete $scope.bb.current_item.id,$scope.setBasket(basket)})},$scope.deleteBasketItem=function(item){return BasketService.deleteItem(item,$scope.bb.company,{bb:$scope.bb}).then(function(basket){return $scope.setBasket(basket)})},$scope.deleteBasketItems=function(items){var item,j,len,results;for(results=[],j=0,len=items.length;len>j;j++)item=items[j],results.push(BasketService.deleteItem(item,$scope.bb.company,{bb:$scope.bb}).then(function(basket){return $scope.setBasket(basket)}));return results},$scope.clearBasketItem=function(){var def;return def=$q.defer(),$scope.setBasketItem(new BBModel.BasketItem(null,$scope.bb)),$scope.bb.current_item.reserve_without_questions=$scope.bb.reserve_without_questions,$scope.bb.default_setup_promises?$q.all($scope.bb.default_setup_promises)["finally"](function(){return $scope.bb.current_item.setDefaults($scope.bb.item_defaults),$q.all($scope.bb.current_item.promises)["finally"](function(){return def.resolve()})}):def.resolve(),def.promise},$scope.setBasketItem=function(item){return $scope.bb.current_item=item,$scope.current_item=$scope.bb.current_item},$scope.setReadyToCheckout=function(ready){return $scope.bb.confirmCheckout=ready},$scope.moveToBasket=function(){return $scope.bb.basket.addItem($scope.bb.current_item)},$scope.quickEmptybasket=function(options){var def,preserve_stacked_items;return preserve_stacked_items=options&&options.preserve_stacked_items?!0:!1,preserve_stacked_items?($scope.bb.basket=new BBModel.Basket(null,$scope.bb),$scope.basket=$scope.bb.basket,$scope.bb.basket.company_id=$scope.bb.company_id,def=$q.defer(),def.resolve(),def.promise):($scope.bb.stacked_items=[],$scope.setBasket(new BBModel.Basket(null,$scope.bb)),$scope.clearBasketItem())},$scope.setBasket=function(basket){return $scope.bb.basket=basket,$scope.basket=basket,$scope.bb.basket.company_id=$scope.bb.company_id,$scope.bb.stacked_items?$scope.bb.setStackedItems(basket.timeItems()):void 0},$scope.logout=function(route){return $scope.client&&$scope.client.valid()?LoginService.logout({root:$scope.bb.api_url}).then(function(){return $scope.client=new BBModel.Client,$scope.decideNextPage(route)}):$scope.member?LoginService.logout({root:$scope.bb.api_url}).then(function(){return $scope.member=new BBModel.Member.Member,$scope.decideNextPage(route)}):void 0},$scope.setAffiliate=function(affiliate){return $scope.bb.affiliate_id=affiliate.id,$scope.bb.affiliate=affiliate,$scope.affiliate=affiliate,$scope.affiliate_id=affiliate.id},restoreBasket=function(){var restore_basket_defer;return restore_basket_defer=$q.defer(),$scope.quickEmptybasket().then(function(){var auth_token,href,params,status,uri;return auth_token=$sessionStorage.getItem("auth_token"),href=$scope.bb.api_url+"/api/v1/status{?company_id,affiliate_id,clear_baskets,clear_member}",params={company_id:$scope.bb.company_id,affiliate_id:$scope.bb.affiliate_id,clear_baskets:$scope.bb.clear_basket?"1":null,clear_member:$scope.bb.clear_member?"1":null},uri=new UriTemplate(href).fillFromObject(params),status=halClient.$get(uri,{auth_token:auth_token,no_cache:!0}),status.then(function(_this){return function(res){return res.$has("client")&&res.$get("client").then(function(client){return!$scope.client||$scope.client&&!$scope.client.valid()?$scope.client=new BBModel.Client(client):void 0}),res.$has("member")&&res.$get("member").then(function(member){return member=LoginService.setLogin(member),$rootScope.member=member,$scope.setClient(member)}),$scope.bb.clear_basket?restore_basket_defer.resolve():res.$has("baskets")?res.$get("baskets").then(function(baskets){var basket;return basket=_.find(baskets,function(b){return parseInt(b.company_id)===$scope.bb.company_id}),basket?(basket=new BBModel.Basket(basket,$scope.bb),basket.$get("items").then(function(items){var i,j,len,promises;for(items=function(){var j,len,results;for(results=[],j=0,len=items.length;len>j;j++)i=items[j],results.push(new BBModel.BasketItem(i));return results}(),j=0,len=items.length;len>j;j++)i=items[j],basket.addItem(i);return $scope.setBasket(basket),promises=[].concat.apply([],function(){var l,len1,results;for(results=[],l=0,len1=items.length;len1>l;l++)i=items[l],results.push(i.promises);return results}()),$q.all(promises).then(function(){return basket.items.length>0&&$scope.setBasketItem(basket.items[0]),restore_basket_defer.resolve()})})):restore_basket_defer.resolve()}):restore_basket_defer.resolve()}}(this),function(err){return restore_basket_defer.resolve()})}),restore_basket_defer.promise},$scope.setCompany=function(company,keep_basket){var defer;return defer=$q.defer(),$scope.bb.company_id=company.id,$scope.bb.company=company,$scope.company=company,$scope.bb.item_defaults.company=$scope.bb.company,company.$has("settings")?company.getSettings().then(function(_this){return function(settings){return $scope.bb.company_settings=settings,$scope.bb.company_settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),$scope.bb.company_settings.merge_people&&($scope.bb.item_defaults.merge_people=!0),$rootScope.bb_currency=$scope.bb.company_settings.currency,$scope.bb.currency=$scope.bb.company_settings.currency,$scope.bb.has_prices=$scope.bb.company_settings.has_prices,!$scope.bb.basket||$scope.bb.basket.company_id!==$scope.bb.company_id&&!keep_basket?restoreBasket().then(function(){return defer.resolve(),$scope.$emit("company:setup")}):(defer.resolve(),$scope.$emit("company:setup"))}}(this)):!$scope.bb.basket||$scope.bb.basket.company_id!==$scope.bb.company_id&&!keep_basket?restoreBasket().then(function(){
return defer.resolve(),$scope.$emit("company:setup")}):(defer.resolve(),$scope.$emit("company:setup")),defer.promise},$scope.recordStep=function(step,title){return $scope.bb.recordStep(step,title)},$scope.setStepTitle=function(title){return $scope.bb.steps[$scope.bb.current_step-1].title=title},$scope.getCurrentStepTitle=function(){var steps;return steps=$scope.bb.steps,_.compact(steps).length||(steps=$scope.bb.allSteps),$scope.bb.current_step?steps[$scope.bb.current_step-1].title:void 0},$scope.checkStepTitle=function(title){return $scope.bb.steps[$scope.bb.current_step-1].title?void 0:$scope.setStepTitle(title)},$scope.loadStep=function(step){var j,len,prev_step,ref,st;if(step!==$scope.bb.current_step&&($scope.bb.calculatePercentageComplete(step),st=$scope.bb.steps[step],prev_step=$scope.bb.steps[step-1],st&&!prev_step&&(prev_step=st),st||(st=prev_step),st&&!$scope.bb.last_step_reached&&(st.stacked_length&&0!==st.stacked_length||($scope.bb.stacked_items=[]),$scope.bb.current_item.loadStep(st.current_item),$scope.bb.steps.splice(step,$scope.bb.steps.length-step),$scope.bb.current_step=step,$scope.showPage(prev_step.page,!0)),$scope.bb.allSteps)){for(ref=$scope.bb.allSteps,j=0,len=ref.length;len>j;j++)step=ref[j],step.active=!1,step.passed=step.number<$scope.bb.current_step;if($scope.bb.allSteps[$scope.bb.current_step-1])return $scope.bb.allSteps[$scope.bb.current_step-1].active=!0}},$scope.loadPreviousStep=function(){var previousStep;return previousStep=$scope.bb.current_step-1,$scope.loadStep(previousStep)},$scope.loadStepByPageName=function(page_name){var j,len,ref,step;for(ref=$scope.bb.allSteps,j=0,len=ref.length;len>j;j++)if(step=ref[j],step.page===page_name)return $scope.loadStep(step.number);return $scope.loadStep(1)},$scope.restart=function(){return $rootScope.$broadcast("clear:formData"),$rootScope.$broadcast("widget:restart"),$scope.setLastSelectedDate(null),$scope.bb.last_step_reached=!1,$scope.loadStep(1)},$scope.setRoute=function(rdata){return $scope.bb.setRoute(rdata)},$scope.setBasicRoute=function(routes){return $scope.bb.setBasicRoute(routes)},$scope.skipThisStep=function(){return $scope.bb.current_step-=1},$scope.setUsingBasket=function(_this){return function(usingBasket){return $scope.bb.usingBasket=usingBasket}}(this),$scope.setClient=function(_this){return function(client){return $scope.client=client,client.postcode&&!$scope.bb.postcode?$scope.bb.postcode=client.postcode:void 0}}(this),$scope.clearClient=function(_this){return function(){return $scope.client=new BBModel.Client,$window.bb_setup&&$scope.client.setDefaults($window.bb_setup),$scope.bb.client_defaults?$scope.client.setDefaults($scope.bb.client_defaults):void 0}}(this),$scope.today=moment().toDate(),$scope.tomorrow=moment().add(1,"days").toDate(),$scope.parseDate=function(_this){return function(d){return moment(d)}}(this),$scope.getUrlParam=function(_this){return function(param){return $window.getURIparam(param)}}(this),$scope.base64encode=function(_this){return function(param){return $window.btoa(param)}}(this),$scope.setLastSelectedDate=function(_this){return function(date){return $scope.last_selected_date=date}}(this),$scope.setLoaded=function(cscope){var loadingFinished;for(cscope.$emit("hide:loader",cscope),cscope.isLoaded=!0,loadingFinished=!0;cscope;)cscope.hasOwnProperty("scopeLoaded")&&($scope.areScopesLoaded(cscope)?cscope.scopeLoaded=!0:loadingFinished=!1),cscope=cscope.$parent;loadingFinished&&$rootScope.$broadcast("loading:finished")},$scope.setLoadedAndShowError=function(scope,err,error_string){return $log.warn(err,error_string),scope.setLoaded(scope),409===err.status?AlertService.danger(ErrorService.getError("ITEM_NO_LONGER_AVAILABLE")):err.data&&"Number of Bookings exceeds the maximum"===err.data.error?AlertService.danger(ErrorService.getError("MAXIMUM_TICKETS")):AlertService.danger(ErrorService.getError("GENERIC"))},$scope.areScopesLoaded=function(cscope){var child;if(cscope.hasOwnProperty("isLoaded")&&!cscope.isLoaded)return!1;for(child=cscope.$$childHead;child;){if(!$scope.areScopesLoaded(child))return!1;child=child.$$nextSibling}return!0},$scope.notLoaded=function(cscope){for($scope.$emit("show:loader",$scope),cscope.isLoaded=!1;cscope;)cscope.hasOwnProperty("scopeLoaded")&&(cscope.scopeLoaded=!1),cscope=cscope.$parent},$scope.broadcastItemUpdate=function(_this){return function(){return $scope.$broadcast("currentItemUpdate",$scope.bb.current_item)}}(this),$scope.hidePage=function(){return $scope.hide_page=!0},$scope.bb.company_set=function(){return null!=$scope.bb.company_id},$scope.isAdmin=function(){return $scope.bb.isAdmin},$scope.isAdminIFrame=function(){var err,location;if(!$scope.bb.isAdmin)return!1;try{return location=$window.parent.location.href,location&&$window.parent.reload_dashboard?!0:!1}catch(_error){return err=_error,!1}},$scope.reloadDashboard=function(){return $window.parent.reload_dashboard()},$scope.$debounce=function(tim){return $scope._debouncing?!1:(tim||(tim=100),$scope._debouncing=!0,$timeout(function(){return $scope._debouncing=!1},tim))},$scope.supportsTouch=function(){return Modernizr.touch},$rootScope.$on("show:loader",function(){return $scope.loading=!0}),$rootScope.$on("hide:loader",function(){return $scope.loading=!1}),String.prototype.parameterise=function(seperator){return null==seperator&&(seperator="-"),this.trim().replace(/\s/g,seperator).toLowerCase()},$scope.isMemberLoggedIn=function(){return LoginService.isLoggedIn()}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMiniBasket",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"MiniBasket"}}),angular.module("BB.Controllers").controller("MiniBasket",function($scope,$rootScope,BasketService,$q){return $scope.controller="public.controllers.MiniBasket",$scope.setUsingBasket(!0),$rootScope.connection_started.then(function(_this){return function(){}}(this)),$scope.basketDescribe=function(_this){return function(nothing,single,plural){return $scope.bb.basket&&0!==$scope.bb.basket.length()?1===$scope.bb.basket.length()?single:plural.replace("$0",$scope.bb.basket.length()):nothing}}(this)}),angular.module("BB.Directives").directive("bbBasketList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"BasketList"}}),angular.module("BB.Controllers").controller("BasketList",function($scope,$element,$attrs,$rootScope,BasketService,$q,AlertService,ErrorService,FormDataStoreService,LoginService){return $scope.controller="public.controllers.BasketList",$scope.setUsingBasket(!0),$scope.show_wallet=$scope.bb.company_settings.hasOwnProperty("has_wallets")&&$scope.bb.company_settings.has_wallets&&$scope.client.valid()&&LoginService.isLoggedIn()&&LoginService.member().id===$scope.client.id&&$scope.client.has_active_wallet,$scope.basket_options=$scope.$eval($attrs.bbBasketList)||{},$rootScope.connection_started.then(function(){var basket_item,i,len,params,promises,ref;if($scope.client.$has("pre_paid_bookings")){for($scope.notLoaded($scope),promises=[],ref=$scope.bb.basket.timeItems(),i=0,len=ref.length;len>i;i++)basket_item=ref[i],params={event_id:basket_item.getEventId()},promises.push($scope.client.getPrePaidBookingsPromise(params));return $q.all(promises).then(function(result){var index,j,len1,prepaid_bookings,ref1;for(ref1=$scope.bb.basket.timeItems(),index=j=0,len1=ref1.length;len1>j;index=++j)basket_item=ref1[index],prepaid_bookings=result[index],$scope.basket_options.auto_use_prepaid_bookings&&prepaid_bookings.length>0&&basket_item.setPrepaidBooking(prepaid_bookings[0]);return $scope.setLoaded($scope)},function(err){return $scope.setLoaded($scope)})}}),$scope.addAnother=function(_this){return function(route){return $scope.clearBasketItem(),$scope.bb.emptyStackedItems(),$scope.bb.current_item.setCompany($scope.bb.company),$scope.restart()}}(this),$scope.checkout=function(_this){return function(route){return $scope.setReadyToCheckout(!0),$scope.bb.basket.items.length>0?$scope.$parent.$has_page_control?!0:$scope.decideNextPage(route):(AlertService.clear(),AlertService.add("info",ErrorService.getError("EMPTY_BASKET_FOR_CHECKOUT")),!1)}}(this),$scope.setReady=function(){return $scope.checkout()},$scope.applyCoupon=function(_this){return function(coupon){var params;return AlertService.clear(),$scope.notLoaded($scope),params={bb:$scope.bb,coupon:coupon},BasketService.applyCoupon($scope.bb.company,params).then(function(basket){var i,item,len,ref;for(ref=basket.items,i=0,len=ref.length;len>i;i++)item=ref[i],item.storeDefaults($scope.bb.item_defaults),item.reserve_without_questions=$scope.bb.reserve_without_questions;return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.setLoaded($scope)},function(err){return err&&err.data&&err.data.error&&(AlertService.clear(),AlertService.add("danger",{msg:err.data.error})),$scope.setLoaded($scope)})}}(this),$scope.applyDeal=function(_this){return function(deal_code){var params;return AlertService.clear(),params=$scope.client?{bb:$scope.bb,deal_code:deal_code,member_id:$scope.client.id}:{bb:$scope.bb,deal_code:deal_code,member_id:null},BasketService.applyDeal($scope.bb.company,params).then(function(basket){var i,item,len,ref;for(ref=basket.items,i=0,len=ref.length;len>i;i++)item=ref[i],item.storeDefaults($scope.bb.item_defaults),item.reserve_without_questions=$scope.bb.reserve_without_questions;return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.items=$scope.bb.basket.items,$scope.deal_code=null},function(err){return err&&err.data&&err.data.error?(AlertService.clear(),AlertService.add("danger",{msg:err.data.error})):void 0})}}(this),$scope.removeDeal=function(_this){return function(deal_code){var params;return params={bb:$scope.bb,deal_code_id:deal_code.id},BasketService.removeDeal($scope.bb.company,params).then(function(basket){var i,item,len,ref;for(ref=basket.items,i=0,len=ref.length;len>i;i++)item=ref[i],item.storeDefaults($scope.bb.item_defaults),item.reserve_without_questions=$scope.bb.reserve_without_questions;return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.items=$scope.bb.basket.items},function(err){return err&&err.data&&err.data.error?(AlertService.clear(),AlertService.add("danger",{msg:err.data.error})):void 0})}}(this),$scope.topUpWallet=function(){return $scope.decideNextPage("basket_wallet")},$scope.setReady=function(){return $scope.bb.basket.items.length>0?$scope.setReadyToCheckout(!0):AlertService.add("info",ErrorService.getError("EMPTY_BASKET_FOR_CHECKOUT"))}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCategories",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CategoryList"}}),angular.module("BB.Controllers").controller("CategoryList",function($scope,$rootScope,CategoryService,$q,PageControllerService){return $scope.controller="public.controllers.CategoryList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(_this){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(_this){return function(comp){return CategoryService.query(comp).then(function(items){return $scope.items=items,1===items.length&&($scope.skipThisStep(),$rootScope.categories=items,$scope.selectItem(items[0],$scope.nextRoute)),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectItem=function(_this){return function(item,route){return $scope.bb.current_item.setCategory(item),$scope.decideNextPage(route)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCheckout",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Checkout"}}),angular.module("BB.Controllers").controller("Checkout",function($scope,$rootScope,$attrs,BasketService,$q,$location,$window,$bbug,FormDataStoreService,$timeout){return $scope.controller="public.controllers.Checkout",$scope.notLoaded($scope),$scope.options=$scope.$eval($attrs.bbCheckout)||{},FormDataStoreService.destroy($scope),$rootScope.connection_started.then(function(_this){return function(){return $scope.bb.basket.setClient($scope.client),$scope.options.no_notifications&&($scope.bb.no_notifications=$scope.options.no_notifications),$scope.loadingTotal=BasketService.checkout($scope.bb.company,$scope.bb.basket,{bb:$scope.bb}),$scope.loadingTotal.then(function(total){return $scope.total=total,total.$has("new_payment")||($scope.$emit("checkout:success",total),$scope.bb.total=$scope.total,$scope.bb.payment_status="complete",$scope.options.disable_confirmation||($scope.skipThisStep(),$scope.decideNextPage())),$scope.checkoutSuccess=!0,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong"),$scope.checkoutFailed=!0,$scope.$emit("checkout:fail",err)})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.print=function(_this){return function(){return $window.open($scope.bb.partial_url+"print_purchase.html?id="+$scope.total.long_id,"_blank","width=700,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0"),!0}}(this),$scope.printElement=function(id,stylesheet){var data,mywindow;return data=$bbug("#"+id).html(),mywindow=$window.open("","","height=600,width=800"),$timeout(function(){return mywindow.document.write("<html><head><title>Booking Confirmation</title>"),stylesheet&&mywindow.document.write('<link rel="stylesheet" href="'+stylesheet+'" type="text/css" />'),mywindow.document.write("</head><body>"),mywindow.document.write(data),mywindow.document.write("</body></html>"),$timeout(function(){return mywindow.document.close(),mywindow.focus(),mywindow.print(),mywindow.close()},100)},2e3)}})}.call(this),function(){angular.module("BB.Directives").directive("bbClientDetails",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ClientDetails"}}),angular.module("BB.Controllers").controller("ClientDetails",function($scope,$rootScope,ClientDetailsService,ClientService,LoginService,BBModel,ValidatorService,QuestionService,AlertService){return $scope.controller="public.controllers.ClientDetails",$scope.notLoaded($scope),$scope.validator=ValidatorService,$scope.existing_member=!1,$scope.login_error=!1,$rootScope.connection_started.then(function(_this){return function(){return!$scope.client.valid()&&LoginService.isLoggedIn()&&$scope.setClient(new BBModel.Client(LoginService.member()._data)),LoginService.isLoggedIn()&&LoginService.member().$has("child_clients")&&LoginService.member()&&LoginService.member().getChildClientsPromise().then(function(children){return $scope.bb.parent_client=new BBModel.Client(LoginService.member()._data),$scope.bb.child_clients=children,$scope.bb.basket.parent_client_id=$scope.bb.parent_client.id}),$scope.client.client_details?($scope.client_details=$scope.client.client_details,$scope.client_details.questions&&QuestionService.checkConditionalQuestions($scope.client_details.questions),$scope.setLoaded($scope)):ClientDetailsService.query($scope.bb.company).then(function(details){return $scope.client_details=details,$scope.client&&$scope.client.pre_fill_answers($scope.client_details),$scope.client_details.questions&&QuestionService.checkConditionalQuestions($scope.client_details.questions),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$rootScope.$watch("member",function(_this){return function(oldmem,newmem){return!$scope.client.valid()&&LoginService.isLoggedIn()?$scope.setClient(new BBModel.Client(LoginService.member()._data)):void 0}}(this)),$scope.validateClient=function(_this){return function(client_form,route){return $scope.notLoaded($scope),$scope.existing_member=!1,$scope.bb&&$scope.bb.parent_client&&($scope.client.parent_client_id=$scope.bb.parent_client.id),$scope.client.setClientDetails($scope.client_details),ClientService.create_or_update($scope.bb.company,$scope.client).then(function(client){return $scope.setLoaded($scope),$scope.setClient(client),$scope.bb.isAdmin&&$scope.client.setValid(!0),$scope.existing_member=!1,$scope.decideNextPage(route)},function(err){return"Please login"===err.data.error&&($scope.existing_member=!0,AlertService.danger({msg:"You have already registered with this email address. Please login or reset your password using the Forgot Password link below."})),$scope.setLoaded($scope)})}}(this),$scope.clientLogin=function(_this){return function(){return $scope.login_error=!1,$scope.login?LoginService.companyLogin($scope.bb.company,{},{email:$scope.login.email,password:$scope.login.password}).then(function(client){return $scope.setClient(new BBModel.Client(client)),$scope.login_error=!1,$scope.decideNextPage()},function(err){return $scope.login_error=!0,$scope.setLoaded($scope),AlertService.danger({msg:"Sorry, your email or password was not recognised. Please try again."})}):void 0}}(this),$scope.setReady=function(_this){return function(){var prom;return $scope.client.setClientDetails($scope.client_details),prom=ClientService.create_or_update($scope.bb.company,$scope.client),prom.then(function(client){return $scope.setLoaded($scope),$scope.setClient(client),client.waitingQuestions?client.gotQuestions.then(function(){return $scope.client_details=client.client_details}):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),prom}}(this),$scope.clientSearch=function(){return null!=$scope.client&&null!=$scope.client.email&&""!==$scope.client.email?($scope.notLoaded($scope),ClientService.query_by_email($scope.bb.company,$scope.client.email).then(function(client){return null!=client&&($scope.setClient(client),$scope.client=client),$scope.setLoaded($scope)},function(err){return $scope.setLoaded($scope)})):($scope.setClient({}),$scope.client={})},$scope.switchNumber=function(to){return $scope.no_mobile=!$scope.no_mobile,"mobile"===to?($scope.bb.basket.setSettings({send_sms_reminder:!0}),$scope.client.phone=null):($scope.bb.basket.setSettings({send_sms_reminder:!1}),$scope.client.mobile=null)},$scope.getQuestion=function(id){var i,len,question,ref;for(ref=$scope.client_details.questions,i=0,len=ref.length;len>i;i++)if(question=ref[i],question.id===id)return question;return null},$scope.useClient=function(client){return $scope.setClient(client)},$scope.recalc_question=function(){return $scope.client_details.questions?QuestionService.checkConditionalQuestions($scope.client_details.questions):void 0}})}.call(this),function(){"use strict";var CompanyListBase;CompanyListBase=function($scope,$rootScope,$q,$attrs){var options;return $scope.controller="public.controllers.CompanyList",$scope.notLoaded($scope),options=$scope.$eval($attrs.bbCompanies),$rootScope.connection_started.then(function(_this){return function(){if($scope.bb.company.companies)$scope.init($scope.bb.company),$rootScope.parent_id=$scope.bb.company.id;else if($rootScope.parent_id)return void $scope.initWidget({company_id:$rootScope.parent_id,first_page:$scope.bb.current_page});return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(_this){return function(comp){return $scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),1===$scope.companies.length?$scope.selectItem($scope.companies[0]):options&&options.hide_not_live_stores?$scope.items=$scope.companies.filter(function(c){return c.live}):$scope.items=$scope.companies,$scope.setLoaded($scope)}}(this),$scope.selectItem=function(_this){return function(item,route){var prms;return $scope.notLoaded($scope),prms={company_id:item.id},$scope.initWidget(prms)}}(this),$scope.splitString=function(company){var arr,result;return arr=company.name.split(" "),result=arr[2]?arr[2]:""}},angular.module("BB.Directives").directive("bbCompanies",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CompanyList"}}),angular.module("BB.Controllers").controller("CompanyList",CompanyListBase),angular.module("BB.Directives").directive("bbPostcodeLookup",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PostcodeLookup"}}),angular.module("BB.Controllers").controller("PostcodeLookup",function($scope,$rootScope,$q,ValidatorService,AlertService,$attrs){return $scope.controller="PostcodeLookup",angular.extend(this,new CompanyListBase($scope,$rootScope,$q,$attrs)),$scope.validator=ValidatorService,$scope.searchPostcode=function(_this){return function(form,prms){var promise;return $scope.notLoaded($scope),promise=ValidatorService.validatePostcode(form,prms),promise?promise.then(function(){var loc;return $scope.bb.postcode=ValidatorService.getGeocodeResult().address_components[0].short_name,$scope.postcode=$scope.bb.postcode,loc=ValidatorService.getGeocodeResult().geometry.location,$scope.selectItem($scope.getNearestCompany({center:loc}))},function(err){return $scope.setLoaded($scope)}):$scope.setLoaded($scope)}}(this),$scope.getNearestCompany=function(_this){return function(arg){var R,a,c,center,chLat,chLon,company,d,dLat,dLon,distances,i,lat1,lat2,latlong,len,lon1,lon2,pi,rLat1,rLat2,ref;for(center=arg.center,pi=Math.PI,R=6371,distances=[],lat1=center.lat(),lon1=center.lng(),ref=$scope.items,i=0,len=ref.length;len>i;i++)company=ref[i],company.address.lat&&company.address["long"]&&company.live&&(latlong=new google.maps.LatLng(company.address.lat,company.address["long"]),lat2=latlong.lat(),lon2=latlong.lng(),chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,company.distance=d,distances.push(company)),distances.sort(function(a,b){return a.distance-b.distance});return distances[0]}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCustomBookingText",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CustomBookingText"}}),angular.module("BB.Controllers").controller("CustomBookingText",function($scope,$rootScope,CustomTextService,$q){return $scope.controller="public.controllers.CustomBookingText",$scope.notLoaded($scope),$rootScope.connection_started.then(function(_this){return function(){return CustomTextService.BookingText($scope.bb.company,$scope.bb.current_item).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}),angular.module("BB.Directives").directive("bbCustomConfirmationText",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CustomConfirmationText"}}),angular.module("BB.Controllers").controller("CustomConfirmationText",function($scope,$rootScope,CustomTextService,$q,PageControllerService){return $scope.controller="public.controllers.CustomConfirmationText",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return $scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadData=function(_this){return function(){return $scope.total?CustomTextService.confirmationText($scope.bb.company,$scope.total).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.loadingTotal?$scope.loadingTotal.then(function(total){return CustomTextService.confirmationText($scope.bb.company,total).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMonthAvailability",function(){return{restrict:"A",replace:!0,scope:!0,controller:"DayList"}}),angular.module("BB.Controllers").controller("DayList",function($scope,$rootScope,$q,DayService,AlertService){return $scope.controller="public.controllers.DayList",$scope.notLoaded($scope),$scope.WeekHeaders=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],$scope.day_data={},$scope.type||($scope.type="month"),$scope.data_source||($scope.data_source=$scope.bb.current_item),$rootScope.connection_started.then(function(_this){return function(){return!$scope.current_date&&$scope.last_selected_date?$scope.current_date=$scope.last_selected_date.startOf($scope.type):$scope.current_date||($scope.current_date=moment().startOf($scope.type)),$scope.loadData()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.$on("currentItemUpdate",function(event){return $scope.loadData()}),$scope.setCalType=function(_this){return function(type){return $scope.type=type}}(this),$scope.setDataSource=function(_this){return function(source){return $scope.data_source=source}}(this),$scope.format_date=function(_this){return function(fmt){return $scope.current_date?$scope.current_date.format(fmt):void 0}}(this),$scope.format_start_date=function(_this){return function(fmt){return $scope.format_date(fmt)}}(this),$scope.format_end_date=function(_this){return function(fmt){return $scope.end_date?$scope.end_date.format(fmt):void 0}}(this),$scope.selectDay=function(_this){return function(day,route,force){return 0!==day.spaces||force?($scope.setLastSelectedDate(day.date),$scope.bb.current_item.setDate(day),$scope.$parent.$has_page_control?void 0:$scope.decideNextPage(route)):!1}}(this),$scope.setMonth=function(_this){return function(month,year){return $scope.current_date=moment().startOf("month").year(year).month(month-1),$scope.current_date.year(),$scope.type="month"}}(this),$scope.setWeek=function(_this){return function(week,year){return $scope.current_date=moment().year(year).isoWeek(week).startOf("week"),$scope.current_date.year(),$scope.type="week"}}(this),$scope.add=function(_this){return function(type,amount){return $scope.current_date.add(amount,type),$scope.loadData()}}(this),$scope.subtract=function(_this){return function(type,amount){return $scope.add(type,-amount)}}(this),$scope.isPast=function(_this){return function(){return $scope.current_date?moment().isAfter($scope.current_date):!0}}(this),$scope.loadData=function(_this){return function(){return"week"===$scope.type?$scope.loadWeek():$scope.loadMonth()}}(this),$scope.loadMonth=function(_this){return function(){var date,edate;return date=$scope.current_date,$scope.month=date.month(),$scope.notLoaded($scope),edate=moment(date).add(1,"months"),$scope.end_date=moment(edate).add(-1,"days"),$scope.data_source?DayService.query({company:$scope.bb.company,cItem:$scope.data_source,month:date.format("MMYY"),client:$scope.client}).then(function(days){var d,day,i,j,k,len,w,week,weeks;for($scope.days=days,i=0,len=days.length;len>i;i++)day=days[i],$scope.day_data[day.string_date]=day;for(weeks=[],w=j=0;5>=j;w=++j){for(week=[],d=k=0;6>=k;d=++k)week.push(days[7*w+d]);weeks.push(week)}return $scope.weeks=weeks,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this),$scope.loadWeek=function(_this){return function(){var date,edate;return date=$scope.current_date,$scope.notLoaded($scope),edate=moment(date).add(7,"days"),$scope.end_date=moment(edate).add(-1,"days"),$scope.data_source?DayService.query({company:$scope.bb.company,cItem:$scope.data_source,date:date.toISODate(),edate:edate.toISODate(),client:$scope.client}).then(function(days){var day,i,len;for($scope.days=days,i=0,len=days.length;len>i;i++)day=days[i],$scope.day_data[day.string_date]=day;return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this),$scope.setReady=function(_this){return function(){return $scope.bb.current_item.date?!0:(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a date"}),!1)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbDeals",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"DealList"}}),angular.module("BB.Controllers").controller("DealList",function($scope,$rootScope,DealService,$q,BBModel,AlertService,FormDataStoreService,ValidatorService,$modal){var ModalInstanceCtrl,init;return $scope.controller="public.controllers.DealList",FormDataStoreService.init("TimeRangeList",$scope,["deals"]),$rootScope.connection_started.then(function(){return init()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),init=function(){var deal_promise;return $scope.notLoaded($scope),$scope.deals?void 0:(deal_promise=DealService.query($scope.bb.company),deal_promise.then(function(deals){return $scope.deals=deals,$scope.setLoaded($scope)}))},$scope.selectDeal=function(deal){var iitem,modalInstance;return iitem=new BBModel.BasketItem(null,$scope.bb),iitem.setDefaults($scope.bb.item_defaults),iitem.setDeal(deal),$scope.bb.company_settings.no_recipient?($scope.notLoaded($scope),$scope.setBasketItem(iitem),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):(modalInstance=$modal.open({templateUrl:$scope.getPartial("_add_recipient"),scope:$scope,controller:ModalInstanceCtrl,resolve:{item:function(){return iitem}}}),modalInstance.result.then(function(item){return $scope.notLoaded($scope),$scope.setBasketItem(item),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}))},ModalInstanceCtrl=function($scope,$modalInstance,item,ValidatorService){return $scope.controller="ModalInstanceCtrl",$scope.item=item,$scope.recipient=!1,$scope.addToBasket=function(form){return ValidatorService.validateForm(form)?$modalInstance.close($scope.item):void 0},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},$scope.purchaseDeals=function(){return $scope.bb.basket.items&&$scope.bb.basket.items.length>0?$scope.decideNextPage():AlertService.add("danger",{msg:"You need to select at least one Gift Certificate to continue"})},$scope.setReady=function(){return $scope.bb.basket.items&&$scope.bb.basket.items.length>0?!0:AlertService.add("danger",{msg:"You need to select at least one Gift Certificate to continue"})}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbDurations",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"DurationList"}}),angular.module("BB.Controllers").controller("DurationList",function($scope,$rootScope,PageControllerService,$q,$attrs,AlertService){return $scope.controller="public.controllers.DurationList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return $scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadData=function(_this){return function(){var d,duration,i,id,initial_duration,len,ref,rem,service;if(id=$scope.bb.company_id,service=$scope.bb.current_item.service,service&&!$scope.durations){for($scope.durations=function(){
var i,len,ref,results;for(ref=_.zip(service.durations,service.prices),results=[],i=0,len=ref.length;len>i;i++)d=ref[i],results.push({value:d[0],price:d[1]});return results}(),initial_duration=$scope.$eval($attrs.bbInitialDuration),ref=$scope.durations,i=0,len=ref.length;len>i;i++)duration=ref[i],$scope.bb.current_item.duration&&duration.value===$scope.bb.current_item.duration?$scope.duration=duration:initial_duration&&initial_duration===duration.value&&($scope.duration=duration,$scope.bb.current_item.setDuration(duration.value)),duration.value<60?duration.pretty=duration.value+" minutes":60===duration.value?duration.pretty="1 hour":(duration.pretty=Math.floor(duration.value/60)+" hours",rem=duration.value%60,0!==rem&&(duration.pretty+=" "+rem+" minutes"));1===$scope.durations.length&&($scope.skipThisStep(),$scope.selectDuration($scope.durations[0],$scope.nextRoute))}return $scope.setLoaded($scope)}}(this),$scope.selectDuration=function(_this){return function(dur,route){return $scope.$parent.$has_page_control?void($scope.duration=dur):($scope.bb.current_item.setDuration(dur.value),$scope.decideNextPage(route),!0)}}(this),$scope.durationChanged=function(_this){return function(){return $scope.bb.current_item.setDuration($scope.duration.value),$scope.broadcastItemUpdate()}}(this),$scope.setReady=function(_this){return function(){return $scope.duration?($scope.bb.current_item.setDuration($scope.duration.value),!0):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a duration"}),!1)}}(this),$scope.$on("currentItemUpdate",function(event){return $scope.loadData()})})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEvent",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Event"}}),angular.module("BB.Controllers").controller("Event",function($scope,$attrs,$rootScope,EventService,$q,PageControllerService,BBModel,ValidatorService){return $scope.controller="public.controllers.Event",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$scope.event_options=$scope.$eval($attrs.bbEvent)||{},$rootScope.connection_started.then(function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var promises;return $scope.event=$scope.bb.current_item.event,promises=[$scope.current_item.event_group.getImagesPromise(),$scope.event.prepEvent()],$scope.client&&promises.push($scope.getPrePaidsForEvent($scope.client,$scope.event)),$q.all(promises).then(function(result){var i,image,len,ref,ticket;if(result[0]&&result[0].length>0&&(image=result[0][0],image.background_css={"background-image":"url("+image.url+")"},$scope.event.image=image),$scope.event.tickets[0].qty=$scope.event_options.default_num_tickets?$scope.event_options.default_num_tickets:0,$scope.event.tickets.length>1)for(ref=$scope.event.tickets.slice(1),i=0,len=ref.length;len>i;i++)ticket=ref[i],ticket.qty=0;return $scope.event_options.default_num_tickets&&$scope.event_options.auto_select_tickets&&1===$scope.event.tickets.length&&1===$scope.event.tickets[0].max_num_bookings&&$scope.selectTickets(),$scope.tickets=$scope.event.tickets,$scope.bb.basket.total_price=$scope.bb.basket.totalPrice(),$scope.stopTicketWatch=$scope.$watch("tickets",function(tickets,oldtickets){return $scope.bb.basket.total_price=$scope.bb.basket.totalPrice(),$scope.event.updatePrice()},!0),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.selectTickets=function(){var base_item,c,i,item,j,len,ref,ref1,ticket;for($scope.notLoaded($scope),$scope.bb.emptyStackedItems(),base_item=$scope.current_item,ref=$scope.event.tickets,i=0,len=ref.length;len>i;i++)if(ticket=ref[i],ticket.qty)switch($scope.event.chain.ticket_type){case"single_space":for(c=j=1,ref1=ticket.qty;ref1>=1?ref1>=j:j>=ref1;c=ref1>=1?++j:--j)item=new BBModel.BasketItem,angular.extend(item,base_item),delete item.id,item.tickets=angular.copy(ticket),item.tickets.qty=1,$scope.bb.stackItem(item);break;case"multi_space":item=new BBModel.BasketItem,angular.extend(item,base_item),item.tickets=angular.copy(ticket),delete item.id,item.tickets.qty=ticket.qty,$scope.bb.stackItem(item)}return 0===$scope.bb.stacked_items.length?void $scope.setLoaded($scope):($scope.bb.pushStackToBasket(),$scope.updateBasket().then(function(_this){return function(){return $scope.setLoaded($scope),$scope.selected_tickets=!0,$scope.stopTicketWatch(),$scope.tickets=function(){var k,len1,ref2,results;for(ref2=$scope.bb.basket.items,results=[],k=0,len1=ref2.length;len1>k;k++)item=ref2[k],results.push(item.tickets);return results}(),$scope.$watch("bb.basket.items",function(items,olditems){return $scope.bb.basket.total_price=$scope.bb.basket.totalPrice(),item.tickets.price=item.totalPrice()},!0)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},$scope.selectItem=function(_this){return function(item,route){return $scope.$parent.$has_page_control?($scope.event=item,!1):($scope.bb.current_item.setEvent(item),$scope.bb.current_item.ready=!1,$scope.decideNextPage(route),!0)}}(this),$scope.setReady=function(_this){return function(){return $scope.bb.event_details={name:$scope.event.chain.name,image:$scope.event.image,address:$scope.event.chain.address,datetime:$scope.event.date,end_datetime:$scope.event.end_datetime,duration:$scope.event.duration,tickets:$scope.event.tickets},$scope.updateBasket()}}(this),$scope.getPrePaidsForEvent=function(client,event){var defer,params;return defer=$q.defer(),params={event_id:event.id},client.getPrePaidBookingsPromise(params).then(function(prepaids){return $scope.pre_paid_bookings=prepaids,defer.resolve(prepaids)},function(err){return defer.reject(err)}),defer.promise}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEventGroups",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"EventGroupList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("EventGroupList",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService,PageControllerService,halClient){var setEventGroupItem;return $scope.controller="public.controllers.EventGroupList",FormDataStoreService.init("EventGroupList",$scope,["event_group"]),$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(_this){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),ppromise=comp.getEventGroupsPromise(),ppromise.then(function(items){var filterItems,i,item,j,len,len1;if(filterItems="false"===$attrs.filterServices?!1:!0,filterItems&&($scope.booking_item.service_ref&&!$scope.show_all?items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref}):$scope.booking_item.category&&!$scope.show_all&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.booking_item.category.self}))),1!==items.length||$scope.allowSinglePick?setEventGroupItem(items):$scope.selectItem(items[0],$scope.nextRoute)?$scope.skipThisStep():setEventGroupItem(items),$scope.booking_item.defaultService())for(i=0,len=items.length;len>i;i++)item=items[i],item.self===$scope.booking_item.defaultService().self&&$scope.selectItem(item,$scope.nextRoute);if($scope.booking_item.event_group)for(j=0,len1=items.length;len1>j;j++)item=items[j],item.selected=!1,item.self===$scope.booking_item.event_group.self&&($scope.event_group=item,item.selected=!0,$scope.booking_item.setEventGroup($scope.event_group));return $scope.setLoaded($scope),$scope.booking_item.event_group||!$scope.booking_item.person&&!$scope.booking_item.resource?$scope.bookable_services=$scope.items:void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},setEventGroupItem=function(items){return $scope.items=items,$scope.event_group?_.each(items,function(item){return item.id===$scope.event_group.id?$scope.event_group=item:void 0}):void 0},$scope.selectItem=function(_this){return function(item,route){return $scope.$parent.$has_page_control?($scope.event_group=item,!1):($scope.booking_item.setEventGroup(item),$scope.decideNextPage(route),!0)}}(this),$scope.$watch("event_group",function(_this){return function(newval,oldval){return!$scope.event_group||$scope.booking_item.event_group&&$scope.booking_item.event_group.self===$scope.event_group.self?void 0:($scope.booking_item.setEventGroup($scope.event_group),$scope.broadcastItemUpdate())}}(this)),$scope.setReady=function(_this){return function(){return $scope.event_group?($scope.booking_item.setEventGroup($scope.event_group),!0):!1}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEvents",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"EventList",link:function(scope,element,attrs){var options;scope.summary=null!=attrs.summary,options=scope.$eval(attrs.bbEvents||{}),scope.mode=options&&options.mode?options.mode:0,scope.summary&&(scope.mode=0)}}}),angular.module("BB.Controllers").controller("EventList",function($scope,$rootScope,EventService,EventChainService,$q,PageControllerService,FormDataStoreService,$filter,PaginationService){var buildDynamicFilters,filterEventsWithDynamicFilters,isFullyBooked,sort;return $scope.controller="public.controllers.EventList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.pick={},$scope.start_date=moment(),$scope.end_date=moment().add(1,"year"),$scope.filters={},$scope.price_options=[0,1e3,2500,5e3],$scope.pagination=PaginationService.initialise({page_size:10,max_size:5}),$scope.events={},$scope.fully_booked=!1,FormDataStoreService.init("EventList",$scope,["selected_date","event_group_id","event_group_manually_set"]),$rootScope.connection_started.then(function(){if($scope.bb.company){if(!$scope.bb.item_defaults.event)return $scope.bb.company.$has("parent")&&!$scope.bb.company.$has("company_questions")?$scope.bb.company.getParentPromise().then(function(parent){return $scope.company_parent=parent,$scope.initialise()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.initialise();$scope.skipThisStep(),$scope.decideNextPage()}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.initialise=function(){var event_group,promises;return $scope.notLoaded($scope),$scope.event_group_manually_set=null==$scope.event_group_manually_set&&null!=$scope.current_item.event_group?!0:!1,$scope.current_item.event&&0!==$scope.mode&&(event_group=$scope.current_item.event_group,$scope.clearBasketItem(),$scope.emptyBasket(),$scope.event_group_manually_set&&$scope.current_item.setEventGroup(event_group)),promises=[],$scope.bb.company.$has("company_questions")?promises.push($scope.bb.company.getCompanyQuestionsPromise()):null!=$scope.company_parent&&$scope.company_parent.$has("company_questions")?promises.push($scope.company_parent.getCompanyQuestionsPromise()):(promises.push($q.when([])),$scope.has_company_questions=!1),$scope.current_item.event_group?promises.push($q.when([])):promises.push($scope.bb.company.getEventGroupsPromise()),0===$scope.mode||2===$scope.mode?promises.push($scope.loadEventSummary()):promises.push($q.when([])),1===$scope.mode||2===$scope.mode?promises.push($scope.loadEventData()):promises.push($q.when([])),$q.all(promises).then(function(result){var company_questions,event_data,event_groups,event_summary;return company_questions=result[0],event_groups=result[1],event_summary=result[2],event_data=result[3],$scope.has_company_questions=null!=company_questions&&company_questions.length>0,company_questions&&buildDynamicFilters(company_questions),event_groups&&($scope.event_groups=_.indexBy(event_groups,"id")),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.loadEventSummary=function(){var comp,current_event,deferred,params;return deferred=$q.defer(),current_event=$scope.current_item.event,$scope.bb.current_item&&($scope.bb.current_item.event_chain_id||$scope.bb.current_item.event_chain)&&(delete $scope.bb.current_item.event_chain,delete $scope.bb.current_item.event_chain_id),comp=$scope.bb.company,params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},$scope.bb.item_defaults.event_chain&&(params.event_chain_id=$scope.bb.item_defaults.event_chain),EventService.summary(comp,params).then(function(items){var d,item,item_dates,j,len;if(items&&items.length>0){for(item_dates=[],j=0,len=items.length;len>j;j++)item=items[j],d=moment(item),item_dates.push({date:d,idate:parseInt(d.format("YYYYDDDD")),count:1,spaces:1});$scope.item_dates=item_dates.sort(function(a,b){return a.idate-b.idate}),0===$scope.mode&&($scope.selected_date&&($scope.selected_date.isAfter($scope.item_dates[0].date)||$scope.selected_date.isSame($scope.item_dates[0].date))&&($scope.selected_date.isBefore($scope.item_dates[$scope.item_dates.length-1].date)||$scope.selected_date.isSame($scope.item_dates[$scope.item_dates.length-1].date))?$scope.showDay($scope.selected_date):$scope.showDay($scope.item_dates[0].date))}return deferred.resolve($scope.item_dates)},function(err){return deferred.reject()}),deferred.promise},$scope.loadEventChainData=function(comp){var deferred,params;return deferred=$q.defer(),$scope.bb.item_defaults.event_chain?deferred.resolve([]):($scope.notLoaded($scope),comp||(comp=$scope.bb.company),params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},EventChainService.query(comp,params).then(function(events){return $scope.setLoaded($scope),deferred.resolve($scope.items)},function(err){return deferred.reject()})),deferred.promise},$scope.loadEventData=function(comp){var chains,current_event,deferred,params;return deferred=$q.defer(),current_event=$scope.current_item.event,$scope.notLoaded($scope),comp||(comp=$scope.bb.company),$scope.bb.current_item&&($scope.bb.current_item.event_chain_id||$scope.bb.current_item.event_chain)&&(delete $scope.bb.current_item.event_chain,delete $scope.bb.current_item.event_chain_id),params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},$scope.bb.item_defaults.event_chain&&(params.event_chain_id=$scope.bb.item_defaults.event_chain),chains=$scope.loadEventChainData(comp),$scope.events={},EventService.query(comp,params).then(function(events){var key,value;events=_.groupBy(events,function(event){return event.date.toISODate()});for(key in events)value=events[key],$scope.events[key]=value;return $scope.items=_.flatten(_.toArray($scope.events)),chains.then(function(){var idate,item,item_dates,j,k,len,len1,ref,x,y;for(ref=$scope.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.prepEvent(),0===$scope.mode&&current_event&&current_event.self===item.self&&(item.select(),$scope.event=item);if(1===$scope.mode)if(item_dates={},items.length>0){for(k=0,len1=items.length;len1>k;k++)item=items[k],item.getDuration(),idate=parseInt(item.date.format("YYYYDDDD")),item.idate=idate,item_dates[idate]||(item_dates[idate]={date:item.date,idate:idate,count:0,spaces:0}),item_dates[idate].count+=1,item_dates[idate].spaces+=item.num_spaces;$scope.item_dates=[];for(x in item_dates)y=item_dates[x],$scope.item_dates.push(y);$scope.item_dates=$scope.item_dates.sort(function(a,b){return a.idate-b.idate})}else idate=parseInt($scope.start_date.format("YYYYDDDD")),$scope.item_dates=[{date:$scope.start_date,idate:idate,count:0,spaces:0}];return isFullyBooked(),$scope.filtered_items=$scope.items,$scope.filterChanged(),PaginationService.update($scope.pagination,$scope.filtered_items.length),$scope.setLoaded($scope),deferred.resolve($scope.items)},function(err){return deferred.reject()})},function(err){return deferred.reject()}),deferred.promise},isFullyBooked=function(){var full_events,item,j,len,ref;for(full_events=[],ref=$scope.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.num_spaces===item.spaces_booked&&full_events.push(item);return full_events.length===$scope.items.length?$scope.fully_booked=!0:void 0},$scope.showDay=function(day){var date,new_date;if(day&&(!day||day.data))return $scope.selected_day&&($scope.selected_day.selected=!1),date=day.date,$scope.event&&!$scope.selected_date.isSame(date,"day")&&delete $scope.event,0===$scope.mode?(new_date=date,$scope.start_date=moment(date),$scope.end_date=moment(date),$scope.loadEventData()):$scope.selected_date&&date.isSame($scope.selected_date,"day")||(new_date=date),new_date?($scope.selected_date=new_date,$scope.filters.date=new_date.toDate(),$scope.selected_day=day,$scope.selected_day.selected=!0):(delete $scope.selected_date,delete $scope.filters.date),$scope.filterChanged()},$scope.$watch("pick.date",function(_this){return function(new_val,old_val){return new_val?($scope.start_date=moment(new_val),$scope.end_date=moment(new_val),$scope.loadEventData()):void 0}}(this)),$scope.selectItem=function(_this){return function(item,route){var i,j,len,ref;if(!(item.getSpacesLeft()<=0&&$scope.bb.company.settings.has_waitlists||item.hasSpace()))return!1;if($scope.notLoaded($scope),$scope.$parent.$has_page_control)return $scope.event&&$scope.event.unselect(),$scope.event=item,$scope.event.select(),$scope.setLoaded($scope),!1;if($scope.bb.moving_purchase)for(ref=$scope.bb.basket.items,j=0,len=ref.length;len>j;j++)i=ref[j],i.setEvent(item);return $scope.bb.current_item.setEvent(item),$scope.bb.current_item.ready=!1,$q.all($scope.bb.current_item.promises).then(function(){return $scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),!0}}(this),$scope.setReady=function(){return $scope.event?($scope.bb.current_item.setEvent($scope.event),!0):!1},$scope.filterEvents=function(item){var result;return result=(item.date.isSame(moment($scope.filters.date),"day")||null==$scope.filters.date)&&($scope.filters.event_group&&item.service_id===$scope.filters.event_group.id||null==$scope.filters.event_group)&&(null!=$scope.filters.price&&item.price_range.from<=$scope.filters.price||null==$scope.filters.price)&&($scope.filters.hide_sold_out_events&&0!==item.getSpacesLeft()||!$scope.filters.hide_sold_out_events)&&filterEventsWithDynamicFilters(item)},filterEventsWithDynamicFilters=function(item){var dynamic_filter,filter,i,j,k,l,len,len1,len2,len3,m,name,ref,ref1,ref2,ref3,result,type;if(!$scope.has_company_questions||!$scope.dynamic_filters)return!0;for(result=!0,ref=$scope.dynamic_filters.question_types,j=0,len=ref.length;len>j;j++)if(type=ref[j],"check"===type)for(ref1=$scope.dynamic_filters.check,k=0,len1=ref1.length;len1>k;k++){if(dynamic_filter=ref1[k],name=dynamic_filter.name.parameterise("_"),filter=!1,item.chain&&item.chain.extra[name])for(ref2=item.chain.extra[name],l=0,len2=ref2.length;len2>l&&(i=ref2[l],!(filter=$scope.dynamic_filters.values[dynamic_filter.name]&&i===$scope.dynamic_filters.values[dynamic_filter.name].name||null==$scope.dynamic_filters.values[dynamic_filter.name]));l++);else void 0!==item.chain.extra[name]||!_.isEmpty($scope.dynamic_filters.values)&&null!=$scope.dynamic_filters.values[dynamic_filter.name]||(filter=!0);result=result&&filter}else for(ref3=$scope.dynamic_filters[type],m=0,len3=ref3.length;len3>m;m++)dynamic_filter=ref3[m],name=dynamic_filter.name.parameterise("_"),filter=$scope.dynamic_filters.values[dynamic_filter.name]&&item.chain.extra[name]===$scope.dynamic_filters.values[dynamic_filter.name].name||null==$scope.dynamic_filters.values[dynamic_filter.name],result=result&&filter;return result},$scope.filterDateChanged=function(){return $scope.filterChanged(),$scope.showDay(moment($scope.filters.date))},$scope.resetFilters=function(){return $scope.filters={},$scope.has_company_questions&&($scope.dynamic_filters.values={}),$scope.filterChanged()},buildDynamicFilters=function(questions){return $scope.dynamic_filters=_.groupBy(questions,"question_type"),$scope.dynamic_filters.question_types=_.uniq(_.pluck(questions,"question_type")),$scope.dynamic_filters.values={}},sort=function(){},$scope.filterChanged=function(){return $scope.items?($scope.filtered_items=$filter("filter")($scope.items,$scope.filterEvents),$scope.pagination.num_items=$scope.filtered_items.length,$scope.filter_active=$scope.filtered_items.length!==$scope.items.length,PaginationService.update($scope.pagination,$scope.filtered_items.length)):void 0},$scope.pageChanged=function(){return PaginationService.update($scope.pagination,$scope.filtered_items.length),$rootScope.$broadcast("page:changed")},$scope.$on("month_picker:month_changed",function(event,month,last_month_shown){var last_event;if($scope.items&&0!==$scope.mode)return last_event=_.last($scope.items).date,last_month_shown.start_date.isSame(last_event,"month")?($scope.start_date=last_month_shown.start_date,$scope.loadEventData()):void 0})})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbGetAvailability",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"GetAvailability",link:function(scope,element,attrs){attrs.bbGetAvailability&&scope.loadAvailability(scope.$eval(attrs.bbGetAvailability))}}}),angular.module("BB.Controllers").controller("GetAvailability",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,halClient){return $scope.loadAvailability=function(_this){return function(prms){var service;return service=halClient.$get($scope.bb.api_url+"/api/v1/"+prms.company_id+"/services/"+prms.service),service.then(function(serv){var eday,sday;return $scope.earliest_day=null,sday=moment(),eday=moment().add(30,"days"),serv.$get("days",{date:sday.toISOString(),edate:eday.toISOString()}).then(function(res){var day,i,len,ref,results;for(ref=res.days,results=[],i=0,len=ref.length;len>i;i++)day=ref[i],day.spaces>0&&!$scope.earliest_day?($scope.earliest_day=moment(day.date),day.first?results.push($scope.earliest_day.add(day.first,"minutes")):results.push(void 0)):results.push(void 0);return results})})}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbItemDetails",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ItemDetails",link:function(scope,element,attrs){var item;attrs.bbItemDetails&&(item=scope.$eval(attrs.bbItemDetails),scope.item_from_param=item,scope.item_details&&delete scope.item_details,scope.loadItem(item))}}}),angular.module("BB.Controllers").controller("ItemDetails",function($scope,$attrs,$rootScope,ItemDetailsService,PurchaseBookingService,AlertService,BBModel,FormDataStoreService,ValidatorService,QuestionService,$modal,$location,$upload,$translate,SettingsService,PurchaseService){var confirming,setItemDetails;return $scope.controller="public.controllers.ItemDetails",$scope.suppress_basket_update=null!=$attrs.bbSuppressBasketUpdate,$scope.item_details_id=$scope.$eval($attrs.bbSuppressBasketUpdate),$scope.suppress_basket_update?FormDataStoreService.init("ItemDetails"+$scope.item_details_id,$scope,["item_details"]):FormDataStoreService.init("ItemDetails",$scope,["item_details"]),QuestionService.addAnswersByName($scope.client,["first_name","last_name","email","mobile"]),$scope.notLoaded($scope),$scope.validator=ValidatorService,confirming=!1,$rootScope.connection_started.then(function(){return confirming?void 0:$scope.loadItem($scope.bb.current_item)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadItem=function(item){var params;return confirming=!0,$scope.item=item,$scope.bb.private_note&&($scope.item.private_note=$scope.bb.private_note),$scope.product=item.product,$scope.item.item_details?(setItemDetails($scope.item.item_details),QuestionService.addDynamicAnswersByName($scope.item_details.questions),$scope.bb.item_defaults.answers&&QuestionService.addAnswersFromDefaults($scope.item_details.questions,$scope.bb.item_defaults.answers),$scope.recalc_price(),$scope.setLoaded($scope),$scope.$emit("item_details:loaded")):(params={company:$scope.bb.company,cItem:$scope.item},ItemDetailsService.query(params).then(function(details){return setItemDetails(details),$scope.item.item_details=$scope.item_details,QuestionService.addDynamicAnswersByName($scope.item_details.questions),$scope.bb.item_defaults.answers&&QuestionService.addAnswersFromDefaults($scope.item_details.questions,$scope.bb.item_defaults.answers),$scope.recalc_price(),$scope.setLoaded($scope),$scope.$emit("item_details:loaded")},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},setItemDetails=function(details){var oldQuestions;return $scope.item&&$scope.item.defaults&&_.each(details.questions,function(item){var n;return n="q_"+item.name,$scope.item.defaults[n]?item.answer=$scope.item.defaults[n]:void 0}),$scope.hasOwnProperty("item_details")&&(oldQuestions=$scope.item_details.questions,_.each(details.questions,function(item){var search;return search=_.findWhere(oldQuestions,{name:item.name}),search?item.answer=search.answer:void 0})),$scope.item_details=details},$scope.$on("currentItemUpdate",function(service){return $scope.item_from_param?$scope.loadItem($scope.item_from_param):$scope.loadItem($scope.bb.current_item)}),$scope.recalc_price=function(){var bprice,qprice;return qprice=$scope.item_details.questionPrice($scope.item.getQty()),bprice=$scope.item.base_price,$scope.item.setPrice(qprice+bprice)},$scope.confirm=function(form,route){return ValidatorService.validateForm(form)?$scope.bb.moving_booking?$scope.confirm_move(form,route):$scope.has_page_control?($scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoaded($scope)})):$scope.decideNextPage(route)):!0:void 0},$scope.setReady=function(_this){return function(){return $scope.item.setAskedQuestions(),$scope.item.ready&&!$scope.suppress_basket_update?$scope.addItemToBasket():!0}}(this),$scope.confirm_move=function(route){var params;return confirming=!0,$scope.item||($scope.item=$scope.bb.current_item),$scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),$scope.bb.moving_purchase?(params={purchase:$scope.bb.moving_purchase,bookings:$scope.bb.basket.items},PurchaseService.update(params).then(function(purchase){return $scope.purchase=purchase,$scope.setLoaded($scope),$scope.item.move_done=!0,$rootScope.$broadcast("booking:moved"),$scope.decideNextPage(route)})):PurchaseBookingService.update($scope.item).then(function(booking){var _i,b,i,len,oldb,ref;if(b=new BBModel.Purchase.Booking(booking),$scope.bb.purchase)for(ref=$scope.bb.purchase.bookings,_i=i=0,len=ref.length;len>i;_i=++i)oldb=ref[_i],oldb.id===b.id&&($scope.bb.purchase.bookings[_i]=b);return $scope.setLoaded($scope),$scope.item.move_done=!0,$rootScope.$broadcast("booking:moved"),$scope.decideNextPage(route),SettingsService.isInternationalizatonEnabled()?$translate("MOVE_BOOKINGS_MSG",{datetime:b.datetime.format("LLLL")}).then(function(translated_text){return AlertService.add("info",{msg:translated_text})}):AlertService.add("info",{msg:"Your booking has been moved to "+b.datetime.format("LLLL")})},function(_this){return function(err){return $scope.setLoaded($scope),AlertService.add("danger",{msg:"Failed to move booking. Please try again."})}}(this))):$scope.decideNextPage(route)},$scope.openTermsAndConditions=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("terms_and_conditions"),scope:$scope})},$scope.getQuestion=function(id){var i,len,question,ref;for(ref=$scope.item_details.questions,i=0,len=ref.length;len>i;i++)if(question=ref[i],question.id===id)return question;return null},$scope.updateItem=function(){return $scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),PurchaseBookingService.update($scope.item).then(function(booking){var _i,b,i,len,oldb,ref;if(b=new BBModel.Purchase.Booking(booking),$scope.bookings)for(ref=$scope.bookings,_i=i=0,len=ref.length;len>i;_i=++i)oldb=ref[_i],oldb.id===b.id&&($scope.bookings[_i]=b);return $scope.purchase.bookings=$scope.bookings,$scope.item_details_updated=!0,$scope.setLoaded($scope)},function(_this){return function(err){return $scope.setLoaded($scope)}}(this))):void 0},$scope.editItem=function(){return $scope.item_details_updated=!1},$scope.onFileSelect=function(item,$file,existing){var att_id,file,method,url;return $scope.upload_progress=0,file=$file,att_id=null,existing&&(att_id=existing),method="POST",att_id&&(method="PUT"),url=item.$href("add_attachment"),$scope.upload=$upload.upload({url:url,method:method,data:{attachment_id:att_id},file:file}).progress(function(evt){return $scope.upload_progress<100?$scope.upload_progress=parseInt(99*evt.loaded/evt.total):void 0}).success(function(data,status,headers,config){return $scope.upload_progress=100,data&&item?(item.attachment=data,item.attachment_id=data.id):void 0})}})}.call(this),function(){angular.module("BB.Directives").directive("bbLogin",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Login"}}),angular.module("BB.Controllers").controller("Login",function($scope,$rootScope,LoginService,$q,ValidatorService,BBModel,$location,AlertService,ErrorService){return $scope.controller="public.controllers.Login",$scope.error=!1,$scope.password_updated=!1,$scope.password_error=!1,$scope.email_sent=!1,$scope.success=!1,$scope.login_error=!1,$scope.validator=ValidatorService,$scope.login_sso=function(token,route){return $rootScope.connection_started.then(function(_this){return function(){return LoginService.ssoLogin({company_id:$scope.bb.company.id,root:$scope.bb.api_url},{token:token}).then(function(member){return route?$scope.showPage(route):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.login_with_password=function(email,password){return $scope.login_error=!1,LoginService.companyLogin($scope.bb.company,{},{email:email,password:password}).then(function(_this){return function(member){return $scope.member=new BBModel.Member.Member(member),$scope.success=!0,$scope.login_error=!1}}(this),function(_this){return function(err){return $scope.login_error=err,AlertService.raise(ErrorService.getAlert("LOGIN_FAILED"))}}(this))},$scope.showEmailPasswordReset=function(_this){return function(){return $scope.showPage("email_reset_password")}}(this),$scope.isLoggedIn=function(){return LoginService.isLoggedIn()},$scope.sendPasswordReset=function(email){return $scope.error=!1,LoginService.sendPasswordReset($scope.bb.company,{email:email,custom:!0}).then(function(){return $scope.email_sent=!0,AlertService.raise(ErrorService.getAlert("PASSWORD_RESET_REQ_SUCCESS"))},function(_this){return function(err){return $scope.error=err,AlertService.raise(ErrorService.getAlert("PASSWORD_RESET_REQ_FAILED"))}}(this))},$scope.updatePassword=function(new_password,confirm_new_password){return AlertService.clear(),$scope.password_error=!1,$scope.error=!1,$rootScope.member&&new_password&&confirm_new_password&&new_password===confirm_new_password?LoginService.updatePassword($rootScope.member,{new_password:new_password,confirm_new_password:confirm_new_password
}).then(function(_this){return function(member){return member?($scope.password_updated=!0,$scope.setClient(member),AlertService.raise(ErrorService.getAlert("PASSWORD_RESET_SUCESS")),$rootScope.$emit("login:password_reset")):void 0}}(this),function(_this){return function(err){return $scope.error=err,AlertService.raise(ErrorService.getAlert("PASSWORD_RESET_FAILED"))}}(this)):($scope.password_error=!0,AlertService.raise(ErrorService.getAlert("PASSWORD_MISMATCH")))}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMap",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"MapCtrl"}}),angular.module("BB.Controllers").controller("MapCtrl",function($scope,$element,$attrs,$rootScope,AlertService,ErrorService,FormDataStoreService,$q,$window,$timeout){var checkDataStore,geolocateFail,map_ready_def,options,reverseGeocode,searchFailed,searchPlaces,searchSuccess;return $scope.controller="public.controllers.MapCtrl",FormDataStoreService.init("MapCtrl",$scope,["address","selectedStore","search_prms"]),options=$scope.$eval($attrs.bbMap)||{},map_ready_def=$q.defer(),$scope.mapLoaded=$q.defer(),$scope.mapReady=map_ready_def.promise,$scope.map_init=$scope.mapLoaded.promise,$scope.numSearchResults=options.num_search_results||6,$scope.range_limit=options.range_limit||1/0,$scope.showAllMarkers=!1,$scope.mapMarkers=[],$scope.shownMarkers=$scope.shownMarkers||[],$scope.numberedPin||($scope.numberedPin=null),$scope.defaultPin||($scope.defaultPin=null),$scope.hide_not_live_stores=!1,!$scope.address&&$attrs.bbAddress&&($scope.address=$scope.$eval($attrs.bbAddress)),$scope.error_msg=options.error_msg||"You need to select a store",$scope.notLoaded($scope),webshim.setOptions({waitReady:!1,loadStyles:!1}),webshim.polyfill("geolocation"),$rootScope.connection_started.then(function(){var comp,i,key,latlong,len,ref,ref1,value;if($scope.selectedStore||$scope.setLoaded($scope),!$scope.bb.company.companies)return $rootScope.parent_id?void $scope.initWidget({company_id:$rootScope.parent_id,first_page:$scope.bb.current_page,keep_basket:!0}):void $scope.initWidget({company_id:$scope.bb.company.id,first_page:null});for($rootScope.parent_id=$scope.bb.company.id,$scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),$scope.mapBounds=new google.maps.LatLngBounds,ref=$scope.companies,i=0,len=ref.length;len>i;i++)comp=ref[i],comp.address&&comp.address.lat&&comp.address["long"]&&(latlong=new google.maps.LatLng(comp.address.lat,comp.address["long"]),$scope.mapBounds.extend(latlong));if($scope.mapOptions={center:$scope.mapBounds.getCenter(),zoom:6,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{style:window.google.maps.MapTypeControlStyle.DROPDOWN_MENU}},options&&options.map_options){ref1=options.map_options;for(key in ref1)value=ref1[key],$scope.mapOptions[key]=value}return map_ready_def.resolve(!0)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.map_init.then(function(){var comp,i,latlong,len,marker,ref;for(ref=$scope.companies,i=0,len=ref.length;len>i;i++)comp=ref[i],comp.address&&comp.address.lat&&comp.address["long"]&&(latlong=new google.maps.LatLng(comp.address.lat,comp.address["long"]),marker=new google.maps.Marker({map:$scope.myMap,position:latlong,visible:$scope.showAllMarkers,icon:$scope.defaultPin}),marker.company=comp,(!$scope.hide_not_live_stores||comp.live)&&$scope.mapMarkers.push(marker));return $timeout(function(){return $scope.myMap.fitBounds($scope.mapBounds),$scope.myMap.setZoom(15)}),checkDataStore()}),$scope.init=function(options){return options?$scope.hide_not_live_stores=options.hide_not_live_stores:void 0},checkDataStore=function(){return $scope.selectedStore?($scope.notLoaded($scope),$scope.search_prms?$scope.searchAddress($scope.search_prms):$scope.geolocate(),google.maps.event.addListenerOnce($scope.myMap,"idle",function(){return _.each($scope.mapMarkers,function(marker){return $scope.selectedStore.id===marker.company.id?google.maps.event.trigger(marker,"click"):void 0})})):void 0},$scope.title=function(){var ci,p1;return ci=$scope.bb.current_item,p1=ci.category&&ci.category.description?ci.category.description:$scope.bb.company.extra.department,p1+" - "+$scope.$eval("getCurrentStepTitle()")},$scope.searchAddress=function(prms){return $scope.reverse_geocode_address&&$scope.reverse_geocode_address===$scope.address?!1:(delete $scope.geocoder_result,prms||(prms={}),$scope.search_prms=prms,$scope.map_init.then(function(){var address,ne,req,sw;return address=$scope.address,prms.address&&(address=prms.address),address?(req={address:address},prms.region&&(req.region=prms.region),prms.componentRestrictions&&(req.componentRestrictions=prms.componentRestrictions),prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),req.bounds=new google.maps.LatLngBounds(sw,ne)),(new google.maps.Geocoder).geocode(req,function(results,status){return results.length>0&&"OK"===status&&($scope.geocoder_result=results[0]),!$scope.geocoder_result||$scope.geocoder_result&&$scope.geocoder_result.partial_match?void searchPlaces(req):($scope.geocoder_result?searchSuccess($scope.geocoder_result):searchFailed(),$scope.setLoaded($scope))})):void 0}),$scope.setLoaded($scope))},searchPlaces=function(prms){var req,service;return req={query:prms.address,types:["shopping_mall","store","embassy"]},prms.bounds&&(req.bounds=prms.bounds),service=new google.maps.places.PlacesService($scope.myMap),service.textSearch(req,function(results,status){return results.length>0&&"OK"===status?searchSuccess(results[0]):$scope.geocoder_result?searchSuccess($scope.geocoder_result):searchFailed()})},searchSuccess=function(result){return AlertService.clear(),$scope.search_failed=!1,$scope.loc=result.geometry.location,$scope.myMap.setCenter($scope.loc),$scope.myMap.setZoom(15),$scope.showClosestMarkers($scope.loc),$rootScope.$broadcast("map:search_success")},searchFailed=function(){return $scope.search_failed=!0,AlertService.danger(ErrorService.getError("LOCATION_NOT_FOUND")),$rootScope.$apply()},$scope.validateAddress=function(form){return form?form.$error.required?(AlertService.clear(),AlertService.danger(ErrorService.getError("MISSING_LOCATION")),!1):!0:!1},$scope.showClosestMarkers=function(latlong){var R,a,c,chLat,chLon,d,dLat,dLon,distances,distances_kilometres,i,iconPath,index,item,items,j,k,l,lat1,lat2,len,len1,len2,localBounds,lon1,lon2,marker,pi,rLat1,rLat2,ref,ref1;for(pi=Math.PI,R=6371,distances=[],distances_kilometres=[],lat1=latlong.lat(),lon1=latlong.lng(),ref=$scope.mapMarkers,i=0,len=ref.length;len>i;i++)for(marker=ref[i],lat2=marker.position.lat(),lon2=marker.position.lng(),chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,k=d,d=.621371192*d,$scope.showAllMarkers||marker.setVisible(!1),marker.distance=d,marker.distance_kilometres=k,d<$scope.range_limit&&distances.push(marker),k<$scope.range_limit&&distances_kilometres.push(marker),items=[distances,distances_kilometres],j=0,len1=items.length;len1>j;j++)item=items[j],item.sort(function(a,b){return a.distance-b.distance,a.distance_kilometres-b.distance_kilometres});for($scope.shownMarkers=distances.slice(0,$scope.numSearchResults),localBounds=new google.maps.LatLngBounds,localBounds.extend(latlong),index=1,ref1=$scope.shownMarkers,l=0,len2=ref1.length;len2>l;l++)marker=ref1[l],$scope.numberedPin&&(iconPath=$window.sprintf($scope.numberedPin,index),marker.setIcon(iconPath)),marker.setVisible(!0),localBounds.extend(marker.position),index+=1;return google.maps.event.trigger($scope.myMap,"resize"),$scope.myMap.fitBounds(localBounds)},$scope.openMarkerInfo=function(marker){return $scope.currentMarker=marker,$scope.myInfoWindow.open($scope.myMap,marker)},$scope.selectItem=function(item,route){return $scope.$debounce(1e3)?item?($scope.notLoaded($scope),$scope.selectedStore&&$scope.selectedStore.id!==item.id&&$scope.$emit("change:storeLocation"),$scope.selectedStore=item,$scope.initWidget({company_id:item.id,first_page:route})):void AlertService.warning({msg:$scope.error_msg}):void 0},$scope.roundNumberUp=function(num,places){return Math.round(num*Math.pow(10,places))/Math.pow(10,places)},$scope.geolocate=function(){return!navigator.geolocation||$scope.reverse_geocode_address&&$scope.reverse_geocode_address===$scope.address?!1:($scope.notLoaded($scope),webshim.ready("geolocation",function(){return options={timeout:5e3,maximumAge:36e5},navigator.geolocation.getCurrentPosition(reverseGeocode,geolocateFail,options)}))},geolocateFail=function(error){switch(error.code){case 2:case 3:return $scope.setLoaded($scope),AlertService.danger(ErrorService.getError("GEOLOCATION_ERROR"));default:return $scope.setLoaded($scope)}},reverseGeocode=function(position){var lat,latlng,long;return lat=parseFloat(position.coords.latitude),long=parseFloat(position.coords.longitude),latlng=new google.maps.LatLng(lat,long),(new google.maps.Geocoder).geocode({latLng:latlng},function(results,status){var ac,i,len,ref;if(results.length>0&&"OK"===status){for($scope.geocoder_result=results[0],ref=$scope.geocoder_result.address_components,i=0,len=ref.length;len>i;i++)ac=ref[i],ac.types.indexOf("route")>=0&&($scope.reverse_geocode_address=ac.long_name),ac.types.indexOf("locality")>=0&&($scope.reverse_geocode_address+=", "+ac.long_name),$scope.address=$scope.reverse_geocode_address;searchSuccess($scope.geocoder_result)}return $scope.setLoaded($scope)})},$scope.increaseRange=function(){return $scope.range_limit=1/0,$scope.searchAddress($scope.search_prms)},$scope.$watch("display.xs",function(_this){return function(new_value,old_value){return new_value!==old_value&&$scope.loc?($scope.myInfoWindow.close(),$scope.myMap.setCenter($scope.loc),$scope.myMap.setZoom(15),$scope.showClosestMarkers($scope.loc)):void 0}}(this)),$rootScope.$on("widget:restart",function(){return $scope.loc=null,$scope.reverse_geocode_address=null,$scope.address=null})})}.call(this),function(){angular.module("BB.Directives").directive("bbMembershipLevels",function($rootScope,MembershipLevelsService){var controller;return controller=function($scope,$element,$attrs){var checkClientDefaults;return $rootScope.connection_started.then(function(){return $scope.initialise()}),$scope.initialise=function(){return $scope.bb.company&&$scope.bb.company.$has("member_levels")?($scope.notLoaded($scope),MembershipLevelsService.getMembershipLevels($scope.bb.company).then(function(member_levels){return $scope.setLoaded($scope),$scope.membership_levels=member_levels},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void 0},$scope.selectMemberLevel=function(level){return level&&$scope.client&&($scope.client.member_level_id=level.id,!$scope.$parent.$has_page_control)?$scope.decideNextPage():void 0},checkClientDefaults=function(){var i,len,membership_level,ref,results;if($scope.bb.client_defaults.membership_ref){for(ref=$scope.membership_levels,results=[],i=0,len=ref.length;len>i;i++)membership_level=ref[i],membership_level.name===$scope.bb.client_defaults.membership_ref?results.push($scope.selectMemberLevel(membership_level)):results.push(void 0);return results}},$scope.setReady=function(){return $scope.client.member_level_id?!0:!1},$scope.getMembershipLevel=function(member_level_id){return _.find($scope.membership_levels,function(level){return level.id===member_level_id})}}})}.call(this),function(){"use strict";var hasProp={}.hasOwnProperty;angular.module("BB.Directives").directive("bbMultiServiceSelect",function(){return{restrict:"AE",scope:!0,controller:"MultiServiceSelect"}}),angular.module("BB.Controllers").controller("MultiServiceSelect",function($scope,$rootScope,$q,$attrs,BBModel,AlertService,CategoryService,FormDataStoreService,$modal){var checkItemDefaults,initialise,initialiseCategories;return FormDataStoreService.init("MultiServiceSelect",$scope,["selected_category_name"]),$scope.options=$scope.$eval($attrs.bbMultiServiceSelect)||{},$scope.options.max_services=$scope.options.max_services||1/0,$scope.options.ordered_categories=$scope.options.ordered_categories||!1,$scope.options.services=$scope.options.services||"items",$rootScope.connection_started.then(function(){return $scope.bb.company.$has("parent")&&!$scope.bb.company.$has("company_questions")?$scope.bb.company.getParentPromise().then(function(parent){return $scope.company=parent,initialise()}):$scope.company=$scope.bb.company,$scope.$watch($scope.options.services,function(newval,oldval){return newval&&angular.isArray(newval)?($scope.items=newval,initialise()):void 0})}),initialise=function(){var promises;if($scope.items&&$scope.company)return $scope.initialised=!0,promises=[],promises.push(CategoryService.query($scope.bb.company)),$scope.company.$has("company_questions")&&promises.push($scope.company.getCompanyQuestionsPromise()),$q.all(promises).then(function(result){var item,j,k,len,len1,ref,ref1,stacked_item;if($scope.company_questions=result[1],initialiseCategories(result[0]),$scope.bb.stacked_items&&$scope.bb.stacked_items.length>0){for(ref=$scope.bb.stacked_items,j=0,len=ref.length;len>j;j++)for(stacked_item=ref[j],ref1=$scope.items,k=0,len1=ref1.length;len1>k;k++)if(item=ref1[k],item.self===stacked_item.service.self){stacked_item.service=item,stacked_item.service.selected=!0;break}}else checkItemDefaults();return $scope.bb.moving_booking&&$scope.nextStep(),$scope.$broadcast("multi_service_select:loaded"),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},checkItemDefaults=function(){var j,len,ref,service;if($scope.bb.item_defaults.service)for(ref=$scope.items,j=0,len=ref.length;len>j;j++)if(service=ref[j],service.self===$scope.bb.item_defaults.service.self)return void $scope.addItem(service)},initialiseCategories=function(categories){var all_categories,category,category_details,category_id,grouped_sub_categories,grouped_sub_category,j,k,key,len,len1,results,services,sub_categories,sub_category,value;if($scope.options.ordered_categories)for(j=0,len=categories.length;len>j;j++)category=categories[j],category.order=parseInt(category.name.slice(0,2)),category.name=category.name.slice(3);$scope.all_categories=_.indexBy(categories,"id"),all_categories=_.groupBy($scope.items,function(item){return item.category_id}),sub_categories=_.findWhere($scope.company_questions,{name:"Extra Category"}),sub_categories&&(sub_categories=_.map(sub_categories.question_items,function(sub_category){return sub_category.name})),categories={};for(key in all_categories)hasProp.call(all_categories,key)&&(value=all_categories[key],value.length>0&&(categories[key]=value));$scope.categories=[],results=[];for(category_id in categories){if(services=categories[category_id],grouped_sub_categories=[],sub_categories)for(k=0,len1=sub_categories.length;len1>k;k++)sub_category=sub_categories[k],grouped_sub_category={name:sub_category,services:_.filter(services,function(service){return service.extra.extra_category===sub_category})},grouped_sub_category.services.length>0&&grouped_sub_categories.push(grouped_sub_category);$scope.all_categories[category_id]&&(category_details={name:$scope.all_categories[category_id].name,description:$scope.all_categories[category_id].description}),category={name:category_details.name,description:category_details.description,sub_categories:grouped_sub_categories},$scope.options.ordered_categories&&(category.order=$scope.all_categories[category_id].order),$scope.categories.push(category),$scope.selected_category_name&&$scope.selected_category_name===category_details.name?results.push($scope.selected_category=$scope.categories[$scope.categories.length-1]):$scope.bb.item_defaults.category&&$scope.bb.item_defaults.category.name===category_details.name&&!$scope.selected_category?($scope.selected_category=$scope.categories[$scope.categories.length-1],results.push($scope.selected_category_name=$scope.selected_category.name)):results.push(void 0)}return results},$scope.changeCategory=function(category_name,services){return category_name&&services?($scope.selected_category={name:category_name,sub_categories:services},$scope.selected_category_name=$scope.selected_category.name,$rootScope.$broadcast("multi_service_select:category_changed")):void 0},$scope.changeCategoryName=function(){return $scope.selected_category_name=$scope.selected_category.name,$rootScope.$broadcast("multi_service_select:category_changed")},$scope.addItem=function(item,duration){var i,iitem,j,len,ref,results;if(!($scope.bb.stacked_items.length<$scope.options.max_services)){for(ref=$scope.items,results=[],j=0,len=ref.length;len>j;j++)i=ref[j],i.popover="Sorry, you can only book a maximum of "+$scope.options.max_services+" treatments",results.push(i.popoverText=i.popover);return results}return $scope.bb.clearStackedItemsDateTime(),item.selected=!0,iitem=new BBModel.BasketItem(null,$scope.bb),iitem.setDefaults($scope.bb.item_defaults),iitem.setService(item),duration&&iitem.setDuration(duration),iitem.setGroup(item.group),$scope.bb.stackItem(iitem),$rootScope.$broadcast("multi_service_select:item_added"),$scope.options.raise_alerts?AlertService.info({msg:item.name+" added to your treatment selection",persist:!1}):void 0},$scope.removeItem=function(item,options){var i,j,len,ref,results;for(item.selected=!1,options&&"BasketItem"===options.type?$scope.bb.deleteStackedItem(item):$scope.bb.deleteStackedItemByService(item),$scope.bb.clearStackedItemsDateTime(),$rootScope.$broadcast("multi_service_select:item_removed"),ref=$scope.items,results=[],j=0,len=ref.length;len>j;j++){if(i=ref[j],i.self===item.self){i.selected=!1;break}results.push(void 0)}return results},$scope.removeStackedItem=function(item){return $scope.removeItem(item,{type:"BasketItem"})},$scope.nextStep=function(){return $scope.bb.stacked_items.length>1?$scope.decideNextPage():1===$scope.bb.stacked_items.length?($scope.bb.basket&&$scope.bb.basket.items.length>0&&$scope.quickEmptybasket({preserve_stacked_items:!0}),$scope.setBasketItem($scope.bb.stacked_items[0]),$scope.decideNextPage()):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select at least one treatment to continue"}))},$scope.addService=function(){return $rootScope.$broadcast("multi_service_select:add_item")},$scope.setReady=function(){return $scope.bb.stacked_items.length>1?!0:1===$scope.bb.stacked_items.length?($scope.bb.basket&&$scope.bb.basket.items.length>0&&$scope.quickEmptybasket({preserve_stacked_items:!0}),$scope.setBasketItem($scope.bb.stacked_items[0]),!0):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select at least one treatment to continue"}),!1)},$scope.selectDuration=function(service){var modalInstance;return 1===service.durations.length?$scope.addItem(service):(modalInstance=$modal.open({templateUrl:$scope.getPartial("_select_duration_modal"),scope:$scope,controller:function($scope,$modalInstance,service){return $scope.durations=service.durations,$scope.duration=$scope.durations[0],$scope.service=service,$scope.cancel=function(){return $modalInstance.dismiss("cancel")},$scope.setDuration=function(){return $modalInstance.close({service:$scope.service,duration:$scope.duration})}},resolve:{service:function(){return service}}}),modalInstance.result.then(function(result){return $scope.addItem(result.service,result.duration)}))}})}.call(this),function(){"use strict";var hasProp={}.hasOwnProperty;angular.module("BB.Directives").directive("bbTimeRangeStacked",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeRangeListStackedController"}}),angular.module("BB.Controllers").controller("TimeRangeListStackedController",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,FormDataStoreService,PersonService,PurchaseService,DateTimeUlititiesService){var isSubtractValid,setEnabledSlots,setTimeRange,spliceExistingDateTimes,updateHideStatus;return $scope.controller="public.controllers.TimeRangeListStacked",FormDataStoreService.init("TimeRangeListStacked",$scope,["selected_slot","original_start_date","start_at_week_start"]),$scope.notLoaded($scope),$scope.available_times=0,$rootScope.connection_started.then(function(){var diff,selected_day,start_date;return $scope.options=$scope.$eval($attrs.bbTimeRangeStacked)||{},$scope.time_range_length||(null!=$attrs.bbTimeRangeLength?$scope.time_range_length=$scope.$eval($attrs.bbTimeRangeLength):$scope.options&&$scope.options.time_range_length?$scope.time_range_length=$scope.options.time_range_length:$scope.time_range_length=7),(null!=$attrs.bbDayOfWeek||$scope.options&&$scope.options.day_of_week)&&($scope.day_of_week=null!=$attrs.bbDayOfWeek?$scope.$eval($attrs.bbDayOfWeek):$scope.options.day_of_week),(null!=$attrs.bbSelectedDay||$scope.options&&$scope.options.selected_day)&&(selected_day=null!=$attrs.bbSelectedDay?moment($scope.$eval($attrs.bbSelectedDay)):moment($scope.options.selected_day),moment.isMoment(selected_day)&&($scope.selected_day=selected_day)),!$scope.start_date&&$scope.last_selected_date?$scope.original_start_date?(diff=$scope.last_selected_date.diff($scope.original_start_date,"days"),diff%=$scope.time_range_length,diff=0===diff?diff:diff+1,start_date=$scope.last_selected_date.clone().subtract(diff,"days"),setTimeRange($scope.last_selected_date,start_date)):setTimeRange($scope.last_selected_date):$scope.bb.stacked_items[0].date?setTimeRange($scope.bb.stacked_items[0].date.date):$scope.selected_day?($scope.original_start_date=$scope.original_start_date||moment($scope.selected_day),setTimeRange($scope.selected_day)):($scope.start_at_week_start=!0,setTimeRange(moment())),$scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),setTimeRange=function(selected_date,start_date){return start_date?$scope.start_date=start_date:$scope.day_of_week?$scope.start_date=selected_date.clone().day($scope.day_of_week):$scope.start_at_week_start?$scope.start_date=selected_date.clone().startOf("week"):$scope.start_date=selected_date.clone(),$scope.selected_day=selected_date,$scope.selected_date=$scope.selected_day.toDate(),isSubtractValid()},$scope.add=function(amount,type){switch($scope.selected_day=moment($scope.selected_date),type){case"days":setTimeRange($scope.selected_day.add(amount,"days"));break;case"weeks":$scope.start_date.add(amount,"weeks"),setTimeRange($scope.start_date)}return $scope.loadData()},$scope.subtract=function(amount,type){return $scope.add(-amount,type)},isSubtractValid=function(){var diff;return $scope.is_subtract_valid=!0,diff=Math.ceil($scope.selected_day.diff(moment(),"day",!0)),$scope.subtract_length=diff<$scope.time_range_length?diff:$scope.time_range_length,0>=diff&&($scope.is_subtract_valid=!1),$scope.subtract_length>1?$scope.subtract_string="Prev "+$scope.subtract_length+" days":1===$scope.subtract_length?$scope.subtract_string="Prev day":$scope.subtract_string="Prev"},$scope.selectedDateChanged=function(){return setTimeRange(moment($scope.selected_date)),$scope.selected_slot=null,$scope.loadData()},updateHideStatus=function(){var day,key,ref,results;ref=$scope.days,results=[];for(key in ref)day=ref[key],results.push($scope.days[key].hide=!day.date.isSame($scope.selected_day,"day"));return results},$scope.isPast=function(){return $scope.start_date?moment().isAfter($scope.start_date):!0},$scope.status=function(day,slot){var status;if(slot)return status=slot.status()},$scope.highlightSlot=function(day,slot){var i,item,len,ref;if(day&&slot&&slot.availability()>0){for($scope.bb.clearStackedItemsDateTime(),$scope.selected_slot&&($scope.selected_slot.selected=!1),$scope.setLastSelectedDate(day.date),$scope.selected_slot=angular.copy(slot),$scope.selected_day=day.date,$scope.selected_date=day.date.toDate(),$scope.$broadcast("slotChanged",day,slot);slot;)for(ref=$scope.bb.stacked_items,i=0,len=ref.length;len>i;i++)if(item=ref[i],item.service.self===slot.service.self&&!item.date&&!item.time){item.setDate(day),item.setTime(slot),slot=slot.next;break}return updateHideStatus(),$rootScope.$broadcast("time:selected")}},$scope.loadData=function(){var edate,grouped_items,i,items,len,pslots;if($scope.notLoaded($scope),$scope.request&&$scope.request.start.twix($scope.request.end).contains($scope.selected_day))return updateHideStatus(),void $scope.setLoaded($scope);for($scope.start_date=moment($scope.start_date),edate=moment($scope.start_date).add($scope.time_range_length,"days"),$scope.end_date=moment(edate).add(-1,"days"),$scope.request={start:moment($scope.start_date),end:moment($scope.end_date)},pslots=[],grouped_items=_.groupBy($scope.bb.stacked_items,function(item){return item.service.id}),grouped_items=_.toArray(grouped_items),i=0,len=grouped_items.length;len>i;i++)items=grouped_items[i],pslots.push(TimeService.query({company:$scope.bb.company,cItem:items[0],date:$scope.start_date,end_date:$scope.end_date,client:$scope.client,available:1}));return $q.all(pslots).then(function(res){var _i,day,item,j,k,l,len1,len2,ref,slots,times,v;for($scope.data_valid=!0,$scope.days={},_i=j=0,len1=grouped_items.length;len1>j;_i=++j)for(items=grouped_items[_i],slots=res[_i],slots&&0!==slots.length||($scope.data_valid=!1),l=0,len2=items.length;len2>l;l++){item=items[l],spliceExistingDateTimes(item,slots),item.slots={};for(day in slots)hasProp.call(slots,day)&&(times=slots[day],item.slots[day]=_.indexBy(times,"time"))}if($scope.data_valid){ref=res[0];for(k in ref)v=ref[k],$scope.days[k]={date:moment(k)};setEnabledSlots(),updateHideStatus(),$rootScope.$broadcast("TimeRangeListStacked:loadFinished"),$scope.$broadcast("dataReloaded")}return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},spliceExistingDateTimes=function(stacked_item,slots){var datetime,time,time_slot;if(stacked_item.datetime||stacked_item.date)return datetime=stacked_item.datetime||DateTimeUlititiesService.convertTimeSlotToMoment(stacked_item.date,stacked_item.time),$scope.start_date<=datetime&&$scope.end_date>=datetime?(time=DateTimeUlititiesService.convertMomentToTime(datetime),time_slot=_.findWhere(slots[datetime.toISODate()],{time:time}),time_slot||(time_slot=stacked_item.time,slots[datetime.toISODate()].splice(0,0,time_slot)),time_slot.selected=stacked_item.self===$scope.bb.stacked_items[0].self):void 0},setEnabledSlots=function(){var day,day_data,isSlotValid,ref,results,slot,time;ref=$scope.days,results=[];for(day in ref)day_data=ref[day],day_data.slots={},$scope.bb.stacked_items.length>1?results.push(function(){var ref1,results1;ref1=$scope.bb.stacked_items[0].slots[day],results1=[];for(time in ref1)slot=ref1[time],slot=angular.copy(slot),isSlotValid=function(slot){var duration,i,index,next,ref2,valid;for(valid=!1,time=slot.time,duration=$scope.bb.stacked_items[0].service.duration,next=time+duration,index=i=1,ref2=$scope.bb.stacked_items.length-1;ref2>=1?ref2>=i:i>=ref2;index=ref2>=1?++i:--i){if(_.isEmpty($scope.bb.stacked_items[index].slots[day])||!$scope.bb.stacked_items[index].slots[day][next])return!1;slot.next=angular.copy($scope.bb.stacked_items[index].slots[day][next]),slot=slot.next,next+=$scope.bb.stacked_items[index].service.duration}return!0},isSlotValid(slot)?results1.push(day_data.slots[slot.time]=slot):results1.push(void 0);return results1}()):results.push(function(){var ref1,results1;ref1=$scope.bb.stacked_items[0].slots[day],results1=[];for(time in ref1)slot=ref1[time],results1.push(day_data.slots[slot.time]=slot);return results1}());return results},$scope.pretty_month_title=function(month_format,year_format,seperator){var month_year_format,start_date;return null==seperator&&(seperator="-"),$scope.start_date?(month_year_format=month_format+" "+year_format,$scope.start_date&&$scope.end_date&&$scope.end_date.isAfter($scope.start_date,"month")?(start_date=$scope.start_date.format(month_format),11===$scope.start_date.month()&&(start_date=$scope.start_date.format(month_year_format)),start_date+" "+seperator+" "+$scope.end_date.format(month_year_format)):$scope.start_date.format(month_year_format)):void 0},$scope.confirm=function(route,options){var booking,different,found,i,item,j,l,len,len1,len2,prom,ref,ref1,ref2;for(null==options&&(options={}),ref=$scope.bb.stacked_items,i=0,len=ref.length;len>i;i++)if(item=ref[i],!item.time)return AlertService.add("danger",{msg:"Select a time to continue your booking"}),!1;if(null!=$scope.bb.moving_booking&&null!=$scope.bb.moving_booking.bookings){for(different=!1,ref1=$scope.bb.moving_booking.bookings,j=0,len1=ref1.length;len1>j;j++){for(booking=ref1[j],found=!1,ref2=$scope.bb.stacked_items,l=0,len2=ref2.length;len2>l;l++)item=ref2[l],booking.getDateString()===item.date.string_date&&booking.getTimeInMins()===item.time.time&&booking.category_name===item.category_name&&(found=!0);if(!found){different=!0;break}}if(!different)return AlertService.add("danger",{msg:"Your treatments are already booked for this time."}),!1}return $scope.bb.basket.clear(),$scope.bb.pushStackToBasket(),$scope.bb.moving_booking?($scope.notLoaded($scope),prom=PurchaseService.update({purchase:$scope.bb.moving_booking,bookings:$scope.bb.basket.items}),void prom.then(function(purchase){return purchase.getBookingsPromise().then(function(bookings){var _i,len3,m,oldb,results;for(results=[],m=0,len3=bookings.length;len3>m;m++)booking=bookings[m],$scope.bookings?results.push(function(){var len4,n,ref3,results1;for(ref3=$scope.bookings,results1=[],_i=n=0,len4=ref3.length;len4>n;_i=++n)oldb=ref3[_i],oldb.id===booking.id?results1.push($scope.bookings[_i]=booking):results1.push(void 0);return results1}()):results.push(void 0);return results}),$scope.setLoaded($scope),$scope.bb.current_item.move_done=!0,$scope.decideNextPage()},function(err){return $scope.setLoaded($scope),AlertService.add("danger",{msg:"Failed to move booking"})})):($scope.notLoaded($scope),options.do_not_route?$scope.updateBasket():$scope.updateBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},$scope.setReady=function(){return $scope.confirm("",{do_not_route:!0})}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPackagePicker",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PackagePicker"}}),angular.module("BB.Controllers").controller("PackagePicker",function($scope,$rootScope,$q,TimeService,BBModel){return $scope.controller="public.controllers.PackagePicker",$scope.sel_date=moment().add(1,"days"),$scope.selected_date=$scope.sel_date.toDate(),$scope.picked_time=!1,$scope.$watch("selected_date",function(_this){return function(newv,oldv){return $scope.sel_date=moment(newv),$scope.loadDay()}}(this)),$scope.loadDay=function(_this){return function(){var i,item,len,pslots,ref;for($scope.timeSlots=[],$scope.notLoaded($scope),pslots=[],ref=$scope.stackedItems,i=0,len=ref.length;len>i;i++)item=ref[i],pslots.push(TimeService.query({company:$scope.bb.company,cItem:item,date:$scope.sel_date,client:$scope.client}));return $q.all(pslots).then(function(res){var _i,earliest,j,k,l,latest,len1,len2,len3,len4,len5,m,n,next_earliest,next_latest,ref1,ref2,ref3,ref4,ref5,results,slot;for($scope.setLoaded($scope),$scope.data_valid=!0,$scope.timeSlots=[],ref1=$scope.stackedItems,_i=j=0,len1=ref1.length;len1>j;_i=++j)item=ref1[_i],item.slots=res[_i],item.slots&&0!==item.slots.length||($scope.data_valid=!1),item.order=_i;if($scope.data_valid){for($scope.timeSlots=res,earliest=null,ref2=$scope.stackedItems,k=0,len2=ref2.length;len2>k;k++){for(item=ref2[k],next_earliest=null,ref3=item.slots,l=0,len3=ref3.length;len3>l;l++)slot=ref3[l],
earliest&&slot.time<earliest?slot.disable():next_earliest||(next_earliest=slot.time+item.service.duration);earliest=next_earliest}for(latest=null,ref4=$scope.bb.stacked_items.slice(0).reverse(),results=[],m=0,len4=ref4.length;len4>m;m++){for(item=ref4[m],next_latest=null,ref5=item.slots,n=0,len5=ref5.length;len5>n;n++)slot=ref5[n],latest&&slot.time>latest?slot.disable():next_latest=slot.time-item.service.duration;results.push(latest=next_latest)}return results}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectSlot=function(_this){return function(sel_item,slot){var count,current,i,item,j,k,latest,len,len1,len2,next,ref,ref1,slots,time;for(ref=$scope.stackedItems,count=i=0,len=ref.length;len>i;count=++i)if(item=ref[count],count===sel_item.order){if(item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),item.setTime(slot),next=slot.time+item.service.duration,time=slot.time,slot=null,count>0)for(current=count-1;current>=0;){if(item=$scope.bb.stacked_items[current],latest=time-item.service.duration,!item.time||item.time.time>latest)for(item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),item.setTime(null),ref1=item.slots,j=0,len1=ref1.length;len1>j;j++)slot=ref1[j],slot.time<latest&&item.setTime(slot);time=item.time.time,current-=1}}else if(count>sel_item.order&&(slots=item.slots,item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),slots))for(item.setTime(null),k=0,len2=slots.length;len2>k;k++)slot=slots[k],slot.time>=next&&!item.time&&(item.setTime(slot),next=slot.time+item.service.duration);return $scope.picked_time=!0}}(this),$scope.hasAvailability=function(_this){return function(slots,start_time,end_time){var i,j,k,l,len,len1,len2,len3,slot;if(!slots)return!1;if(start_time&&end_time){for(i=0,len=slots.length;len>i;i++)if(slot=slots[i],slot.time>=start_time&&slot.time<end_time&&slot.availability()>0)return!0}else if(end_time){for(j=0,len1=slots.length;len1>j;j++)if(slot=slots[j],slot.time<end_time&&slot.availability()>0)return!0}else if(start_time){for(k=0,len2=slots.length;len2>k;k++)if(slot=slots[k],slot.time>=start_time&&slot.availability()>0)return!0}else for(l=0,len3=slots.length;len3>l;l++)if(slot=slots[l],slot.availability()>0)return!0}}(this),$scope.confirm=function(_this){return function(){}}(this)})}.call(this),function(){"use strict";var BBBasicPageCtrl;BBBasicPageCtrl=function($scope,$q,ValidatorService){var isScopeReady;return $scope.controllerClass="public.controllers.PageController",$scope.$has_page_control=!0,$scope.validator=ValidatorService,isScopeReady=function(_this){return function(cscope){var child,children,i,len,ready,ready_list;for(ready_list=[],children=[],child=cscope.$$childHead;child;)children.push(child),child=child.$$nextSibling;for(children.sort(function(a,b){return(a.ready_order||0)>=(b.ready_order||0)?1:-1}),i=0,len=children.length;len>i;i++)child=children[i],ready=isScopeReady(child),angular.isArray(ready)?Array.prototype.push.apply(ready_list,ready):ready_list.push(ready);return cscope.hasOwnProperty("setReady")&&ready_list.push(cscope.setReady()),ready_list}}(this),$scope.checkReady=function(){var checkread,i,len,ready_list,v;if(ready_list=isScopeReady($scope),checkread=$q.defer(),$scope.$checkingReady=checkread.promise,ready_list=ready_list.filter(function(v){return!("boolean"==typeof v&&v)}),!ready_list||0===ready_list.length)return checkread.resolve(),!0;for(i=0,len=ready_list.length;len>i;i++)if(v=ready_list[i],"boolean"==typeof value||!v)return checkread.reject(),!1;return $scope.notLoaded($scope),$q.all(ready_list).then(function(){return $scope.setLoaded($scope),checkread.resolve()},function(err){return $scope.setLoaded($scope)}),!0},$scope.routeReady=function(route){return $scope.$checkingReady?$scope.$checkingReady.then(function(_this){return function(){return $scope.decideNextPage(route)}}(this)):$scope.decideNextPage(route)}},angular.module("BB.Directives").directive("bbPage",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PageController"}}),angular.module("BB.Controllers").controller("PageController",BBBasicPageCtrl),angular.module("BB.Services").value("PageControllerService",BBBasicPageCtrl)}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPayment",function($window,$location,$sce,SettingsService){var error,getHost,linker,sendLoadEvent;return error=function(scope,message){return scope.error(message)},getHost=function(url){var a;return a=document.createElement("a"),a.href=url,a.protocol+"//"+a.host},sendLoadEvent=function(element,origin,scope){var custom_stylesheet,payload,referrer;return referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),scope.payment_options.custom_stylesheet&&(custom_stylesheet=scope.payment_options.custom_stylesheet),payload=JSON.stringify({type:"load",message:referrer,custom_partial_url:scope.bb.custom_partial_url,custom_stylesheet:custom_stylesheet,scroll_offset:SettingsService.getScrollOffset()}),element.find("iframe")[0].contentWindow.postMessage(payload,origin)},linker=function(scope,element,attributes){return scope.payment_options=scope.$eval(attributes.bbPayment)||{},scope.route_to_next_page=null!=scope.payment_options.route_to_next_page?!1:!0,element.find("iframe").bind("load",function(_this){return function(event){var origin,url;return scope.bb&&scope.bb.total&&scope.bb.total.$href("new_payment")&&(url=scope.bb.total.$href("new_payment")),origin=getHost(url),sendLoadEvent(element,origin,scope),scope.$apply(function(){return scope.callSetLoaded()})}}(this)),$window.addEventListener("message",function(_this){return function(event){var data;return angular.isObject(event.data)?data=event.data:event.data.match(/iFrameSizer/)||(data=JSON.parse(event.data)),scope.$apply(function(){if(data)switch(data.type){case"submitting":return scope.callNotLoaded();case"error":return scope.callSetLoaded(),error(scope,event.data.message);case"payment_complete":return scope.callSetLoaded(),scope.paymentDone()}})}}(this),!1)},{restrict:"AE",replace:!0,scope:!0,controller:"Payment",link:linker}}),angular.module("BB.Controllers").controller("Payment",function($scope,$rootScope,$q,$location,$window,$sce,$log,$timeout){return $scope.controller="public.controllers.Payment",$scope.notLoaded($scope),$scope.purchase&&($scope.bb.total=$scope.purchase),$rootScope.connection_started.then(function(_this){return function(){return $scope.total&&($scope.bb.total=$scope.total),$scope.bb&&$scope.bb.total&&$scope.bb.total.$href("new_payment")?$scope.url=$sce.trustAsResourceUrl($scope.bb.total.$href("new_payment")):void 0}}(this)),$scope.callNotLoaded=function(_this){return function(){return $scope.notLoaded($scope)}}(this),$scope.callSetLoaded=function(_this){return function(){return $scope.setLoaded($scope)}}(this),$scope.paymentDone=function(){return $scope.bb.payment_status="complete",$scope.$emit("payment:complete"),$scope.route_to_next_page?$scope.decideNextPage():void 0},$scope.error=function(message){return $log.warn("Payment Failure: "+message)}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPayForm",function($window,$timeout,$sce,$http,$compile,$document,$location,SettingsService){var applyCustomPartials,applyCustomStylesheet,linker;return applyCustomPartials=function(custom_partial_url,scope,element){return null!=custom_partial_url?($document.domain="bookingbug.com",$http.get(custom_partial_url).then(function(custom_templates){return $compile(custom_templates.data)(scope,function(custom,scope){var custom_form,e,i,len;for(i=0,len=custom.length;len>i;i++)e=custom[i],"STYLE"===e.tagName&&element.after(e.outerHTML);return custom_form=function(){var j,len1,results;for(results=[],j=0,len1=custom.length;len1>j;j++)e=custom[j],"payment_form"===e.id&&results.push(e);return results}(),custom_form&&custom_form[0]?$compile(custom_form[0].innerHTML)(scope,function(compiled_form,scope){var action,form;return form=element.find("form")[0],action=form.action,compiled_form.attr("action",action),$(form).replaceWith(compiled_form)}):void 0})})):void 0},applyCustomStylesheet=function(href){var css_id,head,link;return css_id="custom_css",document.getElementById(css_id)?void 0:(head=document.getElementsByTagName("head")[0],link=document.createElement("link"),link.id=css_id,link.rel="stylesheet",link.type="text/css",link.href=href,link.media="all",head.appendChild(link),link.onload=function(){return"parentIFrame"in $window?parentIFrame.size():void 0})},linker=function(scope,element,attributes){return $window.addEventListener("message",function(_this){return function(event){var data;if(angular.isObject(event.data)?data=event.data:angular.isString(event.data)&&!event.data.match(/iFrameSizer/)&&(data=JSON.parse(event.data)),data)switch(data.type){case"load":return scope.$apply(function(){return scope.referrer=data.message,data.custom_partial_url&&applyCustomPartials(event.data.custom_partial_url,scope,element),data.custom_stylesheet&&applyCustomStylesheet(data.custom_stylesheet),data.scroll_offset?SettingsService.setScrollOffset(data.scroll_offset):void 0})}}}(this),!1)},{restrict:"AE",replace:!0,scope:!0,controller:"PayForm",link:linker}}),angular.module("BB.Controllers").controller("PayForm",function($scope,$location){var sendSubmittingEvent,submitPaymentForm;return $scope.controller="public.controllers.PayForm",$scope.setTotal=function(total){return $scope.total=total},$scope.setCard=function(card){return $scope.card=card},sendSubmittingEvent=function(_this){return function(){var payload,referrer,target_origin;return referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),target_origin=$scope.referrer,payload=JSON.stringify({type:"submitting",message:referrer}),parent.postMessage(payload,target_origin)}}(this),submitPaymentForm=function(_this){return function(){var payment_form;return payment_form=angular.element.find("form"),payment_form[0].submit()}}(this),$scope.submitAndSendMessage=function(_this){return function(event){var payment_form;return event.preventDefault(),event.stopPropagation(),payment_form=$scope.$eval("payment_form"),payment_form.$invalid?(payment_form.submitted=!0,!1):(sendSubmittingEvent(),submitPaymentForm())}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPeople",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PersonList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem))}}}),angular.module("BB.Controllers").controller("PersonList",function($scope,$rootScope,PageControllerService,PersonService,ItemService,$q,BBModel,PersonModel,FormDataStoreService){var getItemFromPerson,loadData,setPerson;return $scope.controller="public.controllers.PersonList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),loadData=function(){var bi,ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),bi=$scope.booking_item,bi.service&&bi.service!==$scope.change_watch_item?($scope.change_watch_item=bi.service,$scope.notLoaded($scope),ppromise=PersonService.query($scope.bb.company),ppromise.then(function(people){return bi.group&&(people=people.filter(function(x){return!x.group_id||x.group_id===bi.group})),$scope.all_people=people}),ItemService.query({company:$scope.bb.company,cItem:bi,wait:ppromise,item:"person"}).then(function(items){var i,j,len,promises;for(bi.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===bi.group})),promises=[],j=0,len=items.length;len>j;j++)i=items[j],promises.push(i.promise);return $q.all(promises).then(function(_this){return function(res){var k,len1,people;for(people=[],k=0,len1=items.length;len1>k;k++)i=items[k],people.push(i.item),bi&&bi.person&&bi.person.self===i.item.self&&($scope.person=i.item,$scope.selected_bookable_items=[i]),bi&&bi.selected_person&&bi.selected_person.item.self===i.item.self&&(bi.selected_person=i);return 1===items.length&&$scope.bb.company.settings&&$scope.bb.company.settings.merge_people?$scope.selectItem(items[0],$scope.nextRoute)?$scope.skipThisStep():(setPerson(people),$scope.bookable_items=items,$scope.selected_bookable_items=items):(setPerson(people),$scope.bookable_items=items,$scope.selected_bookable_items||($scope.selected_bookable_items=items)),$scope.setLoaded($scope)}}(this))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void(bi.service||$scope.setLoaded($scope))},setPerson=function(people){return $scope.bookable_people=people,$scope.person?_.each(people,function(person){return person.id===$scope.person.id?$scope.person=person:void 0}):void 0},getItemFromPerson=function(_this){return function(person){var item,j,len,ref;if(person instanceof PersonModel&&$scope.bookable_items)for(ref=$scope.bookable_items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.item.self===person.self)return item;return person}}(this),$scope.selectItem=function(_this){return function(item,route){return $scope.$parent.$has_page_control?($scope.person=item,!1):($scope.booking_item.setPerson(getItemFromPerson(item)),$scope.decideNextPage(route),!0)}}(this),$scope.selectAndRoute=function(_this){return function(item,route){return $scope.booking_item.setPerson(getItemFromPerson(item)),$scope.decideNextPage(route),!0}}(this),$scope.$watch("person",function(_this){return function(newval,oldval){if($scope.person&&$scope.booking_item){if(!$scope.booking_item.person||$scope.booking_item.person.self!==$scope.person.self)return $scope.booking_item.setPerson(getItemFromPerson($scope.person)),$scope.broadcastItemUpdate()}else if(newval!==oldval)return $scope.booking_item.setPerson(null),$scope.broadcastItemUpdate()}}(this)),$scope.$on("currentItemUpdate",function(event){return loadData()}),$scope.setReady=function(_this){return function(){return $scope.person?($scope.booking_item.setPerson(getItemFromPerson($scope.person)),!0):($scope.booking_item.setPerson(null),!0)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbProductList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ProductList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("ProductList",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService,PageControllerService,halClient){return $scope.controller="public.controllers.ProductList",$scope.notLoaded($scope),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),company.$get("products").then(function(products){return products.$get("products").then(function(products){return $scope.products=products,$scope.setLoaded($scope)})})},$scope.selectItem=function(item,route){return $scope.$parent.$has_page_control?($scope.product=item,!1):($scope.booking_item.setProduct(item),$scope.decideNextPage(route),!0)}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPurchaseTotal",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PurchaseTotal"}}),angular.module("BB.Controllers").controller("PurchaseTotal",function($scope,$rootScope,$window,PurchaseTotalService,$q){return $scope.controller="public.controllers.PurchaseTotal",angular.extend(this,new $window.PageController($scope,$q)),$scope.load=function(_this){return function(total_id){return $rootScope.connection_started.then(function(){return $scope.loadingTotal=PurchaseTotalService.query({company:$scope.bb.company,total_id:total_id}),$scope.loadingTotal.then(function(total){return $scope.total=total})})}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbResources",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ResourceList"}}),angular.module("BB.Controllers").controller("ResourceList",function($scope,$rootScope,$attrs,PageControllerService,ResourceService,ItemService,$q,BBModel,ResourceModel){var getItemFromResource,loadData;return $scope.controller="public.controllers.ResourceList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.options=$scope.$eval($attrs.bbResources)||{},$rootScope.connection_started.then(function(_this){return function(){return loadData()}}(this)),loadData=function(_this){return function(){var params,rpromise;return $scope.bb.steps&&"resource_list"===$scope.bb.steps[0].page||$scope.options.resource_first||$scope.bb.current_item.service&&$scope.bb.current_item.service!==$scope.change_watch_item?($scope.change_watch_item=$scope.bb.current_item.service,$scope.notLoaded($scope),rpromise=ResourceService.query($scope.bb.company),rpromise.then(function(resources){return $scope.bb.current_item.group&&(resources=resources.filter(function(x){return!x.group_id||x.group_id===$scope.bb.current_item.group})),$scope.all_resources=resources}),params={company:$scope.bb.company,cItem:$scope.bb.current_item,wait:rpromise,item:"resource"},ItemService.query(params).then(function(items){var i,j,len,promises;for(promises=[],$scope.bb.current_item.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===$scope.bb.current_item.group})),j=0,len=items.length;len>j;j++)i=items[j],promises.push(i.promise);return $q.all(promises).then(function(res){var k,len1,resources;for(resources=[],k=0,len1=items.length;len1>k;k++)i=items[k],resources.push(i.item),$scope.bb.current_item&&$scope.bb.current_item.resource&&$scope.bb.current_item.resource.self===i.item.self&&($scope.resource=i.item);return 1===resources.length?$scope.selectItem(items[0].item,$scope.nextRoute,!0)||($scope.bookable_resources=resources,$scope.bookable_items=items):($scope.bookable_resources=resources,$scope.bookable_items=items),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return"No service link found"===err&&($scope.bb.steps&&"resource_list"===$scope.bb.steps[0].page||$scope.options.resource_first)?$scope.setLoaded($scope):$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void($scope.bb.current_item.service||$scope.setLoaded($scope))}}(this),getItemFromResource=function(_this){return function(resource){var item,j,len,ref;if(resource instanceof ResourceModel&&$scope.bookable_items)for(ref=$scope.bookable_items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.item.self===resource.self)return item;return resource}}(this),$scope.selectItem=function(_this){return function(item,route,skip_step){return null==skip_step&&(skip_step=!1),$scope.$parent.$has_page_control?($scope.resource=item,!1):($scope.bb.current_item.setResource(getItemFromResource(item)),skip_step&&$scope.skipThisStep(),$scope.decideNextPage(route),!0)}}(this),$scope.$watch("resource",function(_this){return function(newval,oldval){return $scope.resource?($scope.bb.current_item.setResource(getItemFromResource($scope.resource)),$scope.broadcastItemUpdate()):newval!==oldval?($scope.bb.current_item.setResource(null),$scope.broadcastItemUpdate()):void 0}}(this)),$scope.$on("currentItemUpdate",function(event){return loadData()}),$scope.setReady=function(_this){return function(){return $scope.resource?($scope.bb.current_item.setResource(getItemFromResource($scope.resource)),!0):($scope.bb.current_item.setResource(null),!0)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbServices",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ServiceList"}}),angular.module("BB.Controllers").controller("ServiceList",function($scope,$rootScope,$q,$attrs,$modal,$sce,ItemService,FormDataStoreService,ValidatorService,PageControllerService,halClient,AlertService,ErrorService,$filter,CategoryService){var setServiceItem;return $scope.controller="public.controllers.ServiceList",FormDataStoreService.init("ServiceList",$scope,["service"]),$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$scope.filters={category_name:null,service_name:null,price:{min:0,max:100},custom_array_value:null},$scope.show_custom_array=!1,$scope.options=$scope.$eval($attrs.bbServices)||{},$attrs.bbItem&&($scope.booking_item=$scope.$eval($attrs.bbItem)),($attrs.bbShowAll||$scope.options.show_all)&&($scope.show_all=!0),$scope.options.allow_single_pick&&($scope.allowSinglePick=!0),$scope.price_options={min:0,max:100},$rootScope.connection_started.then(function(_this){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),$scope.bb.company.$has("named_categories")?CategoryService.query($scope.bb.company).then(function(_this){return function(items){return $scope.all_categories=items}}(this),function(err){return $scope.all_categories=[]}):$scope.all_categories=[],$scope.service&&$scope.service.company_id!==$scope.bb.company.id&&($scope.service=null),ppromise=comp.getServicesPromise(),this.skipped=!1,ppromise.then(function(_this){return function(items){var filterItems,item,j,k,len,len1;if(filterItems="false"===$attrs.filterServices?!1:!0,filterItems&&($scope.booking_item.service_ref&&!$scope.show_all?items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref}):$scope.booking_item.category&&!$scope.show_all&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.booking_item.category.self}))),$scope.options.show_event_groups||(items=items.filter(function(x){return!x.is_event_group})),1!==items.length||$scope.allowSinglePick?setServiceItem(items):$scope.selectItem(items[0],$scope.nextRoute)?_this.skipped||($scope.skipThisStep(),_this.skipped=!0):setServiceItem(items),$scope.booking_item.defaultService())for(j=0,len=items.length;len>j;j++)item=items[j],(item.self===$scope.booking_item.defaultService().self||item.name===$scope.booking_item.defaultService().name&&!item.deleted)&&$scope.selectItem(item,$scope.nextRoute);if($scope.booking_item.service)for(k=0,len1=items.length;len1>k;k++)item=items[k],item.selected=!1,item.self===$scope.booking_item.service.self&&($scope.service=item,item.selected=!0,$scope.booking_item.setService($scope.service));return $scope.setLoaded($scope),$scope.booking_item.service||!($scope.booking_item.person&&!$scope.booking_item.anyPerson()||$scope.booking_item.resource&&!$scope.booking_item.anyResource())?$scope.bookable_services=$scope.items:void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.booking_item.person&&!$scope.booking_item.anyPerson()||$scope.booking_item.resource&&!$scope.booking_item.anyResource()?ItemService.query({company:$scope.bb.company,cItem:$scope.booking_item,wait:ppromise,item:"service"}).then(function(_this){return function(items){var i,services;return $scope.booking_item.service_ref&&(items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref})),$scope.booking_item.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===$scope.booking_item.group})),services=function(){var j,len,results;for(results=[],j=0,len=items.length;len>j;j++)i=items[j],null!=i.item&&results.push(i.item);return results}(),$scope.bookable_services=services,$scope.bookable_items=items,1!==services.length||$scope.allowSinglePick?setServiceItem(services):$scope.selectItem(services[0],$scope.nextRoute)?_this.skipped||($scope.skipThisStep(),_this.skipped=!0):setServiceItem(services),$scope.setLoaded($scope)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):void 0},setServiceItem=function(items){return $scope.items=items,$scope.filtered_items=$scope.items,$scope.service?_.each(items,function(item){return item.id===$scope.service.id?$scope.service=item:void 0}):void 0},$scope.selectItem=function(_this){return function(item,route){return $scope.routed?!0:$scope.$parent.$has_page_control?($scope.service=item,!1):item.is_event_group?($scope.booking_item.setEventGroup(item),$scope.decideNextPage(route),$scope.routed=!0):($scope.booking_item.setService(item),$scope.decideNextPage(route),$scope.routed=!0,!0)}}(this),$scope.$watch("service",function(_this){return function(newval,oldval){return!$scope.service||!$scope.booking_item||$scope.booking_item.service&&$scope.booking_item.service.self===$scope.service.self?void 0:($scope.booking_item.setService($scope.service),$scope.broadcastItemUpdate())}}(this)),$scope.setReady=function(_this){return function(){return $scope.service?($scope.booking_item.setService($scope.service),!0):$scope.bb.stacked_items&&$scope.bb.stacked_items.length>0?!0:!1}}(this),$scope.errorModal=function(){var error_modal;return error_modal=$modal.open({templateUrl:$scope.getPartial("_error_modal"),controller:function($scope,$modalInstance){return $scope.message=ErrorService.getError("GENERIC").msg,$scope.ok=function(){return $modalInstance.close()}}})},$scope.filterFunction=function(service){return service?($scope.service_array=[],$scope.custom_array=function(match){var item,j,len,ref;if(!match)return!1;if($scope.options.custom_filter){for(match=match.toLowerCase(),ref=service.extra[$scope.options.custom_filter],j=0,len=ref.length;len>j;j++)if(item=ref[j],item=item.toLowerCase(),item===match)return $scope.show_custom_array=!0,!0;return!1}},$scope.service_name_include=function(match){var item;return match?match?(match=match.toLowerCase(),item=service.name.toLowerCase(),item.includes(match)?!0:!1):void 0:!1},(!$scope.filters.category_name||service.category_id===$scope.filters.category_name.id)&&(!$scope.filters.service_name||$scope.service_name_include($scope.filters.service_name))&&(!$scope.filters.custom_array_value||$scope.custom_array($scope.filters.custom_array_value))&&(!service.price||service.price>=100*$scope.filters.price.min&&service.price<=100*$scope.filters.price.max)):!1},$scope.resetFilters=function(){return $scope.options.clear_results&&($scope.show_custom_array=!1),$scope.filters.category_name=null,$scope.filters.service_name=null,$scope.filters.price.min=0,$scope.filters.price.max=100,$scope.filters.custom_array_value=null,$scope.filterChanged()},$scope.filterChanged=function(){return $scope.filtered_items=$filter("filter")($scope.items,$scope.filterFunction)}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimeSlots",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeSlots",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("TimeSlots",function($scope,$rootScope,$q,$attrs,SlotService,FormDataStoreService,ValidatorService,PageControllerService,halClient,BBModel){var setItem;return $scope.controller="public.controllers.SlotList",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),$scope.start_date=moment(),$scope.end_date=moment().add(1,"month"),SlotService.query($scope.bb.company,{item:$scope.booking_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()}).then(function(slots){return $scope.slots=slots,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},setItem=function(slot){return $scope.booking_item.setSlot(slot)},$scope.selectItem=function(slot,route){return $scope.$parent.$has_page_control?(setItem(slot),!1):(setItem(slot),$scope.decideNextPage(route),!0)}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbSpaces",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"SpaceList"}}),angular.module("BB.Controllers").controller("SpaceList",function($scope,$rootScope,ServiceService,SpaceService,$q){return $scope.controller="public.controllers.SpaceList",$rootScope.connection_started.then(function(_this){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(_this){return function(comp){return SpaceService.query(comp).then(function(items){return $scope.currentItem.category&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.currentItem.category.self})),$scope.items=items,1!==items.length||$scope.allowSinglePick?$scope.listLoaded=!0:($scope.skipThisStep(),$rootScope.services=items,$scope.selectItem(items[0],$scope.nextRoute))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectItem=function(_this){return function(item,route){return $scope.currentItem.setService(item),$scope.decide_next_page(route)}}(this)})}.call(this),function(){angular.module("BB.Directives").directive("bbSurveyQuestions",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"SurveyQuestions"}}),angular.module("BB.Controllers").controller("SurveyQuestions",function($scope,$rootScope,CompanyService,PurchaseService,ClientService,$modal,$location,$timeout,BBWidget,BBModel,$q,QueryStringService,SSOService,AlertService,LoginService,$window,$upload,ServiceService,ValidatorService,PurchaseBookingService,$sessionStorage){var getBookingAndSurvey,getBookingRef,getMember,getPurchaseID,init,setPurchaseCompany,showLoginError;return $scope.controller="SurveyQuestions",$scope.completed=!1,$scope.login={email:"",password:""},$scope.login_error=!1,$scope.booking_ref="",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return init()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),init=function(_this){return function(){if($scope.company){if(!$scope.company.settings.requires_login)return getBookingAndSurvey();if($scope.checkIfLoggedIn(),$rootScope.member)return getBookingAndSurvey()}}}(this),$scope.checkIfLoggedIn=function(_this){return function(){return LoginService.checkLogin()}}(this),$scope.loadSurvey=function(_this){return function(purchase){return $scope.company||$scope.purchase.$get("company").then(function(company){return setPurchaseCompany(company)}),$scope.purchase.$has("client")&&$scope.purchase.$get("client").then(function(client){return $scope.setClient(new BBModel.Client(client))}),$scope.purchase.getBookingsPromise().then(function(bookings){var address,booking,i,len,params,pretty_address,ref,results;for(params={},$scope.bookings=bookings,ref=$scope.bookings,results=[],i=0,len=ref.length;len>i;i++)booking=ref[i],booking.datetime&&(booking.pretty_date=moment(booking.datetime).format("dddd, MMMM Do YYYY")),booking.address&&(address=new BBModel.Address(booking.address),pretty_address=address.addressSingleLine(),booking.pretty_address=pretty_address),$rootScope.user&&(params.admin_only=!0),results.push(booking.$get("survey_questions",params).then(function(details){var item_details;return item_details=new BBModel.ItemDetails(details),
booking.survey_questions=item_details.survey_questions,booking.getSurveyAnswersPromise().then(function(answers){var answer,j,k,len1,len2,question,ref1,ref2;for(booking.survey_answers=answers,ref1=booking.survey_questions,j=0,len1=ref1.length;len1>j;j++)if(question=ref1[j],booking.survey_answers)for(ref2=booking.survey_answers,k=0,len2=ref2.length;len2>k;k++)answer=ref2[k],answer.question_text===question.name&&answer.value&&(question.answer=answer.value);return $scope.setLoaded($scope)})}));return results},function(err){return $scope.setLoaded($scope),failMsg()})}}(this),$scope.submitSurveyLogin=function(_this){return function(form){return ValidatorService.validateForm(form)?LoginService.companyLogin($scope.company,{},{email:$scope.login.email,password:$scope.login.password,id:$scope.company.id}).then(function(member){return LoginService.setLogin(member),getBookingAndSurvey()},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):void 0}}(this),$scope.loadSurveyFromPurchaseID=function(_this){return function(id){var auth_token,params;return params={purchase_id:id,url_root:$scope.bb.api_url},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.query(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.loadSurveyFromBookingRef=function(_this){return function(id){var auth_token,params;return params={booking_ref:id,url_root:$scope.bb.api_url,raw:!0},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.bookingRefQuery(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.submitSurvey=function(_this){return function(form){var booking,i,len,params,ref,results;if(ValidatorService.validateForm(form)){for(ref=$scope.bookings,results=[],i=0,len=ref.length;len>i;i++)booking=ref[i],booking.checkReady(),booking.ready?($scope.notLoaded($scope),booking.client_id=$scope.client.id,params=booking,results.push(PurchaseBookingService.addSurveyAnswersToBooking(params).then(function(booking){return $scope.setLoaded($scope),$scope.completed=!0},function(err){return $scope.setLoaded($scope)}))):results.push($scope.decideNextPage(route));return results}}}(this),$scope.submitBookingRef=function(_this){return function(form){var auth_token,params;if(ValidatorService.validateForm(form))return $scope.notLoaded($scope),params={booking_ref:$scope.booking_ref,url_root:$scope.bb.api_url,raw:!0},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.bookingRefQuery(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.storeBookingCookie=function(){return document.cookie="bookingrefsc="+$scope.booking_ref},showLoginError=function(_this){return function(){return $scope.login_error=!0}}(this),getMember=function(_this){return function(){var params;return params={member_id:$scope.member_id,company_id:$scope.company_id},LoginService.memberQuery(params).then(function(member){return $scope.member=member})}}(this),setPurchaseCompany=function(company){return $scope.bb.company_id=company.id,$scope.bb.company=new BBModel.Company(company),$scope.company=$scope.bb.company,$scope.bb.item_defaults.company=$scope.bb.company,company.settings&&(company.settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),company.settings.merge_people)?$scope.bb.item_defaults.merge_people=!0:void 0},getBookingRef=function(){var booking_ref,matches;return matches=/^.*(?:\?|&)booking_ref=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(booking_ref=matches[1]),booking_ref},getPurchaseID=function(){var matches,purchase_id;return matches=/^.*(?:\?|&)id=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(purchase_id=matches[1]),purchase_id},getBookingAndSurvey=function(){var id;return id=getBookingRef(),id?$scope.loadSurveyFromBookingRef(id):(id=getPurchaseID())?$scope.loadSurveyFromPurchaseID(id):$scope.bb.total?$scope.loadSurveyFromPurchaseID($scope.bb.total.long_id):void 0}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimes",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeList"}}),angular.module("BB.Controllers").controller("TimeList",function($attrs,$element,$scope,$rootScope,$q,TimeService,AlertService,BBModel){return $scope.controller="public.controllers.TimeList",$scope.notLoaded($scope),$scope.data_source||($scope.data_source=$scope.bb.current_item),$scope.options=$scope.$eval($attrs.bbTimes)||{},$rootScope.connection_started.then(function(_this){return function(){return $scope.loadDay()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.setDate=function(_this){return function(date){var day;return day=new BBModel.Day({date:date,spaces:1}),$scope.setDay(day)}}(this),$scope.setDay=function(_this){return function(dayItem){return $scope.selected_day=dayItem,$scope.selected_date=dayItem.date}}(this),$scope.setDataSource=function(_this){return function(source){return $scope.data_source=source}}(this),$scope.setItemLinkSource=function(_this){return function(source){return $scope.item_link_source=source}}(this),$scope.$on("dateChanged",function(_this){return function(event,newdate){return $scope.setDate(newdate),$scope.loadDay()}}(this)),$scope.$on("currentItemUpdate",function(event){return $scope.loadDay()}),$scope.format_date=function(_this){return function(fmt){return $scope.data_source.date?$scope.data_source.date.date.format(fmt):void 0}}(this),$scope.selectSlot=function(_this){return function(slot,route){return slot&&slot.availability()>0&&($scope.item_link_source&&$scope.data_source.setItem($scope.item_link_source),$scope.selected_day&&($scope.setLastSelectedDate($scope.selected_day.date),$scope.data_source.setDate($scope.selected_day)),$scope.data_source.setTime(slot),!$scope.$parent.$has_page_control)?$scope.data_source.ready?$scope.addItemToBasket().then(function(){return $scope.decideNextPage(route)}):$scope.decideNextPage(route):void 0}}(this),$scope.highlightSlot=function(_this){return function(slot){return slot&&slot.availability()>0?($scope.selected_day&&($scope.setLastSelectedDate($scope.selected_day.date),$scope.data_source.setDate($scope.selected_day)),$scope.data_source.setTime(slot),$scope.$broadcast("slotChanged")):void 0}}(this),$scope.status=function(slot){var status;if(slot)return status=slot.status()},$scope.add=function(_this){return function(type,amount){var newdate;return newdate=moment($scope.data_source.date.date).add(amount,type),$scope.data_source.setDate(new BBModel.Day({date:newdate.format(),spaces:0})),$scope.setLastSelectedDate(newdate),$scope.loadDay(),$scope.$broadcast("dateChanged",newdate)}}(this),$scope.subtract=function(_this){return function(type,amount){return $scope.add(type,-amount)}}(this),$scope.loadDay=function(_this){return function(){var pslots;return $scope.data_source&&$scope.data_source.days_link||$scope.item_link_source?(!$scope.selected_date&&$scope.data_source&&$scope.data_source.date&&($scope.selected_date=$scope.data_source.date.date),$scope.selected_date?($scope.notLoaded($scope),pslots=TimeService.query({company:$scope.bb.company,cItem:$scope.data_source,item_link:$scope.item_link_source,date:$scope.selected_date,client:$scope.client,available:1}),pslots["finally"](function(){return $scope.setLoaded($scope)}),pslots.then(function(data){var dtimes,found_time,i,j,k,len,len1,len2,pad,ref,s,t,v;if($scope.slots=data,$scope.$broadcast("slotsUpdated"),$scope.add_padding&&data.length>0){for(dtimes={},i=0,len=data.length;len>i;i++)s=data[i],dtimes[s.time]=1;for(ref=$scope.add_padding,v=j=0,len1=ref.length;len1>j;v=++j)pad=ref[v],dtimes[pad]||data.splice(v,0,new BBModel.TimeSlot({time:pad,avail:0},data[0].service))}if(($scope.data_source.requested_time||$scope.data_source.time)&&$scope.selected_date.isSame($scope.data_source.date.date)){for(found_time=!1,k=0,len2=data.length;len2>k;k++)t=data[k],t.time===$scope.data_source.requested_time&&($scope.data_source.requestedTimeUnavailable(),$scope.selectSlot(t),found_time=!0),$scope.data_source.time&&t.time===$scope.data_source.time.time&&($scope.data_source.setTime(t),found_time=!0);if(!found_time)return $scope.options.persist_requested_time||$scope.data_source.requestedTimeUnavailable(),$scope.time_not_found=!0,AlertService.add("danger",{msg:"Sorry, your requested time slot is not available. Please choose a different time."})}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void $scope.setLoaded($scope)):$scope.setLoaded($scope)}}(this),$scope.padTimes=function(_this){return function(times){return $scope.add_padding=times}}(this),$scope.setReady=function(_this){return function(){return $scope.data_source.time?$scope.data_source.ready?$scope.addItemToBasket():!0:(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a time slot"}),!1)}}(this)}),angular.module("BB.Directives").directive("bbAccordianGroup",function(){return{restrict:"AE",scope:!0,controller:"AccordianGroup"}}),angular.module("BB.Controllers").controller("AccordianGroup",function($scope,$rootScope,$q){var hasAvailability,updateAvailability;return $scope.accordian_slots=[],$scope.is_open=!1,$scope.has_availability=!1,$scope.is_selected=!1,$scope.collaspe_when_time_selected=!0,$scope.start_time=0,$scope.end_time=0,$scope.init=function(_this){return function(start_time,end_time,options){var i,len,ref,slot;for($scope.start_time=start_time,$scope.end_time=end_time,$scope.collaspe_when_time_selected=options&&!options.collaspe_when_time_selected?!1:!0,ref=$scope.slots,i=0,len=ref.length;len>i;i++)slot=ref[i],slot.time>=start_time&&slot.time<end_time&&$scope.accordian_slots.push(slot);return updateAvailability()}}(this),updateAvailability=function(_this){return function(){var item;if($scope.has_availability=!1,$scope.accordian_slots){if($scope.has_availability=hasAvailability(),item=$scope.data_source,!(item.time&&item.time.time>=$scope.start_time&&item.time.time<$scope.end_time&&item.date&&item.date.date.isSame($scope.selected_day.date,"day")))return $scope.is_selected=!1,$scope.is_open=!1;if($scope.is_selected=!0,!$scope.collaspe_when_time_selected)return $scope.is_open=!0}}}(this),hasAvailability=function(_this){return function(){var i,len,ref,slot;if(!$scope.accordian_slots)return!1;for(ref=$scope.accordian_slots,i=0,len=ref.length;len>i;i++)if(slot=ref[i],slot.availability()>0)return!0;return!1}}(this),$scope.$on("slotChanged",function(_this){return function(event){return updateAvailability()}}(this)),$scope.$on("slotsUpdated",function(_this){return function(event){var i,len,ref,slot;for($scope.accordian_slots=[],ref=$scope.slots,i=0,len=ref.length;len>i;i++)slot=ref[i],slot.time>=$scope.start_time&&slot.time<$scope.end_time&&$scope.accordian_slots.push(slot);return updateAvailability()}}(this))})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimeRanges",function(){return{restrict:"AE",replace:!0,scope:!0,priority:1,controller:"TimeRangeList"}}),angular.module("BB.Controllers").controller("TimeRangeList",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,FormDataStoreService,ErrorService){var checkRequestedTime,currentPostcode,isSubtractValid,setTimeRange;return $scope.controller="public.controllers.TimeRangeList",currentPostcode=$scope.bb.postcode,FormDataStoreService.init("TimeRangeList",$scope,["selected_slot","postcode","original_start_date","start_at_week_start"]),currentPostcode!==$scope.postcode&&($scope.selected_slot=null,$scope.selected_date=null),$scope.postcode=$scope.bb.postcode,$scope.notLoaded($scope),$scope.data_source||($scope.data_source=$scope.bb.current_item),$rootScope.connection_started.then(function(){var date,diff,selected_day,start_date;return $scope.options=$scope.$eval($attrs.bbTimeRanges)||{},null!=$attrs.bbTimeRangeLength?$scope.time_range_length=$scope.$eval($attrs.bbTimeRangeLength):$scope.options&&$scope.options.time_range_length?$scope.time_range_length=$scope.options.time_range_length:$scope.time_range_length=7,(null!=$attrs.bbDayOfWeek||$scope.options&&$scope.options.day_of_week)&&($scope.day_of_week=null!=$attrs.bbDayOfWeek?$scope.$eval($attrs.bbDayOfWeek):$scope.options.day_of_week),(null!=$attrs.bbSelectedDay||$scope.options&&$scope.options.selected_day)&&(selected_day=null!=$attrs.bbSelectedDay?moment($scope.$eval($attrs.bbSelectedDay)):moment($scope.options.selected_day),moment.isMoment(selected_day)&&($scope.selected_day=selected_day)),$scope.options.ignore_min_advance_datetime=$scope.options.ignore_min_advance_datetime?!0:!1,!$scope.start_date&&$scope.last_selected_date?$scope.original_start_date?(diff=$scope.last_selected_date.diff($scope.original_start_date,"days"),diff%=$scope.time_range_length,diff=0===diff?diff:diff+1,start_date=$scope.last_selected_date.clone().subtract(diff,"days"),setTimeRange($scope.last_selected_date,start_date)):setTimeRange($scope.last_selected_date):$scope.bb.current_item.date||$scope.bb.current_item.requested_date?(date=$scope.bb.current_item.date?$scope.bb.current_item.date.date:$scope.bb.current_item.requested_date,setTimeRange(date)):$scope.selected_day?($scope.original_start_date=$scope.original_start_date||moment($scope.selected_day),setTimeRange($scope.selected_day)):($scope.start_at_week_start=!0,setTimeRange(moment())),$scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),setTimeRange=function(selected_date,start_date){start_date?$scope.start_date=start_date:$scope.day_of_week?$scope.start_date=selected_date.clone().day($scope.day_of_week):$scope.start_at_week_start?$scope.start_date=selected_date.clone().startOf("week"):$scope.start_date=selected_date.clone(),$scope.selected_day=selected_date,$scope.selected_date=$scope.selected_day.toDate(),isSubtractValid()},$scope.init=function(options){return null==options&&(options={}),null==options.selected_day||options.selected_day._isAMomementObject?void 0:$scope.selected_day=moment(options.selected_day)},$scope.moment=function(date){return moment(date)},$scope.setDataSource=function(source){return $scope.data_source=source},$scope.$on("currentItemUpdate",function(event){return $scope.loadData()}),$scope.add=function(type,amount){switch(amount>0&&($element.removeClass("subtract"),$element.addClass("add")),$scope.selected_day=moment($scope.selected_date),type){case"days":setTimeRange($scope.selected_day.add(amount,"days"));break;case"weeks":$scope.start_date.add(amount,type),setTimeRange($scope.start_date);break;case"months":$scope.start_date.add(amount,type).startOf("month"),setTimeRange($scope.start_date)}return $scope.loadData()},$scope.subtract=function(type,amount){return $element.removeClass("add"),$element.addClass("subtract"),$scope.add(type,-amount)},$scope.isSubtractValid=function(type,amount){var date;return!$scope.start_date||$scope.isAdmin()?!0:(date=$scope.start_date.clone().subtract(amount,type),!date.isBefore(moment(),"day"))},isSubtractValid=function(){var diff;return $scope.is_subtract_valid=!0,diff=Math.ceil($scope.selected_day.diff(moment(),"day",!0)),$scope.subtract_length=diff<$scope.time_range_length?diff:$scope.time_range_length,0>=diff&&($scope.is_subtract_valid=!1),$scope.subtract_length>1?$scope.subtract_string="Prev "+$scope.subtract_length+" days":1===$scope.subtract_length?$scope.subtract_string="Prev day":$scope.subtract_string="Prev"},$scope.selectedDateChanged=function(){return setTimeRange(moment($scope.selected_date)),$scope.selected_slot=null,$scope.loadData()},$scope.updateHideStatus=function(){var day,i,len,ref,results;for(ref=$scope.days,results=[],i=0,len=ref.length;len>i;i++)day=ref[i],results.push(day.hide=!day.date.isSame($scope.selected_day,"day"));return results},$scope.isPast=function(){return $scope.start_date?moment().isAfter($scope.start_date):!0},$scope.status=function(day,slot){var status;if(slot)return status=slot.status()},$scope.selectSlot=function(day,slot,route){return slot&&slot.availability()>0?($scope.bb.current_item.setTime(slot),day&&($scope.setLastSelectedDate(day.date),$scope.bb.current_item.setDate(day)),$scope.bb.current_item.reserve_ready?($scope.notLoaded($scope),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.decideNextPage(route)):void 0},$scope.highlightSlot=function(day,slot){var current_item;return current_item=$scope.bb.current_item,slot&&slot.availability()>0?(day&&($scope.setLastSelectedDate(day.date),current_item.setDate(day)),current_item.setTime(slot),current_item.setDate(day),$scope.selected_slot=slot,$scope.selected_day=day.date,$scope.selected_date=day.date.toDate(),!$scope.bb.current_item.earliest_time_slot||!$scope.bb.current_item.earliest_time_slot.selected||$scope.bb.current_item.earliest_time_slot.date.isSame(day.date,"day")&&$scope.bb.current_item.earliest_time_slot.time===slot.time||($scope.bb.current_item.earliest_time_slot.selected=!1),$scope.updateHideStatus(),$rootScope.$broadcast("time:selected"),$scope.$broadcast("slotChanged",day,slot)):void 0},$scope.loadData=function(){var current_item,date,duration,edate,loc,promise;return current_item=$scope.bb.current_item,current_item.service&&!$scope.options.ignore_min_advance_datetime&&($scope.min_date=current_item.service.min_advance_datetime,$scope.max_date=current_item.service.max_advance_datetime,$scope.selected_day&&$scope.selected_day.isBefore(current_item.service.min_advance_datetime,"day")&&!$scope.isAdmin()&&setTimeRange(current_item.service.min_advance_datetime)),date=$scope.start_date,edate=moment(date).add($scope.time_range_length,"days"),$scope.end_date=moment(edate).add(-1,"days"),AlertService.clear(),duration=$scope.bb.current_item.duration,$scope.bb.current_item.min_duration&&(duration=$scope.bb.current_item.min_duration),loc=null,$scope.bb.postcode&&(loc=",,,,"+$scope.bb.postcode+","),$scope.data_source&&$scope.data_source.days_link?($scope.notLoaded($scope),loc=null,$scope.bb.postcode&&(loc=",,,,"+$scope.bb.postcode+","),promise=TimeService.query({company:$scope.bb.company,resource_ids:$scope.bb.item_defaults.resources,cItem:$scope.data_source,date:date,client:$scope.client,end_date:$scope.end_date,duration:duration,location:loc,num_resources:$scope.bb.current_item.num_resources,available:1}),promise["finally"](function(){return $scope.setLoaded($scope)}),promise.then(function(datetime_arr){var d,day,dtimes,i,j,k,len,len1,len2,pad,pair,ref,ref1,slot,time_slots,v;for($scope.days=[],ref=_.sortBy(_.pairs(datetime_arr),function(pair){return pair[0]}),i=0,len=ref.length;len>i;i++){if(pair=ref[i],d=pair[0],time_slots=pair[1],day={date:moment(d),slots:time_slots},$scope.days.push(day),time_slots.length>0&&((!current_item.earliest_time||current_item.earliest_time.isAfter(d))&&(current_item.earliest_time=moment(d).add(time_slots[0].time,"minutes")),(!current_item.earliest_time_slot||current_item.earliest_time_slot.date.isAfter(d))&&(current_item.earliest_time_slot={date:moment(d).add(time_slots[0].time,"minutes"),time:time_slots[0].time})),$scope.add_padding&&time_slots.length>0){for(dtimes={},j=0,len1=time_slots.length;len1>j;j++)slot=time_slots[j],dtimes[slot.time]=1,slot.date=day.date.format("DD-MM-YY");for(ref1=$scope.add_padding,v=k=0,len2=ref1.length;len2>k;v=++k)pad=ref1[v],dtimes[pad]||time_slots.splice(v,0,new BBModel.TimeSlot({time:pad,avail:0},time_slots[0].service))}checkRequestedTime(day,time_slots)}return $scope.updateHideStatus()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.setLoaded($scope)},checkRequestedTime=function(day,time_slots){var current_item,found_time,i,len,slot;if(current_item=$scope.bb.current_item,(current_item.requested_time||current_item.time)&&current_item.requested_date&&day.date.isSame(current_item.requested_date)){for(found_time=!1,i=0,len=time_slots.length;len>i;i++){if(slot=time_slots[i],slot.time===current_item.requested_time)return current_item.requestedTimeUnavailable(),$scope.selectSlot(day,slot),found_time=!0,void($scope.days=[]);current_item.time&&current_item.time.time===slot.time&&1===slot.avail&&($scope.selected_slot&&$scope.selected_slot.time!==current_item.time.time&&($scope.selected_slot=current_item.time),current_item.setTime(slot),found_time=!0)}if(!found_time)return current_item.requestedTimeUnavailable(),AlertService.raise(ErrorService.getAlert("REQ_TIME_NOT_AVAIL"))}},$scope.padTimes=function(times){return $scope.add_padding=times},$scope.setReady=function(){return $scope.bb.current_item.time?$scope.bb.moving_booking&&$scope.bb.current_item.start_datetime().isSame($scope.bb.current_item.original_datetime)?(AlertService.raise(ErrorService.getAlert("APPT_AT_SAME_TIME")),!1):$scope.bb.moving_booking?($scope.bb.company.$has("resources")&&!$scope.bb.current_item.resource&&($scope.bb.current_item.resource=!0),$scope.bb.company.$has("people")&&!$scope.bb.current_item.person&&($scope.bb.current_item.person=!0),!0):$scope.bb.current_item.reserve_ready?$scope.addItemToBasket():!0:(AlertService.raise(ErrorService.getAlert("TIME_SLOT_NOT_SELECTED")),!1)},$scope.format_date=function(fmt){return $scope.start_date?$scope.start_date.format(fmt):void 0},$scope.format_start_date=function(fmt){return $scope.format_date(fmt)},$scope.format_end_date=function(fmt){return $scope.end_date?$scope.end_date.format(fmt):void 0},$scope.pretty_month_title=function(month_format,year_format,seperator){var month_year_format,start_date;return null==seperator&&(seperator="-"),month_year_format=month_format+" "+year_format,$scope.start_date&&$scope.end_date&&$scope.end_date.isAfter($scope.start_date,"month")?(start_date=$scope.format_start_date(month_format),11===$scope.start_date.month()&&(start_date=$scope.format_start_date(month_year_format)),start_date+" "+seperator+" "+$scope.format_end_date(month_year_format)):$scope.format_start_date(month_year_format)},$scope.selectEarliestTimeSlot=function(){var day,slot;return day=_.find($scope.days,function(day){return day.date.isSame($scope.bb.current_item.earliest_time_slot.date,"day")}),slot=_.find(day.slots,function(slot){return slot.time===$scope.bb.current_item.earliest_time_slot.time}),day&&slot?($scope.bb.current_item.earliest_time_slot.selected=!0,$scope.highlightSlot(day,slot)):void 0}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTotal",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Total"}}),angular.module("BB.Controllers").controller("Total",function($scope,$rootScope,$q,$location,$window,PurchaseService,QueryStringService){return $scope.controller="public.controllers.Total",$scope.notLoaded($scope),$rootScope.connection_started.then(function(_this){return function(){var id;return $scope.bb.payment_status=null,id=QueryStringService("purchase_id"),id&&!$scope.bb.total?PurchaseService.query({url_root:$scope.bb.api_url,purchase_id:id}).then(function(total){return $scope.total=total,$scope.setLoaded($scope),total.paid===total.total_price?$scope.$emit("checkout:success",total):void 0}):($scope.total=$scope.bb.total,$scope.setLoaded($scope),$scope.total.paid===$scope.total.total_price?$scope.$emit("checkout:success",$scope.total):void 0)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.print=function(_this){return function(){return $window.open($scope.bb.partial_url+"print_purchase.html?id="+$scope.total.long_id,"_blank","width=700,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0"),!0}}(this)})}.call(this),angular.module("angular-hal",[]).provider("data_cache",function(){this.$get=function(){return data=[],{set:function(key,val){return data[key]=val,val},get:function(key){return data[key]},del:function(key){delete data[key]},has:function(key){return key in data},delMatching:function(str){for(var k in data)-1!=k.indexOf(str)&&delete data[k]}}}}).provider("shared_header",function(){this.$get=function(){return data={},{set:function(key,val){return sessionStorage.setItem(key,val),data[key]=val,val},get:function(key){return data[key]},del:function(key){delete data[key]},has:function(key){return key in data}}}}).factory("halClient",["$http","$q","data_cache","shared_header","UriTemplate",function($http,$q,data_cache,shared_header,UriTemplate){function BaseResource(href,options,data){function defineHiddenProperty(target,name,value){target[name]=value}function embedResource(resource){if(angular.isArray(resource))return resource.map(function(resource){return embedResource(resource)});var href=resource.$href("self");embedded.set(href,$q.when(resource))}function hrefLink(link,params){var href=link.templated?new UriTemplate(link.href).fillFromObject(params||{}):link.href;return href}function callLink(method,link,params,data){if(angular.isArray(link))return $q.all(link.map(function(link){if("GET"!==method)throw"method is not supported for arrays";return callLink(method,link,params,data)}));var linkHref=hrefLink(link,params);return"GET"===method?embedded.has(linkHref)?embedded.get(linkHref):embedded.set(linkHref,callService(method,linkHref,options,data)):callService(method,linkHref,options,data)}function flushLink(link,params){if(angular.isArray(link))return link.map(function(link){return flushLink(link,params)});var linkHref=hrefLink(link,params);embedded.has(linkHref)&&embedded.del(linkHref)}options||(options={});var links={},embedded=data_cache;data.hasOwnProperty("auth_token")&&(options.auth_token=data.auth_token),href=getSelfLink(href,data).href,defineHiddenProperty(this,"$href",function(rel,params){return rel in links?hrefLink(links[rel],params):null}),defineHiddenProperty(this,"$has",function(rel){return rel in links}),defineHiddenProperty(this,"$flush",function(rel,params){var link=links[rel];return flushLink(link,params)}),defineHiddenProperty(this,"$get",function(rel,params){var link=links[rel];return callLink("GET",link,params)}),defineHiddenProperty(this,"$post",function(rel,params,data){var link=links[rel];return callLink("POST",link,params,data)}),defineHiddenProperty(this,"$put",function(rel,params,data){var link=links[rel];return callLink("PUT",link,params,data)}),defineHiddenProperty(this,"$patch",function(rel,params,data){var link=links[rel];return callLink("PATCH",link,params,data)}),defineHiddenProperty(this,"$del",function(rel,params){var link=links[rel];return callLink("DELETE",link,params)}),defineHiddenProperty(this,"$links",function(){return links}),defineHiddenProperty(this,"$toStore",function(){return JSON.stringify({data:this,links:links,options:options})}),defineHiddenProperty(this,"setOption",function(key,value){options[key]=value}),defineHiddenProperty(this,"getOption",function(key){return options[key]}),defineHiddenProperty(this,"$link",function(rel){return links[rel]}),Object.keys(data).filter(function(key){return!~["_","$"].indexOf(key[0])}).forEach(function(key){this[key]=data[key]},this),data._links&&Object.keys(data._links).forEach(function(rel){var link=data._links[rel];link=normalizeLink(href,link),links[rel]=link},this),data._embedded&&Object.keys(data._embedded).forEach(function(rel){var embedded=data._embedded[rel],link=getSelfLink(href,embedded);links[rel]=link;var resource=createResource(href,options,embedded);embedResource(resource)},this)}function createResource(href,options,data){if(angular.isArray(data))return data.map(function(data){return createResource(href,options,data)});var resource=new BaseResource(href,options,data);return resource}function normalizeLink(baseHref,link){return angular.isArray(link)?link.map(function(link){return normalizeLink(baseHref,link)}):(link?("string"==typeof link&&(link={href:link}),link.href=resolveUrl(baseHref,link.href)):link={href:baseHref},link)}function getSelfLink(baseHref,resource){return angular.isArray(resource)?resource.map(function(resource){return getSelfLink(baseHref,resource)}):normalizeLink(baseHref,resource&&resource._links&&resource._links.self)}function callService(method,href,options,data){options||(options={}),headers={Authorization:options.authorization,"Content-Type":"application/json",Accept:"application/hal+json,application/json"},options.app_id&&shared_header.set("app_id",options.app_id),options.app_key&&shared_header.set("app_key",options.app_key),options.auth_token&&(sessionStorage.setItem("auth_token",options.auth_token),shared_header.set("auth_token",options.auth_token)),shared_header.has("app_id")&&(headers["App-Id"]=shared_header.get("app_id")),shared_header.has("app_key")&&(headers["App-Key"]=shared_header.get("app_key")),shared_header.has("auth_token")&&(headers["Auth-Token"]=shared_header.get("auth_token")),options.bypass_auth&&(headers["Bypass-Auth"]=options.bypass_auth);var resource=$http({method:method,url:options.transformUrl?options.transformUrl(href):href,headers:headers,data:data}).then(function(res){switch(res.headers("auth-token")&&304!=res.status&&(options.auth_token=res.headers("Auth-Token"),shared_header.set("auth_token",res.headers("Auth-Token"))),res.status){case 200:return res.data?createResource(href,options,res.data):null;case 201:return res.data?createResource(href,options,res.data):res.headers("Content-Location")?res.headers("Content-Location"):null;case 204:return null;default:return $q.reject(res)}},function(res){return $q.reject(res)});return resource}function parseHal(data){var resource=createResource(data._links.self.href,null,data);return resource}function resolveUrl(baseHref,href){for(var resultHref="",reFullUrl=/^((?:\w+\:)?)((?:\/\/)?)([^\/]*)((?:\/.*)?)$/,baseHrefMatch=reFullUrl.exec(baseHref),hrefMatch=reFullUrl.exec(href),partIndex=1;5>partIndex;partIndex++)resultHref+=hrefMatch[partIndex]?hrefMatch[partIndex]:baseHrefMatch[partIndex];return resultHref}return{setCache:function(cache){data_cache=cache},clearCache:function(str){data_cache.delMatching(str)},createResource:function(store){return"string"==typeof store&&(store=JSON.parse(store)),resource=store.data,resource._links=store.links,key=store.links.self.href,options=store.options,new BaseResource(key,options,resource)},$get:function(href,options){return!data_cache.has(href)||options&&options.no_cache?data_cache.set(href,callService("GET",href,options)):data_cache.get(href)},$post:function(href,options,data){return callService("POST",href,options,data)},$put:function(href,options,data){return callService("PUT",href,options,data)},$patch:function(href,options,data){return callService("PATCH",href,options,data)},$del:function(href,options){return callService("DELETE",href,options)},$parse:function(data){return parseHal(data)}}}]),angular.module("ngStorage",[]).factory("$fakeStorage",[function(){function FakeStorage(){}return FakeStorage.prototype.setItem=function(key,value){this[key]=value},FakeStorage.prototype.getItem=function(key){return"undefined"==typeof this[key]?null:this[key]},FakeStorage.prototype.removeItem=function(key){this[key]=void 0},FakeStorage.prototype.clear=function(){for(var key in this)this.hasOwnProperty(key)&&this.removeItem(key)},FakeStorage.prototype.key=function(index){return Object.keys(this)[index]},new FakeStorage}]).factory("$localStorage",["$window","$fakeStorage",function($window,$fakeStorage){
function isStorageSupported(storageName){var testKey="test",storage=$window[storageName];try{return storage.setItem(testKey,"1"),storage.removeItem(testKey),!0}catch(error){return!1}}var storage=isStorageSupported("localStorage")?$window.localStorage:$fakeStorage;return{setItem:function(key,value){storage.setItem(key,value)},getItem:function(key,defaultValue){return storage.getItem(key)||defaultValue},setObject:function(key,value){storage.setItem(key,JSON.stringify(value))},getObject:function(key){return JSON.parse(storage.getItem(key)||"{}")},removeItem:function(key){storage.removeItem(key)},clear:function(){storage.clear()},key:function(index){storage.key(index)}}}]).factory("$sessionStorage",["$window","$fakeStorage",function($window,$fakeStorage){function isStorageSupported(storageName){var testKey="test",storage=$window[storageName];try{return storage.setItem(testKey,"1"),storage.removeItem(testKey),!0}catch(error){return!1}}var storage=isStorageSupported("sessionStorage")?$window.sessionStorage:$fakeStorage;return{setItem:function(key,value){storage.setItem(key,value)},getItem:function(key,defaultValue){return storage.getItem(key)||defaultValue},setObject:function(key,value){storage.setItem(key,JSON.stringify(value))},getObject:function(key){return JSON.parse(storage.getItem(key)||"{}")},removeItem:function(key){storage.removeItem(key)},clear:function(){storage.clear()},key:function(index){storage.key(index)}}}]),function(){var angularFileUpload=angular.module("angularFileUpload",[]);angularFileUpload.service("$upload",["$http","$timeout",function($http,$timeout){function sendHttp(config){config.method=config.method||"POST",config.headers=config.headers||{},config.transformRequest=config.transformRequest||function(data,headersGetter){return window.ArrayBuffer&&data instanceof window.ArrayBuffer?data:$http.defaults.transformRequest[0](data,headersGetter)},window.XMLHttpRequest.__isShim&&(config.headers.__setXHR_=function(){return function(xhr){xhr&&(config.__XHR=xhr,config.xhrFn&&config.xhrFn(xhr),xhr.upload.addEventListener("progress",function(e){config.progress&&$timeout(function(){config.progress&&config.progress(e)})},!1),xhr.upload.addEventListener("load",function(e){e.lengthComputable&&config.progress&&config.progress(e)},!1))}});var promise=$http(config);return promise.progress=function(fn){return config.progress=fn,promise},promise.abort=function(){return config.__XHR&&$timeout(function(){config.__XHR.abort()}),promise},promise.xhr=function(fn){return config.xhrFn=fn,promise},promise.then=function(promise,origThen){return function(s,e,p){config.progress=p||config.progress;var result=origThen.apply(promise,[s,e,p]);return result.abort=promise.abort,result.progress=promise.progress,result.xhr=promise.xhr,result.then=promise.then,result}}(promise,promise.then),promise}this.upload=function(config){config.headers=config.headers||{},config.headers["Content-Type"]=void 0,config.transformRequest=config.transformRequest||$http.defaults.transformRequest;var formData=new FormData,origTransformRequest=config.transformRequest,origData=config.data;return config.transformRequest=function(formData,headerGetter){if(origData)if(config.formDataAppender)for(var key in origData){var val=origData[key];config.formDataAppender(formData,key,val)}else for(var key in origData){var val=origData[key];if("function"==typeof origTransformRequest)val=origTransformRequest(val,headerGetter);else for(var i=0;i<origTransformRequest.length;i++){var transformFn=origTransformRequest[i];"function"==typeof transformFn&&(val=transformFn(val,headerGetter))}formData.append(key,val)}if(null!=config.file){var fileFormName=config.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(config.file))for(var isFileFormNameString="[object String]"===Object.prototype.toString.call(fileFormName),i=0;i<config.file.length;i++)formData.append(isFileFormNameString?fileFormName+i:fileFormName[i],config.file[i],config.file[i].name);else formData.append(fileFormName,config.file,config.file.name)}return formData},config.data=formData,sendHttp(config)},this.http=function(config){return sendHttp(config)}}]),angularFileUpload.directive("ngFileSelect",["$parse","$timeout",function($parse,$timeout){return function(scope,elem,attr){var fn=$parse(attr.ngFileSelect);elem.bind("change",function(evt){var fileList,i,files=[];if(fileList=evt.target.files,null!=fileList)for(i=0;i<fileList.length;i++)files.push(fileList.item(i));$timeout(function(){fn(scope,{$files:files,$event:evt})})}),("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&elem.bind("touchend",function(e){e.preventDefault(),e.target.click()})}}]),angularFileUpload.directive("ngFileDropAvailable",["$parse","$timeout",function($parse,$timeout){return function(scope,elem,attr){if("draggable"in document.createElement("span")){var fn=$parse(attr.ngFileDropAvailable);$timeout(function(){fn(scope)})}}}]),angularFileUpload.directive("ngFileDrop",["$parse","$timeout",function($parse,$timeout){return function(scope,elem,attr){function traverseFileTree(files,item){if(item.isDirectory){var dirReader=item.createReader();processing++,dirReader.readEntries(function(entries){for(var i=0;i<entries.length;i++)traverseFileTree(files,entries[i]);processing--})}else processing++,item.file(function(file){processing--,files.push(file)})}if("draggable"in document.createElement("span")){var cancel=null,fn=$parse(attr.ngFileDrop);elem[0].addEventListener("dragover",function(evt){$timeout.cancel(cancel),evt.stopPropagation(),evt.preventDefault(),elem.addClass(attr.ngFileDragOverClass||"dragover")},!1),elem[0].addEventListener("dragleave",function(evt){cancel=$timeout(function(){elem.removeClass(attr.ngFileDragOverClass||"dragover")})},!1);var processing=0;elem[0].addEventListener("drop",function(evt){evt.stopPropagation(),evt.preventDefault(),elem.removeClass(attr.ngFileDragOverClass||"dragover");var files=[],items=evt.dataTransfer.items;if(items&&items.length>0&&items[0].webkitGetAsEntry)for(var i=0;i<items.length;i++)traverseFileTree(files,items[i].webkitGetAsEntry());else{var fileList=evt.dataTransfer.files;if(null!=fileList)for(var i=0;i<fileList.length;i++)files.push(fileList.item(i))}!function callback(delay){$timeout(function(){processing?callback(10):fn(scope,{$files:files,$event:evt})},delay||0)}()},!1)}}}])}(),angular.module("ngLocalData",["angular-hal"]).factory("$localCache",["halClient","$q",function(halClient,$q){return data={},jsonData=function(data){return data&&JSON.parse(data)},storage=function(){return sessionStorage},localSave=function(key,item){storage().setItem(key,item.$toStore())},localLoad=function(key){return res=jsonData(storage().getItem(key)),res?(r=halClient.createResource(res),def=$q.defer(),def.resolve(r),def.promise):null},localDelete=function(key){storage().removeItem(key)},{set:function(key,val){return data[key]=val,val.then(function(item){localSave(key,item)}),val},get:function(key){return localLoad(key),data[key]||(data[key]=localLoad(key)),data[key]},del:function(key){localDelete(key),delete data[key]},has:function(key){return data[key]||(res=localLoad(key),res&&(data[key]=res)),key in data}}}]).factory("$localData",["$http","$rootScope",function($http,$rootScope){function LocalDataFactory(name){function LocalData(value){this.setStore(value)}return LocalData.prototype.jsonData=function(data){return data&&JSON.parse(data)},LocalData.prototype.storage=function(){return sessionStorage},LocalData.prototype.localSave=function(item){this.storage().setItem(this.store_name+item.id,JSON.stringify(item))},LocalData.prototype.localSaveIndex=function(ids){this.storage().setItem(this.store_name,ids.join(",")),this.ids=ids},LocalData.prototype.localLoadIndex=function(){return store=this.storage().getItem(this.store_name),records=store&&store.split(",")||[],records},LocalData.prototype.localLoad=function(id){return this.jsonData(this.storage().getItem(this.store_name+id))},LocalData.prototype.count=function(){return this.ids.length},LocalData.prototype.setStore=function(name){for(this.store_name=name,this.data_store=[],this.ids=this.localLoadIndex(),a=0;a<this.ids.length;a++)this.data_store.push(this.localLoad(this.ids[a]))},LocalData.prototype.update=function(data){ids=[];for(x in data)data[x].id&&(ids.push(data[x].id),this.localSave(data[x]));this.localSaveIndex(ids)},new LocalData(name)}return LocalDataFactory}]),getControllerScope=function(controller,fn){$(document).ready(function(){var $element=$('div[data-ng-controller="'+controller+'"]'),scope=angular.element($element).scope();fn(scope)})},function(){"use strict";angular.module("BB.Directives").directive("bbBasket",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,templateUrl:function(element,attrs){return _.has(attrs,"mini")?PathSvc.directivePartial("_basket_mini"):PathSvc.directivePartial("basket")},controllerAs:"BasketCtrl",controller:function($scope,$modal,BasketService){var BasketInstanceCtrl;$scope.setUsingBasket(!0),this.empty=function(){return $scope.$eval("emptyBasket()")},this.view=function(){return $scope.$eval("viewBasket()")},$scope.showBasketDetails=function(){var modalInstance;return"basket"===$scope.bb.current_page||"checkout"===$scope.bb.current_page?!1:modalInstance=$modal.open({templateUrl:$scope.getPartial("_basket_details"),scope:$scope,controller:BasketInstanceCtrl,resolve:{basket:function(){return $scope.bb.basket}}})},BasketInstanceCtrl=function($scope,$rootScope,$modalInstance,basket){return $scope.basket=basket,$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},$scope.$watch(function(){var len;$scope.basketItemCount=len=$scope.bb.basket?$scope.bb.basket.length():0,len?1===len?$scope.basketStatus="1 item in your basket":$scope.basketStatus=len+" items in your basket":$scope.basketStatus="empty"})},link:function(scope,element,attrs){return element.bind("click",function(e){return e.preventDefault()})}}}),angular.module("BB.Directives").directive("bbMinSpend",function(){return{restrict:"A",scope:!0,controller:function($scope,$element,$attrs,AlertService,$filter){var checkMinSpend,options;return options=$scope.$eval($attrs.bbMinSpend||{}),$scope.min_spend=options.min_spend||0,$scope.setReady=function(){return checkMinSpend()},checkMinSpend=function(){var i,item,len1,price,ref;for(price=0,ref=$scope.bb.stacked_items,i=0,len1=ref.length;len1>i;i++)item=ref[i],price+=item.service.price;return price>=$scope.min_spend?(AlertService.clear(),!0):(AlertService.clear(),price=$filter("ipretty_price")($scope.min_spend),AlertService.add("warning",{msg:"You need to spend at least "+price+" to make a booking."}),!1)}}}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbBreadcrumb",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,controller:"Breadcrumbs",templateUrl:function(element,attrs){return _.has(attrs,"complex")?PathSvc.directivePartial("_breadcrumb_complex"):PathSvc.directivePartial("_breadcrumb")},link:function(scope){}}}),angular.module("BB.Controllers").controller("Breadcrumbs",function($scope){var atDisablePoint,currentStep,lastStep,loadStep;return loadStep=$scope.loadStep,$scope.steps=$scope.bb.steps,$scope.allSteps=$scope.bb.allSteps,$scope.loadStep=function(number){return lastStep()||currentStep(number)||atDisablePoint()?void 0:loadStep(number)},lastStep=function(){return $scope.bb.current_step===$scope.bb.allSteps.length},currentStep=function(step){return step===$scope.bb.current_step},atDisablePoint=function(){return angular.isDefined($scope.bb.disableGoingBackAtStep)?$scope.bb.current_step>=$scope.bb.disableGoingBackAtStep:!1},$scope.isDisabledStep=function(step){return lastStep()||currentStep(step.number)||!step.passed||atDisablePoint()?!0:!1}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbContentNew",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,templateUrl:PathSvc.directivePartial("content_main"),controller:function($scope){$scope.initPage=function(){return $scope.$eval("setPageLoaded()")}}}})}.call(this),function(){angular.module("BB.Directives").directive("bbDatepickerPopup",function($parse,$document,$timeout,$bbug){var e,ie8orLess;ie8orLess=!1;try{ie8orLess=window.parseInt(/MSIE\s*(\d)/.exec(window.navigator.userAgent)[1])}catch(_error){e=_error,ie8orLess=!1}return{restrict:"A",priority:-1,require:"ngModel",link:function(scope,element,attrs,ngModel){var callDateHandler,data,dateFormat,f,getTimeRangeScope,getter,origDateParser,replacementDateParser,timeRangeScope,yearNow;return origDateParser=null,data=element.controller("ngModel"),dateFormat=attrs.bbDatepickerPopup?attrs.bbDatepickerPopup:"DD/MM/YYYY",yearNow=moment(new Date).year(),getter=$parse(attrs.ngModel),timeRangeScope=scope,getTimeRangeScope=function(scope){return scope?scope.controller&&scope.controller.indexOf("TimeRangeList")>0?timeRangeScope=scope:getTimeRangeScope(scope.$parent):void 0},getTimeRangeScope(scope),ie8orLess&&$bbug(element).on("keydown keyup keypress",function(ev){return ev.preventDefault(),ev.stopPropagation()}),(ie8orLess||scope.display.xs)&&$bbug(element).attr("readonly","true"),$bbug(element).on("keydown",function(e){return 13===e.keyCode?(replacementDateParser($bbug(e.target).val(),!0),$document.trigger("click"),$bbug(element).blur()):void 0}),$bbug(element).on("click",function(e){return e.preventDefault(),e.stopPropagation(),$timeout(function(){return scope.opened=!0})}),callDateHandler=function(date){var isDate,watch;return watch=scope.$watch(getter,function(newVal,oldVal){return newVal?void 0:getter.assign(timeRangeScope,date)}),$timeout(watch,0),isDate=_.isDate(date),isDate&&(getter.assign(timeRangeScope,date),ngModel.$setValidity("date",!0),scope.$eval(attrs.onDateChange)),isDate},replacementDateParser=function(viewValue,returnKey){var mDate;return callDateHandler(viewValue)?viewValue:ie8orLess?viewValue:(mDate=moment(viewValue,dateFormat),mDate.isValid()||(mDate=moment(new Date)),/\/YY$/.test(dateFormat)&&(dateFormat+="YY"),0===mDate.year()&&mDate.year(yearNow),viewValue=mDate.format("MM/DD/YYYY"),viewValue=viewValue.replace(/\/00/,"/20"),/\/02\d{2}$/.test(viewValue)?void 0:returnKey?(2===mDate.year().toString().length&&mDate.year(mDate.year()+2e3),callDateHandler(mDate._d)):origDateParser.call(this,viewValue))},(f=function(){return _.isFunction(data.$parsers[0])?(origDateParser=data.$parsers[0],void(data.$parsers[0]=replacementDateParser)):setTimeout(f,10)})()}}})}.call(this),function(){angular.module("BB.Directives").directive("datetimepicker",function(){var controller,link;return controller=function($scope){return $scope.open=function($event){return $event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.$watch("$$value$$",function(value){return null!=value?$scope.updateModel(value):void 0})},link=function(scope,element,attrs,ngModel){return ngModel.$render=function(){return ngModel.$viewValue?moment.isMoment(ngModel.$viewValue)?scope.$$value$$=ngModel.$viewValue.format():scope.$$value$$=ngModel.$viewValue:scope.$$value$$=scope.schemaValidate.schema["default"]},scope.updateModel=function(value){return ngModel.$setViewValue(moment(value).format())}},{require:"ngModel",link:link,controller:controller,scope:{schemaValidate:"="},templateUrl:"datetimepicker.html"}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbFormDataStore",function(FormDataStoreService){return{require:"?bbWidget",link:function(scope){return FormDataStoreService.register(scope)}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("ngConfirmClick",function(){return{link:function(scope,element,attr){var clickAction,msg;return msg=attr.ngConfirmClick||"Are you sure?",clickAction=attr.ngConfirmedClick,element.bind("click",function(_this){return function(event){return window.confirm(msg)?scope.$eval(clickAction):void 0}}(this))}}}),app.directive("ngValidInclude",function($compile){return{link:function(scope,element,attr){return scope[attr.watchValue].then(function(_this){return function(logged){return element.attr("ng-include",attr.ngValidInclude),element.attr("ng-valid-include",null),$compile(element)(scope)}}(this))}}}),app.directive("ngDelayed",function($compile){return{link:function(scope,element,attr){return scope[attr.ngDelayedWatch].then(function(_this){return function(logged){return element.attr(attr.ngDelayed,attr.ngDelayedValue),element.attr("ng-delayed-value",null),element.attr("ng-delayed-watch",null),element.attr("ng-delayed",null),$compile(element)(scope),attr.ngDelayedReady?scope[attr.ngDelayedReady].resolve(!0):void 0}}(this))}}}),app.directive("ngInitial",function(){return{restrict:"A",controller:["$scope","$element","$attrs","$parse",function($scope,$element,$attrs,$parse){var getter,setter,val;return val=$attrs.ngInitial||$attrs.value,getter=$parse($attrs.ngModel),setter=getter.assign,"true"===val?val=!0:"false"===val&&(val=!1),setter($scope,val)}]}}),app.directive("bbPrintPage",function($window,$timeout){return{restrict:"A",link:function(scope,element,attr){return attr.bbPrintPage?scope.$watch(attr.bbPrintPage,function(_this){return function(newVal,oldVal){return $timeout(function(){return $window.print()},3e3)}}(this)):void 0}}}),app.directive("bbInclude",function($compile,$rootScope){return{link:function(scope,element,attr){var track_page;return track_page=null!=attr.bbTrackPage?!0:!1,scope.$watch("bb.path_setup",function(_this){return function(newval,oldval){return newval&&(element.attr("ng-include","'"+scope.getPartial(attr.bbInclude)+"'"),element.attr("bb-include",null),$compile(element)(scope),track_page)?$rootScope.$broadcast("page:loaded",attr.bbInclude):void 0}}(this))}}}),app.directive("bbRaiseAlertWhenInvalid",function($compile){return{require:"^form",link:function(scope,element,attr,ctrl){var options;return ctrl.raise_alerts=!0,options=scope.$eval(attr.bbRaiseAlertWhenInvalid),options&&options.alert?ctrl.alert=options.alert:void 0}}}),app.directive("bbHeader",function($compile){return{link:function(scope,element,attr){return scope.bb.waitForRoutes(),scope.$watch("bb.path_setup",function(_this){return function(newval,oldval){return newval?(element.attr("ng-include","'"+scope.getPartial(attr.bbHeader)+"'"),element.attr("bb-header",null),$compile(element)(scope)):void 0}}(this))}}}),app.directive("bbDate",function(){return{restrict:"AE",scope:!0,link:function(scope,element,attrs){var date,track_service;return track_service=null!=attrs.bbTrackService,date=attrs.bbDate?moment(scope.$eval(attrs.bbDate)):scope.bb&&scope.bb.current_item&&scope.bb.current_item.date?scope.bb.current_item.date.date:moment(),track_service&&scope.bb.current_item&&scope.bb.current_item.service&&(scope.min_date=scope.bb.current_item.service.min_advance_datetime,scope.max_date=scope.bb.current_item.service.max_advance_datetime),scope.$broadcast("dateChanged",moment(date)),scope.bb_date={date:date,js_date:date.toDate(),addDays:function(type,amount){return this.date=moment(this.date).add(amount,type),this.js_date=this.date.toDate(),scope.$broadcast("dateChanged",moment(this.date))},subtractDays:function(type,amount){return this.addDays(type,-amount)},setDate:function(date){return this.date=date,this.js_date=date.toDate(),scope.$broadcast("dateChanged",moment(this.date))}},scope.$on("currentItemUpdate",function(event){return scope.bb.current_item.service&&track_service&&(scope.min_date=scope.bb.current_item.service.min_advance_datetime,scope.max_date=scope.bb.current_item.service.max_advance_datetime,scope.bb_date.date.isBefore(scope.min_date,"day")&&scope.bb_date.setDate(scope.min_date.clone()),scope.bb_date.date.isAfter(scope.max_date,"day"))?scope.bb_date.setDate(scope.max_date.clone()):void 0}),scope.$watch("bb_date.js_date",function(newval,oldval){var ndate;return ndate=moment(newval),!scope.bb_date.date.isSame(ndate)&&(scope.bb_date.date=ndate,moment(ndate).isValid())?scope.$broadcast("dateChanged",moment(ndate)):void 0})}}}),app.directive("bbDebounce",function($timeout){return{restrict:"A",link:function(scope,element,attrs){var delay;return delay=400,attrs.bbDebounce&&(delay=attrs.bbDebounce),element.bind("click",function(_this){return function(){return $timeout(function(){return element.attr("disabled",!0)},0),$timeout(function(){return element.attr("disabled",!1)},delay)}}(this))}}}),app.directive("bbLocalNumber",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var prettyifyNumber;return prettyifyNumber=function(value){return value&&"0"!==value[0]&&(value="0"+value),value},ctrl.$formatters.push(prettyifyNumber)}}}),app.directive("bbPadWithZeros",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var how_many,options,padNumber;return options=scope.$eval(attrs.bbPadWithZeros)||{},how_many=options.how_many||2,padNumber=function(value){var i,index,padding,ref;if(value=String(value),value&&value.length<how_many){for(padding="",index=i=1,ref=how_many-value.length;ref>=1?ref>=i:i>=ref;index=ref>=1?++i:--i)padding+="0";value=padding.concat(value)}return value},ctrl.$formatters.push(padNumber)}}}),app.directive("bbFormResettable",function($parse){return{restrict:"A",controller:function($scope,$element,$attrs){return $scope.inputs=[],$scope.resetForm=function(options){var i,input,len,ref,results;for(options&&options.clear_submitted&&($scope[$attrs.name].submitted=!1),ref=$scope.inputs,results=[],i=0,len=ref.length;len>i;i++)input=ref[i],input.getter.assign($scope,null),results.push(input.controller.$setPristine());return results},{registerInput:function(input,ctrl){var getter;return getter=$parse(input),$scope.inputs.push({getter:getter,controller:ctrl})}}}}}),app.directive("bbResettable",function(){return{restrict:"A",require:["ngModel","^bbFormResettable"],link:function(scope,element,attrs,ctrls){var formResettableCtrl,ngModelCtrl;return ngModelCtrl=ctrls[0],formResettableCtrl=ctrls[1],formResettableCtrl.registerInput(attrs.ngModel,ngModelCtrl)}}}),app.directive("bbDateSplit",function($parse){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var ngModel,question;return ngModel=ctrls[0],question=scope.$eval(attrs.bbDateSplit),question.date={day:null,month:null,year:null,date:null,joinDate:function(){var date_string;return this.day&&this.month&&this.year?(date_string=this.day+"/"+this.month+"/"+this.year,this.date=moment(date_string,"DD/MM/YYYY"),date_string=this.date.toISODate(),ngModel.$setViewValue(date_string),ngModel.$render()):void 0},splitDate:function(date){return date&&date.isValid()?(this.day=date.date(),this.month=date.month()+1,this.year=date.year(),this.date=date):void 0}},question.answer&&question.date.splitDate(moment(question.answer)),ngModel.$viewValue?question.date.splitDate(moment(ngModel.$viewValue)):void 0}}}),app.directive("bbCommPref",function($parse){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var comm_pref_default,ngModelCtrl;return ngModelCtrl=ctrls[0],comm_pref_default=scope.$eval(attrs.bbCommPref||!1),ngModelCtrl.$setViewValue(comm_pref_default),scope.$watch(attrs.ngModel,function(newval,oldval){return newval!==oldval?(scope.bb.current_item.settings.send_email_followup=newval,scope.bb.current_item.settings.send_sms_followup=newval):void 0})}}}),app.directive("bbCountTicketTypes",function(){return{restrict:"A",link:function(scope,element,attrs){var counts,i,item,items,len,results;for(items=scope.$eval(attrs.bbCountTicketTypes),counts=[],results=[],i=0,len=items.length;len>i;i++)item=items[i],item.tickets?(counts[item.tickets.name]?counts[item.tickets.name]+=1:counts[item.tickets.name]=1,results.push(item.number=counts[item.tickets.name])):results.push(void 0);return results}}}),app.directive("bbCapitaliseFirstLetter",function(){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var ngModel;return ngModel=ctrls[0],scope.$watch(attrs.ngModel,function(newval,oldval){var string;newval&&(string=scope.$eval(attrs.ngModel),string=string.charAt(0).toUpperCase()+string.slice(1),ngModel.$setViewValue(string),ngModel.$render())})}}}),app.directive("apiUrl",function($rootScope,$compile,$sniffer,$timeout,$window){return{restrict:"A",replace:!0,compile:function(tElem,tAttrs){return{pre:function(scope,element,attrs){var src,url;return $rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=attrs.apiUrl,url=document.createElement("a"),url.href=attrs.apiUrl,$sniffer.msie&&$sniffer.msie<10&&url.host!==$window.location.host?(src=":"===url.protocol[url.protocol.length-1]?url.protocol+"//"+url.host+"/ClientProxy.html":url.protocol+"://"+url.host+"/ClientProxy.html",$rootScope.iframe_proxy_ready=!1,$window.iframeLoaded=function(){return $rootScope.iframe_proxy_ready=!0,$rootScope.$broadcast("iframe_proxy_ready",{iframe_proxy_ready:!0})},$compile("<iframe id='ieapiframefix' name='"+url.hostname+("' src='"+src+"' style='visibility:false;display:none;' onload='iframeLoaded()'></iframe>"))(scope,function(_this){return function(cloned,scope){return element.append(cloned)}}(this))):void 0}}}}}),app.directive("bbApiUrl",function($rootScope,$compile,$sniffer,$timeout,$window,$location){return{restrict:"A",scope:{apiUrl:"@bbApiUrl"},compile:function(tElem,tAttrs){return{pre:function(scope,element,attrs){var src,url;return $rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=scope.apiUrl,url=document.createElement("a"),url.href=scope.apiUrl,$sniffer.msie&&$sniffer.msie<10&&""!==url.host&&url.host!==$location.host()&&url.host!==$location.host()+":"+$location.port()?(src=":"===url.protocol[url.protocol.length-1]?url.protocol+"//"+url.host+"/ClientProxy.html":url.protocol+"://"+url.host+"/ClientProxy.html",$rootScope.iframe_proxy_ready=!1,$window.iframeLoaded=function(){return $rootScope.iframe_proxy_ready=!0,$rootScope.$broadcast("iframe_proxy_ready",{iframe_proxy_ready:!0})},$compile("<iframe id='ieapiframefix' name='"+url.hostname+("' src='"+src+"' style='visibility:false;display:none;' onload='iframeLoaded()'></iframe>"))(scope,function(_this){return function(cloned,scope){return element.append(cloned)}}(this))):void 0}}}}}),app.directive("bbPriceFilter",function(PathSvc){return{restrict:"AE",replace:!0,scope:!1,require:"^?bbServices",templateUrl:function(element,attrs){return PathSvc.directivePartial("_price_filter")},controller:function($scope,$attrs){var setPricefilter,suitable_max;return $scope.$watch("items",function(new_val,old_val){return new_val?setPricefilter(new_val):void 0}),setPricefilter=function(items){return $scope.price_array=_.uniq(_.map(items,function(item){return item.price/100||0})),$scope.price_array.sort(function(a,b){return a-b}),suitable_max()},suitable_max=function(){var max_number,min_number,top_number;return top_number=_.last($scope.price_array),max_number=function(){switch(!1){case!(1>top_number):return 0;case!(11>top_number):return 10;case!(51>top_number):return 50;case!(101>top_number):return 100;case!(1e3>top_number):return 100*Math.ceil(top_number/100)}}(),min_number=0,$scope.price_options={min:min_number,max:max_number},$scope.filters.price={min:min_number,max:max_number}},$scope.$watch("filters.price.min",function(new_val,old_val){return new_val!==old_val?$scope.filterChanged():void 0}),$scope.$watch("filters.price.max",function(new_val,old_val){return new_val!==old_val?$scope.filterChanged():void 0})}}}),app.directive("bbBookingExport",function($compile){return{restrict:"AE",scope:!0,template:'<div bb-include="_popout_export_booking" style="display: inline;"></div>',link:function(scope,element,attrs){var setHTML;return scope.$watch("total",function(newval,old){return newval?setHTML(newval):void 0}),scope.$watch("purchase",function(newval,old){return newval?setHTML(newval):void 0}),setHTML=function(purchase_total){return scope.html="<a class='image img_outlook' title='Add this booking to an Outlook Calendar' href='"+purchase_total.icalLink()+"'><img alt='' src='//images.bookingbug.com/widget/outlook.png'></a> <a class='image img_ical' title='Add this booking to an iCal Calendar' href='"+purchase_total.webcalLink()+"'><img alt='' src='//images.bookingbug.com/widget/ical.png'></a> <a class='image img_gcal' title='Add this booking to Google Calendar' href='"+purchase_total.gcalLink()+"' target='_blank'><img src='//images.bookingbug.com/widget/gcal.png' border='0'></a>"}}}}),app.directive("bbCurrencyField",function($filter){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var convertToCurrency,convertToInteger;return convertToCurrency=function(value){return value/100},convertToInteger=function(value){return 100*value},ctrl.$formatters.push(convertToCurrency),ctrl.$parsers.push(convertToInteger)}}})}.call(this),function(){"use strict";var app,isEmpty;app=angular.module("BB.Directives"),app.directive("bbQuestionLine",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){var e,elm,html,index;return"heading"===scope.question.detail_type&&(elm="",scope.question.name.length>0&&(elm+="<div class='bb-question-heading'>"+scope.question.name+"</div>"),scope.question.help_text&&scope.question.help_text.length>0&&(elm+="<div class='bb-question-help-text'>"+scope.question.help_text+"</div>"),element.html(elm)),scope.idmaps&&(scope.idmaps[scope.question.detail_type]&&scope.idmaps[scope.question.detail_type].block||scope.idmaps[scope.question.id]&&scope.idmaps[scope.question.id].block)?(index=scope.idmaps[scope.question.id]?scope.question.id:scope.question.detail_type,html=scope.$parent.idmaps[index].html,e=$compile(html)(scope,function(_this){return function(cloned,scope){return element.replaceWith(cloned)}}(this))):void 0}}}),app.directive("bbQuestion",function($compile,$timeout){return{priority:0,replace:!0,transclude:!1,restrict:"A",compile:function(el,attr,trans){return{pre:function(scope,element,attrs){var adminRequired,date_format,date_format_2,ref;return adminRequired=null!=(ref=attrs.bbAdminRequired)?ref:!1,date_format="DD/MM/YYYY",date_format_2="dd/MM/yyyy",null!=attrs.bbDateFormat&&"US"===attrs.bbDateFormat&&(date_format="MM/DD/YYYY",date_format_2="MM/dd/yyyy"),scope.$watch(attrs.bbQuestion,function(question){var e,html,i,index,itemx,j,lastName,len1,len2,name,placeholder,ref1,ref2;if(question){if(html="",lastName="",placeholder="",null!=attrs.defaultPlaceholder&&"text_area"===question.detail_type|"text_field"===question.detail_type&&(question["default"]&&(placeholder=question["default"]),question.answer===question["default"]&&(question.answer="")),scope.recalc=function(_this){return function(){return angular.isDefined(scope.recalc_price)&&(question.outcome||scope.recalc_price()),angular.isDefined(scope.recalc_question)?scope.recalc_question():void 0}}(this),scope.idmaps&&(scope.idmaps[question.detail_type]||scope.idmaps[question.id]))index=scope.idmaps[scope.question.id]?scope.question.id:scope.question.detail_type,html=scope.idmaps[index].html;else if("select"===question.detail_type||"select-price"===question.detail_type){for(html="<select ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' class='form-question form-control'>",ref1=question.options,i=0,len1=ref1.length;len1>i;i++)itemx=ref1[i],html+="<option data_id='"+itemx.id+"' value='"+itemx.name+"'>"+itemx.display_name+"</option>";html+="</select>"}else if("text_area"===question.detail_type)html="<textarea placeholder='"+placeholder+"' ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' rows=3 class='form-question form-control'>"+question.answer+"</textarea>";else if("radio"===question.detail_type){for(html='<div class="radio-group">',ref2=question.options,j=0,len2=ref2.length;len2>j;j++)itemx=ref2[j],html+="<div class='radio'><label class='radio-label'><input ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' type='radio' value=\""+itemx.name+'"/>'+itemx.name+"</label></div>";
html+="</div>"}else"check"===question.detail_type?(name=question.name,name===lastName&&(name=""),lastName=question.name,html="<div class='checkbox' ng-class='{\"selected\": question.answer}'><label><input name='q"+question.id+"' id='"+question.id+"' ng-model='question.answer' ng-checked='question.answer == \"1\"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' type='checkbox' value=1>"+name+"</label></div>"):html="check-price"===question.detail_type?"<div class='checkbox'><label><input name='q"+question.id+"' id='"+question.id+"' ng-model='question.answer' ng-checked='question.answer == \"1\"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' type='checkbox' value=1> ({{question.price | currency:'GBP'}})</label></div>":"date"===question.detail_type?"<div class='input-group date-picker'> <input type='text' class='form-question form-control' name='q"+question.id+"' id='"+question.id+"' bb-datepicker-popup='"+date_format+"' datepicker-popup='"+date_format_2+"' ng-model='question.answer' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' datepicker-options='{\"starting-day\": 1}' show-weeks='false' show-button-bar='false' is-open='opened' /> <span class='input-group-btn' ng-click='$event.preventDefault();$event.stopPropagation();opened=true'> <button class='btn btn-default' type='submit'><span class='glyphicon glyphicon-calendar'></span></button> </span> </div>":"<input type='text' placeholder='"+placeholder+"'  ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' class='form-question form-control'/>";if(html)return e=$compile(html)(scope,function(_this){return function(cloned,scope){return element.replaceWith(cloned)}}(this))}})},post:function(scope,$e,$a,parentControl){}}}}}),app.directive("bbQuestionSetup",function(){return{restrict:"A",terminal:!0,priority:1e3,link:function(scope,element,attrs){var block,child,def,i,id,idmaps,index,len1,ref;for(idmaps={},def=null,ref=element.children(),index=i=0,len1=ref.length;len1>i;index=++i)child=ref[index],id=$(child).attr("bb-question-id"),block=!1,$(child).attr("bb-replace-block")&&(block=!0),child.innerHTML=child.innerHTML.replace(/question_form/g,"question_form_"+index),idmaps[id]={id:id,html:child.innerHTML,block:block};return scope.idmaps=idmaps,element.replaceWith("")}}}),app.directive("bbFocus",[function(){var FOCUS_CLASS;return FOCUS_CLASS="bb-focused",{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){return ctrl.$focused=!1,element.bind("focus",function(evt){return element.addClass(FOCUS_CLASS),scope.$apply(function(){return ctrl.$focused=!0})}).bind("blur",function(evt){return element.removeClass(FOCUS_CLASS),scope.$apply(function(){return ctrl.$focused=!1})})}}}]),isEmpty=function(value){return angular.isUndefined(value)||""===value||null===value||value!==value},app.directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){var minValidator;scope.$watch(attr.ngMin,function(){ctrl.$setViewValue(ctrl.$viewValue)}),minValidator=function(value){var min;return min=scope.$eval(attr.ngMin)||0,!isEmpty(value)&&min>value?void ctrl.$setValidity("ngMin",!1):(ctrl.$setValidity("ngMin",!0),value)},ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}}}),app.directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){var maxValidator;scope.$watch(attr.ngMax,function(){ctrl.$setViewValue(ctrl.$viewValue)}),maxValidator=function(value){var max;return max=scope.$eval(attr.ngMax),!isEmpty(value)&&value>max?void ctrl.$setValidity("ngMax",!1):(ctrl.$setValidity("ngMax",!0),value)},ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}}}),app.directive("creditCardNumber",function(){var getCardType,isValid,linker;return getCardType=function(ccnumber){return ccnumber?(ccnumber=ccnumber.toString().replace(/\s+/g,""),/^(34)|^(37)/.test(ccnumber)?"american_express":/^(62)|^(88)/.test(ccnumber)?"china_unionpay":/^30[0-5]/.test(ccnumber)?"diners_club_carte_blanche":/^(2014)|^(2149)/.test(ccnumber)?"diners_club_enroute":/^36/.test(ccnumber)?"diners_club_international":/^(6011)|^(622(1(2[6-9]|[3-9][0-9])|[2-8][0-9]{2}|9([01][0-9]|2[0-5])))|^(64[4-9])|^65/.test(ccnumber)?"discover":/^35(2[89]|[3-8][0-9])/.test(ccnumber)?"jcb":/^(6304)|^(6706)|^(6771)|^(6709)/.test(ccnumber)?"laser":/^(5018)|^(5020)|^(5038)|^(5893)|^(6304)|^(6759)|^(6761)|^(6762)|^(6763)|^(0604)/.test(ccnumber)?"maestro":/^5[1-5]/.test(ccnumber)?"master":/^4/.test(ccnumber)?"visa":/^(4026)|^(417500)|^(4405)|^(4508)|^(4844)|^(4913)|^(4917)/.test(ccnumber)?"visa_electron":void 0):""},isValid=function(ccnumber){var len,mul,prodArr,sum;if(!ccnumber)return!1;for(ccnumber=ccnumber.toString().replace(/\s+/g,""),len=ccnumber.length,mul=0,prodArr=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],sum=0;len--;)sum+=prodArr[mul][parseInt(ccnumber.charAt(len),10)],mul^=1;return sum%10===0&&sum>0},linker=function(scope,element,attributes,ngModel){return scope.$watch(function(){return ngModel.$modelValue},function(newValue){return ngModel.$setValidity("card_number",isValid(newValue)),scope.cardType=getCardType(newValue),null!=newValue&&16===newValue.length?ngModel.$invalid?(element.parent().addClass("has-error"),element.parent().removeClass("has-success")):(element.parent().removeClass("has-error"),element.parent().addClass("has-success")):element.parent().removeClass("has-success")})},{restrict:"C",require:"ngModel",link:linker,scope:{cardType:"="}}}),app.directive("cardSecurityCode",function(){var linker;return linker=function(scope,element,attributes){return scope.$watch("cardType",function(newValue){return"american_express"===newValue?(element.attr("maxlength",4),element.attr("placeholder","")):(element.attr("maxlength",3),element.attr("placeholder",""))})},{restrict:"AC",link:linker,scope:{cardType:"="}}}),app.directive("bbInputGroupManager",function(ValidatorService){return{restrict:"A",controller:function($scope,$element,$attrs){return $scope.input_manger={input_groups:{},inputs:[],registerInput:function(input,name){return this.inputs.indexOf(input.$name)>=0?void 0:(this.inputs.push(input.$name),this.input_groups[name]||(this.input_groups[name]={inputs:[],valid:!1}),this.input_groups[name].inputs.push(input))},validateInputGroup:function(name){var i,input,is_valid,j,len1,len2,ref,ref1;for(is_valid=!1,ref=this.input_groups[name].inputs,i=0,len1=ref.length;len1>i&&(input=ref[i],!(is_valid=input.$modelValue));i++);if(is_valid===!this.input_groups[name].valid){for(ref1=this.input_groups[name].inputs,j=0,len2=ref1.length;len2>j;j++)input=ref1[j],input.$setValidity(input.$name,is_valid);return this.input_groups[name].valid=is_valid}}},$element.on("submit",function(){var input_group,results;results=[];for(input_group in $scope.input_manger.input_groups)results.push($scope.input_manger.validateInputGroup(input_group));return results})}}}),app.directive("bbInputGroup",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ngModel){return scope.input_manger.inputs.indexOf(ngModel.$name)>=0?void 0:(scope.input_manger.registerInput(ngModel,attrs.bbInputGroup),scope.$watch(attrs.ngModel,function(newval,oldval){return newval===!oldval?scope.input_manger.validateInputGroup(attrs.bbInputGroup):void 0}))}}}),app.directive("bbQuestionLabel",function($compile){return{transclude:!1,restrict:"A",scope:!1,link:function(scope,element,attrs){return scope.$watch(attrs.bbQuestionLabel,function(question){return!question||"check"!==question.detail_type&&"check-price"!==question.detail_type?void 0:element.html("")})}}}),app.directive("bbQuestionLink",function($compile){return{transclude:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var id;return id=parseInt(attrs.bbQuestionLink),scope.$watch("question_set",function(newval,oldval){var i,len1,q,ref,results;if(newval){for(ref=scope.question_set,results=[],i=0,len1=ref.length;len1>i;i++)q=ref[i],q.id===id?(scope.question=q,element.attr("ng-model","question.answer"),element.attr("bb-question-link",null),results.push($compile(element)(scope))):results.push(void 0);return results}})}}}),app.directive("bbQuestionSet",function($compile){return{transclude:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var set;return set=attrs.bbQuestionSet,element.addClass("ng-hide"),scope.$watch(set,function(newval,oldval){return newval?(scope.question_set=newval,element.removeClass("ng-hide")):void 0})}}}),app.directive("bbMatchInput",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl,ngModel){var compare;return scope.$watch(attrs.bbMatchInput,function(){return scope.val_1=scope.$eval(attrs.bbMatchInput),compare(ctrl.$viewValue)}),compare=function(value){return ctrl.$setValidity("match",scope.val_1===value),value},ctrl.$parsers.push(compare)}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("intTelNumber",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var convertNumber,options;return options=scope.$eval(attrs.intTelNumber),element.intlTelInput(options),convertNumber=function(value){var str;return str="",null!=scope.$eval(attrs.ngModel+"_prefix")&&(str+="+"+scope.$eval(attrs.ngModel+"_prefix")+" "),null!=scope.$eval(attrs.ngModel)&&(str+=scope.$eval(attrs.ngModel)),"+"===str[0]&&(element.intlTelInput("setNumber","+"+scope.$eval(attrs.ngModel+"_prefix")+" "+scope.$eval(attrs.ngModel)),ctrl.$setValidity("pattern",!0)),str},ctrl.$formatters.push(convertNumber)}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbLoader",function($rootScope,$compile,PathSvc,TemplateSvc){return{restrict:"A",replace:!1,scope:{},controllerAs:"LoaderCtrl",controller:function($scope){var addScopeId,hideLoader,parentScopeId,removeScopeId,scopeIdArr,showLoader;parentScopeId=$scope.$parent.$id,scopeIdArr=[],addScopeId=function(id){scopeIdArr.push(id),scopeIdArr=_.uniq(scopeIdArr)},removeScopeId=function(id){return scopeIdArr=_.without(scopeIdArr,id),scopeIdArr.length},showLoader=function(e,cscope){var sid;for(sid=cscope.$id;cscope;){if(cscope.$id===parentScopeId){addScopeId(sid),$scope.scopeLoaded=!1;break}cscope=cscope.$parent}},hideLoader=function(e,cscope){removeScopeId(cscope.$id)||($scope.scopeLoaded=!0)},$rootScope.$on("show:loader",showLoader),$rootScope.$on("hide:loader",hideLoader),$scope.scopeLoaded=!1},link:function(scope,element,attrs){TemplateSvc.get(PathSvc.directivePartial("loader")).then(function(html){var str;_.isString(attrs.bbLoader)&&(str=attrs.bbLoader.slice(1),/^#/.test(attrs.bbLoader)?html.attr("id",str):/^\./.test(attrs.bbLoader)&&html.addClass(str)),element.prepend(html),$compile(html)(scope)})}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbContent",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){return element.attr("ng-include","bb_main"),element.attr("onLoad","initPage()"),element.attr("bb-content",null),element.attr("ng-hide","hide_page"),scope.initPage=function(_this){return function(){return scope.setPageLoaded(),scope.setLoadingPage(!1)}}(this),$compile(element)(scope)}}}),app.directive("bbLoading",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){scope.scopeLoaded=scope.areScopesLoaded(scope),element.attr("ng-hide","scopeLoaded"),element.attr("bb-loading",null),$compile(element)(scope)}}}),app.directive("bbWaitFor",function($compile){return{transclude:!1,restrict:"A",priority:800,link:function(scope,element,attrs){var name,prom;name=attrs.bbWaitVar,name||(name="allDone"),scope[name]=!1,prom=scope.$eval(attrs.bbWaitFor),prom.then(function(){return scope[name]=!0})}}}),app.directive("bbScrollTo",function($rootScope,AppConfig,BreadcrumbService,$bbug,$window,SettingsService){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){var always_scroll,bb_transition_time,evnts,scrollToCallback;return evnts=attrs.bbScrollTo.split(","),always_scroll=null!=attrs.bbAlwaysScroll||!1,bb_transition_time=null!=attrs.bbTransitionTime?parseInt(attrs.bbTransitionTime,10):500,angular.isArray(evnts)?angular.forEach(evnts,function(evnt){return scope.$on(evnt,function(e){return scrollToCallback(evnt)})}):scope.$on(evnts,function(e){return scrollToCallback(evnts)}),scrollToCallback=function(evnt){var current_step,scroll_to_element;return scroll_to_element=$bbug("page:loaded"===evnt&&scope.display&&scope.display.xs&&$bbug('[data-scroll-id="'+AppConfig.uid+'"]').length?'[data-scroll-id="'+AppConfig.uid+'"]':element),current_step=BreadcrumbService.getCurrentStep(),scroll_to_element&&("page:loaded"===evnt&&current_step>1||always_scroll||"widget:restart"===evnt||!scroll_to_element.is(":visible")&&0!==scroll_to_element.offset().top)?"parentIFrame"in $window?parentIFrame.scrollToOffset(0,scroll_to_element.offset().top-SettingsService.getScrollOffset()):$bbug("html, body").animate({scrollTop:scroll_to_element.offset().top-SettingsService.getScrollOffset()},bb_transition_time):void 0}}}}),app.directive("bbSlotGrouper",function(){return{restrict:"A",scope:!0,link:function(scope,element,attrs){var i,len,slot,slots;if(slots=scope.$eval(attrs.slots)){for(scope.grouped_slots=[],i=0,len=slots.length;len>i;i++)slot=slots[i],slot.time>=scope.$eval(attrs.startTime)&&slot.time<scope.$eval(attrs.endTime)&&scope.grouped_slots.push(slot);return scope.has_slots=scope.grouped_slots.length>0}}}}),app.directive("bbForm",function($bbug,$window,SettingsService){return{restrict:"A",require:"^form",link:function(scope,elem,attrs,ctrls){var form_controller;return form_controller=ctrls,elem.on("submit",function(){var invalid_form_group,invalid_input,property;form_controller.submitted=!0;for(property in form_controller)form_controller[property].hasOwnProperty("$valid")&&(form_controller[property].submitted=!0);return scope.$apply(),invalid_form_group=elem.find(".has-error:first"),invalid_form_group&&invalid_form_group.length>0?("parentIFrame"in $window?parentIFrame.scrollToOffset(0,invalid_form_group.offset().top-SettingsService.getScrollOffset()):$bbug("html, body").animate({scrollTop:invalid_form_group.offset().top-SettingsService.getScrollOffset()},1e3),invalid_input=invalid_form_group.find(".ng-invalid"),invalid_input.focus(),!1):!0})}}}),app.directive("bbAddressMap",function($document){return{restrict:"A",scope:!0,replace:!0,controller:function($scope,$element,$attrs){return $scope.isDraggable=$document.width()>480,$scope.$watch($attrs.bbAddressMap,function(new_val,old_val){var map_item;if(new_val)return map_item=new_val,$scope.map={center:{latitude:map_item.lat,longitude:map_item["long"]},zoom:15},$scope.options={scrollwheel:!1,draggable:$scope.isDraggable},$scope.marker={id:0,coords:{latitude:map_item.lat,longitude:map_item["long"]}}})}}}),angular.module("BB.Directives").directive("bbMergeDuplicateQuestions",function(){return{restrict:"A",scope:!0,controller:function($scope,$rootScope){return $scope.questions={},$rootScope.$on("item_details:loaded",function(){var i,item,j,len,len1,question,ref,ref1;for(ref=$scope.bb.stacked_items,i=0,len=ref.length;len>i;i++)if(item=ref[i],item.item_details&&item.item_details.questions)for(item.item_details.hide_questions=!1,ref1=item.item_details.questions,j=0,len1=ref1.length;len1>j;j++){if(question=ref1[j],$scope.questions[question.id]){item.setCloneAnswers($scope.questions[question.id].item),item.item_details.hide_questions=!0;break}$scope.questions[question.id]={question:question,item:item}}return $scope.has_questions=_.pluck($scope.questions,"question").length>0})}}}),angular.module("BB.Directives").directive("bbModal",function($window,$bbug){return{restrict:"A",scope:!0,link:function(scope,elem,attrs){var deregisterWatcher;return deregisterWatcher=scope.$watch(function(){var height,modal_padding,new_height;return height=elem.height(),modal_padding=200,height>$bbug(window).height()?(new_height=$(window).height()-modal_padding,elem.attr("style","height: "+new_height+"px; overflow-y: scroll;"),deregisterWatcher()):void 0})}}})}.call(this),function(){angular.module("BB").directive("bbMemberLogin",function($log,$rootScope,$templateCache,$q,halClient,BBModel,$sessionStorage,$window,AlertService,ErrorService){return{restrict:"A",template:'<form name="login_form" ng-submit="submit(login_form)" sf-schema="schema"\nsf-form="form" sf-model="login_form" sf-options="{feedback: false}"\nng-if="schema && form"></form>',controller:function($scope,$element,$attrs){return $scope.login_form={},$rootScope.connection_started.then(function(){var session_member;return $sessionStorage.getItem("login")?(session_member=$sessionStorage.getItem("login"),session_member=halClient.createResource(session_member),$rootScope.member=new BBModel.Member.Member(session_member),$scope.setClient($rootScope.member),$scope.bb.destination?$scope.redirectTo($scope.bb.destination):($scope.setLoaded($scope),$scope.decideNextPage())):halClient.$get($scope.bb.api_url+"/api/v1").then(function(root){return root.$get("new_login").then(function(new_login){return $scope.form=new_login.form,$scope.schema=new_login.schema},function(err){return console.log("err ",err)})},function(err){return console.log("err ",err)})}),$scope.redirectTo=function(destination){return $window.location.href=destination},$scope.submit=function(form){return form.role="member",$scope.company.$post("login",{},form).then(function(login){return login.$has("members")?login.$get("members").then(function(members){var auth_token;return $rootScope.member=new BBModel.Member.Member(members[0]),auth_token=$rootScope.member.getOption("auth_token"),$sessionStorage.setItem("login",$rootScope.member.$toStore()),$sessionStorage.setItem("auth_token",auth_token),$scope.setClient($rootScope.member),$scope.bb.destination?$scope.redirectTo($scope.bb.destination):$scope.decideNextPage()}):login.$has("member")?login.$get("member").then(function(member){var auth_token;return $rootScope.member=new BBModel.Member.Member(member),auth_token=$rootScope.member.getOption("auth_token"),$sessionStorage.setItem("login",$rootScope.member.$toStore()),$sessionStorage.setItem("auth_token",auth_token),$scope.setClient($rootScope.member),$scope.decideNextPage()}):void 0},function(err){return AlertService.raise(ErrorService.getAlert("LOGIN_FAILED"))})}}}})}.call(this),function(){angular.module("BB.Directives").directive("bbMonthPicker",function(){return{restrict:"AE",replace:!0,scope:!0,require:"^bbEvents",link:function(scope,el,attrs){return scope.picker_settings=scope.$eval(attrs.bbMonthPicker)||{},scope.watch_val=attrs.dayData,scope.$watch(scope.watch_val,function(newval,oldval){return newval?scope.processDates(newval):void 0})},controller:function($scope){return $scope.processDates=function(dates){var cur_month,d,date,datehash,day_data,diff,i,j,k,l,last_date,len,m,month,months,ref,w,week;for(datehash={},i=0,len=dates.length;len>i;i++)date=dates[i],datehash[date.date.format("DDMMYY")]=date,!$scope.first_available_day&&date.spaces>0&&($scope.first_available_day=date.date);for(cur_month=$scope.picker_settings.start_at_first_available_day?$scope.first_available_day.clone().startOf("month"):moment().startOf("month"),date=cur_month.startOf("week"),last_date=_.last(dates),diff=last_date.date.diff(date,"months"),diff=diff>0?diff+1:1,$scope.num_months=$scope.picker_settings&&$scope.picker_settings.months?$scope.picker_settings.months:diff,months=[],m=j=1,ref=$scope.num_months;ref>=1?ref>=j:j>=ref;m=ref>=1?++j:--j){for(date=cur_month.clone().startOf("week"),month={weeks:[]},w=k=1;6>=k;w=++k){for(week={days:[]},d=l=1;7>=l;d=++l)date.isSame(date.clone().startOf("month"),"day")&&!month.start_date&&(month.start_date=date.clone()),day_data=datehash[date.format("DDMMYY")],week.days.push({date:date.clone(),data:day_data,available:day_data&&day_data.spaces&&day_data.spaces>0,today:moment().isSame(date,"day"),past:date.isBefore(moment(),"day"),disabled:!month.start_date||!date.isSame(month.start_date,"month")}),date.add(1,"day");month.weeks.push(week)}months.push(month),cur_month.add(1,"month")}return $scope.months=months,null!=$scope.selected_date&&$scope.selectMonthNumber($scope.selected_date.month()),$scope.selected_month=$scope.selected_month||$scope.months[0]},$scope.selectMonth=function(month){var day,i,j,len,len1,ref,ref1,week;if($scope.selected_month=month,0===$scope.mode)for(ref=month.weeks,i=0,len=ref.length;len>i;i++)for(week=ref[i],ref1=week.days,j=0,len1=ref1.length;len1>j;j++)if(day=ref1[j],day.data&&day.data.spaces>0&&(day.date.isSame(month.start_date,"day")||day.date.isAfter(month.start_date,"day")))return void $scope.showDay(day)},$scope.selectMonthNumber=function(month){var i,len,m,ref;if(!$scope.selected_month||$scope.selected_month.start_date.month()!==month){for($scope.notLoaded($scope),ref=$scope.months,i=0,len=ref.length;len>i;i++)m=ref[i],m.start_date.month()===month&&$scope.selectMonth(m);return $scope.setLoaded($scope),!0}},$scope.add=function(value){var i,index,len,month,ref;for(ref=$scope.months,index=i=0,len=ref.length;len>i;index=++i)if(month=ref[index],$scope.selected_month===month&&$scope.months[index+value])return $scope.selectMonth($scope.months[index+value]),!0;return!1},$scope.subtract=function(value){return $scope.add(-value)},$scope.setMonth=function(index,slides_to_show){var last_month_shown;return $scope.months[index]?($scope.selectMonth($scope.months[index]),last_month_shown=$scope.months[index+(slides_to_show-1)],$scope.$emit("month_picker:month_changed",$scope.months[index],last_month_shown)):void 0}}}}),angular.module("BB.Directives").directive("bbSlick",function($rootScope,$timeout,$bbug,PathSvc,$compile,$templateCache,$window){return{restrict:"A",replace:!0,scope:!0,require:"^bbMonthPicker",templateUrl:function(element,attrs){return PathSvc.directivePartial("_month_picker")},controller:function($scope,$element,$attrs){return $scope.slickOnInit=function(){return $scope.refreshing=!0,$scope.$apply(),$scope.refreshing=!1,$scope.$apply()}}}})}.call(this),function(){angular.module("BB.Directives").directive("ngOptions",function($sniffer,$rootScope){return{restrict:"A",link:function(scope,el,attrs){var size;return size=parseInt(attrs.size,10),!isNaN(size)&&size>1&&$sniffer.msie?$rootScope.$on("loading:finished",function(){return el.focus(),$("body").focus()}):void 0}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("script",function($compile,halClient){return{transclude:!1,restrict:"E",link:function(scope,element,attrs){var body,json,res;return"text/hal-object"===attrs.type?(body=element[0].innerText,json=$bbug.parseJSON(body),res=halClient.$parse(json)):void 0}}})}.call(this),function(){angular.module("BB.Directives").directive("bbPaymentButton",function($compile,$sce,$http,$templateCache,$q,$log){var getButtonFormTemplate,getTemplate,linker,setClassAndValue;return getTemplate=function(type,scope){switch(type){case"button_form":return getButtonFormTemplate(scope);case"page":return'<a ng-click="decideNextPage()">{{label}}</a>';case"location":return"<a href='{{payment_link}}'>{{label}}</a>";default:return""}},getButtonFormTemplate=function(scope){var src;return src=$sce.parseAsResourceUrl("'"+scope.payment_link+"'")(),$http.get(src,{}).then(function(response){return response.data})},setClassAndValue=function(scope,element,attributes){var c,i,inputs,j,len,main_tag,ref,results;switch(scope.link_type){case"button_form":inputs=element.find("input"),main_tag=function(){var j,len,results;for(results=[],j=0,len=inputs.length;len>j;j++)i=inputs[j],"submit"===$(i).attr("type")&&results.push(i);return results}()[0],attributes.value&&$(main_tag).attr("value",attributes.value);break;case"page":case"location":main_tag=element.find("a")[0]}if(attributes["class"]){for(ref=attributes["class"].split(" "),results=[],j=0,len=ref.length;len>j;j++)c=ref[j],$(main_tag).addClass(c),results.push($(element).removeClass(c));return results}},linker=function(scope,element,attributes){return scope.$watch("total",function(){var url;return scope.bb.payment_status="pending",scope.bb.total=scope.total,scope.link_type=scope.total.$link("new_payment").type,scope.label=attributes.value||"Make Payment",scope.payment_link=scope.total.$href("new_payment"),url=scope.total.$href("new_payment"),$q.when(getTemplate(scope.link_type,scope)).then(function(template){return element.html(template).show(),$compile(element.contents())(scope),setClassAndValue(scope,element,attributes)},function(err){return $log.warn(err.data),element.remove()})})},{restrict:"EA",replace:!0,scope:{total:"=",bb:"=",decideNextPage:"="},link:linker}}),angular.module("BB.Directives").directive("bbPaypalExpressButton",function($compile,$sce,$http,$templateCache,$q,$log,$window,UriTemplate){var linker;return linker=function(scope,element,attributes){var paypalOptions,total;return total=scope.total,paypalOptions=scope.paypalOptions,scope.href=new UriTemplate(total.$link("paypal_express").href).fillFromObject(paypalOptions),scope.showLoader=function(){return scope.notLoaded?scope.notLoaded(scope):void 0}},{restrict:"EA",replace:!0,template:'<a ng-href="{{href}}" ng-click="showLoader()">Pay</a>',scope:{total:"=",bb:"=",decideNextPage:"=",paypalOptions:"=bbPaypalExpressButton",notLoaded:"="},link:linker}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbPaypal",function(PathSvc){return{restrict:"A",replace:!0,scope:{ppDetails:"=bbPaypal"},templateUrl:PathSvc.directivePartial("paypal_button"),link:function(scope,element,attrs){var keys;return scope.inputs=[],scope.ppDetails?(keys=_.keys(scope.ppDetails),_.each(keys,function(keyName){var obj;return obj={name:keyName,value:scope.ppDetails[keyName]},scope.inputs.push(obj)})):void 0}}})}.call(this),function(){angular.module("BB.Directives").directive("pricepicker",function(){var controller,link;return controller=function($scope){return $scope.$watch("price",function(price){return null!=price?$scope.updateModel(price):void 0})},link=function(scope,element,attrs,ngModel){return ngModel.$render=function(){return ngModel.$viewValue?scope.price=ngModel.$viewValue:void 0},scope.updateModel=function(value){return ngModel.$setViewValue(value)}},{require:"ngModel",link:link,controller:controller,scope:{currency:"@"},template:'<span>{{0 | currency: currency | limitTo: 1}}</span>\n<input type="number" ng-model="price" class="form-control" step="0.01">'}})}.call(this),function(){angular.module("BB.Directives").directive("scoped",function($document,$timeout){var scopeIt;return this.compat=function(){var DOMRules,DOMStyle,changeSelectorTextAllowed,check,e,scopeSupported,testSheet,testStyle;check=document.createElement("style"),DOMStyle="undefined"!=typeof check.sheet?"sheet":"undefined"!=typeof check.getSheet?"getSheet":"styleSheet",scopeSupported=void 0!==check.scoped,document.body.appendChild(check),testSheet=check[DOMStyle],testSheet.addRule?testSheet.addRule("c","blink"):testSheet.insertRule("c{}",0),DOMRules=testSheet.rules?"rules":"cssRules",testStyle=testSheet[DOMRules][0];try{testStyle.selectorText="d"}catch(_error){e=_error}return changeSelectorTextAllowed="d"===testStyle.selectorText.toLowerCase(),check.parentNode.removeChild(check),{scopeSupported:scopeSupported,rules:DOMRules,sheet:DOMStyle,changeSelectorTextAllowed:changeSelectorTextAllowed}}(),scopeIt=function(_this){return function(element){var allRules,glue,id,idCounter,index,par,results,rule,selector,sheet,styleNode,styleRule;if(styleNode=element[0],idCounter=0,sheet=styleNode[_this.compat.sheet]){for(allRules=sheet[_this.compat.rules],par=styleNode.parentNode,id=par.id||(par.id="scopedByScopedPolyfill_"+ ++idCounter),glue="",index=allRules.length||0;par;)par.id&&(glue="#"+par.id+" "+glue),par=par.parentNode;for(results=[];index--;)rule=allRules[index],rule.selectorText?rule.selectorText.match(new RegExp(glue))?results.push(void 0):(selector=glue+" "+rule.selectorText.split(",").join(", "+glue),selector=selector.replace(/[\ ]+:root/gi,""),_this.compat.changeSelectorTextAllowed?results.push(rule.selectorText=selector):rule.type&&1!==rule.type?results.push(void 0):(styleRule=rule.style.cssText,styleRule?(sheet.removeRule?sheet.removeRule(index):sheet.deleteRule(index),sheet.addRule?results.push(sheet.addRule(selector,styleRule)):results.push(sheet.insertRule(selector+"{"+styleRule+"}",index))):results.push(void 0))):results.push(void 0);return results}}}(this),{restrict:"A",link:function(scope,element,attrs){return scope.scopeSupported=this.compat.scopeSupported,this.compat.scopeSupported?void 0:$timeout(function(){return scopeIt(element)})},controller:function($scope,$element,$timeout){$scope.scopeSupported||(this.updateCss=function(){return $timeout(function(){return scopeIt($element)})})}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("bbDisplayMode",function($compile,$window,$bbug){return{transclude:!1,restrict:"A",template:'<span class="visible-xs"></span><span class="visible-sm"></span><span class="visible-md"></span><span class="visible-lg"></span>',link:function(scope,elem,attrs){var getCurrentSize,isVisible,markers,t,update;return markers=elem.find("span"),$bbug(elem).addClass("bb-display-mode"),scope.display={},isVisible=function(element){return element&&"none"!==element.style.display&&element.offsetWidth&&element.offsetHeight},getCurrentSize=function(){var element,i,len;for(i=0,len=markers.length;len>i;i++)return element=markers[i],isVisible(element)?element.className.slice(8,11):(scope.display={},scope.display[element.className.slice(8,11)]=!0,!1)},update=function(_this){return function(){var nsize;return nsize=getCurrentSize(),nsize!==_this.currentSize?(_this.currentSize=nsize,scope.display.xs=!1,scope.display.sm=!1,scope.display.md=!1,scope.display.lg=!1,scope.display.not_xs=!0,scope.display.not_sm=!0,scope.display.not_md=!0,scope.display.not_lg=!0,scope.display[nsize]=!0,scope.display["not_"+nsize]=!1,!0):!1}}(this),t=null,angular.element($window).bind("resize",function(_this){return function(){return window.clearTimeout(t),t=setTimeout(function(){return update()?scope.$apply():void 0},50)}}(this)),angular.element($window).bind("load",function(_this){return function(){return update()?scope.$apply():void 0}}(this))}}})}.call(this),function(){angular.module("BB.Directives").directive("bbToggleEdit",function($compile,$window,$document){return{restrict:"AE",link:function(scope,element,attr){return scope.editing=!1,element.on("dblclick",function(_this){return function(event){return scope.$apply(function(){return scope.editing=!0})}}(this)),$document.on("click",function(_this){return function(){return element.is(":hover")?void 0:scope.$apply(function(){return scope.editing=!1})}}(this)),!0}}})}.call(this),function(){angular.module("BB.Directives").directive("popover",function(){var openElement,openScope;return openElement=null,openScope=null,$('div[ng-controller="BBCtrl"]').off(".bbtooltip").on("click.bbtooltip",function(e){var target;return target=$(e.target).closest("[popover]")[0],!target&&openElement&&openScope&&($(openElement).next(".popover").remove(),openScope.tt_isOpen=!1),!0}),{restrict:"EA",priority:-1e3,link:function(scope,element){return element.on("click.bbtooltip",function(e){return openElement===$(e.target).closest("[popover]")[0]?void e.preventDefault():(openElement&&openScope&&($(openElement).next(".popover").remove(),openScope.tt_isOpen=!1),openElement=element[0],openScope=scope)}),scope.$on("$destroy",function(){return $(element).off(".bbtooltip")})}}})}.call(this),function(angular){"use strict";var app=angular.module("BB.Directives");app.directive("appVersion",function(version){
return function(scope,elm,attrs){elm.text(version)}})}(window.angular),function(){var app;app=angular.module("BB.Filters"),app.filter("stripPostcode",function(){return function(address){var match;return match=address.toLowerCase().match(/[a-z]+\d/),match&&(address=address.substr(0,match.index)),address=$.trim(address),/,$/.test(address)&&(address=address.slice(0,-1)),address}}),app.filter("labelNumber",function(){return function(input,labels){var response;return response=input,labels[input]&&(response=labels[input]),response}}),app.filter("interpolate",["version",function(version){return function(text){return String(text).replace(/\%VERSION\%/gm,version)}}]),app.filter("rag",function(){return function(value,v1,v2){return v1>=value?"red":v2>=value?"amber":"green"}}),app.filter("time",function($window){return function(v){return $window.sprintf("%02d:%02d",Math.floor(v/60),v%60)}}),app.filter("address_single_line",function(){return function(_this){return function(address){var addr;if(address&&address.address1)return addr="",addr+=address.address1,address.address2&&address.address2.length>0&&(addr+=", ",addr+=address.address2),address.address3&&address.address3.length>0&&(addr+=", ",addr+=address.address3),address.address4&&address.address4.length>0&&(addr+=", ",addr+=address.address4),address.address5&&address.address5.length>0&&(addr+=", ",addr+=address.address5),address.postcode&&address.postcode.length>0&&(addr+=", ",addr+=address.postcode),addr}}(this)}),app.filter("address_multi_line",function(){return function(_this){return function(address){var str;if(address&&address.address1)return str="",address.address1&&(str+=address.address1),address.address2&&str.length>0&&(str+="<br/>"),address.address2&&(str+=address.address2),address.address3&&str.length>0&&(str+="<br/>"),address.address3&&(str+=address.address3),address.address4&&str.length>0&&(str+="<br/>"),address.address4&&(str+=address.address4),address.address5&&str.length>0&&(str+="<br/>"),address.address5&&(str+=address.address5),address.postcode&&str.length>0&&(str+="<br/>"),address.postcode&&(str+=address.postcode),str}}(this)}),app.filter("map_lat_long",function(){return function(_this){return function(address){var cord;if(address&&address.map_url)return cord=/([-+]*\d{1,3}[\.]\d*)[, ]([-+]*\d{1,3}[\.]\d*)/.exec(address.map_url),cord[0]}}(this)}),app.filter("currency",function($filter){return function(_this){return function(number,currencyCode){return $filter("icurrency")(number,currencyCode)}}(this)}),app.filter("icurrency",function($window,$rootScope){return function(_this){return function(number,currencyCode){var currency,decimal,format,thousand;return currencyCode||(currencyCode=$rootScope.bb_currency),currency={USD:"$",GBP:"",AUD:"$",EUR:"",CAD:"$",MIXED:"~"},$.inArray(currencyCode,["USD","AUD","CAD","MIXED","GBP"])>=0?(thousand=",",decimal=".",format="%s%v"):(thousand=".",decimal=",",format="%s%v"),number/=100,$window.accounting.formatMoney(number,currency[currencyCode],2,thousand,decimal,format)}}(this)}),app.filter("pretty_price",function($filter){return function(price,symbol){return $filter("ipretty_price")(price,symbol)}}),app.filter("ipretty_price",function($window,$rootScope){return function(price,symbol){var currency;return symbol||(currency={USD:"$",GBP:"",AUD:"$",EUR:"",CAD:"$",MIXED:"~"},symbol=currency[$rootScope.bb_currency]),price/=100,0===parseFloat(price)?"Free":parseFloat(price)%1===0?symbol+parseFloat(price):symbol+$window.sprintf("%.2f",parseFloat(price))}}),app.filter("time_period",function(){return function(v,options){var hour_string,hours,min_string,mins,seperator,str,val;if(angular.isNumber(v))return hour_string=options&&options.abbr_units?"hr":"hour",min_string=options&&options.abbr_units?"min":"minute",seperator=options&&angular.isString(options.seperator)?options.seperator:"and",val=parseInt(v),60>val?val+" "+min_string+"s":(hours=parseInt(val/60),mins=val%60,0===mins?1===hours?"1 "+hour_string:hours+" "+hour_string+"s":(str=hours+" "+hour_string,hours>1&&(str+="s"),0===mins?str:(seperator.length>0&&(str+=" "+seperator),str+=" "+mins+" "+min_string+"s")))}}),app.filter("twelve_hour_time",function($window){return function(time,options){var h,m,omit_mins_on_hour,seperator,suffix,t;if(angular.isNumber(time))return omit_mins_on_hour=options&&options.omit_mins_on_hour||!1,seperator=options&&options.seperator?options.seperator:":",t=time,h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),time=0===m&&omit_mins_on_hour?""+h:""+h+seperator+$window.sprintf("%02d",m),time+=suffix}}),app.filter("time_period_from_seconds",function(){return function(v){var hours,mins,secs,str,val;if(val=parseInt(v),60>val)return""+val+" seconds";if(hours=Math.floor(val/3600),mins=Math.floor(val%3600/60),secs=Math.floor(val%60),str="",hours>0){if(str+=hours+" hour",hours>1&&(str+="s"),0===mins&&0===secs)return str;str+=" and "}if(mins>0){if(str+=mins+" minute",mins>1&&(str+="s"),0===secs)return str;str+=" and "}return str+=secs+" second",secs>0&&(str+="s"),str}}),app.filter("round_up",function(){return function(number,interval){var result;return result=number/interval,result=parseInt(result),result*=interval,number%interval>0&&(result+=interval),result}}),app.filter("exclude_days",function(){return function(days,excluded){return _.filter(days,function(day){return-1===excluded.indexOf(day.date.format("dddd"))})}}),app.filter("us_tel",function(){return function(tel){var city,country,number,value;if(!tel)return"";if(value=tel.toString().trim().replace(/^\+/,""),value.match(/[^0-9]/))return tel;switch(country=void 0,city=void 0,number=void 0,value.length){case 10:country=1,city=value.slice(0,3),number=value.slice(3);break;case 11:country=value[0],city=value.slice(1,4),number=value.slice(4);break;case 12:country=value.slice(0,3),city=value.slice(3,5),number=value.slice(5);break;default:return tel}return 1===country&&(country=""),number=number.slice(0,3)+"-"+number.slice(3),(country+city+"-"+number).trim()}}),app.filter("uk_local_number",function(){return function(tel){return tel?tel.replace(/\+44 \(0\)/,"0"):""}}),app.filter("datetime",function(){return function(datetime,format,show_timezone){var result;return null==show_timezone&&(show_timezone=!0),datetime&&(datetime=moment(datetime),datetime.isValid())?(result=datetime.format(format),datetime.zone()!==(new Date).getTimezoneOffset()&&show_timezone&&(result+=datetime._z?datetime.format(" z"):" UTC"+datetime.format("Z")),result):void 0}}),app.filter("range",function(){return function(input,min,max){var i,j,ref,ref1;for(i=j=ref=parseInt(min),ref1=parseInt(max);ref1>=ref?ref1>=j:j>=ref1;i=ref1>=ref?++j:--j)input.push(i);return input}}),app.filter("international_number",function(){return function(_this){return function(number,prefix){return number&&prefix?prefix+" "+number:number?""+number:""}}(this)}),app.filter("startFrom",function(){return function(input,start){return void 0===input?input:input.slice(+start)}}),app.filter("add",function(){return function(_this){return function(item,value){return item&&value?(item=parseInt(item),item+value):void 0}}(this)}),app.filter("spaces_remaining",function(){return function(spaces){return 1>spaces?0:spaces}}),app.filter("key_translate",function(){return function(input){var add_underscore,remove_punctuations,upper_case;return upper_case=angular.uppercase(input),remove_punctuations=upper_case.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,""),add_underscore=remove_punctuations.replace(/\ /g,"_")}})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("AddressModel",function($q,BBModel,BaseModel){var Address;return Address=function(superClass){function Address(){return Address.__super__.constructor.apply(this,arguments)}return extend(Address,superClass),Address.prototype.addressSingleLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+=", "),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+=", "),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+=", "),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+=", "),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+=", "),this.postcode&&(str+=this.postcode),str},Address.prototype.hasAddress=function(){return this.address1||this.address2||this.postcode},Address.prototype.addressCsvLine=function(){var str;return str="",this.address1&&(str+=this.address1),str+=", ",this.address2&&(str+=this.address2),str+=", ",this.address3&&(str+=this.address3),str+=", ",this.address4&&(str+=this.address4),str+=", ",this.address5&&(str+=this.address5),str+=", ",this.postcode&&(str+=this.postcode),str+=", ",this.country&&(str+=this.country),str},Address.prototype.addressMultiLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+="<br/>"),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+="<br/>"),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+="<br/>"),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+="<br/>"),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+="<br/>"),this.postcode&&(str+=this.postcode),str},Address}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("AffiliateModel",function($q,BBModel,BaseModel){var Affiliate;return Affiliate=function(superClass){function Affiliate(data){Affiliate.__super__.constructor.call(this,data),this.test=1}return extend(Affiliate,superClass),Affiliate.prototype.getCompanyByRef=function(ref){var defer;return defer=$q.defer(),this.$get("companies",{reference:ref}).then(function(company){return company?defer.resolve(new BBModel.Company(company)):defer.reject("No company for ref "+ref)},function(err){return console.log("err ",err),defer.reject(err)}),defer.promise},Affiliate}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("AnswerModel",function($q,BBModel,BaseModel,$bbug){var Answer;return Answer=function(superClass){function Answer(data){Answer.__super__.constructor.call(this,data)}return extend(Answer,superClass),Answer.prototype.getQuestion=function(){var defer;return defer=$q.defer(),this.question&&defer.resolve(this.question),this._data.$has("question")?this._data.$get("question").then(function(_this){return function(question){return _this.question=question,defer.resolve(_this.question)}}(this)):defer.resolve([]),defer.promise},Answer}(BaseModel)})}.call(this),function(){angular.module("BB.Models").service("BBModel",function($q,$injector){var admin_models,afuncs,fn,fn1,fn2,fn3,funcs,i,j,k,l,len,len1,len2,len3,member_models,mfuncs,model,models,pfuncs,purchase_models;for(models=["Address","Answer","Affiliate","Basket","BasketItem","BookableItem","Category","Client","ClientDetails","Company","CompanySettings","Day","Event","EventChain","EventGroup","EventTicket","EventSequence","ItemDetails","Person","PurchaseItem","PurchaseTotal","Question","Resource","Service","Slot","Space","Clinic","SurveyQuestion","TimeSlot","BusinessQuestion","Image","Deal","PrePaidBooking","MembershipLevel","Product","EventCollection"],funcs={},fn=function(_this){return function(model){return funcs[model]=function(p1,p2){return new($injector.get(model+"Model"))(p1,p2)}}}(this),i=0,len=models.length;len>i;i++)model=models[i],fn(model);for(purchase_models=["Booking","Total","CourseBooking"],pfuncs={},fn1=function(_this){return function(model){return pfuncs[model]=function(init){return new($injector.get("Purchase."+model+"Model"))(init)}}}(this),j=0,len1=purchase_models.length;len1>j;j++)model=purchase_models[j],fn1(model);for(funcs.Purchase=pfuncs,member_models=["Member","Booking","PrePaidBooking","Wallet","WalletLog"],mfuncs={},fn2=function(_this){return function(model){return mfuncs[model]=function(init){return new($injector.get("Member."+model+"Model"))(init)}}}(this),k=0,len2=member_models.length;len2>k;k++)model=member_models[k],fn2(model);for(funcs.Member=mfuncs,admin_models=["Booking","Slot","User","Administrator","Schedule","Address","Resource","Person","Service","Login","EventChain","EventGroup","Event","Queuer","ClientQueue","Clinic"],afuncs={},fn3=function(_this){return function(model){return afuncs[model]=function(init){return new($injector.get("Admin."+model+"Model"))(init)}}}(this),l=0,len3=admin_models.length;len3>l;l++)model=admin_models[l],fn3(model);return funcs.Admin=afuncs,funcs}),angular.module("BB.Models").service("BaseModel",function($q,$injector,$rootScope,$timeout){var Base;return Base=function(){function Base(data){this.deleted=!1,this.updateModel(data)}return Base.prototype.updateModel=function(data){var link,links,m,n,name,obj,results;if(data&&(this._data=data),data)for(n in data)m=data[n],this[n]=m;if(this._data&&this._data.$href){this.self=this._data.$href("self"),links=this.$links(),this.__linkedData={},this.__linkedPromises={},results=[];for(link in links)obj=links[link],name=this._snakeToCamel("get_"+link),results.push(function(_this){return function(link,obj,name){return _this[name]||(_this[name]=function(){return this.$buildOject(link)}),_this[name+"Promise"]?void 0:_this[name+"Promise"]=function(){return this.$buildOjectPromise(link)}}}(this)(link,obj,name));return results}},Base.prototype._snakeToCamel=function(s){return s.replace(/(\_\w)/g,function(m){return m[1].toUpperCase()})},Base.prototype.$buildOject=function(link){return this.__linkedData[link]?this.__linkedData[link]:(this.$buildOjectPromise(link).then(function(_this){return function(ans){return _this.__linkedData[link]=ans,$timeout(function(){return _this.__linkedData[link]=ans})}}(this)),null)},Base.prototype.$buildOjectPromise=function(link){var prom;return this.__linkedPromises[link]?this.__linkedPromises[link]:(prom=$q.defer(),this.__linkedPromises[link]=prom.promise,this.$get(link).then(function(_this){return function(res){var inj;return inj=$injector.get("BB.Service."+link),inj?inj.promise?inj.unwrap(res).then(function(ans){return prom.resolve(ans)},function(err){return prom.reject(err)}):prom.resolve(inj.unwrap(res)):prom.resolve(res)}}(this),function(err){return prom.reject(err)}),this.__linkedPromises[link])},Base.prototype.get=function(ikey){return this._data?this._data[ikey]:null},Base.prototype.set=function(ikey,value){return this._data?this._data[ikey]=value:null},Base.prototype.$href=function(rel,params){return this._data?this._data.$href(rel,params):void 0},Base.prototype.$has=function(rel){return this._data?this._data.$has(rel):void 0},Base.prototype.$flush=function(rel,params){return this._data?this._data.$href(rel,params):void 0},Base.prototype.$get=function(rel,params){return this._data?this._data.$get(rel,params):void 0},Base.prototype.$post=function(rel,params,dat){return this._data?this._data.$post(rel,params,dat):void 0},Base.prototype.$put=function(rel,params,dat){return this._data?this._data.$put(rel,params,dat):void 0},Base.prototype.$patch=function(rel,params,dat){return this._data?this._data.$patch(rel,params,dat):void 0},Base.prototype.$del=function(rel,params){return this._data?this._data.$del(rel,params):void 0},Base.prototype.$links=function(){return this._data?this._data.$links():void 0},Base.prototype.$toStore=function(){return this._data?this._data.$toStore():void 0},Base}()})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BasketModel",function($q,BBModel,BaseModel){var Basket;return Basket=function(superClass){function Basket(data,scope){scope&&scope.isAdmin?this.is_admin=scope.isAdmin:this.is_admin=!1,null!=scope&&scope.parent_client&&(this.parent_client_id=scope.parent_client.id),this.items=[],Basket.__super__.constructor.call(this,data)}return extend(Basket,superClass),Basket.prototype.addItem=function(item){var i,j,len,ref;for(ref=this.items,j=0,len=ref.length;len>j;j++){if(i=ref[j],i===item)return;if(i.id&&item.id&&i.id===item.id)return}return this.items.push(item)},Basket.prototype.clear=function(){return this.items=[]},Basket.prototype.clearItem=function(item){return this.items=this.items.filter(function(i){return i!==item})},Basket.prototype.readyToCheckout=function(){return this.items.length>0?!0:!1},Basket.prototype.timeItems=function(){var i,j,len,ref,titems;for(titems=[],ref=this.items,j=0,len=ref.length;len>j;j++)i=ref[j],i.is_coupon||titems.push(i);return titems},Basket.prototype.couponItems=function(){var citems,i,j,len,ref;for(citems=[],ref=this.items,j=0,len=ref.length;len>j;j++)i=ref[j],i.is_coupon&&citems.push(i);return citems},Basket.prototype.removeCoupons=function(){return this.items=_.reject(this.items,function(x){return x.is_coupon})},Basket.prototype.setSettings=function(set){return set?(this.settings||(this.settings={}),$.extend(this.settings,set)):void 0},Basket.prototype.setClient=function(client){return this.client=client},Basket.prototype.setClientDetails=function(client_details){return this.client_details=new BBModel.PurchaseItem(client_details)},Basket.prototype.getPostData=function(){var item,j,len,post,ref;for(post={client:this.client.getPostData(),settings:this.settings,reference:this.reference},post.is_admin=this.is_admin,post.parent_client_id=this.parent_client_id,post.items=[],ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],post.items.push(item.getPostData());return post},Basket.prototype.dueTotal=function(){var item,j,len,ref,total;for(total=this.totalPrice(),ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.isWaitlist()&&(total-=item.price);return 0>total&&(total=0),total},Basket.prototype.length=function(){return this.items.length},Basket.prototype.questionPrice=function(options){var item,j,len,price,ref,unready;for(unready=options&&options.unready,price=0,ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],(!item.ready&&unready||!unready)&&(price+=item.questionPrice());return price},Basket.prototype.totalPrice=function(options){var item,j,len,price,ref,unready;for(unready=options&&options.unready,price=0,ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],(!item.ready&&unready||!unready)&&(price+=item.totalPrice());return price},Basket.prototype.updateTotalPrice=function(options){return this.total_price=this.totalPrice(options)},Basket.prototype.fullPrice=function(){var item,j,len,price,ref;for(price=0,ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],price+=item.fullPrice();return price},Basket.prototype.hasCoupon=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.is_coupon)return!0;return!1},Basket.prototype.totalCoupons=function(){return this.fullPrice()-this.totalPrice()-this.totalDealPaid()},Basket.prototype.totalDuration=function(){var duration,item,j,len,ref;for(duration=0,ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.service&&item.service.listed_duration&&(duration+=item.service.listed_duration);return duration},Basket.prototype.containsDeal=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.deal_id)return!0;return!1},Basket.prototype.hasDeal=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.deal_codes&&item.deal_codes.length>0)return!0;return!1},Basket.prototype.getDealCodes=function(){return this.deals=this.items[0]&&this.items[0].deal_codes?this.items[0].deal_codes:[],this.deals},Basket.prototype.totalDeals=function(){var deal,j,len,ref,value;for(value=0,ref=this.getDealCodes(),j=0,len=ref.length;len>j;j++)deal=ref[j],value+=deal.value;return value},Basket.prototype.totalDealPaid=function(){var item,j,len,ref,total_cert_paid;for(total_cert_paid=0,ref=this.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.certificate_paid&&(total_cert_paid+=item.certificate_paid);return total_cert_paid},Basket.prototype.remainingDealBalance=function(){return this.totalDeals()-this.totalDealPaid()},Basket.prototype.hasWaitlistItem=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.isWaitlist())return!0;return!1},Basket.prototype.hasExternalPurchase=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;len>j;j++)if(item=ref[j],item.isExternalPurchase())return!0;return!1},Basket}(BaseModel)})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BasketItemModel",function($q,$window,BBModel,BookableItemModel,BaseModel,$bbug){var BasketItem;return BasketItem=function(superClass){function BasketItem(data,bb){this.fullPrice=bind(this.fullPrice,this),this.totalPrice=bind(this.totalPrice,this),this.getQty=bind(this.getQty,this),this.questionPrice=bind(this.questionPrice,this);var chain,comp,per,res,serv,t;BasketItem.__super__.constructor.call(this,data),this.ready=!1,this.days_link=null,this.book_link=null,this.parts_links={},this.settings||(this.settings={}),this.has_questions=!1,bb&&(this.reserve_without_questions=bb.reserve_without_questions),this.time&&(this.time=new BBModel.TimeSlot({time:this.time,event_id:this.event_id,selected:!0,avail:1,price:this.price})),this.date&&(this.date=new BBModel.Day({date:this.date,spaces:1})),this.datetime&&(this.date=new BBModel.Day({date:this.datetime.toISODate(),spaces:1}),t=60*this.datetime.hour()+this.datetime.minute(),this.time=new BBModel.TimeSlot({time:t,event_id:this.event_id,selected:!0,avail:1,price:this.price})),this.id&&(this.reserve_ready=!0,this.held={time:this.time,date:this.date,event_id:this.event_id}),this.promises=[],data&&(data.$has("answers")&&data.$get("answers").then(function(_this){return function(answers){var a,i,len,results;for(data.questions=[],results=[],i=0,len=answers.length;len>i;i++)a=answers[i],results.push(data.questions.push({id:a.question_id,answer:a.value}));return results}}(this)),data.$has("company")&&(comp=data.$get("company"),this.promises.push(comp),comp.then(function(_this){return function(comp){var c;return c=new BBModel.Company(comp),_this.promises.push(c.getSettings()),_this.setCompany(c)}}(this))),data.$has("service")&&(serv=data.$get("service"),this.promises.push(serv),serv.then(function(_this){return function(serv){var prom;return serv.$has("category")&&(prom=serv.$get("category"),_this.promises.push(prom),prom.then(function(cat){return _this.setCategory(new BBModel.Category(cat))})),_this.setService(new BBModel.Service(serv),data.questions),_this.duration&&_this.setDuration(_this.duration),_this.checkReady(),_this.time?_this.time.service=_this.service:void 0}}(this))),data.$has("event_group")&&(serv=data.$get("event_group"),this.promises.push(serv),serv.then(function(_this){return function(serv){var prom;return serv.$has("category")&&(prom=serv.$get("category"),_this.promises.push(prom),prom.then(function(cat){return _this.setCategory(new BBModel.Category(cat))})),_this.setEventGroup(new BBModel.EventGroup(serv)),_this.time?_this.time.service=_this.event_group:void 0}}(this))),data.$has("event_chain")&&(chain=data.$get("event_chain"),this.promises.push(chain),data.$has("event")||chain.then(function(_this){return function(serv){return _this.setEventChain(new BBModel.EventChain(serv),data.questions)}}(this))),data.$has("resource")&&(res=data.$get("resource"),this.promises.push(res),res.then(function(_this){return function(res){return _this.setResource(new BBModel.Resource(res),!1)}}(this))),data.$has("person")&&(per=data.$get("person"),this.promises.push(per),per.then(function(_this){return function(per){return _this.setPerson(new BBModel.Person(per),!1)}}(this))),data.$has("event")&&data.$get("event").then(function(_this){return function(event){return _this.setEvent(new BBModel.Event(event))}}(this)),data.settings&&(this.settings=$bbug.extend(!0,{},data.settings)),data.attachment_id&&(this.attachment_id=data.attachment_id),data.$has("product")&&data.$get("product").then(function(_this){return function(product){return _this.setProduct(product)}}(this)),data.$has("deal")&&data.$get("deal").then(function(_this){return function(deal){return _this.setDeal(new BBModel.Deal(deal))}}(this)))}return extend(BasketItem,superClass),BasketItem.prototype.setDefaults=function(defaults){return defaults.settings&&(this.settings=defaults.settings),defaults.company&&this.setCompany(defaults.company),defaults.merge_resources&&this.setResource(null),defaults.merge_people&&this.setPerson(null),defaults.resource&&this.setResource(defaults.resource),defaults.person&&this.setPerson(defaults.person),defaults.service&&this.setService(defaults.service),defaults.category&&this.setCategory(defaults.category),defaults.time&&(this.requested_time=parseInt(defaults.time)),defaults.date&&(this.requested_date=moment(defaults.date)),defaults.service_ref&&(this.service_ref=defaults.service_ref),defaults.group&&(this.group=defaults.group),defaults.clinic&&(this.clinic=defaults.clinic),defaults.private_note&&(this.private_note=defaults.private_note),defaults.event_group&&this.setEventGroup(defaults.event_group),defaults.event&&this.setEvent(defaults.event),this.defaults=defaults},BasketItem.prototype.storeDefaults=function(defaults){return this.defaults=defaults},BasketItem.prototype.defaultService=function(){return this.defaults?this.defaults.service:null},BasketItem.prototype.requestedTimeUnavailable=function(){return delete this.requested_time,delete this.requested_date},BasketItem.prototype.setSlot=function(slot){var t;return this.date=new BBModel.Day({date:slot.datetime.toISODate(),spaces:1}),t=60*slot.datetime.hour()+slot.datetime.minute(),this.time=new BBModel.TimeSlot({time:t,avail:1,price:this.price}),this.available_slot=slot.id},BasketItem.prototype.setCompany=function(company){return this.company=company,this.parts_links.company=this.company.$href("self"),this.item_details?this.item_details.currency_code=this.company.currency_code:void 0},BasketItem.prototype.clearExistingItem=function(){var prom;return this.$has("self")&&this.event_id&&(prom=this.$del("self"),this.promises.push(prom),prom.then(function(){})),delete this.earliest_time,delete this.event_id},BasketItem.prototype.setItem=function(item){return item?"person"===item.type?this.setPerson(item):"service"===item.type?this.setService(item):"resource"===item.type?this.setResource(item):void 0:void 0},BasketItem.prototype.setService=function(serv,default_questions){var prom;if(null==default_questions&&(default_questions=null),this.service){if(this.service.self&&serv.self&&this.service.self===serv.self)return this.service.$has("book")&&(this.book_link=this.service),serv.$has("days")&&(this.days_link=serv),void(serv.$has("book")&&(this.book_link=serv));this.item_details=null,this.clearExistingItem()}return this.service&&serv&&this.service.self&&serv.self&&this.service.self!==serv.self&&serv.durations&&serv.durations.length>1&&(this.duration=null,this.listed_duration=null),this.service=serv,serv&&serv instanceof BookableItemModel&&(this.service=serv.item),this.parts_links.service=this.service.$href("self"),this.service.$has("book")&&(this.book_link=this.service),serv.$has("days")&&(this.days_link=serv),serv.$has("book")&&(this.book_link=serv),this.service.$has("questions")?(this.has_questions=!0,prom=this.service.$get("questions"),this.promises.push(prom),prom.then(function(_this){return function(details){return _this.company&&(details.currency_code=_this.company.currency_code),_this.item_details=new BBModel.ItemDetails(details),_this.has_questions=_this.item_details.hasQuestions,default_questions?(_this.item_details.setAnswers(default_questions),_this.setAskedQuestions()):void 0}}(this),function(_this){return function(err){return _this.has_questions=!1}}(this))):this.has_questions=!1,this.service&&this.service.durations&&1===this.service.durations.length&&(this.setDuration(this.service.durations[0]),this.listed_duration=this.service.durations[0]),this.service&&this.service.listed_durations&&1===this.service.listed_durations.length&&(this.listed_duration=this.service.listed_durations[0]),this.service.$has("category")&&(prom=this.service.getCategoryPromise())?this.promises.push(prom):void 0},BasketItem.prototype.setEventGroup=function(event_group){var prom;if(!(this.event_group&&this.event_group.self&&event_group.self&&this.event_group.self===event_group.self))return this.event_group=event_group,this.parts_links.event_group=this.event_group.$href("self").replace("event_group","service"),this.event_group.$has("category")&&(prom=this.event_group.getCategoryPromise())?this.promises.push(prom):void 0},BasketItem.prototype.setEventChain=function(event_chain,default_questions){var prom;return null==default_questions&&(default_questions=null),this.event_chain&&this.event_chain.self&&event_chain.self&&this.event_chain.self===event_chain.self?void 0:(this.event_chain=event_chain,this.base_price=parseFloat(event_chain.price),this.price!==this.base_price?this.setPrice(this.price):this.setPrice(this.base_price),this.event_chain.isSingleBooking()&&(this.tickets={name:"Admittance",max:1,type:"normal",price:this.base_price},this.tickets.pre_paid_booking_id=this.pre_paid_booking_id,this.num_book&&(this.tickets.qty=this.num_book)),this.event_chain.$has("questions")?(this.has_questions=!0,prom=this.event_chain.$get("questions"),this.promises.push(prom),prom.then(function(_this){return function(details){return _this.item_details=new BBModel.ItemDetails(details),_this.has_questions=_this.item_details.hasQuestions,default_questions?(_this.item_details.setAnswers(default_questions),_this.setAskedQuestions()):void 0}}(this),function(_this){return function(err){return _this.has_questions=!1}}(this))):this.has_questions=!1)},BasketItem.prototype.setEvent=function(event,default_questions){var prom;if(null==default_questions&&(default_questions=null),this.event&&this.event.unselect(),this.event=event,this.event.select(),this.event_chain_id=event.event_chain_id,this.setDate({date:event.date}),this.setTime(event.time),this.setDuration(event.duration),event.$has("book")&&(this.book_link=event),event.qty&&(this.num_book=event.qty),prom=this.event.getChain(),this.promises.push(prom),prom.then(function(_this){return function(chain){return _this.setEventChain(chain,default_questions)}}(this)),prom=this.event.getGroup(),this.promises.push(prom),prom.then(function(_this){return function(group){return _this.setEventGroup(group)}}(this)),this.event.getSpacesLeft()<=0&&!this.company.settings){if(this.company.getSettings().has_waitlists)return this.status=8}else if(this.event.getSpacesLeft()<=0&&this.company.settings&&this.company.settings.has_waitlists)return this.status=8},BasketItem.prototype.setCategory=function(cat){
return this.category=cat},BasketItem.prototype.setPerson=function(per,set_selected){if(null==set_selected&&(set_selected=!0),set_selected&&this.earliest_time&&delete this.earliest_time,per){if(this.person=per,set_selected&&(this.settings.person=this.person.id),this.parts_links.person=this.person.$href("self"),per.$has("days")&&(this.days_link=per),per.$has("book")&&(this.book_link=per),this.event_id&&this.$has("person")&&this.$href("person")!==this.person.self&&(delete this.event_id,this.resource&&this.defaults&&this.defaults.merge_resources))return this.setResource(null)}else if(this.person=!0,set_selected&&(this.settings.person=-1),this.parts_links.person=null,this.service&&this.setService(this.service),this.resource&&!this.anyResource()&&this.setResource(this.resource,!1),this.event_id&&(delete this.event_id,this.resource&&this.defaults&&this.defaults.merge_resources))return this.setResource(null)},BasketItem.prototype.setResource=function(res,set_selected){if(null==set_selected&&(set_selected=!0),set_selected&&this.earliest_time&&delete this.earliest_time,res){if(this.resource=res,set_selected&&(this.settings.resource=this.resource.id),this.parts_links.resource=this.resource.$href("self"),res.$has("days")&&(this.days_link=res),res.$has("book")&&(this.book_link=res),this.event_id&&this.$has("resource")&&this.$href("resource")!==this.resource.self&&(delete this.event_id,this.person&&this.defaults&&this.defaults.merge_people))return this.setPerson(null)}else if(this.resource=!0,set_selected&&(this.settings.resource=-1),this.parts_links.resource=null,this.service&&this.setService(this.service),this.person&&!this.anyPerson()&&this.setPerson(this.person,!1),this.event_id&&(delete this.event_id,this.person&&this.defaults&&this.defaults.merge_people))return this.setPerson(null)},BasketItem.prototype.setDuration=function(dur){return this.duration=dur,this.service&&(this.base_price=this.service.getPriceByDuration(dur)),this.time&&this.time.price&&(this.base_price=this.time.price),this.price&&this.price!==this.base_price?this.setPrice(this.price):this.setPrice(this.base_price)},BasketItem.prototype.print_time=function(){return this.time?this.time.print_time():void 0},BasketItem.prototype.print_end_time=function(){return this.time?this.time.print_end_time(this.duration):void 0},BasketItem.prototype.print_time12=function(show_suffix){return null==show_suffix&&(show_suffix=!0),this.time?this.time.print_time12(show_suffix):void 0},BasketItem.prototype.print_end_time12=function(show_suffix){return null==show_suffix&&(show_suffix=!0),this.time?this.time.print_end_time12(show_suffix,this.duration):void 0},BasketItem.prototype.setTime=function(time){var hours,mins,val;return this.time&&this.time.unselect(),this.time=time,this.time&&(this.time.select(),this.datetime&&(val=parseInt(time.time),hours=parseInt(val/60),mins=val%60,this.datetime.hour(hours),this.datetime.minutes(mins)),this.price&&this.time.price&&this.price!==this.time.price?this.setPrice(this.price):this.price&&!this.time.price?this.setPrice(this.price):this.time.price&&!this.price?this.setPrice(this.time.price):this.price&&this.time.price?this.setPrice(this.price):this.setPrice(null)),this.checkReady()},BasketItem.prototype.setDate=function(date){return this.date=date,this.date&&(this.date.date=moment(this.date.date),this.datetime&&(this.datetime.date(this.date.date.date()),this.datetime.month(this.date.date.month()),this.datetime.year(this.date.date.year()))),this.checkReady()},BasketItem.prototype.clearDateTime=function(){return delete this.date,delete this.time,delete this.datetime,this.ready=!1,this.reserve_ready=!1},BasketItem.prototype.clearTime=function(){return delete this.time,this.ready=!1,this.reserve_ready=!1},BasketItem.prototype.setGroup=function(group){return this.group=group},BasketItem.prototype.setAskedQuestions=function(){return this.asked_questions=!0,this.checkReady()},BasketItem.prototype.checkReady=function(){return!(this.date&&this.time&&this.service||this.event||this.product||this.external_purchase||this.deal||this.date&&this.service&&"day"===this.service.duration_unit)||!this.asked_questions&&this.has_questions||(this.ready=!0),(this.date&&this.time&&this.service||this.event||this.product||this.external_purchase||this.deal||this.date&&this.service&&"day"===this.service.duration_unit)&&(this.asked_questions||!this.has_questions||this.reserve_without_questions)?this.reserve_ready=!0:void 0},BasketItem.prototype.getPostData=function(){var data,i,j,len,len1,m_question,o_question,ref,ref1;if(this.cloneAnswersItem)for(ref=this.cloneAnswersItem.item_details.questions,i=0,len=ref.length;len>i;i++)for(o_question=ref[i],ref1=this.item_details.questions,j=0,len1=ref1.length;len1>j;j++)m_question=ref1[j],m_question.id===o_question.id&&(m_question.answer=o_question.answer,this.setAskedQuestions());return data={},this.date&&(data.date=this.date.date.toISODate()),this.time?(data.time=this.time.time,this.time.event_id?data.event_id=this.time.event_id:this.time.event_ids&&(data.event_ids=this.time.event_ids)):this.date&&this.date.event_id&&(data.event_id=this.date.event_id),data.price=this.price,data.paid=this.paid,this.book_link&&(data.book=this.book_link.$href("book")),data.id=this.id,data.duration=this.duration,data.settings=this.settings,data.settings||(data.settings={}),this.earliest_time&&(data.settings.earliest_time=this.earliest_time),this.item_details&&this.asked_questions&&(data.questions=this.item_details.getPostData()),this.move_item_id&&(data.move_item_id=this.move_item_id),this.srcBooking&&(data.move_item_id=this.srcBooking.id),this.service&&(data.service_id=this.service.id),this.resource&&(data.resource_id=this.resource.id),this.person&&(data.person_id=this.person.id),data.length=this.length,this.event&&(data.event_id=this.event.id,null!=this.event.pre_paid_booking_id?data.pre_paid_booking_id=this.event.pre_paid_booking_id:this.tickets&&null!=this.tickets.pre_paid_booking_id&&(data.pre_paid_booking_id=this.tickets.pre_paid_booking_id),data.tickets=this.tickets),null!=this.pre_paid_booking_id&&(data.pre_paid_booking_id=this.pre_paid_booking_id),data.event_chain_id=this.event_chain_id,data.event_group_id=this.event_group_id,data.qty=this.qty,this.status&&(data.status=this.status),null!=this.num_resources&&(data.num_resources=parseInt(this.num_resources)),data.product=this.product,data.external_purchase=this.external_purchase,this.deal&&(data.deal=this.deal),this.deal&&this.recipient&&(data.recipient=this.recipient),this.deal&&this.recipient&&this.recipient_mail&&(data.recipient_mail=this.recipient_mail),data.coupon_id=this.coupon_id,data.is_coupon=this.is_coupon,this.attachment_id&&(data.attachment_id=this.attachment_id),this.deal_codes&&(data.vouchers=this.deal_codes),this.product_id&&(data.product_id=this.product_id),this.email&&(data.email=this.email),this.first_name&&(data.first_name=this.first_name),this.last_name&&(data.last_name=this.last_name),null!=this.email&&(data.email=this.email),null!=this.email_admin&&(data.email_admin=this.email_admin),this.private_note&&(data.private_note=this.private_note),this.available_slot&&(data.available_slot=this.available_slot),data},BasketItem.prototype.setPrice=function(nprice){var printed_price;return null==nprice?(this.price=null,this.printed_price=null,this.printed_vat_cal=null,this.printed_vat=null,this.printed_vat_inc=null):(this.price=parseFloat(nprice),printed_price=this.price/100,this.printed_price=printed_price%1===0?""+parseInt(printed_price):$window.sprintf("%.2f",printed_price),this.company&&this.company.settings&&(this.printed_vat_cal=this.company.settings.payment_tax),this.printed_vat_cal&&(this.printed_vat=this.printed_vat_cal/100*printed_price),this.printed_vat_cal?this.printed_vat_inc=this.printed_vat_cal/100*printed_price+printed_price:void 0)},BasketItem.prototype.getStep=function(){var temp;return temp={},temp.service=this.service,temp.category=this.category,temp.person=this.person,temp.resource=this.resource,temp.duration=this.duration,temp.event=this.event,temp.event_group=this.event_group,temp.event_chain=this.event_chain,temp.time=this.time,temp.date=this.date,temp.days_link=this.days_link,temp.book_link=this.book_link,temp.ready=this.ready,temp},BasketItem.prototype.loadStep=function(step){return this.id?void 0:(this.service=step.service,this.category=step.category,this.person=step.person,this.resource=step.resource,this.duration=step.duration,this.event=step.event,this.event_chain=step.event_chain,this.event_group=step.event_group,this.time=step.time,this.date=step.date,this.days_link=step.days_link,this.book_link=step.book_link,this.ready=step.ready)},BasketItem.prototype.describe=function(){var title;return title="-",this.service&&(title=this.service.name),this.event_group&&this.event&&"-"===title&&(title=this.event_group.name+" - "+this.event.description),this.product&&(title=this.product.name),this.external_purchase&&(title=this.external_purchase.name),this.deal&&(title=this.deal.name),title},BasketItem.prototype.booking_date=function(format){return this.date&&this.date.date?this.date.date.format(format):null},BasketItem.prototype.booking_time=function(seperator){var duration;return null==seperator&&(seperator="-"),this.time?(duration=this.listed_duration?this.listed_duration:this.duration,this.time.print_time()+" "+seperator+" "+this.time.print_end_time(duration)):null},BasketItem.prototype.duePrice=function(){return this.isWaitlist()?0:this.price},BasketItem.prototype.isWaitlist=function(){return this.status&&8===this.status},BasketItem.prototype.start_datetime=function(){var start_datetime;return this.date&&this.time?(start_datetime=moment(this.date.date.toISODate()),start_datetime.minutes(this.time.time),start_datetime):null},BasketItem.prototype.end_datetime=function(){var duration,end_datetime;return this.date&&this.time&&(this.listed_duration||this.duration)?(duration=this.listed_duration?this.listed_duration:this.duration,end_datetime=moment(this.date.date.toISODate()),end_datetime.minutes(this.time.time+duration),end_datetime):null},BasketItem.prototype.setSrcBooking=function(booking){return this.srcBooking=booking,this.duration=booking.duration/60},BasketItem.prototype.anyPerson=function(){return this.person&&"boolean"==typeof this.person},BasketItem.prototype.anyResource=function(){return this.resource&&"boolean"==typeof this.resource},BasketItem.prototype.isMovingBooking=function(){return this.srcBooking||this.move_item_id},BasketItem.prototype.setCloneAnswers=function(otherItem){return this.cloneAnswersItem=otherItem},BasketItem.prototype.questionPrice=function(){return this.item_details?this.item_details.questionPrice(this.getQty()):0},BasketItem.prototype.getQty=function(){return this.qty?this.qty:this.tickets?this.tickets.qty:1},BasketItem.prototype.totalPrice=function(){var pr;return this.tickets&&this.tickets.pre_paid_booking_id?0:this.pre_paid_booking_id?0:null!=this.discount_price?this.discount_price+this.questionPrice():(pr=this.total_price,angular.isNumber(pr)||(pr=this.price),angular.isNumber(pr)||(pr=0),pr+this.questionPrice())},BasketItem.prototype.fullPrice=function(){var pr;return pr=this.base_price,pr||(pr=this.total_price),pr||(pr=this.price),pr||(pr=0),pr+this.questionPrice()},BasketItem.prototype.setProduct=function(product){return this.product=product,this.product.$has("book")&&(this.book_link=this.product),product.price?this.setPrice(product.price):void 0},BasketItem.prototype.setExternalPurchase=function(external_purchase){return this.external_purchase=external_purchase,this.book_link=this.company,external_purchase.price?this.setPrice(external_purchase.price):void 0},BasketItem.prototype.setDeal=function(deal){return this.deal=deal,this.deal.$has("book")&&(this.book_link=this.deal),deal.price?this.setPrice(deal.price):void 0},BasketItem.prototype.hasPrice=function(){return null!=this.price},BasketItem.prototype.getAttachment=function(){return this.attachment?this.attachment:this.$has("attachment")&&this.attachment_id?this._data.$get("attachment").then(function(_this){return function(att){return _this.attachment=att,_this.attachment}}(this)):void 0},BasketItem.prototype.setPrepaidBooking=function(prepaid_booking){return this.prepaid_booking=prepaid_booking,this.pre_paid_booking_id=prepaid_booking.id},BasketItem.prototype.hasPrepaidBooking=function(){return null!=this.pre_paid_booking_id},BasketItem.prototype.getEventId=function(){return this.time&&this.time.event_id?this.time.event_id:this.date&&this.date.event_id?this.date.event_id:this.event?this.event.id:void 0},BasketItem.prototype.isExternalPurchase=function(){return null!=this.external_purchase},BasketItem}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BookableItemModel",function($q,BBModel,BaseModel){var BookableItem;return BookableItem=function(superClass){function BookableItem(data){BookableItem.__super__.constructor.apply(this,arguments),this.name="-Waiting-",this.ready=$q.defer(),this.promise=this._data.$get("item"),this.promise.then(function(_this){return function(val){var m,n,ref,ref1,ref2;if("person"===val.type){if(_this.item=new BBModel.Person(val),_this.item){ref=_this.item._data;for(n in ref)m=ref[n],_this.item._data.hasOwnProperty(n)&&"function"!=typeof m&&(_this[n]=m);return _this.ready.resolve()}return _this.ready.resolve()}if("resource"===val.type){if(_this.item=new BBModel.Resource(val),_this.item){ref1=_this.item._data;for(n in ref1)m=ref1[n],_this.item._data.hasOwnProperty(n)&&"function"!=typeof m&&(_this[n]=m);return _this.ready.resolve()}return _this.ready.resolve()}if("service"===val.type){if(_this.item=new BBModel.Service(val),_this.item){ref2=_this.item._data;for(n in ref2)m=ref2[n],_this.item._data.hasOwnProperty(n)&&"function"!=typeof m&&(_this[n]=m);return _this.ready.resolve()}return _this.ready.resolve()}}}(this))}return extend(BookableItem,superClass),BookableItem.prototype.item=null,BookableItem.prototype.promise=null,BookableItem}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BusinessQuestionModel",function($q,$filter,BBModel,BaseModel){var BusinessQuestion;return BusinessQuestion=function(superClass){function BusinessQuestion(data){BusinessQuestion.__super__.constructor.call(this,data)}return extend(BusinessQuestion,superClass),BusinessQuestion}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("CategoryModel",function($q,BBModel,BaseModel){var Category;return Category=function(superClass){function Category(){return Category.__super__.constructor.apply(this,arguments)}return extend(Category,superClass),Category}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ClientModel",function($q,BBModel,BaseModel,LocaleService){var Client;return Client=function(superClass){function Client(data){Client.__super__.constructor.apply(this,arguments),this.name=this.getName(),data&&(data.answers&&data.$has("questions")&&(this.waitingQuestions=$q.defer(),this.gotQuestions=this.waitingQuestions.promise,data.$get("questions").then(function(_this){return function(details){return _this.client_details=new BBModel.ClientDetails(details),_this.client_details.setAnswers(data.answers),_this.questions=_this.client_details.questions,_this.setAskedQuestions(),_this.waitingQuestions.resolve()}}(this))),this.raw_mobile=this.mobile,this.mobile&&"0"!==this.mobile[0]&&(this.mobile="0"+this.mobile),this.phone&&"0"!==this.phone[0]&&(this.phone="0"+this.phone))}return extend(Client,superClass),Client.prototype.setClientDetails=function(details){return this.client_details=details,this.questions=this.client_details.questions},Client.prototype.setDefaults=function(values){return values.name&&(this.name=values.name),values.first_name&&(this.first_name=values.first_name),values.last_name&&(this.last_name=values.last_name),values.phone&&(this.phone=values.phone),values.mobile&&(this.mobile=values.mobile),values.email&&(this.email=values.email),values.id&&(this.id=values.id),values.ref&&(this.comp_ref=values.ref),values.comp_ref&&(this.comp_ref=values.comp_ref),values.address1&&(this.address1=values.address1),values.address2&&(this.address2=values.address2),values.address3&&(this.address3=values.address3),values.address4&&(this.address4=values.address4),values.address5&&(this.address5=values.address5),values.postcode&&(this.postcode=values.postcode),values.country&&(this.country=values.country),values.answers?this.default_answers=values.answers:void 0},Client.prototype.pre_fill_answers=function(details){var i,len,q,ref,results;if(this.default_answers){for(ref=details.questions,results=[],i=0,len=ref.length;len>i;i++)q=ref[i],this.default_answers[q.name]?results.push(q.answer=this.default_answers[q.name]):results.push(void 0);return results}},Client.prototype.getName=function(){var str;return str="",this.first_name&&(str+=this.first_name),str.length>0&&this.last_name&&(str+=" "),this.last_name&&(str+=this.last_name),str},Client.prototype.addressSingleLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+=", "),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+=", "),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+=", "),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+=", "),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+=", "),this.postcode&&(str+=this.postcode),str},Client.prototype.hasAddress=function(){return this.address1||this.address2||this.postcode},Client.prototype.addressCsvLine=function(){var str;return str="",this.address1&&(str+=this.address1),str+=", ",this.address2&&(str+=this.address2),str+=", ",this.address3&&(str+=this.address3),str+=", ",this.address4&&(str+=this.address4),str+=", ",this.address5&&(str+=this.address5),str+=", ",this.postcode&&(str+=this.postcode),str+=", ",this.country&&(str+=this.country),str},Client.prototype.addressMultiLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+="<br/>"),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+="<br/>"),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+="<br/>"),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+="<br/>"),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+="<br/>"),this.postcode&&(str+=this.postcode),str},Client.prototype.getPostData=function(){var i,len,q,ref,x;if(x={},x.first_name=this.first_name,x.last_name=this.last_name,this.house_number?x.address1=this.house_number+" "+this.address1:x.address1=this.address1,x.address2=this.address2,x.address3=this.address3,x.address4=this.address4,x.address5=this.address5,x.postcode=this.postcode,x.country=this.country,x.phone=this.phone,x.email=this.email,x.id=this.id,x.comp_ref=this.comp_ref,x.parent_client_id=this.parent_client_id,x.password=this.password,x.notifications=this.notifications,this.member_level_id&&(x.member_level_id=this.member_level_id),this.send_welcome_email&&(x.send_welcome_email=this.send_welcome_email),this.default_company_id&&(x.default_company_id=this.default_company_id),this.mobile&&(this.remove_prefix(),x.mobile=this.mobile,x.mobile_prefix=this.mobile_prefix),this.questions)for(x.questions=[],ref=this.questions,i=0,len=ref.length;len>i;i++)q=ref[i],x.questions.push(q.getPostData());return x},Client.prototype.valid=function(){return this.isValid?this.isValid:this.email||this.hasServerId()?!0:!1},Client.prototype.setValid=function(val){return this.isValid=val},Client.prototype.hasServerId=function(){return this.id},Client.prototype.setAskedQuestions=function(){return this.asked_questions=!0},Client.prototype.fullMobile=function(){return this.mobile?this.mobile_prefix?"+"+this.mobile_prefix+this.mobile:this.mobile:void 0},Client.prototype.remove_prefix=function(){var pref_arr;return pref_arr=this.mobile.match(/^(\+|00)(999|998|997|996|995|994|993|992|991|990|979|978|977|976|975|974|973|972|971|970|969|968|967|966|965|964|963|962|961|960|899|898|897|896|895|894|893|892|891|890|889|888|887|886|885|884|883|882|881|880|879|878|877|876|875|874|873|872|871|870|859|858|857|856|855|854|853|852|851|850|839|838|837|836|835|834|833|832|831|830|809|808|807|806|805|804|803|802|801|800|699|698|697|696|695|694|693|692|691|690|689|688|687|686|685|684|683|682|681|680|679|678|677|676|675|674|673|672|671|670|599|598|597|596|595|594|593|592|591|590|509|508|507|506|505|504|503|502|501|500|429|428|427|426|425|424|423|422|421|420|389|388|387|386|385|384|383|382|381|380|379|378|377|376|375|374|373|372|371|370|359|358|357|356|355|354|353|352|351|350|299|298|297|296|295|294|293|292|291|290|289|288|287|286|285|284|283|282|281|280|269|268|267|266|265|264|263|262|261|260|259|258|257|256|255|254|253|252|251|250|249|248|247|246|245|244|243|242|241|240|239|238|237|236|235|234|233|232|231|230|229|228|227|226|225|224|223|222|221|220|219|218|217|216|215|214|213|212|211|210|98|95|94|93|92|91|90|86|84|82|81|66|65|64|63|62|61|60|58|57|56|55|54|53|52|51|49|48|47|46|45|44|43|41|40|39|36|34|33|32|31|30|27|20|7|1)/),pref_arr?(this.mobile.replace(pref_arr[0],""),this.mobile_prefix=pref_arr[0]):void 0},Client.prototype.getPrePaidBookingsPromise=function(params){var defer;return defer=$q.defer(),this.$has("pre_paid_bookings")?this.$get("pre_paid_bookings",params).then(function(collection){return collection.$get("pre_paid_bookings").then(function(prepaids){var prepaid;return defer.resolve(function(){var i,len,results;for(results=[],i=0,len=prepaids.length;len>i;i++)prepaid=prepaids[i],results.push(new BBModel.PrePaidBooking(prepaid));return results}())},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}):defer.resolve([]),defer.promise},Client}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ClientDetailsModel",function($q,BBModel,BaseModel){var ClientDetails;return ClientDetails=function(superClass){function ClientDetails(data){var i,len,q,ref;if(ClientDetails.__super__.constructor.apply(this,arguments),this.questions=[],this._data)for(ref=data.questions,i=0,len=ref.length;len>i;i++)q=ref[i],this.questions.push(new BBModel.Question(q));this.hasQuestions=this.questions.length>0}return extend(ClientDetails,superClass),ClientDetails.prototype.getPostData=function(questions){var data,i,len,q;for(data=[],i=0,len=questions.length;len>i;i++)q=questions[i],data.push({answer:q.answer,id:q.id,price:q.price});return data},ClientDetails.prototype.setAnswers=function(answers){var a,ahash,i,j,len,len1,q,ref,results;for(ahash={},i=0,len=answers.length;len>i;i++)a=answers[i],ahash[a.question_id]=a;for(ref=this.questions,results=[],j=0,len1=ref.length;len1>j;j++)q=ref[j],ahash[q.id]?results.push(q.answer=ahash[q.id].answer):results.push(void 0);return results},ClientDetails}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ClinicModel",function($q,BBModel,BaseModel){var Clinic;return Clinic=function(superClass){function Clinic(data){Clinic.__super__.constructor.call(this,data),this.setTimes(),this.setResourcesAndPeople(),this.settings||(this.settings={})}return extend(Clinic,superClass),Clinic.prototype.setResourcesAndPeople=function(){return this.resources=_.reduce(this.resource_ids,function(h,id){return h[id]=!0,h},{}),this.people=_.reduce(this.person_ids,function(h,id){return h[id]=!0,h},{}),this.services=_.reduce(this.service_ids,function(h,id){return h[id]=!0,h},{}),this.uncovered=!this.person_ids||0===this.person_ids.length,this.uncovered?this.className="clinic_uncovered":this.className="clinic_covered"},Clinic.prototype.setTimes=function(){return this.start_time&&(this.start_time=moment(this.start_time),this.start=this.start_time),this.end_time&&(this.end_time=moment(this.end_time),this.end=this.end_time),this.title=this.name},Clinic}(BaseModel)})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("CompanyModel",function($q,BBModel,BaseModel,halClient,AppConfig,$sessionStorage){var Company;return Company=function(superClass){function Company(data){this.pusherSubscribe=bind(this.pusherSubscribe,this);var all_companies,c,child,comp,i,j,len,len1,ref1,ref2;if(Company.__super__.constructor.call(this,data),this.companies){for(all_companies=[],this.child_companies=[],ref1=this.companies,i=0,len=ref1.length;len>i;i++)if(comp=ref1[i],c=new BBModel.Company(halClient.$parse(comp)),this.child_companies.push(c),c.companies)for(ref2=c.companies,j=0,len1=ref2.length;len1>j;j++)child=ref2[j],all_companies.push(child);else all_companies.push(c);this.companies=all_companies}}return extend(Company,superClass),Company.prototype.getCompanyByRef=function(ref){var defer;return defer=$q.defer(),this.$get("companies").then(function(companies){var company;return company=_.find(companies,function(c){return c.reference===ref}),company?defer.resolve(company):defer.reject("No company for ref "+ref)},function(err){return console.log("err ",err),defer.reject(err)}),defer.promise},Company.prototype.findChildCompany=function(id){var c,cname,i,j,len,len1,name,ref1,ref2;if(!this.companies)return null;for(ref1=this.companies,i=0,len=ref1.length;len>i;i++){if(c=ref1[i],c.id===parseInt(id))return c;if(c.ref&&c.ref===String(id))return c}if("string"==typeof id)for(name=id.replace(/[\s\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,"").toLowerCase(),ref2=this.companies,j=0,len1=ref2.length;len1>j;j++)if(c=ref2[j],cname=c.name.replace(/[\s\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,"").toLowerCase(),name===cname)return c;return null},Company.prototype.getSettings=function(){var def;return def=$q.defer(),this.settings?def.resolve(this.settings):this.$has("settings")?this.$get("settings").then(function(_this){return function(set){return _this.settings=new BBModel.CompanySettings(set),def.resolve(_this.settings)}}(this)):def.reject("Company has no settings"),def.promise},Company.prototype.pusherSubscribe=function(callback,options){var channelName;return null==options&&(options={}),"undefined"!=typeof Pusher&&null!==Pusher&&null==this.pusher&&(this.pusher=new Pusher("c8d8cea659cc46060608",{encrypted:options.hasOwnProperty("encrypted")?options.encrypted:!0,authEndpoint:this.$link("pusher").href,auth:{headers:{"App-Id":AppConfig.appId,"App-Key":AppConfig.appKey,"Auth-Token":$sessionStorage.getItem("auth_token")}}}),channelName="private-c"+this.id+"-w"+this.numeric_widget_id,null==this.pusher.channel(channelName))?(this.pusher_channel=this.pusher.subscribe(channelName),this.pusher_channel.bind("booking",callback),this.pusher_channel.bind("cancellation",callback),this.pusher_channel.bind("updating",callback)):void 0},Company}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("CompanySettingsModel",function($q,BBModel,BaseModel){var CompanySettings;return CompanySettings=function(superClass){function CompanySettings(){return CompanySettings.__super__.constructor.apply(this,arguments)}return extend(CompanySettings,superClass),CompanySettings}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("DayModel",function($q,BBModel,BaseModel){var Day;return Day=function(superClass){function Day(data){Day.__super__.constructor.apply(this,arguments),this.string_date=this.date,this.date=moment(this.date)}return extend(Day,superClass),Day.prototype.day=function(){return this.date.date()},Day.prototype.off=function(month){return this.date.month()!==month},Day.prototype["class"]=function(month){var str;return str="",this.date.month()<month&&(str+="off off-prev"),this.date.month()>month&&(str+="off off-next"),0===this.spaces&&(str+=" not-avail"),str},Day}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("DealModel",function($q,BBModel,BaseModel){var Deal;return Deal=function(superClass){function Deal(){return Deal.__super__.constructor.apply(this,arguments)}return extend(Deal,superClass),Deal}(BaseModel)})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventModel",function($q,BBModel,BaseModel,DateTimeUlititiesService){var Event;return Event=function(superClass){function Event(data){Event.__super__.constructor.call(this,data),this.getDate(),this.time=new BBModel.TimeSlot({time:DateTimeUlititiesService.convertMomentToTime(this.date)}),this.duration&&(this.end_datetime=this.date.clone().add(this.duration,"minutes"))}return extend(Event,superClass),Event.prototype.getGroup=function(){var defer;return defer=$q.defer(),this.group?defer.resolve(this.group):this.$has("event_groups")?this.$get("event_groups").then(function(_this){return function(group){return _this.group=new BBModel.EventGroup(group),defer.resolve(_this.group)}}(this),function(err){return defer.reject(err)}):defer.reject("No event group"),defer.promise;
},Event.prototype.getChain=function(){var defer;return defer=$q.defer(),this.chain?defer.resolve(this.chain):this.$has("event_chains")?this.$get("event_chains").then(function(_this){return function(chain){return _this.chain=new BBModel.EventChain(chain),defer.resolve(_this.chain)}}(this)):defer.reject("No event chain"),defer.promise},Event.prototype.getDate=function(){return this.date?this.date:(this.date=moment(this._data.datetime),this.date)},Event.prototype.dateString=function(str){var date;return date=this.date(),date?date.format(str):void 0},Event.prototype.getDuration=function(){var defer;return defer=new $q.defer,this.duration?defer.resolve(this.duration):this.getChain().then(function(_this){return function(chain){return _this.duration=chain.duration,defer.resolve(_this.duration)}}(this)),defer.promise},Event.prototype.getDescription=function(){return this.getChain().description},Event.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Event.prototype.getPounds=function(){return this.chain?Math.floor(this.getPrice()).toFixed(0):void 0},Event.prototype.getPrice=function(){return 0},Event.prototype.getPence=function(){return this.chain?(this.getPrice()%1).toFixed(2).slice(-2):void 0},Event.prototype.getNumBooked=function(){return this.spaces_blocked+this.spaces_booked+this.spaces_reserved+this.spaces_held},Event.prototype.getSpacesLeft=function(pool){return null==pool&&(pool=null),pool&&this.ticket_spaces&&this.ticket_spaces[pool]?this.ticket_spaces[pool].left:this.num_spaces-this.getNumBooked()},Event.prototype.hasSpace=function(){return this.getSpacesLeft()>0},Event.prototype.hasWaitlistSpace=function(){return this.getSpacesLeft()<=0&&this.getChain().waitlength>this.spaces_wait},Event.prototype.getRemainingDescription=function(){var left;return left=this.getSpacesLeft(),left>0&&3>left?"Only "+left+" "+(left>1?"spaces":"space")+" left":this.hasWaitlistSpace()?"Join Waitlist":""},Event.prototype.select=function(){return this.selected=!0},Event.prototype.unselect=function(){return this.selected?delete this.selected:void 0},Event.prototype.prepEvent=function(){var def;return def=$q.defer(),this.getChain().then(function(_this){return function(){return _this.chain.$has("address")&&_this.chain.getAddressPromise().then(function(address){return _this.chain.address=address}),_this.chain.getTickets().then(function(tickets){var i,len,ref,ticket;if(_this.tickets=tickets,_this.price_range={},tickets&&tickets.length>0)for(ref=_this.tickets,i=0,len=ref.length;len>i;i++)ticket=ref[i],(!_this.price_range.from||_this.price_range.from&&ticket.price<_this.price_range.from)&&(_this.price_range.from=ticket.price),(!_this.price_range.to||_this.price_range.to&&ticket.price>_this.price_range.to)&&(_this.price_range.to=ticket.price),ticket.old_price=ticket.price;else _this.price_range.from=_this.price,_this.price_range.to=_this.price;return _this.ticket_prices=_.indexBy(tickets,"name"),def.resolve(_this)})}}(this)),def.promise},Event.prototype.updatePrice=function(){var i,len,ref,results,ticket;for(ref=this.tickets,results=[],i=0,len=ref.length;len>i;i++)ticket=ref[i],ticket.pre_paid_booking_id?results.push(ticket.price=0):results.push(ticket.price=ticket.old_price);return results},Event}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventChainModel",function($q,BBModel,BaseModel){var EventChain;return EventChain=function(superClass){function EventChain(){return EventChain.__super__.constructor.apply(this,arguments)}return extend(EventChain,superClass),EventChain.prototype.name=function(){return this._data.name},EventChain.prototype.isSingleBooking=function(){return 1===this.max_num_bookings&&!this.$has("ticket_sets")},EventChain.prototype.hasTickets=function(){return this.$has("ticket_sets")},EventChain.prototype.getTickets=function(){var def;return def=$q.defer(),this.tickets?def.resolve(this.tickets):this.$has("ticket_sets")?this.$get("ticket_sets").then(function(_this){return function(tickets){var i,len,ticket;for(_this.tickets=[],i=0,len=tickets.length;len>i;i++)ticket=tickets[i],_this.tickets.push(new BBModel.EventTicket(ticket));return _this.adjustTicketsForRemaining(),def.resolve(_this.tickets)}}(this)):(this.tickets=[new BBModel.EventTicket({name:"Admittance",min_num_bookings:1,max_num_bookings:this.max_num_bookings,type:"normal",price:this.price})],this.adjustTicketsForRemaining(),def.resolve(this.tickets)),def.promise},EventChain.prototype.adjustTicketsForRemaining=function(){var i,len,ref,results;if(this.tickets){for(ref=this.tickets,results=[],i=0,len=ref.length;len>i;i++)this.ticket=ref[i],results.push(this.ticket.max_spaces=this.spaces);return results}},EventChain}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventCollectionModel",function($q,BBModel,BaseModel){var EventCollection;return EventCollection=function(superClass){function EventCollection(){return EventCollection.__super__.constructor.apply(this,arguments)}return extend(EventCollection,superClass),EventCollection}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventGroupModel",function($q,BBModel,BaseModel){var EventGroup;return EventGroup=function(superClass){function EventGroup(){return EventGroup.__super__.constructor.apply(this,arguments)}return extend(EventGroup,superClass),EventGroup.prototype.name=function(){return this._data.name},EventGroup.prototype.colour=function(){return this._data.colour},EventGroup}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventSequenceModel",function($q,BBModel,BaseModel){var EventSequence;return EventSequence=function(superClass){function EventSequence(){return EventSequence.__super__.constructor.apply(this,arguments)}return extend(EventSequence,superClass),EventSequence.prototype.name=function(){return this._data.name},EventSequence}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventTicketModel",function($q,BBModel,BaseModel){var EventTicket;return EventTicket=function(superClass){function EventTicket(data){var ms;EventTicket.__super__.constructor.call(this,data),this.max=this.max_num_bookings,this.max_spaces&&(ms=this.max_spaces,this.counts_as&&(ms=this.max_spaces/this.counts_as),ms<max&&(this.max=ms))}return extend(EventTicket,superClass),EventTicket.prototype.fullName=function(){return this.pool_name?this.pool_name+" - "+this.name:this.name},EventTicket.prototype.getRange=function(cap){var c,ref,results;return cap&&(c=cap,this.counts_as&&(c=cap/this.counts_as),c+this.min_num_bookings<this.max&&(this.max=c+this.min_num_bookings)),[0].concat(function(){results=[];for(var i=ref=this.min_num_bookings,ref1=this.max;ref1>=ref?ref1>=i:i>=ref1;ref1>=ref?i++:i--)results.push(i);return results}.apply(this))},EventTicket.prototype.totalQty=function(){return this.qty?this.counts_as?this.qty*this.counts_as:this.qty:0},EventTicket.prototype.getMax=function(cap,ev){var c,i,len,live_max,ref,ticket,used;if(null==ev&&(ev=null),live_max=this.max,ev){for(used=0,ref=ev.tickets,i=0,len=ref.length;len>i;i++)ticket=ref[i],used+=ticket.totalQty();this.qty&&(used-=this.totalQty()),this.counts_as&&(used=Math.ceil(used/this.counts_as)),live_max-=used,0>live_max&&(live_max=0)}return cap&&(c=cap,this.counts_as&&(c=cap/this.counts_as),c+this.min_num_bookings<live_max)?c+this.min_num_bookings:live_max},EventTicket.prototype.add=function(value){return this.qty||(this.qty=0),this.qty=parseInt(this.qty),angular.isNumber(this.qty)&&this.qty>=this.max&&value>0||0===this.qty&&0>value?void 0:this.qty+=value},EventTicket.prototype.subtract=function(value){return this.add(-value)},EventTicket}(BaseModel)})}.call(this),function(){"use strict";angular.module("BB.Models").factory("FilterModel",function($q,BBModel,BaseModel){var Filter;return Filter=function(){function Filter(data){this.filter=!0,this.subfilters=[],this.type="date"}return Filter}()})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ImageModel",function($q,$filter,BBModel,BaseModel){var Image;return Image=function(superClass){function Image(data){Image.__super__.constructor.call(this,data)}return extend(Image,superClass),Image}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ItemDetailsModel",function($q,BBModel,BaseModel,$bbug,QuestionService){var ItemDetails;return ItemDetails=function(superClass){function ItemDetails(data){var i,len,q,ref;if(this._data=data,this._data&&(this.self=this._data.$href("self")),this.questions=[],this.survey_questions=[],data)for(ref=data.questions,i=0,len=ref.length;len>i;i++)q=ref[i],q.outcome===!1?(data.currency_code&&(q.currency_code=data.currency_code),this.questions.push(new BBModel.Question(q))):this.survey_questions.push(new BBModel.SurveyQuestion(q));this.hasQuestions=this.questions.length>0,this.hasSurveyQuestions=this.survey_questions.length>0}return extend(ItemDetails,superClass),ItemDetails.prototype.questionPrice=function(qty){var i,len,price,q,ref;for(qty||(qty=1),this.checkConditionalQuestions(),price=0,ref=this.questions,i=0,len=ref.length;len>i;i++)q=ref[i],price+=q.selectedPriceQty(qty);return price},ItemDetails.prototype.checkConditionalQuestions=function(){return QuestionService.checkConditionalQuestions(this.questions)},ItemDetails.prototype.getPostData=function(){var data,i,len,q,ref;for(data=[],ref=this.questions,i=0,len=ref.length;len>i;i++)q=ref[i],q.currentlyShown&&data.push(q.getPostData());return data},ItemDetails.prototype.setAnswers=function(answers){var a,ahash,i,j,len,len1,q,ref;for(ahash={},i=0,len=answers.length;len>i;i++)a=answers[i],ahash[a.id]=a;for(ref=this.questions,j=0,len1=ref.length;len1>j;j++)q=ref[j],ahash[q.id]&&(q.answer=ahash[q.id].answer);return this.checkConditionalQuestions()},ItemDetails.prototype.getQuestion=function(id){return _.findWhere(this.questions,{id:id})},ItemDetails}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("MembershipLevelModel",function($q,BBModel,BaseModel){var MembershipLevel;return MembershipLevel=function(superClass){function MembershipLevel(){return MembershipLevel.__super__.constructor.apply(this,arguments)}return extend(MembershipLevel,superClass),MembershipLevel}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PersonModel",function($q,BBModel,BaseModel){var Person;return Person=function(superClass){function Person(){return Person.__super__.constructor.apply(this,arguments)}return extend(Person,superClass),Person}(BaseModel)})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PrePaidBookingModel",function($q,BBModel,BaseModel){var PrePaidBooking;return PrePaidBooking=function(superClass){function PrePaidBooking(data){PrePaidBooking.__super__.constructor.call(this,data)}return extend(PrePaidBooking,superClass),PrePaidBooking.prototype.checkValidity=function(item){return this.service_id&&item.service_id&&this.service_id!==item.service_id?!1:this.resource_id&&item.resource_id&&this.resource_id!==item.resource_id?!1:this.person_id&&item.person_id&&this.person_id!==item.person_id?!1:!0},PrePaidBooking}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ProductModel",function($q,BBModel,BaseModel){var Product;return Product=function(superClass){function Product(){return Product.__super__.constructor.apply(this,arguments)}return extend(Product,superClass),Product}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PurchaseItemModel",function($q,BBModel,BaseModel){var PurchaseItem;return PurchaseItem=function(superClass){function PurchaseItem(data){PurchaseItem.__super__.constructor.call(this,data),this.parts_links={},data&&(data.$has("service")&&(this.parts_links.service=data.$href("service")),data.$has("resource")&&(this.parts_links.resource=data.$href("resource")),data.$has("person")&&(this.parts_links.person=data.$href("person")),data.$has("company")&&(this.parts_links.company=data.$href("company")))}return extend(PurchaseItem,superClass),PurchaseItem.prototype.describe=function(){return this.get("describe")},PurchaseItem.prototype.full_describe=function(){return this.get("full_describe")},PurchaseItem.prototype.hasPrice=function(){return this.price&&this.price>0},PurchaseItem}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PurchaseTotalModel",function($q,BBModel,BaseModel){var PurchaseTotal;return PurchaseTotal=function(superClass){function PurchaseTotal(data){var cprom;PurchaseTotal.__super__.constructor.call(this,data),this.promise=this._data.$get("purchase_items"),this.items=[],this.promise.then(function(_this){return function(items){var i,item,len,results;for(results=[],i=0,len=items.length;len>i;i++)item=items[i],results.push(_this.items.push(new BBModel.PurchaseItem(item)));return results}}(this)),this._data.$has("client")&&(cprom=data.$get("client"),cprom.then(function(_this){return function(client){return _this.client=new BBModel.Client(client)}}(this)))}return extend(PurchaseTotal,superClass),PurchaseTotal.prototype.icalLink=function(){return this._data.$href("ical")},PurchaseTotal.prototype.webcalLink=function(){return this._data.$href("ical")},PurchaseTotal.prototype.gcalLink=function(){return this._data.$href("gcal")},PurchaseTotal.prototype.id=function(){return this.get("id")},PurchaseTotal}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("QuestionModel",function($q,$filter,BBModel,BaseModel){var Question;return Question=function(superClass){function Question(data){var currency,i,len,option,ref;if(Question.__super__.constructor.call(this,data),this.price&&(this.price=parseFloat(this.price)),this._data["default"]&&(this.answer=this._data["default"]),this._data.options)for(ref=this._data.options,i=0,len=ref.length;len>i;i++)option=ref[i],option.is_default&&(this.answer=option.name),this.hasPrice()?(option.price=parseFloat(option.price),currency=data.currency_code?data.currency_code:"GBP",option.display_name=option.name+" ("+$filter("currency")(option.price,currency)+")"):option.display_name=option.name;("check"===this._data.detail_type||"check-price"===this._data.detail_type)&&(this.answer=this._data["default"]&&"1"===this._data["default"]),this.currentlyShown=!0}return extend(Question,superClass),Question.prototype.hasPrice=function(){return"check-price"===this.detail_type||"select-price"===this.detail_type||"radio-price"===this.detail_type},Question.prototype.selectedPrice=function(){var i,len,option,ref;if(!this.hasPrice())return 0;if("check-price"===this.detail_type)return this.answer?this.price:0;for(ref=this._data.options,i=0,len=ref.length;len>i;i++)if(option=ref[i],this.answer===option.name)return option.price;return 0},Question.prototype.selectedPriceQty=function(qty){var p;return qty||(qty=1),p=this.selectedPrice(),this.price_per_booking&&(p*=qty),p},Question.prototype.getAnswerId=function(){var i,len,o,ref;if(!this.answer||!this.options||0===this.options.length)return null;for(ref=this.options,i=0,len=ref.length;len>i;i++)if(o=ref[i],this.answer===o.name)return o.id;return null},Question.prototype.showElement=function(){return this.currentlyShown=!0},Question.prototype.hideElement=function(){return this.currentlyShown=!1},Question.prototype.getPostData=function(){var p,x;return x={},x.id=this.id,x.answer=this.answer,"date"===this.detail_type&&this.answer&&(x.answer=moment(this.answer).toISODate()),p=this.selectedPrice(),p&&(x.price=p),x},Question}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ResourceModel",function($q,BBModel,BaseModel){var Resource;return Resource=function(superClass){function Resource(){return Resource.__super__.constructor.apply(this,arguments)}return extend(Resource,superClass),Resource}(BaseModel)})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ServiceModel",function($q,BBModel,BaseModel){var Service;return Service=function(superClass){function Service(data){this.days_array=bind(this.days_array,this),this.getCategoryPromise=bind(this.getCategoryPromise,this),Service.__super__.constructor.apply(this,arguments),this.prices&&this.prices.length>0&&(this.price=this.prices[0]),this.durations&&this.durations.length>0&&(this.duration=this.durations[0]),this.listed_durations||(this.listed_durations=this.durations),this.listed_durations&&this.listed_durations.length>0&&(this.listed_duration=this.listed_durations[0]),this.min_advance_datetime=moment().add(this.min_advance_period,"seconds"),this.max_advance_datetime=moment().add(this.max_advance_period,"seconds")}return extend(Service,superClass),Service.prototype.getPriceByDuration=function(dur){var d,i,j,len,ref;for(ref=this.durations,i=j=0,len=ref.length;len>j;i=++j)if(d=ref[i],d===dur)return this.prices[i]},Service.prototype.getCategoryPromise=function(){var prom;return this.$has("category")?(prom=this.$get("category"),prom.then(function(_this){return function(cat){return _this.category=new BBModel.Category(cat)}}(this)),prom):null},Service.prototype.days_array=function(){var arr,j,ref,ref1,str,x;for(arr=[],x=j=ref=this.min_bookings,ref1=this.max_bookings;ref1>=ref?ref1>=j:j>=ref1;x=ref1>=ref?++j:--j)str=""+x+" day",x>1&&(str+="s"),arr.push({name:str,val:x});return arr},Service}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("SlotModel",function($q,BBModel,BaseModel){var Slot;return Slot=function(superClass){function Slot(data){Slot.__super__.constructor.call(this,data),this.datetime=moment(data.datetime)}return extend(Slot,superClass),Slot}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("SpaceModel",function($q,BBModel,BaseModel){var Space;return Space=function(superClass){function Space(){return Space.__super__.constructor.apply(this,arguments)}return extend(Space,superClass),Space}(BaseModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("SurveyQuestionModel",function($q,$window,BBModel,BaseModel,QuestionModel){var SurveyQuestion;return SurveyQuestion=function(superClass){function SurveyQuestion(){return SurveyQuestion.__super__.constructor.apply(this,arguments)}return extend(SurveyQuestion,superClass),SurveyQuestion}(QuestionModel)})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("TimeSlotModel",function($q,$window,BBModel,BaseModel){var TimeSlot;return TimeSlot=function(superClass){function TimeSlot(data,service){TimeSlot.__super__.constructor.call(this,data),this.service=service,this.time_12=this.print_time12(),this.time_24=this.print_time()}return extend(TimeSlot,superClass),TimeSlot.prototype.print_time=function(){var min,t;return this.start?this.start.format("h:mm"):(t=this.get("time"),min=10>t%60?"0"+t%60:t%60,""+Math.floor(t/60)+":"+min)},TimeSlot.prototype.print_end_time=function(dur){var min,t;return this.end?this.end.format("h:mm"):(dur||(dur=this.service.listed_durations[0]),t=this.get("time")+dur,min=10>t%60?"0"+t%60:t%60,""+Math.floor(t/60)+":"+min)},TimeSlot.prototype.print_time12=function(show_suffix){var h,m,suffix,t,time;return null==show_suffix&&(show_suffix=!0),t=this.get("time"),h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),time=$window.sprintf("%d.%02d",h,m),show_suffix&&(time+=suffix),time},TimeSlot.prototype.print_end_time12=function(show_suffix,dur){var end_time,h,m,suffix,t;return null==show_suffix&&(show_suffix=!0),dur=null,dur||(dur=null!=this.service.listed_duration?this.service.listed_duration:this.service.listed_durations[0]),t=this.get("time")+dur,h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),end_time=$window.sprintf("%d.%02d",h,m),show_suffix&&(end_time+=suffix),end_time},TimeSlot.prototype.availability=function(){return this.avail},TimeSlot.prototype.select=function(){return this.selected=!0},TimeSlot.prototype.unselect=function(){return this.selected?delete this.selected:void 0},TimeSlot.prototype.disable=function(reason){return this.disabled=!0,this.disabled_reason=reason},TimeSlot.prototype.enable=function(){return this.disabled&&delete this.disabled,this.disabled_reason?delete this.disabled_reason:void 0},TimeSlot.prototype.status=function(){return this.selected?"selected":this.disabled?"disabled":this.availability()>0?"enabled":"disabled"},TimeSlot}(BaseModel)})}.call(this),function(){angular.module("BB.Services").factory("AddressListService",function($q,$window,halClient,UriTemplate){return{query:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/company/{company_id}/addresses/{post_code}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company.id,post_code:prms.post_code}),halClient.$get(uri,{}).then(function(addressList){return deferred.resolve(addressList)},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},getAddress:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/company/{company_id}/addresses/address/{id}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company.id,id:prms.id}),halClient.$get(uri,{}).then(function(customerAddress){return deferred.resolve(customerAddress)},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("AlertService",function($rootScope,ErrorService,$timeout){var alertService,titleLookup;return $rootScope.alerts=[],titleLookup=function(type,title){if(title)return title;switch(type){case"error":case"danger":title="Error";break;default:title=null}return title},alertService={add:function(type,arg){var alert,msg,persist,title;return title=arg.title,msg=arg.msg,persist=arg.persist,null==persist&&(persist=!0),$rootScope.alerts=[],alert={type:type,title:titleLookup(type,title),msg:msg,close:function(){return alertService.closeAlert(this)}},$rootScope.alerts.push(alert),persist||$timeout(function(){return $rootScope.alerts.splice($rootScope.alerts.indexOf(alert),1)},3e3),$rootScope.$broadcast("alert:raised")},closeAlert:function(alert){return this.closeAlertIdx($rootScope.alerts.indexOf(alert))},closeAlertIdx:function(index){return $rootScope.alerts.splice(index,1)},clear:function(){return $rootScope.alerts=[]},error:function(alert){return alert?this.add("error",{title:alert.title,msg:alert.msg,persist:alert.persist}):void 0},danger:function(alert){return alert?this.add("danger",{title:alert.title,msg:alert.msg,persist:alert.persist}):void 0},info:function(alert){return alert?this.add("info",{title:alert.title,msg:alert.msg,persist:alert.persist}):void 0},warning:function(alert){return alert?this.add("warning",{title:alert.title,msg:alert.msg,persist:alert.persist}):void 0},raise:function(alert){return alert?this.add(alert.type,{title:alert.title,msg:alert.msg,persist:alert.persist}):void 0}}})}.call(this),function(){angular.module("BB.Services").factory("BasketService",function($q,$rootScope,BBModel,MutexService){return{addItem:function(company,params){var data,deferred,lnk;return deferred=$q.defer(),lnk=params.item.book_link,data=params.item.getPostData(),lnk?MutexService.getLock().then(function(mutex){return lnk.$post("book",params,data).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,j,len,promises;for(promises=[],j=0,len=items.length;len>j;j++)i=items[j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}):deferred.reject("rel book not found for event"),deferred.promise},applyCoupon:function(company,params){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return company.$post("coupon",{},{coupon:params.coupon}).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,j,len,promises;for(promises=[],j=0,len=items.length;len>j;j++)i=items[j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise},updateBasket:function(company,params){var data,deferred,item,j,len,lnk,ref,xdata;for(deferred=$q.defer(),data={entire_basket:!0,items:[]},ref=params.items,j=0,len=ref.length;len>j;j++)item=ref[j],item.book_link&&(lnk=item.book_link),xdata=item.getPostData(),data.items.push(xdata);return lnk?(MutexService.getLock().then(function(mutex){return lnk.$post("book",params,data).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,k,len1,promises;for(promises=[],k=0,len1=items.length;len1>k;k++)i=items[k],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise):(deferred.reject("rel book not found for event"),deferred.promise)},checkPrePaid:function(item,pre_paid_bookings){var booking,j,len,valid_pre_paid;for(valid_pre_paid=null,j=0,len=pre_paid_bookings.length;len>j;j++)if(booking=pre_paid_bookings[j],booking.checkValidity(item)){valid_pre_paid=booking;break}return valid_pre_paid},query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("basket")?company.$get("basket").then(function(basket){return basket=new BBModel.Basket(basket,params.bb),basket.$has("items")&&basket.$get("items").then(function(items){var item,j,len,results;
for(results=[],j=0,len=items.length;len>j;j++)item=items[j],results.push(basket.addItem(new BBModel.BasketItem(item,params.bb)));return results}),deferred.resolve(basket)},function(err){return deferred.reject(err)}):deferred.reject("rel basket not found for company"),deferred.promise},deleteItem:function(item,company,params){var deferred;return params||(params={}),deferred=$q.defer(),item.$has("self")?MutexService.getLock().then(function(mutex){return item.$del("self",params).then(function(basket){return MutexService.unlock(mutex),company.$flush("basket"),basket=new BBModel.Basket(basket,params.bb),basket.$has("items")&&basket.$get("items").then(function(items){var j,len,results;for(results=[],j=0,len=items.length;len>j;j++)item=items[j],results.push(basket.addItem(new BBModel.BasketItem(item,params.bb)));return results}),deferred.resolve(basket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)}):deferred.reject("rel self not found for item"),deferred.promise},checkout:function(company,basket,params){var data,deferred;return deferred=$q.defer(),basket.$has("checkout")?(data=basket.getPostData(),params.bb.qudini_booking_id&&(data.qudini_booking_id=params.bb.qudini_booking_id),params.bb.no_notifications&&(data.no_notifications=params.bb.no_notifications),data.affiliate_id=$rootScope.affiliate_id,basket.waiting_for_checkout=!0,MutexService.getLock().then(function(mutex){return basket.$post("checkout",params,data).then(function(total){var tot;return MutexService.unlock(mutex),$rootScope.$broadcast("updateBookings"),tot=new BBModel.Purchase.Total(total),$rootScope.$broadcast("newCheckout",tot),basket.clear(),basket.waiting_for_checkout=!1,deferred.resolve(tot)},function(err){return basket.waiting_for_checkout=!1,deferred.reject(err)})},function(err){return basket.waiting_for_checkout=!1,MutexService.unlock(mutex),deferred.reject(err)})):deferred.reject("rel checkout not found for basket"),deferred.promise},empty:function(bb){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return bb.company.$del("basket").then(function(basket){return MutexService.unlock(mutex),bb.company.$flush("basket"),deferred.resolve(new BBModel.Basket(basket,bb))},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)}),deferred.promise},memberCheckout:function(basket,params){var data,deferred,item;return deferred=$q.defer(),basket.$has("checkout")?null===$rootScope.member?deferred.reject("member not set"):(basket._data.setOption("auth_token",$rootScope.member._data.getOption("auth_token")),data={items:function(){var j,len,ref,results;for(ref=basket.items,results=[],j=0,len=ref.length;len>j;j++)item=ref[j],results.push(item._data);return results}()},basket.$post("checkout",params,data).then(function(total){return total.$has("member")&&total.$get("member").then(function(member){return $rootScope.member.flushBookings(),$rootScope.member=new BBModel.Member.Member(member)}),deferred.resolve(total)},function(err){return deferred.reject(err)})):deferred.reject("rel checkout not found for basket"),deferred.promise},applyDeal:function(company,params){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return params.bb.basket.$post("deal",{},{deal_code:params.deal_code}).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,j,len,promises;for(promises=[],j=0,len=items.length;len>j;j++)i=items[j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise},removeDeal:function(company,params){var deferred;return params||(params={}),deferred=$q.defer(),params.bb.basket.$has("deal")?(MutexService.getLock().then(function(mutex){return params.bb.basket.$put("deal",{},{deal_code_id:params.deal_code_id.toString()}).then(function(basket){return MutexService.unlock(mutex),company.$flush("basket"),basket=new BBModel.Basket(basket,params.bb),basket.$has("items")?basket.$get("items").then(function(items){var item,j,len;for(j=0,len=items.length;len>j;j++)item=items[j],basket.addItem(new BBModel.BasketItem(item,params.bb));return deferred.resolve(basket)},function(err){return deferred.reject(err)}):void 0},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise):deferred.reject("No Remove Deal link found")}}})}.call(this),function(){angular.module("BB.Services").factory("BreadcrumbService",function(){var current_step;return current_step=1,{setCurrentStep:function(step){return current_step=step},getCurrentStep:function(){return current_step}}})}.call(this),function(){angular.module("BB.Services").factory("CategoryService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("categories")?company.$get("named_categories").then(function(_this){return function(resource){return resource.$get("categories").then(function(items){var _i,cat,categories,i,j,len;for(categories=[],_i=j=0,len=items.length;len>j;_i=++j)i=items[_i],cat=new BBModel.Category(i),cat.order||(cat.order=_i),categories.push(cat);return deferred.resolve(categories)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No categories found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ClientService",function($q,BBModel,MutexService){return{create:function(company,client){var deferred;return deferred=$q.defer(),company.$has("client")?MutexService.getLock().then(function(mutex){return company.$post("client",{},client.getPostData()).then(function(_this){return function(cl){return deferred.resolve(new BBModel.Client(cl)),MutexService.unlock(mutex)}}(this),function(_this){return function(err){return deferred.reject(err),MutexService.unlock(mutex)}}(this))}):deferred.reject("Cannot create new people for this company"),deferred.promise},update:function(company,client){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return client.$put("self",{},client.getPostData()).then(function(_this){return function(cl){return deferred.resolve(new BBModel.Client(cl)),MutexService.unlock(mutex)}}(this),function(_this){return function(err){return deferred.reject(err),MutexService.unlock(mutex)}}(this))}),deferred.promise},create_or_update:function(company,client){return client.$has("self")?this.update(company,client):this.create(company,client)},query_by_email:function(company,email){var deferred;return deferred=$q.defer(),null!=company&&null!=email?company.$get("client_by_email",{email:email}).then(function(_this){return function(client){return null!=client?deferred.resolve(new BBModel.Client(client)):deferred.resolve({})}}(this),function(err){return deferred.reject(err)}):deferred.reject("No company or email defined"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ClientDetailsService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("client_details")?company.$get("client_details").then(function(_this){return function(details){return deferred.resolve(new BBModel.ClientDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No client_details found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ClinicService",function($q,BBModel,$window){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),params.id?company.$get("clinics",params).then(function(clinic){return clinic=new BBModel.Clinic(clinic),defer.resolve(clinic)},function(err){return defer.reject(err)}):company.$get("clinics",params).then(function(collection){return collection.$get("clinics").then(function(clinics){var s;return clinics=function(){var i,len,results;for(results=[],i=0,len=clinics.length;len>i;i++)s=clinics[i],results.push(new BBModel.Clinic(s));return results}(),defer.resolve(clinics)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){angular.module("BB.Services").factory("CompanyService",function($q,halClient,BBModel){return{query:function(company_id,options){var deferred,url;return options.root||(options.root=""),url=options.root+"/api/v1/company/"+company_id,deferred=$q.defer(),halClient.$get(url,options).then(function(_this){return function(company){return deferred.resolve(company)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},queryChildren:function(company){var deferred;return deferred=$q.defer(),company.$has("companies")?company.$get("companies").then(function(_this){return function(resource){return resource.$get("companies").then(function(items){var companies,i,j,len;for(companies=[],j=0,len=items.length;len>j;j++)i=items[j],companies.push(new BBModel.Company(i));return deferred.resolve(companies)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No child companies found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("CustomTextService",function($q,BBModel){return{BookingText:function(company,basketItem){var deferred;return deferred=$q.defer(),company.$get("booking_text").then(function(_this){return function(emb){return emb.$get("booking_text").then(function(details){var detail,i,len,link,msgs,name,ref;for(msgs=[],i=0,len=details.length;len>i;i++)if(detail=details[i],"Booking"===detail.message_type){ref=basketItem.parts_links;for(name in ref)link=ref[name],detail.$href("item")===link&&-1===msgs.indexOf(detail.message)&&msgs.push(detail.message)}return deferred.resolve(msgs)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},confirmationText:function(company,total){var deferred;return deferred=$q.defer(),company.$get("booking_text").then(function(emb){return emb.$get("booking_text").then(function(details){return total.getMessages(details,"Confirm").then(function(msgs){return deferred.resolve(msgs)})})},function(err){return deferred.reject(err)}),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("DateTimeUlititiesService",function(){return{convertTimeSlotToMoment:function(day,time_slot){var datetime,hours,mins,val;if(day||time_slot)return datetime=moment(),val=parseInt(time_slot.time),hours=parseInt(val/60),mins=val%60,datetime.hour(hours),datetime.minutes(mins),datetime.seconds(0),datetime.date(day.date.date()),datetime.month(day.date.month()),datetime.year(day.date.year()),datetime},convertMomentToTime:function(datetime){return datetime.minutes()+60*datetime.hours()}}})}.call(this),function(){angular.module("BB.Services").factory("DayService",function($q,BBModel){return{query:function(prms){var deferred,extra;return deferred=$q.defer(),prms.cItem.days_link?(extra={},extra.month=prms.month,extra.date=prms.date,extra.edate=prms.edate,prms.client&&(extra.location=prms.client.addressCsvLine()),prms.cItem.person&&!prms.cItem.anyPerson()&&(extra.person_id=prms.cItem.person.id),prms.cItem.resource&&!prms.cItem.anyResource()&&(extra.resource_id=prms.cItem.resource.id),prms.cItem.days_link.$get("days",extra).then(function(_this){return function(found){var afound,days,i,j,len;for(afound=found.days,days=[],j=0,len=afound.length;len>j;j++)i=afound[j],i.type===prms.item&&days.push(new BBModel.Day(i));return deferred.resolve(days)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.reject("No Days Link found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("DealService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("deals")?company.$get("deals").then(function(_this){return function(resource){return resource.$get("deals").then(function(deals){var deal;return deals=function(){var i,len,results;for(results=[],i=0,len=deals.length;len>i;i++)deal=deals[i],results.push(new BBModel.Deal(deal));return results}(),deferred.resolve(deals)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No Deals found"),deferred.promise}}})}.call(this),function(){angular.module("BB").config(function($logProvider,$injector){return $logProvider.debugEnabled(!0)}),angular.module("BB.Services").factory("DebugUtilsService",function($rootScope,$location,$window,$log,BBModel,$bbug){var logObjectKeys,showScopeChain;return logObjectKeys=function(obj,showValue){var key,value;for(key in obj)value=obj[key],!obj.hasOwnProperty(key)||_.isFunction(value)||/^\$\$/.test(key)||(console.log(key),showValue&&console.log("	",value,"\n"))},showScopeChain=function(){var $root,data,f;$root=$("[ng-app]"),data=$root.data(),data&&data.$scope&&(f=function(scope){return console.log(scope.$id),console.log(scope),scope.$$nextSibling?f(scope.$$nextSibling):scope.$$childHead?f(scope.$$childHead):void 0})(data.$scope)},function(){return"localhost"!==$location.host()&&"127.0.0.1"!==$location.host()||3e3!==$location.port()?void 0:window.setTimeout(function(){var scope;for(scope=$rootScope;scope&&"public.controllers.BBCtrl"!==scope.controller;)scope=scope.$$childHead;return $bbug($window).on("dblclick",function(e){var controller,controllerName,pscope;for(scope=angular.element(e.target).scope(),controller=scope.hasOwnProperty("controller"),pscope=scope,controller&&(controllerName=scope.controller);!controller;)pscope=pscope.$parent,controllerName=pscope.controller,controller=pscope.hasOwnProperty("controller");return $window.bbScope=scope,$log.log(e.target),$log.log($window.bbScope),$log.log("Controller ->",controllerName)}),$window.bbBBCtrlScopeKeyNames=function(prop){return logObjectKeys(scope,prop)},$window.bbBBCtrlScope=function(){return scope},$window.bbCurrentItem=function(){return scope.current_item},$window.bbShowScopeChain=showScopeChain},10)}(),{logObjectKeys:logObjectKeys}})}.call(this),function(){angular.module("BB.Services").factory("Dialog",function($modal,$log){var controller;return controller=function($scope,$modalInstance,model,title,success,fail,body){return $scope.body=body,$scope.ok=function(){return $modalInstance.close(model)},$scope.cancel=function(){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")},$modalInstance.result.then(function(){return success?success(model):void 0},function(){return fail?fail():void 0})},{confirm:function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="dialog.html"),$modal.open({templateUrl:templateUrl,controller:controller,size:config.size||"sm",resolve:{model:function(){return config.model},title:function(){return config.title},success:function(){return config.success},fail:function(){return config.fail},body:function(){return config.body}}})}}})}.call(this),function(){angular.module("BB.Services").factory("ErrorService",function(SettingsService){var alerts;return alerts=[{key:"GENERIC",type:"error",title:"",persist:!0,msg:"Sorry, it appears that something went wrong. Please try again or call the business you're booking with if the problem persists."},{key:"LOCATION_NOT_FOUND",type:"warning",title:"",persist:!0,msg:"Sorry, we don't recognise that location"},{key:"MISSING_LOCATION",type:"warning",title:"",persist:!0,msg:"Please enter your location"},{key:"MISSING_POSTCODE",type:"warning",title:"",persist:!0,msg:"Please enter a postcode"},{key:"INVALID_POSTCODE",type:"warning",title:"",persist:!0,msg:"Please enter a valid postcode"},{key:"ITEM_NO_LONGER_AVAILABLE",type:"error",title:"",persist:!0,msg:"Sorry. The item you were trying to book is no longer available. Please try again."},{key:"FORM_INVALID",type:"warning",title:"",persist:!0,msg:"Please complete all required fields"},{key:"GEOLOCATION_ERROR",type:"error",title:"",persist:!0,msg:"Sorry, we could not determine your location. Please try searching instead."},{key:"EMPTY_BASKET_FOR_CHECKOUT",type:"warning",title:"",persist:!0,msg:"There are no items in the basket to proceed to checkout."},{key:"MAXIMUM_TICKETS",type:"warning",title:"",persist:!0,msg:"Unfortunately, the maximum number of tickets per person has been reached."},{key:"TIME_SLOT_NOT_SELECTED",type:"warning",title:"",persist:!0,msg:"You need to select a time slot"},{key:"APPT_AT_SAME_TIME",type:"warning",title:"",persist:!0,msg:"Your appointment is already booked for this time"},{key:"REQ_TIME_NOT_AVAIL",type:"warning",title:"",persist:!0,msg:"Sorry, the requested time slot is not available. Please choose a different time."},{key:"TOPUP_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, your topup failed. Please try again."},{key:"UPDATE_SUCCESS",type:"success",title:"",persist:!0,msg:"Updated"},{key:"UPDATE_FAILED",type:"warning",title:"",persist:!0,msg:"Update failed. Please try again"},{key:"ALREADY_REGISTERED",type:"warning",title:"",persist:!0,msg:"You have already registered with this email address. Please login or reset your password."},{key:"LOGIN_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, your email or password was not recognised. Please try again."},{key:"PASSWORD_RESET_REQ_SUCCESS",type:"success",title:"",persist:!0,msg:"We have sent you an email with instructions on how to reset your password."},{key:"PASSWORD_RESET_REQ_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, we didn't find an account registered with that email."},{key:"PASSWORD_RESET_SUCESS",type:"success",title:"",persist:!0,msg:"Your password has been updated."},{key:"PASSWORD_RESET_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, we couldn't update your password. Plese try again."},{key:"PASSWORD_MISMATCH",type:"warning",title:"",persist:!0,msg:"Your passwords don't match each other."}],{getError:function(key){var error,translate;return error=_.findWhere(alerts,{key:key}),error.persist=!0,translate=SettingsService.isInternationalizatonEnabled(),error&&translate?{msg:"ERROR."+key}:error&&!translate?error:translate?{msg:"GENERIC"}:alerts[0]},getAlert:function(key){var alert,translate;return alert=_.findWhere(alerts,{key:key}),translate=SettingsService.isInternationalizatonEnabled(),alert&&translate?{msg:"ALERT."+key}:alert&&!translate?alert:null}}})}.call(this),function(){angular.module("BB.Services").factory("EventService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("events",params).then(function(_this){return function(resource){return resource.$get("events",params).then(function(events){var event;return events=function(){var i,len,results;for(results=[],i=0,len=events.length;len>i;i++)event=events[i],results.push(new BBModel.Event(event));return results}(),deferred.resolve(events)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise},summary:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),params.summary=!0,company.$get("events",params).then(function(_this){return function(resource){return deferred.resolve(resource.events)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise},queryEventCollection:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("events",params).then(function(_this){return function(resource){var collection;return collection=new BBModel.EventCollection(resource),deferred.resolve(collection)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("EventChainService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_chains")?company.$get("event_chains",params).then(function(_this){return function(resource){return resource.$get("event_chains",params).then(function(event_chains){var event_chain;return event_chains=function(){var i,len,results;for(results=[],i=0,len=event_chains.length;len>i;i++)event_chain=event_chains[i],results.push(new BBModel.EventChain(event_chain));return results}(),deferred.resolve(event_chains)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_chains"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("EventGroupService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_groups")?company.$get("event_groups",params).then(function(_this){return function(resource){return resource.$get("event_groups",params).then(function(event_groups){var event_group;return event_groups=function(){var i,len,results;for(results=[],i=0,len=event_groups.length;len>i;i++)event_group=event_groups[i],results.push(new BBModel.EventGroup(event_group));return results}(),deferred.resolve(event_groups)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_groups"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("EventSequenceService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_sequences")?company.$get("event_sequences",params).then(function(_this){return function(resource){return resource.$get("event_sequences",params).then(function(event_sequences){var event_sequence;return event_sequences=function(){var i,len,results;for(results=[],i=0,len=event_sequences.length;len>i;i++)event_sequence=event_sequences[i],results.push(new BBModel.EventSequence(event_sequence));return results}(),deferred.resolve(event_sequences)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_sequences"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("PathSvc",function($sce,AppConfig){return{directivePartial:function(fileName){var partial_url;return AppConfig.partial_url?(partial_url=AppConfig.partial_url,$sce.trustAsResourceUrl(partial_url+"/"+fileName+".html")):$sce.trustAsResourceUrl(fileName+".html")}}})}.call(this),function(){"use strict";angular.module("BB.Services").factory("FormDataStoreService",function($rootScope,$window,$log,$parse){var checkForListeners,checkRegisteredWidgets,clear,dataStore,div,getParentScope,init,log,register,registeredWidgetArr,removeWidget,resetValuesOnScope,setIfUndefined,setListeners,setValuesOnScope,showInfo,storeFormData,toId;return registeredWidgetArr=[],dataStore={},toId=0,div="___",log=function(){},showInfo=function(){return log(dataStore)},setIfUndefined=function(keyName,val){var getter,scope;return scope=this,getter=$parse(keyName),"undefined"==typeof getter(scope)?getter.assign(scope,val):void 0},resetValuesOnScope=function(scope,props){var i,len,prop,setter;for(i=0,len=props.length;len>i;i++)prop=props[i],prop=$parse(prop),(setter=prop.assign)(scope,null)},clear=function(scope,keepScopeValues){var data,key,widgetId;if(!scope)throw new Error("Missing scope object. Cannot clear form data without scope");if(_.isString(scope))return data=dataStore[scope],keepScopeValues||resetValuesOnScope(data[0],data[1]),void delete dataStore[scope];if(scope=getParentScope(scope),scope&&scope.bb){widgetId=scope.bb.uid,removeWidget(scope);for(key in dataStore)data=dataStore[key],-1!==key.indexOf(widgetId)&&(data[3]&&_.each(data[3],function(func){return _.isFunction(func)?func():void 0}),keepScopeValues||resetValuesOnScope(data[0],data[1]),delete dataStore[key])}},storeFormData=function(){var i,key,len,ndata,prop,props,scope,step,val;log("formDataStore ->",dataStore);for(key in dataStore){for(step=dataStore[key],log("	",key),scope=step[0],props=step[1],ndata=step[2],ndata||(ndata=step[2]={}),i=0,len=props.length;len>i;i++)prop=props[i],val=ndata[prop],"data:destroyed"===val?ndata[prop]=null:(val=angular.copy(scope.$eval(prop)),ndata[prop]=val),log("		",prop,val);log("\n")}},setValuesOnScope=function(currentPage,scope){var cpage,storedValues;cpage=dataStore[currentPage],storedValues=cpage[2],log("Decorating scope ->",currentPage,storedValues),_.isObject(storedValues)&&_.each(_.keys(storedValues),function(keyName){var getter;return"undefined"!=typeof storedValues[keyName]&&"data:destroyed"!==storedValues[keyName]?(getter=$parse(keyName),getter.assign(scope,storedValues[keyName])):void 0}),cpage[0]=scope,log(scope),log("\n")},getParentScope=function(scope){for(;scope;){if(scope.hasOwnProperty("cid")&&"BBCtrl"===scope.cid)return scope;scope=scope.$parent}},checkRegisteredWidgets=function(scope){var i,isRegistered,len,rscope;for(isRegistered=!1,scope=getParentScope(scope),i=0,len=registeredWidgetArr.length;len>i;i++)rscope=registeredWidgetArr[i],rscope===scope&&(isRegistered=!0);return isRegistered},checkForListeners=function(propsArr){var watchArr;return watchArr=[],_.each(propsArr,function(propName,index){var split;return split=propName.split("->"),2===split.length?(watchArr.push(split),propsArr[index]=split[0]):void 0}),watchArr},setListeners=function(scope,listenerArr,currentPage){var cpage,listenersArr;return listenerArr.length?(cpage=dataStore[currentPage],listenersArr=cpage[3]||[],_.each(listenerArr,function(item,index){var func;return func=$rootScope.$on(item[1],function(){var e;try{return cpage[2][item[0]]="data:destroyed"}catch(_error){return e=_error,log(e)}}),listenersArr.push(func)}),cpage[3]=listenersArr):void 0},init=function(uid,scope,propsArr){var currentPage,watchArr;if(checkRegisteredWidgets(scope)){if(currentPage=scope.bb.uid+div+scope.bb.current_page+div+uid,currentPage=currentPage.toLowerCase(),watchArr=checkForListeners(propsArr),scope.clearStoredData=function(currentPage){return function(){clear(currentPage)}}(currentPage),!currentPage)throw new Error("Missing current step");if(dataStore[currentPage])return void setValuesOnScope(currentPage,scope);log("Controller registered ->",currentPage,scope,"\n\n"),dataStore[currentPage]=[scope,propsArr],setListeners(scope,watchArr,currentPage)}},removeWidget=function(scope){registeredWidgetArr=_.without(registeredWidgetArr,scope)},register=function(scope){var registered;for(registered=!1,scope&&scope.$$childHead&&(scope=scope.$$childHead);!_.has(scope,"cid");)scope=scope.$parent;if(scope){if("BBCtrl"!==scope.cid)throw new Error("This directive can only be used with the BBCtrl");return _.each(registeredWidgetArr,function(stored){return scope===stored?registered=!0:void 0}),registered?void 0:(log("Scope registered ->",scope),scope.$on("destroy",removeWidget),registeredWidgetArr.push(scope))}},$rootScope.$watch(function(){$window.clearTimeout(toId),toId=setTimeout(storeFormData,300)}),$rootScope.$on("save:formData",storeFormData),$rootScope.$on("clear:formData",clear),{init:init,destroy:function(scope){return clear(scope,!0)},showInfo:showInfo,register:register,setIfUndefined:setIfUndefined}})}.call(this),function(){angular.module("BB.Services").factory("GeolocationService",function($q){return{haversine:function(position1,position2){var R,a,c,chLat,chLon,d,dLat,dLon,distance,distances,lat1,lat2,lon1,lon2,pi,rLat1,rLat2;return pi=Math.PI,R=6371,distances=[],lat1=position1.lat,lon1=position1["long"],lat2=position2.lat,lon2=position2["long"],chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,d=.621371192*d,distance=Math.round(d)},geocode:function(address,prms){var deferred,ne,request,sw;return null==prms&&(prms={}),deferred=$q.defer(),request={address:address},prms.region&&(request.region=prms.region),prms.componentRestrictions&&(request.componentRestrictions=prms.componentRestrictions),prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),request.bounds=new google.maps.LatLngBounds(sw,ne)),(new google.maps.Geocoder).geocode(request,function(results,status){return results&&"OK"===status?deferred.resolve({results:results,status:status}):deferred.reject(status)}),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ItemService",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.cItem.service&&"service"!==prms.item?prms.cItem.service.$has("items")?this.build_items(prms.cItem.service.$get("items"),prms,deferred):prms.cItem.service.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):prms.cItem.resource&&!prms.cItem.anyResource()&&"resource"!==prms.item?prms.cItem.resource.$has("items")?this.build_items(prms.cItem.resource.$get("items"),prms,deferred):prms.cItem.resource.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):prms.cItem.person&&!prms.cItem.anyPerson()&&"person"!==prms.item?prms.cItem.person.$has("items")?this.build_items(prms.cItem.person.$get("items"),prms,deferred):prms.cItem.person.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):deferred.reject("No service link found"),deferred.promise},build_items:function(base_items,prms,deferred){var wait_items;return wait_items=[base_items],prms.wait&&wait_items.push(prms.wait),$q.all(wait_items).then(function(_this){return function(resources){var resource;return resource=resources[0],resource.$get("items").then(function(found){var i,len,m,matching,v,wlist;for(matching=[],wlist=[],i=0,len=found.length;len>i;i++)v=found[i],v.type===prms.item&&matching.push(new BBModel.BookableItem(v));return $q.all(function(){var j,len1,results;for(results=[],j=0,len1=matching.length;len1>j;j++)m=matching[j],results.push(m.ready.promise);return results}()).then(function(){return deferred.resolve(matching)})})}}(this))}}})}.call(this),function(){angular.module("BB.Services").factory("ItemDetailsService",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.cItem.service?prms.cItem.service.$has("questions")?prms.cItem.service.$get("questions").then(function(_this){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(_this){
return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):prms.cItem.event_chain?prms.cItem.event_chain.$has("questions")?prms.cItem.event_chain.$get("questions").then(function(_this){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):prms.cItem.deal?prms.cItem.deal.$has("questions")?prms.cItem.deal.$get("questions").then(function(_this){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):deferred.reject("No service link found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("LocaleService",function($window){var locale;return locale=$window.getURIparam("locale"),locale?locale:$window.navigator.language?$window.navigator.language:"en"})}.call(this),function(){angular.module("BB.Services").factory("LoginService",function($q,halClient,$rootScope,BBModel,$sessionStorage){return{companyLogin:function(company,params,form){var deferred;return deferred=$q.defer(),company.$post("login",params,form).then(function(_this){return function(login){return login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)},function(err){return deferred.reject(err)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},login:function(form,options){var deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login",halClient.$post(url,options,form).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},companyQuery:function(_this){return function(id){var comp_promise;return id?(comp_promise=halClient.$get(location.protocol+"//"+location.host+"/api/v1/company/"+id),comp_promise.then(function(company){return company=new BBModel.Company(company)})):void 0}}(this),memberQuery:function(_this){return function(params){var member_promise;return params.member_id&&params.company_id?(member_promise=halClient.$get(location.protocol+"//"+location.host+("/api/v1/"+params.company_id+"/")+"members/"+params.member_id),member_promise.then(function(member){return member=new BBModel.Member.Member(member)})):void 0}}(this),ssoLogin:function(options,data){var deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/sso/"+options.company_id,halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return member=new BBModel.Member.Member(member),_this.setLogin(member),deferred.resolve(member)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},isLoggedIn:function(){return this.checkLogin(),!$rootScope.member||$rootScope.user&&void 0!==$rootScope.user?!1:!0},setLogin:function(member){var auth_token;return auth_token=member.getOption("auth_token"),member=new BBModel.Member.Member(member),$sessionStorage.setItem("login",member.$toStore()),$sessionStorage.setItem("auth_token",auth_token),$rootScope.member=member,member},member:function(){return this.checkLogin(),$rootScope.member},checkLogin:function(){var member;if(!$rootScope.member)return member=$sessionStorage.getItem("login"),member?$rootScope.member=halClient.createResource(member):void 0},logout:function(options){var deferred,url;return $rootScope.member=null,deferred=$q.defer(),options||(options={}),options.root||(options.root=""),url=options.root+"/api/v1/logout",$sessionStorage.removeItem("login"),$sessionStorage.removeItem("auth_token"),$sessionStorage.clear(),halClient.$del(url,options,{}).then(function(_this){return function(logout){return $sessionStorage.removeItem("login"),$sessionStorage.removeItem("auth_token"),$sessionStorage.clear(),deferred.resolve(!0)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},sendPasswordReset:function(company,params){var deferred;return deferred=$q.defer(),company.$post("email_password_reset",{},params).then(function(_this){return function(){return deferred.resolve(!0)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},updatePassword:function(member,params){var deferred;return params.auth_token=member.getOption("auth_token"),member&&params.new_password&&params.confirm_new_password?(deferred=$q.defer(),member.$post("update_password",{},params).then(function(_this){return function(login){return login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)},function(err){return deferred.reject(err)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise):void 0}}})}.call(this),function(){angular.module("BB.Services").factory("MembershipLevelsService",function($q,BBModel){return{getMembershipLevels:function(company){var deferred;return deferred=$q.defer(),company.$get("member_levels").then(function(resource){return resource.$get("membership_levels").then(function(_this){return function(membership_levels){var level,levels;return levels=function(){var i,len,results;for(results=[],i=0,len=membership_levels.length;len>i;i++)level=membership_levels[i],results.push(new BBModel.MembershipLevel(level));return results}(),deferred.resolve(levels)}}(this))},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ModalForm",function($modal,$log,Dialog){var editForm,newForm;return newForm=function($scope,$modalInstance,company,title,new_rel,post_rel,success,fail){return $scope.loading=!0,$scope.title=title,$scope.company=company,$scope.company.$has(new_rel)?$scope.company.$get(new_rel).then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model={},$scope.loading=!1}):$log.warn("company does not have '"+new_rel+"' rel"),$scope.submit=function(form){return $scope.$broadcast("schemaFormValidate"),$scope.loading=!0,$scope.company.$post(post_rel,{},$scope.form_model).then(function(model){return $scope.loading=!1,$modalInstance.close(model),success?success(model):void 0},function(err){return $scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail?fail(err):void 0})},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")}},editForm=function($scope,$modalInstance,model,title,success,fail){return $scope.loading=!0,$scope.title=title,$scope.model=model,$scope.model.$has("edit")?$scope.model.$get("edit").then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model=$scope.model,$scope.loading=!1}):$log.warn("model does not have 'edit' rel"),$scope.submit=function(form){return $scope.$broadcast("schemaFormValidate"),$scope.loading=!0,$scope.model.$update?$scope.model.$update($scope.form_model).then(function(){return $scope.loading=!1,$modalInstance.close($scope.model),success?success($scope.model):void 0},function(err){return $scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail?fail():void 0}):$scope.model.$put("self",{},$scope.form_model).then(function(model){return $scope.loading=!1,$modalInstance.close(model),success?success(model):void 0},function(err){return $scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail?fail():void 0})},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")},$scope.cancelBooking=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.close(),Dialog.confirm({model:model,body:"Are you sure you want to cancel this booking?",success:function(model){return model.$del("self").then(function(response){return success?success(response):void 0})}})}},{"new":function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="modal_form.html"),$modal.open({templateUrl:templateUrl,controller:newForm,size:config.size,resolve:{company:function(){return config.company},title:function(){return config.title},new_rel:function(){return config.new_rel},post_rel:function(){return config.post_rel},success:function(){return config.success},fail:function(){return config.fail}}})},edit:function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="modal_form.html"),$modal.open({templateUrl:templateUrl,controller:editForm,size:config.size,resolve:{model:function(){return config.model},title:function(){return config.title},success:function(){return config.success},fail:function(){return config.fail}}})}}})}.call(this),function(){angular.module("BB.Services").factory("MutexService",function($q,$window,$rootScope){return{getLock:function(prms){var iprom,mprom;return mprom=$q.defer(),iprom=$q.defer(),mprom.promise.then(function(){var next_mux;return $rootScope.mutexes.shift(),$rootScope.mutexes.length>0?(next_mux=$rootScope.mutexes[0],next_mux.iprom.resolve(next_mux.mprom)):void 0}),$rootScope.mutexes&&0!==$rootScope.mutexes.length?($rootScope.mutexes.push({mprom:mprom,iprom:iprom}),iprom.promise):($rootScope.mutexes=[{mprom:mprom,iprom:iprom}],iprom.resolve(mprom),iprom.promise)},unlock:function(mutex){return mutex.resolve()}}})}.call(this),function(){angular.module("BB.Services").factory("PaginationService",function(){return{initialise:function(options){var paginator;if(options)return paginator={current_page:1,page_size:options.page_size,num_pages:null,max_size:options.max_size,num_items:null}},update:function(paginator,length){var end,start,total;if(paginator&&length)return paginator.num_items=length,start=(paginator.page_size-1)*paginator.current_page-(paginator.page_size-1-paginator.current_page),end=paginator.current_page*paginator.page_size,total=end<paginator.page_size?end:length,end=end>total?total:end,total=total>=100?"100+":total,paginator.summary=start+" - "+end+" of "+total}}})}.call(this),function(){angular.module("BB.Services").factory("PersonService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("people")?company.$get("people").then(function(_this){return function(resource){return resource.$get("people").then(function(items){var i,j,len,people;for(people=[],j=0,len=items.length;len>j;j++)i=items[j],people.push(new BBModel.Person(i));return deferred.resolve(people)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No people found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ProductService",function($q,$window,halClient,UriTemplate){return{getProduct:function(prms){var deferred,href,uri;return deferred=$q.defer(),href=prms.api_url+"/api/v1/{company_id}/products/{id}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company_id,id:prms.product_id}),halClient.$get(uri,{}).then(function(product){return deferred.resolve(product)},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},query:function(company){var deferred;return deferred=$q.defer(),company.$has("products")?company.$get("products").then(function(_this){return function(resource){return resource.$get("products").then(function(items){var i,j,len,resources;for(resources=[],j=0,len=items.length;len>j;j++)i=items[j],resources.push(new BBModel.Product(i));return deferred.resolve(resources)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No products found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("PurchaseTotalService",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.company.$has("total")?prms.company.$get("total",{total_id:prms.total_id}).then(function(_this){return function(total){return deferred.resolve(new BBModel.PurchaseTotal(total))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No Total link found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("QueryStringService",function($window){return function(keyName){var hash,hashes,href,i,isNum,len,val,varObj;if(varObj={},href=$window.location.href,!(href.indexOf("?")<0)){for(hashes=href.slice(href.indexOf("?")+1).split(/[#&]/),isNum=function(num){return null==num||"0"===num.substr(0,1)||/[a-zA-Z\-\_\+\.\#\%\*\,]/.test(num)||window.isNaN(window.parseInt(num,10))?void 0:!0},i=0,len=hashes.length;len>i;i++)hash=hashes[i],hash=hash.split("="),val=hash[1],val=isNum(val)?window.parseInt(val,10):"true"===val?!0:"false"===val?!1:window.decodeURIComponent(val),varObj[hash[0]]=val;return keyName?varObj[keyName]:varObj}}})}.call(this),function(){"use strict";angular.module("BB.Services").factory("QuestionService",function($window,QueryStringService,$bbug){var addAnswersById,addAnswersByName,addAnswersFromDefaults,addDynamicAnswersByName,checkConditionalQuestions,convertDates,convertToSnakeCase,defaults,findByQuestionId,storeDefaults;return defaults=QueryStringService()||{},convertDates=function(obj){return _.each(obj,function(val,key){var date;return date=$window.moment(obj[key]),_.isString(obj[key])&&date.isValid()?obj[key]=date:void 0})},$window.bb_setup&&(convertDates($window.bb_setup),angular.extend(defaults,$window.bb_setup)),addAnswersById=function(questions){return questions?angular.isArray(questions)?_.each(questions,function(question){var id;return id=question.id+"",!question.answer&&defaults[id]?question.answer=defaults[id]:void 0}):defaults[questions.id+""]?questions.answer=defaults[questions.id+""]:void 0:void 0},convertToSnakeCase=function(str){return str=str.toLowerCase(),str=$.trim(str),str=str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,""),str=str.replace(/\s{2,}/g," "),str=str.replace(/\s/g,"_")},addDynamicAnswersByName=function(questions){var keys;return angular.isArray(questions)?(keys=_.keys(defaults),_.each(questions,function(question){var name;return name=convertToSnakeCase(question.name),_.each(keys,function(key){name.indexOf(key)>=0&&defaults[key]&&!question.answer&&(question.answer=defaults[key],delete defaults[key])})})):void 0},addAnswersByName=function(obj,keys){var i,key,len,type;if(type=Object.prototype.toString.call(obj).slice(8,-1),"Object"===type&&angular.isArray(keys))for(i=0,len=keys.length;len>i;i++)key=keys[i],defaults[key]&&!obj[key]&&(obj[key]=defaults[key],delete defaults[key])},addAnswersFromDefaults=function(questions,answers){var i,len,name,question,results;for(results=[],i=0,len=questions.length;len>i;i++)question=questions[i],name=question.help_text,answers[name]&&(question.answer=answers[name]),answers[question.id+""]?results.push(question.answer=answers[question.id+""]):results.push(void 0);return results},storeDefaults=function(obj){return angular.extend(defaults,obj.bb_setup||{})},checkConditionalQuestions=function(questions){var a,ans,cond,found,i,len,q,ref,results,v;for(results=[],i=0,len=questions.length;len>i;i++)if(q=questions[i],q.settings&&q.settings.conditional_question)if(cond=findByQuestionId(questions,parseInt(q.settings.conditional_question))){ans=cond.getAnswerId(),found=!1,$bbug.isEmptyObject(q.settings.conditional_answers)&&"check"===cond.detail_type&&!cond.answer&&(found=!0),ref=q.settings.conditional_answers;for(a in ref)v=ref[a],"c"===a[0]&&1===parseInt(v)&&cond.answer?found=!0:parseInt(a)===ans&&1===parseInt(v)&&(found=!0);found?results.push(q.showElement()):results.push(q.hideElement())}else results.push(void 0);else results.push(void 0);return results},findByQuestionId=function(questions,qid){var i,len,q;for(i=0,len=questions.length;len>i;i++)if(q=questions[i],q.id===qid)return q;return null},{getStoredData:function(){return defaults},storeDefaults:storeDefaults,addAnswersById:addAnswersById,addAnswersByName:addAnswersByName,addDynamicAnswersByName:addDynamicAnswersByName,addAnswersFromDefaults:addAnswersFromDefaults,convertToSnakeCase:convertToSnakeCase,checkConditionalQuestions:checkConditionalQuestions}})}.call(this),function(){angular.module("BB.Services").factory("RecaptchaService",function($q,halClient,UriTemplate){return{validateResponse:function(params){var deferred,href,prms,uri;return deferred=$q.defer(),href=params.api_url+"/api/v1/recaptcha",uri=new UriTemplate(href),prms={},prms.response=params.response,halClient.$post(uri,{},prms).then(function(response){return deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ResourceService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("resources")?company.$get("resources").then(function(_this){return function(resource){return resource.$get("resources").then(function(items){var i,j,len,resources;for(resources=[],j=0,len=items.length;len>j;j++)i=items[j],resources.push(new BBModel.Resource(i));return deferred.resolve(resources)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No resource found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ServiceService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("services")?company.$get("services").then(function(_this){return function(resource){return resource.$get("services").then(function(items){var i,j,len,services;for(services=[],j=0,len=items.length;len>j;j++)i=items[j],services.push(new BBModel.Service(i));return deferred.resolve(services)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No services found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("SettingsService",function(){var i18n,scroll_offset;return i18n=!1,scroll_offset=0,{enableInternationalizaton:function(){return i18n=!0},isInternationalizatonEnabled:function(){return i18n},setScrollOffset:function(value){return scroll_offset=parseInt(value)},getScrollOffset:function(){return scroll_offset}}})}.call(this),function(){angular.module("BB.Services").factory("SlotService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("slots")?(params.item&&(params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("slots",params).then(function(_this){return function(resource){return resource.$get("slots",params).then(function(slots){var slot;return slots=function(){var i,len,results;for(results=[],i=0,len=slots.length;len>i;i++)slot=slots[i],results.push(new BBModel.Slot(slot));return results}(),deferred.resolve(slots)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("SpaceService",["$q",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("spaces")?company.$get("spaces").then(function(_this){return function(resource){return resource.$get("spaces").then(function(items){var i,j,len,spaces;for(spaces=[],j=0,len=items.length;len>j;j++)i=items[j],spaces.push(new BBModel.Space(i));return deferred.resolve(spaces)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No spaces found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("SSOService",function($q,$rootScope,halClient,LoginService){return{memberLogin:function(options){var data,deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/sso/"+options.company_id,data={token:options.member_sso},halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return member=LoginService.setLogin(member),deferred.resolve(member)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},adminLogin:function(options){var data,deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/admin_sso/"+options.company_id,data={token:options.admin_sso},halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("administrator").then(function(admin){return deferred.resolve(admin)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("TemplateSvc",function($q,$http,$templateCache,BBModel){return{get:function(path){var cacheTmpl,deferred;return deferred=$q.defer(),cacheTmpl=$templateCache.get(path),cacheTmpl?deferred.resolve(angular.element(cacheTmpl)):$http({method:"GET",url:path}).success(function(tmpl,status){return $templateCache.put(path,tmpl),deferred.resolve(angular.element(tmpl))}).error(function(data,status){return deferred.reject(data)}),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("TimeService",function($q,BBModel,halClient){return{query:function(prms){var date,deferred,extra,item_link;if(deferred=$q.defer(),prms.date)date=prms.date.toISODate();else{if(!prms.cItem.date)return deferred.reject("No date set"),deferred.promise;date=prms.cItem.date.date.toISODate()}return null==prms.duration&&prms.cItem&&prms.cItem.duration&&(prms.duration=prms.cItem.duration),item_link=prms.item_link,prms.cItem&&prms.cItem.days_link&&!item_link&&(item_link=prms.cItem.days_link),item_link?(extra={date:date},prms.location&&(extra.location=prms.location),prms.cItem.event_id&&(extra.event_id=prms.cItem.event_id),!prms.cItem.person||prms.cItem.anyPerson()||item_link.event_id||extra.event_id||(extra.person_id=prms.cItem.person.id),!prms.cItem.resource||prms.cItem.anyResource()||item_link.event_id||extra.event_id||(extra.resource_id=prms.cItem.resource.id),prms.end_date&&(extra.end_date=prms.end_date.toISODate()),extra.duration=prms.duration,extra.resource_ids=prms.resource_ids,extra.num_resources=prms.num_resources,extra.event_id&&(item_link=prms.company),item_link.$get("times",extra).then(function(_this){return function(results){var times;return results.$has("date_links")?results.$get("date_links").then(function(all_days){var all_days_def,date_times,day,fn,j,len;for(date_times={},all_days_def=[],fn=function(day){var times;return day.elink=$q.defer(),all_days_def.push(day.elink.promise),day.$has("event_links")?day.$get("event_links").then(function(all_events){var times;return times=_this.merge_times(all_events,prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),date_times[day.date]=times,day.elink.resolve()}):day.times?(times=_this.merge_times([day],prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),date_times[day.date]=times,day.elink.resolve()):void 0},j=0,len=all_days.length;len>j;j++)day=all_days[j],fn(day);return $q.all(all_days_def).then(function(){return deferred.resolve(date_times)})}):results.$has("event_links")?results.$get("event_links").then(function(all_events){var times;return times=_this.merge_times(all_events,prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),deferred.resolve(times)}):results.times?(times=_this.merge_times([results],prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),deferred.resolve(times)):void 0}}(this),function(err){return deferred.reject(err)})):deferred.reject("No day data"),deferred.promise},merge_times:function(all_events,service,item){var date_times,ev,i,j,k,l,len,len1,len2,ref,sorted_times,times;if(!all_events||0===all_events.length)return[];for(sorted_times=[],j=0,len=all_events.length;len>j;j++)if(ev=all_events[j],ev.times){for(ref=ev.times,k=0,len1=ref.length;len1>k;k++)i=ref[k],(!sorted_times[i.time]||0===sorted_times[i.time].avail||0===Math.floor(Math.random()*all_events.length)&&i.avail>0)&&(i.event_id=ev.event_id,sorted_times[i.time]=i);item.held&&this.checkCurrentItem(item.held,sorted_times,ev),this.checkCurrentItem(item,sorted_times,ev)}for(times=[],date_times={},l=0,len2=sorted_times.length;len2>l;l++)i=sorted_times[l],i&&times.push(new BBModel.TimeSlot(i,service));return times},checkCurrentItem:function(item,sorted_times,ev){return item&&item.id&&item.event_id===ev.event_id&&item.time&&!sorted_times[item.time.time]&&item.date&&item.date.date.toISODate()===ev.date?(sorted_times[item.time.time]=item.time,halClient.clearCache(ev.$href("self"))):item&&item.id&&item.event_id===ev.event_id&&item.time&&sorted_times[item.time.time]&&item.date&&item.date.date.toISODate()===ev.date?sorted_times[item.time.time].avail=1:void 0}}})}.call(this),function(){angular.module("BB.Services").factory("TimeSlotService",function($q,BBModel){return{query:function(params){var company,defer;return defer=$q.defer(),company=params.company,company.$get("slots",params).then(function(collection){return collection.$get("slots").then(function(slots){var s;return slots=function(){var i,len,results;for(results=[],i=0,len=slots.length;len>i;i++)s=slots[i],results.push(new BBModel.TimeSlot(s));return results}(),defer.resolve(slots)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){angular.module("BB.Services").factory("BB.Service.address",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Address(resource)}}}),angular.module("BB.Services").factory("BB.Service.person",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Person(resource)}}}),angular.module("BB.Services").factory("BB.Service.people",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("people").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Person(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.resource",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Resource(resource)}}}),angular.module("BB.Services").factory("BB.Service.resources",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("resources").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Resource(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.service",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Service(resource)}}}),angular.module("BB.Services").factory("BB.Service.services",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("services").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Service(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.event_group",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventGroup(resource)}}}),angular.module("BB.Services").factory("BB.Service.event_groups",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("event_groups").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.EventGroup(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.event_chain",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventChain(resource)}}}),angular.module("BB.Services").factory("BB.Service.category",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Category(resource)}}}),angular.module("BB.Services").factory("BB.Service.categories",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("categories").then(function(_this){return function(items){var cat,i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],cat=new BBModel.Category(i),cat.order||(cat.order=_i),models.push(cat);return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.client",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Client(resource)}}}),angular.module("BB.Services").factory("BB.Service.child_clients",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("clients").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Client(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.clients",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("clients").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Client(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.questions",function($q,BBModel){return{unwrap:function(resource){var defer,i,j,k,len,len1,ref,results,results1;if(resource.questions){for(ref=resource.questions,results=[],j=0,len=ref.length;len>j;j++)i=ref[j],results.push(new BBModel.Question(i));return results}if(resource.$has("questions"))return defer=$q.defer(),resource.$get("questions").then(function(items){return defer.resolve(function(){var k,len1,results1;for(results1=[],k=0,len1=items.length;len1>k;k++)i=items[k],results1.push(new BBModel.Question(i));return results1}())},function(err){return defer.reject(err)}),defer.promise;for(results1=[],k=0,len1=resource.length;len1>k;k++)i=resource[k],results1.push(new BBModel.Question(i));return results1}}}),angular.module("BB.Services").factory("BB.Service.question",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Question(resource)}}}),angular.module("BB.Services").factory("BB.Service.answers",function($q,BBModel){
return{promise:!1,unwrap:function(items){var answers,i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Answer(i));return answers={answers:models,getAnswer:function(question){var a,k,len1,ref;for(ref=this.answers,k=0,len1=ref.length;len1>k;k++)if(a=ref[k],a.question_text===question||a.question_id===question)return a.value}}}}}),angular.module("BB.Services").factory("BB.Service.administrators",function($q,BBModel){return{unwrap:function(items){var i,j,len,results;for(results=[],j=0,len=items.length;len>j;j++)i=items[j],results.push(new BBModel.Admin.User(i));return results}}}),angular.module("BB.Services").factory("BB.Service.company",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Company(resource)}}}),angular.module("BB.Services").factory("BB.Service.event_chains",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventChain(resource)}}}),angular.module("BB.Services").factory("BB.Service.parent",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Company(resource)}}}),angular.module("BB.Services").factory("BB.Service.company_questions",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("company_questions").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.BusinessQuestion(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.company_question",function($q,BBModel){return{unwrap:function(resource){return new BBModel.BusinessQuestion(resource)}}}),angular.module("BB.Services").factory("BB.Service.images",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("images").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Image(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.bookings",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("bookings").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.Member.Booking(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.wallet",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Member.Wallet(resource)}}}),angular.module("BB.Services").factory("BB.Service.product",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Product(resource)}}}),angular.module("BB.Services").factory("BB.Service.products",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("products").then(function(_this){return function(items){var cat,i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],cat=new BBModel.Product(i),cat.order||(cat.order=_i),models.push(cat);return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.pre_paid_booking",function($q,BBModel){return{unwrap:function(resource){return new BBModel.PrePaidBooking(resource)}}}),angular.module("BB.Services").factory("BB.Service.pre_paid_bookings",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("pre_paid_bookings").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;len>j;j++)i=items[j],models.push(new BBModel.PrePaidBooking(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ValidatorService",function($rootScope,AlertService,ErrorService,BBModel,$q,$bbug){var alphanumeric,email_regex,geocode_result,international_number,mobile_regex_lenient,number_only_regex,uk_landline_regex_lenient,uk_landline_regex_strict,uk_mobile_regex_strict,uk_postcode_regex,uk_postcode_regex_lenient;return uk_postcode_regex=/^(((([A-PR-UWYZ][0-9][0-9A-HJKS-UW]?)|([A-PR-UWYZ][A-HK-Y][0-9][0-9ABEHMNPRV-Y]?))\s{0,1}[0-9]([ABD-HJLNP-UW-Z]{2}))|(GIR\s{0,2}0AA))$/i,uk_postcode_regex_lenient=/^[A-Z]{1,2}[0-9][0-9A-Z]?\s*[0-9][A-Z]{2}$/i,number_only_regex=/^\d+$/,uk_mobile_regex_strict=/^((\+44\s?|0)7([45789]\d{2}|624)\s?\d{3}\s?\d{3})$/,mobile_regex_lenient=/^(0|\+)([\d \(\)]{9,19})$/,uk_landline_regex_strict=/^(\(?(0|\+44)[1-9]{1}\d{1,4}?\)?\s?\d{3,4}\s?\d{3,4})$/,uk_landline_regex_lenient=/^(0|\+)([\d \(\)]{9,19})$/,international_number=/^(\+)([\d \(\)]{9,19})$/,email_regex=/^$|^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i,alphanumeric=/^[a-zA-Z0-9]*$/,geocode_result=null,{alpha:/^[a-zA-Z\s]*$/,us_phone_number:/(^[\d \(\)-]{9,16})$/,getEmailPattern:function(){return email_regex},getUKPostcodePattern:function(){return uk_postcode_regex_lenient},getNumberOnlyPattern:function(){return number_only_regex},getAlphaNumbericPattern:function(){return alphanumeric},getUKMobilePattern:function(strict){return null==strict&&(strict=!1),strict?uk_mobile_regex_strict:mobile_regex_lenient},getMobilePattern:function(){return mobile_regex_lenient},getUKLandlinePattern:function(strict){return null==strict&&(strict=!1),strict?uk_landline_regex_strict:uk_landline_regex_lenient},getIntPhonePattern:function(){return international_number},getGeocodeResult:function(){return geocode_result?geocode_result:void 0},validatePostcode:function(form,prms){var deferred,geocoder,ne,postcode,req,sw;return AlertService.clear(),form&&form.postcode?form.$error.required?(AlertService.danger(ErrorService.getError("MISSING_POSTCODE")),!1):form.$error.pattern?(AlertService.danger(ErrorService.getError("INVALID_POSTCODE")),!1):(deferred=$q.defer(),postcode=form.postcode.$viewValue,req={address:postcode},prms.region&&(req.region=prms.region),req.componentRestrictions={postalCode:req.address},prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),req.bounds=new google.maps.LatLngBounds(sw,ne)),geocoder=new google.maps.Geocoder,geocoder.geocode(req,function(results,status){return 1===results.length&&"OK"===status?(geocode_result=results[0],deferred.resolve(!0)):(AlertService.danger(ErrorService.getError("INVALID_POSTCODE")),$rootScope.$apply(),deferred.reject(!1))}),deferred.promise):!1},validateForm:function(form){return form?(form.submitted=!0,form.$invalid&&form.raise_alerts&&form.alert?(AlertService.danger(form.alert),!1):form.$invalid&&form.raise_alerts?(AlertService.danger(ErrorService.getError("FORM_INVALID")),!1):form.$invalid?!1:!0):!1},resetForm:function(form){return form?(form.submitted=!1,form.$setPristine()):void 0},resetForms:function(forms){var form,i,len,results1;if(forms&&$bbug.isArray(forms)){for(results1=[],i=0,len=forms.length;len>i;i++)form=forms[i],form.submitted=!1,results1.push(form.$setPristine());return results1}}}})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("BB.Models").factory("BBWidget",function($q,BBModel,BasketService,$urlMatcherFactory,$location,BreadcrumbService,$window,$rootScope){var Widget;return Widget=function(){function Widget(){this.clearAddress=bind(this.clearAddress,this),this.emptyStackedItems=bind(this.emptyStackedItems,this),this.deleteStackedItemByService=bind(this.deleteStackedItemByService,this),this.removeItemFromStack=bind(this.removeItemFromStack,this),this.deleteStackedItem=bind(this.deleteStackedItem,this),this.sortStackedItems=bind(this.sortStackedItems,this),this.setStackedItems=bind(this.setStackedItems,this),this.stackItem=bind(this.stackItem,this),this.waitForRoutes=bind(this.waitForRoutes,this),this.setBasicRoute=bind(this.setBasicRoute,this),this.setRoute=bind(this.setRoute,this),this.calculatePercentageComplete=bind(this.calculatePercentageComplete,this),this.recordStep=bind(this.recordStep,this),this.recordCurrentPage=bind(this.recordCurrentPage,this),this.uid=_.uniqueId("bbwidget_"),this.page_suffix="",this.steps=[],this.allSteps=[],this.item_defaults={},this.usingBasket=!1,this.confirmCheckout=!1,this.isAdmin=!1,this.payment_status=null}return Widget.prototype.pageURL=function(route){return route+".html"},Widget.prototype.updateRoute=function(page){var company,date,event_group,pattern,prms,service_name,time,url;if(this.routeFormat)return page||(page=this.current_page),pattern=$urlMatcherFactory.compile(this.routeFormat),service_name="-",event_group="-",this.current_item&&(this.current_item.service&&(service_name=this.convertToDashSnakeCase(this.current_item.service.name)),this.current_item.event_group&&(event_group=this.convertToDashSnakeCase(this.current_item.event_group.name)),this.current_item.date&&(date=this.current_item.date.date.toISODate()),this.current_item.time&&(time=this.current_item.time.time),this.current_item.company&&(company=this.convertToDashSnakeCase(this.current_item.company.name))),this.route_values&&(prms=angular.copy(this.route_values)),prms||(prms={}),angular.extend(prms,{page:page,company:company,service:service_name,event_group:event_group,date:date,time:time}),url=pattern.format(prms),url=url.replace(/\/+$/,""),$location.path(url),this.routing=!0,url},Widget.prototype.setRouteFormat=function(route){var match,match_test,parts,path,pattern;if(this.routeFormat=route,this.routeFormat&&(this.routing=!0,path=$location.path())){for(parts=this.routeFormat.split("/");parts.length>0&&!match;)match_test=parts.join("/"),pattern=$urlMatcherFactory.compile(match_test),match=pattern.exec(path),parts.pop();if(match)return match.company&&(this.item_defaults.company=decodeURIComponent(match.company)),match.service&&"-"!==match.service&&(this.item_defaults.service=decodeURIComponent(match.service)),match.event_group&&"-"!==match.event_group&&(this.item_defaults.event_group=match.event_group),match.person&&(this.item_defaults.person=decodeURIComponent(match.person)),match.resource&&(this.item_defaults.resource=decodeURIComponent(match.resource)),match.resources&&(this.item_defaults.resources=decodeURIComponent(match.resoures)),match.date&&(this.item_defaults.date=match.date),match.time&&(this.item_defaults.time=match.time),this.route_matches=match}},Widget.prototype.matchURLToStep=function(){var _i,j,len,path,ref,step;if(!this.routeFormat)return null;for(path=$location.path(),ref=this.steps,_i=j=0,len=ref.length;len>j;_i=++j)if(step=ref[_i],step.url&&step.url===path)return step.number;return null},Widget.prototype.convertToDashSnakeCase=function(str){return str=str.toLowerCase(),str=$.trim(str),str=str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,""),str=str.replace(/\s{2,}/g," "),str=str.replace(/\s/g,"-")},Widget.prototype.recordCurrentPage=function(){var j,k,l,len,len1,len2,match,ref,ref1,ref2,step,title;if(this.current_step||(this.current_step=0),match=!1,this.allSteps)for(ref=this.allSteps,j=0,len=ref.length;len>j;j++)step=ref[j],step.page===this.current_page&&(this.current_step=step.number,match=!0);if(!match)for(ref1=this.steps,k=0,len1=ref1.length;len1>k;k++)step=ref1[k],step&&step.page===this.current_page&&(this.current_step=step.number,match=!0);if(match||(this.current_step+=1),title="",this.allSteps){for(ref2=this.allSteps,l=0,len2=ref2.length;len2>l;l++)step=ref2[l],step.active=!1,step.passed=step.number<this.current_step;this.allSteps[this.current_step-1]&&(this.allSteps[this.current_step-1].active=!0,title=this.allSteps[this.current_step-1].title)}return this.recordStep(this.current_step,title)},Widget.prototype.recordStep=function(step,title){var j,len,ref;for(this.steps[step-1]={url:this.updateRoute(this.current_page),current_item:this.current_item.getStep(),page:this.current_page,number:step,title:title,stacked_length:this.stacked_items.length},BreadcrumbService.setCurrentStep(step),ref=this.steps,j=0,len=ref.length;len>j;j++)step=ref[j],step&&(step.passed=step.number<this.current_step,step.active=step.number===this.current_step);return this.calculatePercentageComplete(step.number),this.allSteps&&this.allSteps.length===step||"checkout"===this.current_page?this.last_step_reached=!0:this.last_step_reached=!1},Widget.prototype.calculatePercentageComplete=function(step_number){return this.percentage_complete=step_number&&this.allSteps?step_number/this.allSteps.length*100:0},Widget.prototype.setRoute=function(rdata){var i,j,k,len,len1,ref,route,step;for(this.allSteps.length=0,this.nextSteps={},void 0!==rdata&&null!==rdata&&void 0!==rdata[0]&&(this.firstStep=rdata[0].page),i=j=0,len=rdata.length;len>j;i=++j)if(step=rdata[i],step.disable_breadcrumbs&&(this.disableGoingBackAtStep=i+1),rdata[i+1]&&(this.nextSteps[step.page]=rdata[i+1].page),this.allSteps.push({number:i+1,title:step.title,page:step.page}),step.when)for(this.routeSteps||(this.routeSteps={}),ref=step.when,k=0,len1=ref.length;len1>k;k++)route=ref[k],this.routeSteps[route]=step.page;return this.$wait_for_routing?this.$wait_for_routing.resolve():void 0},Widget.prototype.setBasicRoute=function(routes){var i,j,len,step;for(this.nextSteps={},this.firstStep=routes[0],i=j=0,len=routes.length;len>j;i=++j)step=routes[i],this.nextSteps[step]=routes[i+1];return this.$wait_for_routing?this.$wait_for_routing.resolve():void 0},Widget.prototype.waitForRoutes=function(){return this.$wait_for_routing?void 0:this.$wait_for_routing=$q.defer()},Widget.prototype.stackItem=function(item){return this.stacked_items.push(item),this.sortStackedItems()},Widget.prototype.setStackedItems=function(items){return this.stacked_items=items,this.sortStackedItems()},Widget.prototype.sortStackedItems=function(){var arr,item,j,len,ref;for(arr=[],ref=this.stacked_items,j=0,len=ref.length;len>j;j++)item=ref[j],arr=arr.concat(item.promises);return $q.all(arr)["finally"](function(_this){return function(){return _this.stacked_items=_this.stacked_items.sort(function(a,b){var ref1,ref2;return a.time&&b.time?null!=(ref1=a.time.time>b.time.time)?ref1:{1:-1}:a.service.category&&!b.service.category?1:b.service.category&&!a.service.category?-1:b.service.category||a.service.category?null!=(ref2=a.service.category.order>b.service.category.order)?ref2:{1:-1}:1})}}(this))},Widget.prototype.deleteStackedItem=function(item){return item&&item.id&&BasketService.deleteItem(item,this.company,{bb:this}),this.stacked_items=this.stacked_items.filter(function(i){return i!==item})},Widget.prototype.removeItemFromStack=function(item){return this.stacked_items=this.stacked_items.filter(function(i){return i!==item})},Widget.prototype.deleteStackedItemByService=function(item){var i,j,len,ref;for(ref=this.stacked_items,j=0,len=ref.length;len>j;j++)i=ref[j],i&&i.service&&i.service.self===item.self&&i.id&&BasketService.deleteItem(i,this.company,{bb:this});return this.stacked_items=this.stacked_items.filter(function(i){return i&&i.service&&i.service.self!==item.self})},Widget.prototype.emptyStackedItems=function(){return this.stacked_items=[]},Widget.prototype.pushStackToBasket=function(){var i,j,len,ref;for(this.basket||(this.basket=new new BBModel.Basket(null,this)),ref=this.stacked_items,j=0,len=ref.length;len>j;j++)i=ref[j],this.basket.addItem(i);return this.emptyStackedItems()},Widget.prototype.totalStackedItemsDuration=function(){var duration,item,j,len,ref;for(duration=0,ref=this.stacked_items,j=0,len=ref.length;len>j;j++)item=ref[j],item.service&&item.service.listed_duration&&(duration+=item.service.listed_duration);return duration},Widget.prototype.clearStackedItemsDateTime=function(){var item,j,len,ref,results;for(ref=this.stacked_items,results=[],j=0,len=ref.length;len>j;j++)item=ref[j],results.push(item.clearDateTime());return results},Widget.prototype.clearAddress=function(){return delete this.address1,delete this.address2,delete this.address3,delete this.address4,delete this.address5},Widget}()})}.call(this),function(){var ModalDelete,ModalDeleteAll;angular.module("BB.Directives").directive("bbPurchase",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Purchase",link:function(scope,element,attrs){scope.init(scope.$eval(attrs.bbPurchase))}}}),angular.module("BB.Controllers").controller("Purchase",function($scope,$rootScope,CompanyService,PurchaseService,ClientService,$modal,$location,$timeout,BBWidget,BBModel,$q,QueryStringService,SSOService,AlertService,LoginService,$window,$upload,ServiceService,$sessionStorage){var checkIfMoveBooking,checkIfWaitlistBookings,failMsg,getCompanyID,getPurchaseID,loginRequired,setPurchaseCompany;return $scope.controller="Purchase",$scope.is_waitlist=!1,$scope.make_payment=!1,setPurchaseCompany=function(company){return $scope.bb.company_id=company.id,$scope.bb.company=new BBModel.Company(company),$scope.company=$scope.bb.company,$scope.bb.item_defaults.company=$scope.bb.company,company.settings&&(company.settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),company.settings.merge_people)?$scope.bb.item_defaults.merge_people=!0:void 0},failMsg=function(){return $scope.fail_msg?AlertService.danger({msg:$scope.fail_msg}):AlertService.danger({msg:"Sorry, something went wrong"})},$scope.init=function(options){return options||(options={}),$scope.notLoaded($scope),options.move_route&&($scope.move_route=options.move_route),options.move_all&&($scope.move_all=options.move_all),options.login_redirect&&$scope.requireLogin({redirect:options.login_redirect}),options.fail_msg&&($scope.fail_msg=options.fail_msg),$scope.bb.total?$scope.load($scope.bb.total.long_id):$scope.bb.purchase?($scope.purchase=$scope.bb.purchase,$scope.bookings=$scope.bb.purchase.bookings,$scope.purchase.confirm_messages&&($scope.messages=$scope.purchase.confirm_messages),$scope.setLoaded($scope)):options.member_sso?SSOService.memberLogin(options).then(function(login){return $scope.load()},function(err){return $scope.setLoaded($scope),failMsg()}):$scope.load()},$scope.load=function(id){return $scope.notLoaded($scope),id=getPurchaseID(),!$scope.loaded&&id&&$rootScope.widget_started.then(function(_this){return function(){return $scope.waiting_for_conn_started.then(function(){var auth_token,company_id,params;return company_id=getCompanyID(),company_id&&CompanyService.query(company_id,{}).then(function(company){return setPurchaseCompany(company)}),params={purchase_id:id,url_root:$scope.bb.api_url},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.query(params).then(function(purchase){return null==$scope.bb.company&&purchase.$get("company").then(function(_this){return function(company){return setPurchaseCompany(company)}}(this)),$scope.purchase=purchase,$scope.bb.purchase=purchase,$scope.price=!(0===$scope.purchase.price),$scope.purchase.getBookingsPromise().then(function(bookings){var booking,i,len,ref,results;for($scope.bookings=bookings,$scope.setLoaded($scope),checkIfMoveBooking(bookings),checkIfWaitlistBookings(bookings),ref=$scope.bookings,results=[],i=0,len=ref.length;len>i;i++)booking=ref[i],results.push(booking.getAnswersPromise().then(function(answers){return booking.answers=answers}));return results},function(err){return $scope.setLoaded($scope),failMsg()}),purchase.$has("client")&&purchase.$get("client").then(function(_this){return function(client){return $scope.setClient(new BBModel.Client(client))}}(this)),$scope.purchase.getConfirmMessages().then(function(messages){return $scope.purchase.confirm_messages=messages,$scope.messages=messages})},function(err){return $scope.setLoaded($scope),err&&401===err.status&&$scope.login_action?LoginService.isLoggedIn()?failMsg():loginRequired():failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loaded=!0},checkIfMoveBooking=function(bookings){var b,id,matches,move_booking;return matches=/^.*(?:\?|&)move_booking=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(id=parseInt(matches[1])),id&&(move_booking=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)b=bookings[i],b.id===id&&results.push(b);return results}(),move_booking.length>0&&$scope.isMovable(bookings[0]))?$scope.move(move_booking[0]):void 0},checkIfWaitlistBookings=function(bookings){var booking;return $scope.waitlist_bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)booking=bookings[i],booking.on_waitlist&&1===booking.settings.sent_waitlist&&results.push(booking);return results}()},$scope.requireLogin=function(_this){return function(action){var div;return _.isString(action.redirect)&&(div=-1===action.redirect.indexOf("?")?"?":"&",action.redirect+=div+"ref="+encodeURIComponent(QueryStringService("ref"))),$scope.login_action=action}}(this),loginRequired=function(_this){return function(){return $scope.login_action.redirect?window.location=$scope.login_action.redirect:void 0}}(this),getCompanyID=function(){var company_id,matches;return matches=/^.*(?:\?|&)company_id=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(company_id=matches[1]),company_id},getPurchaseID=function(){var id,matches;return matches=/^.*(?:\?|&)id=(.*?)(?:&|$)/.exec($location.absUrl()),matches||(matches=/^.*print_purchase\/(.*?)(?:\?|$)/.exec($location.absUrl())),matches||(matches=/^.*print_purchase_jl\/(.*?)(?:\?|$)/.exec($location.absUrl())),matches?id=matches[1]:QueryStringService("ref")&&(id=QueryStringService("ref")),QueryStringService("booking_id")&&(id=QueryStringService("booking_id")),id},$scope.move=function(booking,route,options){return null==options&&(options={}),route||(route=$scope.move_route),$scope.move_all?$scope.moveAll(route,options):($scope.notLoaded($scope),$scope.initWidget({company_id:booking.company_id,no_route:!0}),$timeout(function(_this){return function(){return $rootScope.connection_started.then(function(){var new_item,proms;return proms=[],$scope.bb.moving_booking=booking,$scope.quickEmptybasket(),new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking,$scope.bb),new_item.ready=!1,Array.prototype.push.apply(proms,new_item.promises),$scope.bb.basket.addItem(new_item),$scope.setBasketItem(new_item),$q.all(proms).then(function(){return $scope.setLoaded($scope),$rootScope.$broadcast("booking:move"),$scope.decideNextPage(route)},function(err){return $scope.setLoaded($scope),failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this)))},$scope.moveAll=function(route,options){return null==options&&(options={}),route||(route=$scope.move_route),$scope.notLoaded($scope),$scope.initWidget({company_id:$scope.bookings[0].company_id,no_route:!0}),$timeout(function(_this){return function(){return $rootScope.connection_started.then(function(){var booking,i,len,new_item,proms,ref;for(proms=[],1===$scope.bookings.length?$scope.bb.moving_booking=$scope.bookings[0]:$scope.bb.moving_booking=$scope.purchase,_.every(_.map($scope.bookings,function(b){return b.event_id}),function(event_id){return event_id===$scope.bookings[0].event_id})&&($scope.bb.moving_purchase=$scope.purchase),$scope.quickEmptybasket(),ref=$scope.bookings,i=0,len=ref.length;len>i;i++)booking=ref[i],new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking),new_item.ready=!1,new_item.move_done=!1,Array.prototype.push.apply(proms,new_item.promises),$scope.bb.basket.addItem(new_item);return $scope.bb.sortStackedItems(),$scope.setBasketItem($scope.bb.basket.items[0]),$q.all(proms).then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoaded($scope),failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this))},$scope.bookWaitlistItem=function(booking){var params;return $scope.notLoaded($scope),params={purchase:$scope.purchase,booking:booking},PurchaseService.bookWaitlistItem(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.bb.purchase=purchase,$scope.purchase.getBookingsPromise().then(function(bookings){return $scope.bookings=bookings,$scope.waitlist_bookings=function(){var i,len,ref,results;for(ref=$scope.bookings,results=[],i=0,len=ref.length;len>i;i++)booking=ref[i],booking.on_waitlist&&1===booking.settings.sent_waitlist&&results.push(booking);return results}(),$scope.purchase.$has("new_payment")&&$scope.purchase.due_now>0&&($scope.make_payment=!0),$scope.setLoaded($scope)},function(err){return $scope.setLoaded($scope),failMsg()})},function(_this){return function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}}(this))},$scope["delete"]=function(booking){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("_cancel_modal"),controller:ModalDelete,resolve:{booking:function(){return booking}}}),modalInstance.result.then(function(booking){return booking.$del("self").then(function(_this){return function(service){return $scope.bookings=_.without($scope.bookings,booking),$rootScope.$broadcast("booking:cancelled")}}(this))})},$scope.delete_all=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("_cancel_modal"),controller:ModalDeleteAll,resolve:{purchase:function(){return $scope.purchase}}}),modalInstance.result.then(function(purchase){return PurchaseService.delete_all(purchase).then(function(purchase){return $scope.purchase=purchase,$scope.bookings=[],$rootScope.$broadcast("booking:cancelled")})})},$scope.isMovable=function(booking){return booking.min_cancellation_time?moment().isBefore(booking.min_cancellation_time):booking.datetime.isAfter(moment())},$scope.onFileSelect=function(booking,$file,existing){var att_id,file,method;return $scope.upload_progress=0,file=$file,att_id=null,existing&&(att_id=existing.id),method="POST",att_id&&(method="PUT"),$scope.upload=$upload.upload({url:booking.$href("attachments"),method:method,data:{att_id:att_id},file:file}).progress(function(evt){return $scope.upload_progress<100?$scope.upload_progress=parseInt(99*evt.loaded/evt.total):void 0}).success(function(data,status,headers,config){return $scope.upload_progress=100,data&&data.attachments&&booking?booking.attachments=data.attachments:void 0})},$scope.createBasketItem=function(booking){var item;return item=new BBModel.BasketItem(booking,$scope.bb),item.setSrcBooking(booking),item},$scope.checkAnswer=function(answer){return"boolean"==typeof answer.value||"string"==typeof answer.value||"number"==typeof answer.value}}),ModalDelete=function($scope,$rootScope,$modalInstance,booking){return $scope.controller="ModalDelete",$scope.booking=booking,$scope.confirm_delete=function(){return $modalInstance.close(booking)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},ModalDeleteAll=function($scope,$rootScope,$modalInstance,purchase){return $scope.controller="ModalDeleteAll",$scope.purchase=purchase,$scope.confirm_delete=function(){return $modalInstance.close(purchase)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}}}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Purchase.BookingModel",function($q,$window,BBModel,BaseModel,$bbug){var Purchase_Booking;return Purchase_Booking=function(superClass){function Purchase_Booking(data){this.getSurveyAnswersPromise=bind(this.getSurveyAnswersPromise,this),this.getAnswersPromise=bind(this.getAnswersPromise,this),Purchase_Booking.__super__.constructor.call(this,data),this.ready=!1,this.datetime=moment.parseZone(this.datetime),this.time_zone&&this.datetime.tz(this.time_zone),this.original_datetime=moment(this.datetime),this.end_datetime=moment.parseZone(this.end_datetime),this.time_zone&&this.end_datetime.tz(this.time_zone)}return extend(Purchase_Booking,superClass),Purchase_Booking.prototype.getGroup=function(){return this.group?this.group:this._data.$has("event_groups")?this._data.$get("event_groups").then(function(_this){return function(group){return _this.group=group,_this.group}}(this)):void 0},Purchase_Booking.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Purchase_Booking.prototype.getCompany=function(){return this.company?this.company:this.$has("company")?this._data.$get("company").then(function(_this){return function(company){return _this.company=new BBModel.Company(company),_this.company}}(this)):void 0},Purchase_Booking.prototype.getAnswersPromise=function(){var defer;return defer=$q.defer(),this.answers&&defer.resolve(this.answers),this._data.$has("answers")?this._data.$get("answers").then(function(_this){return function(answers){var a;return _this.answers=function(){var i,len,results;for(results=[],i=0,len=answers.length;len>i;i++)a=answers[i],results.push(new BBModel.Answer(a));return results}(),defer.resolve(_this.answers)}}(this)):defer.resolve([]),defer.promise},Purchase_Booking.prototype.getSurveyAnswersPromise=function(){var defer;return defer=$q.defer(),this.survey_answers&&defer.resolve(this.survey_answers),this._data.$has("survey_answers")?this._data.$get("survey_answers").then(function(_this){return function(survey_answers){var a;return _this.survey_answers=function(){var i,len,results;for(results=[],i=0,len=survey_answers.length;len>i;i++)a=survey_answers[i],results.push(new BBModel.Answer(a));return results}(),defer.resolve(_this.survey_answers)}}(this)):defer.resolve([]),defer.promise},Purchase_Booking.prototype.answer=function(q){var a,i,len,ref;if(this.answers)for(ref=this.answers,i=0,len=ref.length;len>i;i++)if(a=ref[i],a.name===q)return a.answer;return null},Purchase_Booking.prototype.getPostData=function(){var data,formatted_survey_answers,i,len,q,ref;if(data={},data.attended=this.attended,data.client_id=this.client_id,data.company_id=this.company_id,data.time=60*this.datetime.hour()+this.datetime.minute(),data.date=this.datetime.toISODate(),data.deleted=this.deleted,data.describe=this.describe,data.duration=this.duration,data.end_datetime=this.end_datetime,this.event&&(data.event_id=this.event.id),this.time&&this.time.event_id&&(data.event_id=this.time.event_id),data.full_describe=this.full_describe,data.id=this.id,data.min_cancellation_time=this.min_cancellation_time,data.on_waitlist=this.on_waitlist,data.paid=this.paid,data.person_name=this.person_name,data.price=this.price,data.purchase_id=this.purchase_id,data.purchase_ref=this.purchase_ref,data.quantity=this.quantity,data.self=this.self,this.move_item_id&&(data.move_item_id=this.move_item_id),this.srcBooking&&(data.move_item_id=this.srcBooking.id),this.person&&(data.person_id=this.person.id),this.service&&(data.service_id=this.service.id),this.resource&&(data.resource_id=this.resource.id),this.item_details&&(data.questions=this.item_details.getPostData()),data.service_name=this.service_name,data.settings=this.settings,this.status&&(data.status=this.status),null!=this.email&&(data.email=this.email),null!=this.email_admin&&(data.email_admin=this.email_admin),formatted_survey_answers=[],this.survey_questions){for(data.survey_questions=this.survey_questions,
ref=this.survey_questions,i=0,len=ref.length;len>i;i++)q=ref[i],formatted_survey_answers.push({value:q.answer,outcome:q.outcome,detail_type_id:q.id,price:q.price});data.survey_answers=formatted_survey_answers}return data},Purchase_Booking.prototype.checkReady=function(){return this.datetime&&this.id&&this.purchase_ref?this.ready=!0:void 0},Purchase_Booking.prototype.printed_price=function(){return parseFloat(this.price)%1===0?""+parseInt(this.price):$window.sprintf("%.2f",parseFloat(this.price))},Purchase_Booking.prototype.getDateString=function(){return this.datetime.toISODate()},Purchase_Booking.prototype.getTimeInMins=function(){return 60*this.datetime.hour()+this.datetime.minute()},Purchase_Booking.prototype.getAttachments=function(){return this.attachments?this.attachments:this.$has("attachments")?this._data.$get("attachments").then(function(_this){return function(atts){return _this.attachments=atts.attachments,_this.attachments}}(this)):void 0},Purchase_Booking.prototype.canCancel=function(){return moment(this.min_cancellation_time).isAfter(moment())},Purchase_Booking.prototype.canMove=function(){return this.canCancel()},Purchase_Booking}(BaseModel)})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Purchase.CourseBookingModel",function($q,BBModel,BaseModel){var Purchase_Course_Booking;return Purchase_Course_Booking=function(superClass){function Purchase_Course_Booking(data){this.getBookings=bind(this.getBookings,this),Purchase_Course_Booking.__super__.constructor.call(this,data)}return extend(Purchase_Course_Booking,superClass),Purchase_Course_Booking.prototype.getBookings=function(){var defer;return defer=$q.defer(),this.bookings&&defer.resolve(this.bookings),this._data.$has("bookings")?this._data.$get("bookings").then(function(_this){return function(bookings){var b;return _this.bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)b=bookings[i],results.push(new BBModel.Purchase.Booking(b));return results}(),_this.bookings.sort(function(a,b){return a.datetime.unix()-b.datetime.unix()}),defer.resolve(_this.bookings)}}(this)):(this.bookings=[],defer.resolve(this.bookings)),defer.promise},Purchase_Course_Booking}(BaseModel)})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Purchase.TotalModel",function($q,$window,BBModel,BaseModel,$sce){var Purchase_Total;return Purchase_Total=function(superClass){function Purchase_Total(data){this.getConfirmMessages=bind(this.getConfirmMessages,this),this.getMember=bind(this.getMember,this),this.getClient=bind(this.getClient,this),this.getMessages=bind(this.getMessages,this),this.getDeals=bind(this.getDeals,this),this.getProducts=bind(this.getProducts,this),this.getPackages=bind(this.getPackages,this),this.getCourseBookingsPromise=bind(this.getCourseBookingsPromise,this),this.getBookingsPromise=bind(this.getBookingsPromise,this),this.getItems=bind(this.getItems,this),Purchase_Total.__super__.constructor.call(this,data),this.getItems().then(function(_this){return function(items){return _this.items=items}}(this)),this.getClient().then(function(_this){return function(client){return _this.client=client}}(this)),this.getMember().then(function(_this){return function(member){return _this.member=member}}(this))}return extend(Purchase_Total,superClass),Purchase_Total.prototype.id=function(){return this.get("id")},Purchase_Total.prototype.icalLink=function(){return this._data.$href("ical")},Purchase_Total.prototype.webcalLink=function(){return this._data.$href("ical")},Purchase_Total.prototype.gcalLink=function(){return this._data.$href("gcal")},Purchase_Total.prototype.getItems=function(){var defer;return defer=$q.defer(),this.items&&defer.resolve(this.items),$q.all([this.getBookingsPromise(),this.getCourseBookingsPromise(),this.getPackages(),this.getProducts(),this.getDeals()]).then(function(result){var items;return items=_.flatten(result),defer.resolve(items)}),defer.promise},Purchase_Total.prototype.getBookingsPromise=function(){var defer;return defer=$q.defer(),this.bookings&&defer.resolve(this.bookings),this._data.$has("bookings")?this._data.$get("bookings").then(function(_this){return function(bookings){var b;return _this.bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)b=bookings[i],results.push(new BBModel.Purchase.Booking(b));return results}(),_this.bookings.sort(function(a,b){return a.datetime.unix()-b.datetime.unix()}),defer.resolve(_this.bookings)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getCourseBookingsPromise=function(){var defer;return defer=$q.defer(),this.course_bookings&&defer.resolve(this.course_bookings),this._data.$has("course_bookings")?this._data.$get("course_bookings").then(function(_this){return function(bookings){var b;return _this.course_bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)b=bookings[i],results.push(new BBModel.Purchase.CourseBooking(b));return results}(),$q.all(_.map(_this.course_bookings,function(b){return b.getBookings()})).then(function(){return defer.resolve(_this.course_bookings)})}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getPackages=function(){var defer;return defer=$q.defer(),this.packages&&defer.resolve(this.packages),this._data.$has("packages")?this._data.$get("packages").then(function(_this){return function(packages){return _this.packages=packages,defer.resolve(_this.packages)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getProducts=function(){var defer;return defer=$q.defer(),this.products&&defer.resolve(this.products),this._data.$has("products")?this._data.$get("products").then(function(_this){return function(products){return _this.products=products,defer.resolve(_this.products)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getDeals=function(){var defer;return defer=$q.defer(),this.deals&&defer.resolve(this.deals),this._data.$has("deals")?this._data.$get("deals").then(function(_this){return function(deals){return _this.deals=deals,defer.resolve(_this.deals)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getMessages=function(booking_texts,msg_type){var bt,defer;return defer=$q.defer(),booking_texts=function(){var i,len,results;for(results=[],i=0,len=booking_texts.length;len>i;i++)bt=booking_texts[i],bt.message_type===msg_type&&results.push(bt);return results}(),0===booking_texts.length?defer.resolve([]):this.getItems().then(function(items){var booking_text,i,item,j,k,len,len1,len2,msgs,ref,type;for(msgs=[],i=0,len=booking_texts.length;len>i;i++)for(booking_text=booking_texts[i],j=0,len1=items.length;len1>j;j++)for(item=items[j],ref=["company","person","resource","service"],k=0,len2=ref.length;len2>k;k++)type=ref[k],item.$has(type)&&item.$href(type)===booking_text.$href("item")&&-1===msgs.indexOf(booking_text.message)&&msgs.push(booking_text.message);return defer.resolve(msgs)}),defer.promise},Purchase_Total.prototype.getClient=function(){var defer;return defer=$q.defer(),this._data.$has("client")?this._data.$get("client").then(function(_this){return function(client){return _this.client=new BBModel.Client(client),defer.resolve(_this.client)}}(this)):defer.reject("No client"),defer.promise},Purchase_Total.prototype.getMember=function(){var defer;return defer=$q.defer(),this._data.$has("member")?this._data.$get("member").then(function(_this){return function(member){return _this.member=new BBModel.Member.Member(member),defer.resolve(_this.member)}}(this)):defer.reject("No client"),defer.promise},Purchase_Total.prototype.getConfirmMessages=function(){var defer;return defer=$q.defer(),this._data.$has("confirm_messages")?this._data.$get("confirm_messages").then(function(_this){return function(msgs){return _this.getMessages(msgs,"Confirm").then(function(filtered_msgs){return defer.resolve(filtered_msgs)})}}(this)):defer.reject("no messages"),defer.promise},Purchase_Total.prototype.printed_total_price=function(){return parseFloat(this.total_price)%1===0?""+parseInt(this.total_price):$window.sprintf("%.2f",parseFloat(this.total_price))},Purchase_Total.prototype.newPaymentUrl=function(){return this._data.$has("new_payment")?$sce.trustAsResourceUrl(this._data.$href("new_payment")):void 0},Purchase_Total.prototype.totalDuration=function(){var duration,i,item,len,ref;for(duration=0,ref=this.items,i=0,len=ref.length;len>i;i++)item=ref[i],item.duration&&(duration+=item.duration);return duration},Purchase_Total.prototype.containsWaitlistItems=function(){var i,item,len,ref,waitlist;for(waitlist=[],ref=this.items,i=0,len=ref.length;len>i;i++)item=ref[i],item.on_waitlist===!0&&waitlist.push(item);return waitlist.length>0?!0:!1},Purchase_Total}(BaseModel)})}.call(this),function(){"use strict";angular.module("BB.Services").factory("PurchaseBookingService",function($q,halClient,BBModel){return{update:function(booking){var data,deferred;return deferred=$q.defer(),data=booking.getPostData(),booking.srcBooking.$put("self",{},data).then(function(_this){return function(booking){return deferred.resolve(new BBModel.Purchase.Booking(booking))}}(this),function(_this){return function(err){return deferred.reject(err,new BBModel.Purchase.Booking(booking))}}(this)),deferred.promise},addSurveyAnswersToBooking:function(booking){var data,deferred;return deferred=$q.defer(),data=booking.getPostData(),data.notify=!1,data.notify_admin=!1,booking.$put("self",{},data).then(function(_this){return function(booking){return deferred.resolve(new BBModel.Purchase.Booking(booking))}}(this),function(_this){return function(err){return deferred.reject(err,new BBModel.Purchase.Booking(booking))}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("PurchaseService",function($q,halClient,BBModel,$window,UriTemplate){return{query:function(params){var defer,uri;return defer=$q.defer(),uri=params.url_root+"/api/v1/purchases/"+params.purchase_id,halClient.$get(uri,params).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise},bookingRefQuery:function(params){var defer,uri;return defer=$q.defer(),uri=new UriTemplate(params.url_root+"/api/v1/purchases/booking_ref/{booking_ref}{?raw}").fillFromObject(params),halClient.$get(uri,params).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise},update:function(params){var bdata,booking,data,defer,i,len,ref;if(defer=$q.defer(),!params.purchase)return defer.reject("No purchase present"),defer.promise;if(data={},params.bookings){for(bdata=[],ref=params.bookings,i=0,len=ref.length;len>i;i++)booking=ref[i],bdata.push(booking.getPostData());data.bookings=bdata}return params.purchase.$put("self",{},data).then(function(_this){return function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)}}(this),function(_this){return function(err){return defer.reject(err)}}(this)),defer.promise},bookWaitlistItem:function(params){var data,defer;return defer=$q.defer(),params.purchase?(data={},params.booking&&(data.booking=params.booking.getPostData()),data.booking_id=data.booking.id,params.purchase.$put("book_waitlist_item",{},data).then(function(_this){return function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)}}(this),function(_this){return function(err){return defer.reject(err)}}(this)),defer.promise):(defer.reject("No purchase present"),defer.promise)},delete_all:function(purchase){var defer;return defer=$q.defer(),purchase?(purchase.$del("self").then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(_this){return function(err){return defer.reject(err)}}(this)),defer.promise):(defer.reject("No purchase present"),defer.promise)},delete_item:function(params){var defer,uri;return defer=$q.defer(),uri=params.api_url+"/api/v1/purchases/"+params.long_id+"/purchase_item/"+params.purchase_item_id,halClient.$del(uri,{}).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise}}})}.call(this);
angular.module("BB").run(["$templateCache",function($templateCache){$templateCache.put("bootstrap_ui_datetime_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\r\n\r\n  <div datetimepicker ng-model="$$value$$" schema-validate="form"></div>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n'),$templateCache.put("bootstrap_ui_time_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n\r\n  <div timepicker ng-model="$$value$$" show-meridian="false"></div>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n'),$templateCache.put("datetimepicker.html",'<label class="control-label">Date</label>\r\n<p class="input-group">\r\n  <input type="text" datepicker-popup="dd-MMMM-yyyy" ng-model="$$value$$"\r\n  class="form-control" is-open="opened"></input>\r\n  <span class="input-group-btn">\r\n    <button type="button" class="btn btn-default" ng-click="open($event)">\r\n      <i class="glyphicon glyphicon-calendar"></i>\r\n    </button>\r\n  </span>\r\n</p>\r\n<label class="control-label">Time</label>\r\n<div timepicker ng-model="$$value$$" show-meridian="false"></div>\r\n'),$templateCache.put("dialog.html",'<div class="modal-header">\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<div class="modal-body">{{body}}</div>\r\n<div class="modal-footer">\r\n  <button class="btn btn-primary" ng-click="ok()">Yes</button>\r\n  <button class="btn btn-default" ng-click="cancel()">No</button>\r\n</div>\r\n'),$templateCache.put("modal_form.html",'<div class="modal-header">\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<form name="modal_form" ng-submit="submit(modal_form)">\r\n  <div ng-show="loading" class="loader"></div>\r\n  <div class="modal-body" sf-schema="schema" sf-form="form"\r\n    sf-model="form_model" sf-options="{formDefaults: {feedback: false}}"\r\n    ng-hide="loading">\r\n  </div>\r\n  <div class="modal-footer">\r\n    <input type="submit" class="btn btn-primary" ng-disabled="loading" value="OK">\r\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\r\n  </div>\r\n</form>\r\n'),$templateCache.put("price_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n\r\n  <div pricepicker ng-model="$$value$$" currency="{{form.currency}}"></div>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n')}]);
(function(){"use strict";angular.module("BBMember",["BB","BBMember.Directives","BBMember.Services","BBMember.Filters","BBMember.Controllers","BBMember.Models","trNgGrid","pascalprecht.translate"]),angular.module("BBMember").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BBMember").run(function(){return TrNgGrid.defaultColumnOptions={enableFiltering:!1}}),angular.module("BBMember.Directives",[]),angular.module("BBMember.Filters",[]),angular.module("BBMember.Services",["ngResource","ngSanitize","ngLocalData"]),angular.module("BBMember.Controllers",["ngLocalData","ngSanitize"]),angular.module("BBMember.Models",[]),angular.module("BBMemberMockE2E",["BBMember","BBAdminMockE2E"])}).call(this),function(){angular.module("BBMember").controller("MemberBookings",function($scope,$modal,$log,MemberBookingService,$q,ModalForm,MemberPrePaidBookingService){var getBookings;return $scope.loading=!0,$scope.getUpcomingBookings=function(){var params;return params={start_date:moment().format("YYYY-MM-DD")},getBookings(params).then(function(bookings){return $scope.upcoming_bookings=bookings})},$scope.getPastBookings=function(num,type){var date,params;return date=num&&type?moment().subtract(num,type):moment().subtract(1,"year"),params={start_date:date.format("YYYY-MM-DD"),end_date:moment().format("YYYY-MM-DD")},getBookings(params).then(function(bookings){return $scope.past_bookings=_.chain(bookings).filter(function(b){return b.datetime.isBefore(moment())}).sortBy(function(b){return-b.datetime.unix()}).value()})},$scope.flushBookings=function(){var params;return params={start_date:moment().format("YYYY-MM-DD")},MemberBookingService.flush($scope.member,params)},$scope.edit=function(booking){return booking.getAnswersPromise().then(function(answers){var answer,i,len,ref;for(ref=answers.answers,i=0,len=ref.length;len>i;i++)answer=ref[i],booking["question"+answer.question_id]=answer.value;return ModalForm.edit({model:booking,title:"Booking Details",templateUrl:"edit_booking_modal_form.html",windowClass:"member_edit_booking_form"})})},$scope.cancel=function(booking){var modalInstance;return modalInstance=$modal.open({templateUrl:"member_booking_delete_modal.html",windowClass:"bbug",controller:function($scope,$rootScope,$modalInstance,booking){return $scope.controller="ModalDelete",$scope.booking=booking,$scope.confirm_delete=function(){return $modalInstance.close(booking)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},resolve:{booking:function(){return booking}}}),modalInstance.result.then(function(booking){return $scope.cancelBooking(booking)})},getBookings=function(params){var defer;return $scope.loading=!0,defer=$q.defer(),MemberBookingService.query($scope.member,params).then(function(bookings){return $scope.loading=!1,defer.resolve(bookings)},function(err){return $log.error(err.data),$scope.loading=!1}),defer.promise},$scope.cancelBooking=function(booking){return $scope.loading=!0,MemberBookingService.cancel($scope.member,booking).then(function(){var removeBooking;return $scope.$emit("cancel:success"),removeBooking=function(booking,bookings){return bookings.filter(function(b){return b.id!==booking.id})},$scope.past_bookings&&($scope.past_bookings=removeBooking(booking,$scope.past_bookings)),$scope.upcoming_bookings&&($scope.upcoming_bookings=removeBooking(booking,$scope.upcoming_bookings)),$scope.removeBooking&&$scope.removeBooking(booking),$scope.loading=!1})},$scope.getPrePaidBookings=function(params){var defer;return $scope.loading=!0,defer=$q.defer(),MemberPrePaidBookingService.query($scope.member,params).then(function(bookings){return $scope.loading=!1,$scope.pre_paid_bookings=bookings,defer.resolve(bookings)},function(err){return $log.error(err.data),$scope.loading=!1}),defer.promise}})}.call(this),function(){angular.module("BBMember").controller("Wallet",function($scope,$q,WalletService,$log,$modal,$rootScope,AlertService,ErrorService){return $scope.member&&($scope.company_id=$scope.member.company_id),$scope.show_wallet_logs=!1,$scope.notLoaded($scope),$scope.error_message=!1,$scope.payment_success=!1,$scope.toggleWalletPaymentLogs=function(){return $scope.show_wallet_logs?$scope.show_wallet_logs=!1:$scope.show_wallet_logs=!0},$scope.showTopUpBox=function(){return $scope.amount?!0:$scope.show_topup_box},$scope.getWalletForMember=function(member,params){return $scope.notLoaded($scope),WalletService.getWalletForMember(member,params).then(function(wallet){return $scope.setLoaded($scope),$scope.wallet=wallet,$scope.wallet},function(err){return $scope.setLoaded($scope),$log.error(err)})},$scope.getWalletLogs=function(wallet){return $scope.notLoaded($scope),WalletService.getWalletLogs($scope.wallet).then(function(logs){return $scope.setLoaded($scope),$scope.logs=logs},function(err){return $scope.setLoaded($scope),$log.error(err.data)})},$scope.createWalletForMember=function(member){return $scope.notLoaded($scope),WalletService.createWalletForMember(member).then(function(wallet){return $scope.setLoaded($scope),$scope.wallet=wallet},function(err){return $scope.setLoaded($scope),$log.error(err.data)})},$scope.updateWallet=function(member,amount){var params;return $scope.notLoaded($scope),$scope.payment_success=!1,$scope.error_message=!1,member&&amount?(params={amount:amount},$scope.wallet&&(params.wallet_id=$scope.wallet.id),$scope.total&&(params.total_id=$scope.total.id),$scope.deposit&&(param.deposit=$scope.deposit),$scope.basket&&(params.basket_total_price=$scope.basket.total_price),WalletService.updateWalletForMember(member,params).then(function(wallet){return $scope.setLoaded($scope),$scope.wallet=wallet},function(err){return $scope.setLoaded($scope),$log.error(err.data)})):void 0},$scope.activateWallet=function(member){var params;return $scope.notLoaded($scope),member?(params={status:1},$scope.wallet&&(params.wallet_id=$scope.wallet.id),WalletService.updateWalletForMember(member,params).then(function(wallet){return $scope.setLoaded($scope),$scope.wallet=wallet},function(err){return $scope.setLoaded($scope),$log.error(err.date)})):void 0},$scope.deactivateWallet=function(member){var params;return $scope.notLoaded($scope),member?(params={status:0},$scope.wallet&&(params.wallet_id=$scope.wallet.id),WalletService.updateWalletForMember(member,params).then(function(wallet){return $scope.setLoaded($scope),$scope.wallet=wallet},function(err){return $scope.setLoaded($scope),$log.error(err.date)})):void 0},$scope.callNotLoaded=function(_this){return function(){return $scope.notLoaded($scope),$scope.$emit("wallet_payment:loading")}}(this),$scope.callSetLoaded=function(_this){return function(){return $scope.setLoaded($scope),$scope.$emit("wallet_payment:finished_loading")}}(this),$scope.walletPaymentDone=function(){var params;return params={no_cache:!0},$scope.getWalletForMember($scope.member,params).then(function(wallet){return $scope.$emit("wallet_payment:success",wallet)})},$scope.basketWalletPaymentDone=function(){return $scope.decideNextPage("checkout")},$scope.error=function(message){return $scope.error_message="Payment Failure: "+message,$log.warn("Payment Failure: "+message),$scope.$emit("wallet_payment:error",$scope.error_message),AlertService.warning(ErrorService.getAlert("TOPUP_FAILED"))},$scope.add=function(value){return value=value||$scope.amount_increment,$scope.amount+=value},$scope.subtract=function(value){return value=value||$scope.amount_increment,$scope.add(-value)},$scope.isSubtractValid=function(value){var new_amount;return $scope.wallet?(value=value||$scope.amount_increment,new_amount=$scope.amount-value,new_amount>=$scope.wallet.min_amount):!1}})}.call(this),function(){angular.module("BBMember").directive("memberBookings",function($rootScope){var link;return link=function(scope,element,attrs){var base,base1;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com")},{link:link,templateUrl:"member_bookings_tabs.html",scope:{apiUrl:"@",member:"="}}})}.call(this),function(){angular.module("BBMember").directive("memberBookingsTable",function($modal,$log,$rootScope,MemberLoginService,MemberBookingService,$compile,$templateCache,ModalForm){var controller,link;return controller=function($scope,$modal){var getBookings;return $scope.loading=!0,$scope.fields||($scope.fields=["describe","full_describe"]),$scope.$watch("member",function(member){return null!=member?getBookings($scope,member):void 0}),$scope.edit=function(id){var booking;return booking=_.find($scope.booking_models,function(b){return b.id===id}),booking.getAnswersPromise().then(function(answers){var answer,i,len,ref;for(ref=answers.answers,i=0,len=ref.length;len>i;i++)answer=ref[i],booking["question"+answer.question_id]=answer.value;return ModalForm.edit({model:booking,title:"Booking Details",templateUrl:"edit_booking_modal_form.html"})})},getBookings=function($scope,member){var params;return params={start_date:moment().format("YYYY-MM-DD")},MemberBookingService.query(member,params).then(function(bookings){return $scope.booking_models=bookings,$scope.bookings=_.map(bookings,function(booking){return _.pick(booking,"id","full_describe","describe")}),$scope.loading=!1},function(err){return $log.error(err.data),$scope.loading=!1})}},link=function(scope,element,attrs){var base,base1;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com")},{link:link,controller:controller,templateUrl:"member_bookings_table.html",scope:{apiUrl:"@",fields:"=?",member:"="}}})}.call(this),function(){angular.module("BBMember").directive("memberForm",function($modal,$log,$rootScope,MemberLoginService,MemberBookingService,AlertService,ErrorService){return{template:'<form sf-schema="schema" sf-form="form" sf-model="member"\n  ng-submit="submit(member)" ng-hide="loading"></form>',scope:{apiUrl:"@",member:"="},link:function(scope,element,attrs){var base,base1;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=attrs.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com")},controller:function($scope){return $scope.loading=!0,$scope.$watch("member",function(member){return null!=member?member.$get("edit_member").then(function(member_schema){return $scope.form=member_schema.form,$scope.schema=member_schema.schema,$scope.loading=!1}):void 0}),$scope.submit=function(form){return $scope.loading=!0,$scope.member.$put("self",{},form).then(function(member){return $scope.loading=!1,AlertService.raise(ErrorService.getAlert("UPDATE_SUCCESS"))},function(err){return $scope.loading=!1,AlertService.raise(ErrorService.getAlert("UPDATE_FAILED"))})}}}})}.call(this),function(){angular.module("BBMember").directive("loginMember",function($modal,$log,$rootScope,MemberLoginService,$templateCache,$q,$sessionStorage,halClient){var link,loginMemberController,pickCompanyController;return loginMemberController=function($scope,$modalInstance,company_id){return $scope.title="Login",$scope.schema={type:"object",properties:{email:{type:"string",title:"Email"},password:{type:"string",title:"Password"}}},$scope.form=[{key:"email",type:"email",feedback:!1,autofocus:!0},{key:"password",type:"password",feedback:!1}],$scope.login_form={},$scope.submit=function(form){var options;return options={company_id:company_id},MemberLoginService.login(form,options).then(function(member){return member.email=form.email,member.password=form.password,$modalInstance.close(member)},function(err){return $modalInstance.dismiss(err)})},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},pickCompanyController=function($scope,$modalInstance,companies){var c;return $scope.title="Pick Company",$scope.schema={type:"object",properties:{company_id:{type:"integer",title:"Company"}}},$scope.schema.properties.company_id["enum"]=function(){var i,len,results;for(results=[],i=0,len=companies.length;len>i;i++)c=companies[i],results.push(c.id);return results}(),$scope.form=[{key:"company_id",type:"select",titleMap:function(){var i,len,results;for(results=[],i=0,len=companies.length;len>i;i++)c=companies[i],results.push({value:c.id,name:c.name});return results}(),autofocus:!0}],$scope.pick_company_form={},$scope.submit=function(form){return $modalInstance.close(form.company_id)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},link=function(scope,element,attrs){var base,base1,loginModal,pickCompanyModal,session_member,tryLogin;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),loginModal=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:"login_modal_form.html",controller:loginMemberController,resolve:{company_id:function(){return scope.companyId}}}),modalInstance.result.then(function(result){return scope.memberEmail=result.email,scope.memberPassword=result.password,result.$has("members")?result.$get("members").then(function(members){var m;return scope.members=members,$q.all(function(){var i,len,results;for(results=[],i=0,len=members.length;len>i;i++)m=members[i],results.push(m.$get("company"));return results}()).then(function(companies){return pickCompanyModal(companies)})}):scope.member=result},function(){return loginModal()})},pickCompanyModal=function(companies){var modalInstance;return modalInstance=$modal.open({templateUrl:"pick_company_modal_form.html",controller:pickCompanyController,resolve:{companies:function(){return companies}}}),modalInstance.result.then(function(company_id){return scope.companyId=company_id,tryLogin()},function(){return pickCompanyModal()})},tryLogin=function(){var login_form,options;return login_form={email:scope.memberEmail,password:scope.memberPassword},options={company_id:scope.companyId},MemberLoginService.login(login_form,options).then(function(result){return result.$has("members")?result.$get("members").then(function(members){var m;return scope.members=members,$q.all(function(){var i,len,results;for(results=[],i=0,len=members.length;len>i;i++)m=members[i],results.push(m.$get("company"));return results}()).then(function(companies){return pickCompanyModal(companies)})}):scope.member=result},function(err){return loginModal()})},scope.memberEmail&&scope.memberPassword?tryLogin():$sessionStorage.getItem("login")?(session_member=$sessionStorage.getItem("login"),session_member=halClient.createResource(session_member),scope.member=session_member):loginModal()},{link:link,scope:{memberEmail:"@",memberPassword:"@",companyId:"@",apiUrl:"@",member:"="},transclude:!0,template:"<div ng-show='member' ng-transclude></div>"}})}.call(this),function(){angular.module("BBMember").directive("bbMemberPastBookings",function($rootScope){return{templateUrl:"member_past_bookings.html",scope:{apiUrl:"@",member:"="},controller:"MemberBookings",link:function(scope,element,attrs){var base,base1,getBookings;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),getBookings=function(){return scope.getPastBookings()},scope.$watch("member",function(){return scope.past_bookings?void 0:getBookings()}),$rootScope.connection_started.then(function(){return getBookings})}}})}.call(this),function(){angular.module("BBMember").directive("bbMemberPrePaidBookings",function($rootScope){return{templateUrl:"member_pre_paid_bookings.html",scope:{apiUrl:"@",member:"="},controller:"MemberBookings",link:function(scope,element,attrs){var base,base1,getBookings;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),scope.loading=!0,getBookings=function(){return scope.getPrePaidBookings({})["finally"](function(){return scope.loading=!1})},scope.$watch("member",function(){return scope.pre_paid_bookings?void 0:getBookings()}),$rootScope.connection_started.then(function(){return getBookings()})}}})}.call(this),function(){angular.module("BBMember").directive("memberSsoLogin",function($rootScope,LoginService,$sniffer,$timeout){var link;return link=function(scope,element,attrs){var base,base1,data,options;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),scope.member=null,options={root:$rootScope.bb.api_url,company_id:scope.companyId},data={token:scope.token},$sniffer.msie&&$sniffer.msie<10&&$rootScope.iframe_proxy_ready===!1?$timeout(function(){return LoginService.ssoLogin(options,data).then(function(member){return scope.member=member})},2e3):LoginService.ssoLogin(options,data).then(function(member){return scope.member=member})},{link:link,scope:{token:"@memberSsoLogin",companyId:"@",apiUrl:"@",member:"="},transclude:!0,template:"<div ng-if='member' ng-transclude></div>"}})}.call(this),function(){angular.module("BBMember").directive("bbMemberUpcomingBookings",function($rootScope){return{templateUrl:"member_upcoming_bookings.html",scope:{apiUrl:"@",member:"="},controller:"MemberBookings",link:function(scope,element,attrs){var base,base1,getBookings;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),getBookings=function(){return scope.getUpcomingBookings()},scope.$on("updateBookings",function(){return scope.flushBookings(),getBookings()}),scope.$watch("member",function(){return scope.upcoming_bookings?void 0:getBookings()}),$rootScope.connection_started.then(function(){return getBookings})}}})}.call(this),function(){angular.module("BBMember").directive("bbWallet",function($rootScope){return{scope:{apiUrl:"@",member:"="},controller:"Wallet",templateUrl:"wallet.html",link:function(scope,element,attrs){var base,base1,getWalletForMember;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),$rootScope.member&&(scope.member||(scope.member=$rootScope.member)),getWalletForMember=function(){return scope.getWalletForMember(scope.member,{})},scope.$watch("member",function(member){return null!=member&&getWalletForMember(),scope.amount?getWalletForMember():void 0}),scope.$on("wallet_payment:success",function(event,wallet){return scope.wallet=wallet,scope.payment_success=!0,scope.error_message=!1,scope.show_topup_box=!1}),scope.$on("wallet_payment:error",function(event,error){return scope.error_message=error,scope.payment_success=!1}),scope.$on("wallet_payment:loading",function(event){return scope.loading=!0}),scope.$on("wallet_payment:finished_loading",function(event){return scope.loading=!1})}}})}.call(this),function(){angular.module("BBMember").directive("bbWalletLogs",function($rootScope){var link;return link=function(scope,element,attrs){var base,base1,getWalletForMember,getWalletLogsForWallet;return $rootScope.bb||($rootScope.bb={}),(base=$rootScope.bb).api_url||(base.api_url=scope.apiUrl),(base1=$rootScope.bb).api_url||(base1.api_url="http://www.bookingbug.com"),getWalletLogsForWallet=function(){return scope.getWalletLogs(scope.wallet)},getWalletForMember=function(){return scope.getWalletForMember(scope.member)},scope.$watch("member",function(member){return null!=member?getWalletForMember():void 0}),scope.$watch("wallet",function(wallet){return null!=wallet?getWalletLogsForWallet():void 0})},{link:link,controller:"Wallet",templateUrl:"wallet_logs.html",scope:{member:"=",wallet:"="}}})}.call(this),function(){angular.module("BB.Directives").directive("bbWalletPayment",function($sce,$rootScope,$window,$location,SettingsService,AlertService,ErrorService){return{restrict:"A",controller:"Wallet",scope:!0,replace:!0,link:function(scope,element,attrs){var getHost,getWalletForMember,sendLoadEvent;return scope.options=scope.$eval(attrs.bbWalletPayment)||{},$rootScope.member&&(scope.member||(scope.member=$rootScope.member)),scope.options.member&&(scope.member||(scope.member=scope.options.member)),scope.options.amount&&(scope.amount=scope.options.amount),scope.amount_increment=scope.options.amount_increment||0,getHost=function(url){var a;return a=document.createElement("a"),a.href=url,a.protocol+"//"+a.host},sendLoadEvent=function(element,origin,scope){var custom_partial_url,custom_stylesheet,payload,referrer;return referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),custom_stylesheet=scope.options.custom_stylesheet?scope.options.custom_stylesheet:null,custom_partial_url=scope.bb&&scope.bb.custom_partial_url?scope.bb.custom_partial_url:null,payload=JSON.stringify({type:"load",message:referrer,custom_partial_url:custom_partial_url,custom_stylesheet:custom_stylesheet,scroll_offset:SettingsService.getScrollOffset()}),element.find("iframe")[0].contentWindow.postMessage(payload,origin)},getWalletForMember=function(){return scope.getWalletForMember(scope.member,{})},scope.$watch("member",function(member){return null!=member&&getWalletForMember(),scope.amount?getWalletForMember():void 0}),scope.$watch("wallet",function(wallet){return wallet&&(wallet.min_amount&&(scope.amount=wallet.min_amount),wallet.$has("new_payment"))?(scope.callNotLoaded(),scope.wallet_payment_url=$sce.trustAsResourceUrl(scope.wallet.$href("new_payment")),scope.show_payment_iframe=!0,element.find("iframe").bind("load",function(_this){return function(event){var origin,url;return scope.wallet_payment_url&&(url=scope.wallet_payment_url),origin=getHost(url),sendLoadEvent(element,origin,scope),scope.$apply(function(){return scope.callSetLoaded()})}}(this))):void 0}),$window.addEventListener("message",function(_this){return function(event){var data;return angular.isObject(event.data)?data=event.data:event.data.match(/iFrameSizer/)||(data=JSON.parse(event.data)),scope.$apply(function(){if(data)switch(data.type){case"submitting":return scope.callNotLoaded();case"error":return scope.callSetLoaded(),scope.error(data.message),scope.show_payment_iframe=!1;case"wallet_payment_complete":return scope.walletPaymentDone();case"basket_wallet_payment_complete":return scope.callSetLoaded(),scope.basketWalletPaymentDone()}})}}(this),!1)}}})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Member.BookingModel",function($q,$window,BBModel,BaseModel,$bbug){var Member_Booking;return Member_Booking=function(superClass){function Member_Booking(data){this.getMemberPromise=bind(this.getMemberPromise,this),Member_Booking.__super__.constructor.call(this,data),this.datetime=moment.parseZone(this.datetime),this.time_zone&&this.datetime.tz(this.time_zone),this.end_datetime=moment.parseZone(this.end_datetime),this.time_zone&&this.end_datetime.tz(this.time_zone)}return extend(Member_Booking,superClass),Member_Booking.prototype.getGroup=function(){return this.group?this.group:this._data.$has("event_groups")?this._data.$get("event_groups").then(function(_this){return function(group){return _this.group=group,_this.group}}(this)):void 0},Member_Booking.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Member_Booking.prototype.getCompany=function(){return this.company?this.company:this.$has("company")?this._data.$get("company").then(function(_this){return function(company){return _this.company=new BBModel.Company(company),_this.company}}(this)):void 0},Member_Booking.prototype.getAnswers=function(){var defer;return defer=$q.defer(),this.answers&&defer.resolve(this.answers),this._data.$has("answers")?this._data.$get("answers").then(function(_this){return function(answers){var a;return _this.answers=function(){var i,len,results;for(results=[],i=0,len=answers.length;len>i;i++)a=answers[i],results.push(new BBModel.Answer(a));return results}(),defer.resolve(_this.answers)}}(this)):defer.resolve([]),defer.promise},Member_Booking.prototype.printed_price=function(){return parseFloat(this.price)%1===0?""+this.price:$window.sprintf("%.2f",parseFloat(this.price))},Member_Booking.prototype.getMemberPromise=function(){var defer;return defer=$q.defer(),this.member&&defer.resolve(this.member),this._data.$has("member")&&this._data.$get("member").then(function(_this){return function(member){return _this.member=new BBModel.Member.Member(member),defer.resolve(_this.member)}}(this)),defer.promise},Member_Booking.prototype.canCancel=function(){return moment(this.min_cancellation_time).isAfter(moment())},Member_Booking.prototype.canMove=function(){return this.canCancel()},Member_Booking}(BaseModel)})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Member.MemberModel",function($q,BBModel,BaseModel,ClientModel){var Member_Member;return Member_Member=function(superClass){function Member_Member(){return Member_Member.__super__.constructor.apply(this,arguments)}return extend(Member_Member,superClass),Member_Member}(ClientModel)})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Member.WalletModel",function(BBModel,BaseModel){var Member_Wallet;return Member_Wallet=function(superClass){function Member_Wallet(data){Member_Wallet.__super__.constructor.call(this,data)}return extend(Member_Wallet,superClass),Member_Wallet}(BaseModel)})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Member.WalletLogModel",function($q,BBModel,BaseModel){var Member_WalletLog;return Member_WalletLog=function(superClass){function Member_WalletLog(data){Member_WalletLog.__super__.constructor.call(this,data)}return extend(Member_WalletLog,superClass),Member_WalletLog}(BaseModel)})}.call(this),function(){angular.module("BB.Services").factory("MemberBookingService",function($q,SpaceCollections,$rootScope,MemberService,BBModel){return{query:function(member,params){var deferred;return deferred=$q.defer(),member.$has("bookings")?member.$get("bookings",params).then(function(_this){return function(bookings){var booking;return angular.isArray(bookings)?(bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)booking=bookings[i],results.push(new BBModel.Member.Booking(booking));return results}(),deferred.resolve(bookings)):bookings.$get("bookings",params).then(function(bookings){return bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)booking=bookings[i],results.push(new BBModel.Member.Booking(booking));return results}(),deferred.resolve(bookings)},function(err){return deferred.reject(err)})}}(this),function(err){return deferred.reject(err)}):deferred.reject("member does not have bookings"),deferred.promise},cancel:function(member,booking){var deferred;return deferred=$q.defer(),booking.$del("self").then(function(_this){return function(b){return booking.deleted=!0,b=new BBModel.Member.Booking(b),MemberService.refresh(member).then(function(member){return member=member},function(err){}),deferred.resolve(b)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},update:function(booking){var deferred;return deferred=$q.defer(),$rootScope.member.flushBookings(),booking.$put("self",{},booking).then(function(_this){return function(booking){var book;return book=new BBModel.Member.Booking(booking),SpaceCollections.checkItems(book),deferred.resolve(book)}}(this),function(_this){return function(err){return _.each(booking,function(value,key,booking){return"data"!==key&&"self"!==key?booking[key]=booking.data[key]:void 0}),deferred.reject(err,new BBModel.Member.Booking(booking))}}(this)),deferred.promise},flush:function(member,params){return member.$has("bookings")?member.$flush("bookings",params):void 0}}})}.call(this),function(){angular.module("BBMember.Services").factory("MemberLoginService",function($q,halClient,$rootScope,BBModel,$sessionStorage){return{login:function(form,options){var defer,url;return defer=$q.defer(),url=$rootScope.bb.api_url+"/api/v1/login",null!=options.company_id&&(url=url+"/member/"+options.company_id),halClient.$post(url,options,form).then(function(login){return login.$has("member")?login.$get("member").then(function(member){var auth_token;return member=new BBModel.Member.Member(member),auth_token=member.getOption("auth_token"),$sessionStorage.setItem("login",member.$toStore()),$sessionStorage.setItem("auth_token",auth_token),defer.resolve(member)}):login.$has("members")?defer.resolve(login):defer.reject("No member account for login")},function(_this){return function(err){var login;return 400===err.status?(login=halClient.$parse(err.data),login.$has("members")?defer.resolve(login):defer.reject(err)):defer.reject(err)}}(this)),defer.promise}}})}.call(this),function(){angular.module("BB.Services").factory("MemberService",function($q,halClient,$rootScope,BBModel){return{refresh:function(member){var deferred;return deferred=$q.defer(),member.$flush("self"),member.$get("self").then(function(_this){return function(member){return member=new BBModel.Member.Member(member),deferred.resolve(member)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},current:function(){var callback,deferred;return deferred=$q.defer(),callback=function(){return deferred.resolve($rootScope.member)},setTimeout(callback,200),deferred.promise},updateMember:function(member,params){var deferred;return deferred=$q.defer(),member.$put("self",{},params).then(function(_this){return function(member){return member=new BBModel.Member.Member(member),deferred.resolve(member)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},sendWelcomeEmail:function(member,params){var deferred;return deferred=$q.defer(),member.$post("send_welcome_email",params).then(function(_this){return function(member){return member=new BBModel.Member.Member(member),deferred.resolve(member)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("MemberPrePaidBookingService",function($q,BBModel){return{query:function(member,params){var deferred;return deferred=$q.defer(),member.$has("pre_paid_bookings")?member.$get("pre_paid_bookings",params).then(function(_this){return function(bookings){var booking;return angular.isArray(bookings)?(bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)booking=bookings[i],results.push(new BBModel.PrePaidBooking(booking));return results}(),deferred.resolve(bookings)):bookings.$get("pre_paid_bookings",params).then(function(bookings){return bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;len>i;i++)booking=bookings[i],
results.push(new BBModel.PrePaidBooking(booking));return results}(),deferred.resolve(bookings)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("member does not have pre paid bookings"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("WalletService",function($q,BBModel){return{getWalletForMember:function(member,params){var deferred;return params||(params={}),params.no_cache=!0,deferred=$q.defer(),member.$has("wallet")?member.$get("wallet",params).then(function(wallet){return wallet=new BBModel.Member.Wallet(wallet),deferred.resolve(wallet)},function(err){return deferred.reject(err)}):deferred.reject("Wallets are not turned on."),deferred.promise},getWalletLogs:function(wallet){var deferred;return deferred=$q.defer(),wallet.$has("logs")?wallet.$get("logs").then(function(resource){return resource.$get("logs").then(function(logs){var log;return logs=function(){var i,len,results;for(results=[],i=0,len=logs.length;len>i;i++)log=logs[i],results.push(new BBModel.Member.WalletLog(log));return results}(),deferred.resolve(logs)})},function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No Payments found"),deferred.promise},updateWalletForMember:function(member,params){var deferred;return deferred=$q.defer(),member.$has("wallet")?member.$put("wallet",{},params).then(function(wallet){return wallet=new BBModel.Member.Wallet(wallet),deferred.resolve(wallet)},function(err){return deferred.reject(err)}):deferred.reject("Wallets are not turned on."),deferred.promise},createWalletForMember:function(member){var deferred,params;return deferred=$q.defer(),params={},member.$has("wallet")?member.$post("wallet",{},params).then(function(wallet){return wallet=new BBModel.Member.Wallet(wallet),deferred.resolve(wallet)},function(err){return deferred.reject(err)}):deferred.reject("Wallets are not turned on."),deferred.promise}}})}.call(this);
angular.module("BB").run(["$templateCache",function($templateCache){$templateCache.put("edit_booking_modal_form.html",'<div class="modal-header">\r\n  <button type="button" class="close" ng-click="cancel($event)">&times;</button>\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<form name="booking_form" ng-submit="submit(modal_form)">\r\n  <div class="member_booking_form_content modal-body" bb-modal>\r\n    <p>{{form_model.full_describe}}</p>\r\n    <p>{{form_model.describe}}</p>\r\n    <div sf-schema="schema" sf-form="form" sf-model="form_model" sf-options="{formDefaults: {feedback: false}}">\r\n    </div>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <input type="submit" class="btn btn-primary" value="Save">\r\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\r\n  </div>\r\n</form>\r\n'),$templateCache.put("login.html",'<form name="login_form" ng-submit="submit()" class="form-horizontal"\r\n  role="form">\r\n  <div class="alert alert-danger" role="alert" ng-if="alert && alert.length > 0">{{alert}}</div>\r\n  <div ng-class="{\'form-group\': true, \'has-error\': emailIsInvalid()}">\r\n    <label for="email" class="col-sm-2 control-label">Email</label>\r\n    <div class="col-sm-10">\r\n      <input type="email" ng-model="email" name="email" class="form-control"\r\n        id="email" placeholder="Email" required autofocus>\r\n    </div>\r\n  </div>\r\n  <div ng-class="{\'form-group\': true, \'has-error\': passwordIsInvalid()}">\r\n    <label for="password" class="col-sm-2 control-label">Password</label>\r\n    <div class="col-sm-10">\r\n      <input type="password" ng-model="password" name="password"\r\n        class="form-control" id="password" placeholder="Password" required>\r\n    </div>\r\n  </div>\r\n  <div class="form-group">\r\n    <div class="col-sm-offset-2 col-sm-10">\r\n      <button type="submit" class="btn btn-primary">Log In</button>\r\n    </div>\r\n  </div>\r\n</form>\r\n'),$templateCache.put("login_modal_form.html",'<div class="modal-header">\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<form name="login_form" ng-submit="submit(login_form)">\r\n  <div class="modal-body" sf-schema="schema" sf-form="form"\r\n    sf-model="login_form">\r\n  </div>\r\n  <div class="modal-footer">\r\n    <input type="submit" class="btn btn-primary" value="OK">\r\n    <button class="btn btn-default" ng-click="cancel($event)">Dismiss</button>\r\n  </div>\r\n</form>\r\n'),$templateCache.put("member_bookings_table.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n<table tr-ng-grid="" items="bookings" enable-filtering="false"\r\n  ng-hide="loading" fields="fields">\r\n  <thead>\r\n    <tr>\r\n      <th field-name="describe" display-name="Date/Time"></th>\r\n      <th field-name="full_describe" display-name="Description"></th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td>\r\n        <button class="btn btn-default btn-sm"\r\n          ng-click="delete(gridItem.id)">\r\n            Cancel\r\n        </button>\r\n        <button class="btn btn-default btn-sm"\r\n          ng-click="edit(gridItem.id)">\r\n            Details\r\n        </button>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n'),$templateCache.put("member_bookings_tabs.html",'<div class="bb-member-bookings">\r\n   <div tabset class="bb-tabs">\r\n    <div tab>\r\n      <div tab-heading>\r\n        Upcoming Bookings\r\n      </div>\r\n      <div id="member">\r\n        <div bb-member-upcoming-bookings member="member"></div>\r\n      </div>\r\n    </div>\r\n    <div tab>\r\n      <div tab-heading>\r\n        Past bookings\r\n      </div>\r\n      <div id="member">\r\n        <div bb-member-past-bookings member="member"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("member_booking_delete_modal.html",'<div class="modal-header">\r\n  <h1 class="modal-title">Cancel Booking</h1>\r\n</div>\r\n\r\n<div class="modal-body">\r\n  \r\n  <ul class="confirmation-summary">\r\n    <li class="row confirmation-summary-item">\r\n      <div class="col-xs-3">Booking</div>\r\n      <div class="col-xs-9">{{booking.full_describe}}</div>\r\n    </li>\r\n    <li class="row confirmation-summary-item">\r\n      <div class="col-xs-3">When</div>\r\n      <div class="col-xs-9">{{booking.datetime | datetime: "h:mma dddd Do MMMM" : false}}</div>\r\n    </li>\r\n  </ul>\r\n\r\n</div>\r\n<div class="modal-footer">\r\n  <button class="btn btn-primary" ng-click="confirm_delete()"><span>Cancel Booking</span></button>\r\n  <button class="btn btn-link" ng-click="cancel()">Do not cancel</button>\r\n</div>\r\n'),$templateCache.put("member_past_bookings.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n<div ng-hide="loading" class="bb-past clearfix">\r\n  <div class="bb-head">\r\n    <span id="your_bookings">Your past appointments:</span>\r\n  </div>\r\n  <div id="bookings">\r\n    <div ng-if="past_bookings.length == 0">\r\n      <h3>You don\'t currently have any past appointments.</h3>\r\n    </div>\r\n    <div ng-repeat="booking in past_bookings | filter:{deleted: false} |\r\n      orderBy: \'datetime.unix()\' " class="booking-row">\r\n      <div class="type col-sm-1">\r\n        <div style="background-color:{{booking.getColour()}}"></div>\r\n      </div>\r\n      <div class="datetime col-sm-5">\r\n        <div>{{booking.datetime.format(\'Do MMM YYYY HH:mm\')}}</div>\r\n      </div>\r\n      <div class="describe col-sm-5">\r\n        <div class="detail">{{booking.full_describe}}</div>\r\n        <div class="resource">{{booking.resource}}</div>\r\n      </div>\r\n      <div class="bb-bookings-action col-sm-1">\r\n        <button ng-click="cancel(booking)" class="btn btn-danger bb-push">\r\n          Cancel\r\n        </button>\r\n      </div>\r\n      <pagination total-items="pagination.num_items"\r\n        ng-model="pagination.current_page" items-per-page="pagination.page_size"\r\n        max-size="pagination.max_size" boundary-links="true" rotate="false"\r\n        num-pages="pagination.num_pages" ng-show="past_bookings"></pagination>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("member_pre_paid_bookings.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n<div ng-hide="loading" class="bb-upcoming clearfix">\r\n  <div id="bookings">\r\n    <div ng-if="pre_paid_bookings.length == 0">\r\n      <h3>You don\'t currently have any pre-paid bookings.</h3>\r\n    </div>\r\n    <div ng-repeat="booking in pre_paid_bookings" class="booking-row">\r\n      <div class="describe">\r\n        <div class="detail">{{booking.service_name}}</div>\r\n        <div class="resource">{{booking.remaining}} of {{booking.num_bookings}} remaining</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("member_upcoming_bookings.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n<div ng-hide="loading" class="bb-upcoming clearfix">\r\n  <div class="bb-head">\r\n    <span id="your_bookings">Your future appointments:</span>\r\n  </div>\r\n  <div id="bookings">\r\n    <div ng-if="upcoming_bookings.length == 0">\r\n      <h3>You don\'t currently have any appointments.</h3>\r\n    </div>\r\n    <div ng-repeat="booking in upcoming_bookings | filter:{deleted: false} | orderBy: \'datetime.unix()\'" class="booking-row">\r\n      <div class="type">\r\n        <div style="background-color:{{booking.getColour()}}"></div>\r\n      </div>\r\n      <div class="datetime">\r\n        <div>{{booking.datetime.format(\'Do MMM YYYY HH:mm\')}}</div>\r\n      </div>\r\n      <div class="describe">\r\n        <div class="detail">{{booking.full_describe}}</div>\r\n        <div class="resource">{{booking.resource}}</div>\r\n      </div>\r\n      <div class="bb-bookings-action">\r\n        <button ng-click="cancel(booking)" class="btn btn-danger bb-push">Cancel</button>\r\n        <button ng-click="edit(booking)" class="btn bb-push">Details</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("pick_company.html",'<form name="pick_company_form" ng-submit="selectedCompany()" role="form">\r\n  <p>Pick Company</p>\r\n  <div ng-repeat="admin in administrators" class="radio">\r\n    <label>\r\n      <input id="company{{admin.company_id}}" type="radio"\r\n        ng-model="$parent.selected_admin" ng-value="admin" required\r\n        name="company">\r\n      {{admin.company_name}}\r\n    </label>\r\n  </div>\r\n  <input type="submit" class="btn btn-default">\r\n</form>\r\n'),$templateCache.put("pick_company_modal_form.html",'<div class="modal-header">\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<form name="pick_company_form" ng-submit="submit(pick_company_form)">\r\n  <div class="modal-body" sf-schema="schema" sf-form="form"\r\n    sf-model="pick_company_form">\r\n  </div>\r\n  <div class="modal-footer">\r\n    <input type="submit" class="btn btn-primary" value="OK">\r\n    <button class="btn btn-default" ng-click="cancel($event)">Dismiss</button>\r\n  </div>\r\n</form>\r\n'),$templateCache.put("wallet.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n<div ng-hide="loading">\r\n  <div ng-if="amount"class="bb-head">\r\n    <span id="wallet"> Your Wallet </span>\r\n  </div>\r\n  <div class="wallet-balance">\r\n    <div ng-if="wallet.amount == 0">\r\n      <span>Balance: </span><span> You dont have any credit in your wallet. </span>\r\n    </div>\r\n    <div ng-if="wallet.amount > 0">\r\n      <span>Balance: </span> <span id="balance"> {{wallet.amount | icurrency:wallet.wallet_currency }} </span>\r\n    </div>\r\n  </div>\r\n  </hr>\r\n  <div class="wallet-status">\r\n    <div ng-hide="wallet.active">\r\n      <span>Status:</span><span><b> Your wallet is not active.</b></span> <span><button ng-click="activateWallet(member)"> Activate </button></span>\r\n    </div>\r\n    <div ng-show="wallet.active">\r\n      <span>Status:</span><span id="status"><b> Active </b></span>\r\n    </div>\r\n  </div>\r\n  </br>\r\n\r\n  <div ng-if="error_message" class="alerts">\r\n    <p class="error_message" ng-bind-html="error_message"></p>\r\n  </div>\r\n\r\n  <div ng-if="payment_success" class="alerts">\r\n    <p class="success_message"> You have successfully topped up your wallet! Your new balance is {{wallet.amount | icurrency:wallet.wallet_currency}}</p>\r\n  </div>\r\n\r\n  <div>\r\n    <button type="button" class="bb-bookings-action" ng-click="(show_topup_box = true);(show_wallet_logs = false);(error_message = false)">Top Up</button>\r\n  </div>\r\n  <br>\r\n  <div ng-if="wallet.$has(\'logs\')">\r\n    <button ng-click="toggleWalletPaymentLogs();(show_topup_box = true)"> Wallet Payments </button>\r\n     <div ng-if="show_wallet_logs">\r\n      <div bb-wallet-logs wallet="wallet"></div>\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-if="!show_wallet_logs && !error_message" bb-wallet-payment>\r\n\r\n    <div class="bb-content">\r\n      <div ng-form class="form-inline">\r\n        <div ng-show="showTopUpBox()" class="form-group">\r\n          <label for="amount">Amount:</label>\r\n          <div class="input-group">\r\n            <input type="number" class="form-control input-sm" id="amount" name="amount" ng-model="amount" placeholder="Enter Top Up Amount" bb-currency-field>\r\n            <span class="input-group-btn">\r\n              <button type="submit" class="btn btn-primary btn-sm" ng-disabled="!amount || (amount < wallet.min_amount)" ng-click="updateWallet(member, amount)">Top Up Wallet</button>\r\n            </span>\r\n          </div>\r\n          <br>\r\n          <small> Minimum top up amount must be greater than {{wallet.min_amount | icurrency }} </small>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-if="wallet.$has(\'new_payment\')" class="bb-payment">\r\n        <div class="bb-head">\r\n          <h3> Make Payment </h3>\r\n        </div>\r\n        <div id="bb-payment">\r\n          <iframe id="bb-widget" ng-src="{{wallet_payment_url}}" width="100%"scrolling="no" frameborder="0"></iframe>\r\n        </div>\r\n        <script type="text/javascript">\r\n          iFrameResize([{log:true, checkOrigin:false}],[\'#bb-widget\']);\r\n       </script> \r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>'),$templateCache.put("wallet_logs.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n<div ng-hide="loading">\r\n  <h4> Wallet Payment History </h4>\r\n  <table class="table table-bordered">\r\n    <thead>\r\n      <tr>\r\n        <th>Action</th>\r\n        <th>Amount</th>\r\n        <th>Changed By</th>\r\n        <th>Date and Time</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="log in logs" ng-class="{\'last-item\': $last}">\r\n        <td>\r\n           {{log.action}}\r\n        </td>\r\n        <td class="text-right">\r\n           {{log.payment_amount | icurrency:log.wallet_currency }}\r\n        </td>\r\n        <td class="text-center">\r\n           {{ log.who_made_the_change }}\r\n        </td>\r\n        <td class="text-center">\r\n           {{ log.created_at | datetime  }}\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>')}]);
angular.module("BB").run(["$templateCache",function($templateCache){$templateCache.put("admin_pick.html",'<div bb-wait-for="quickEmptybasket()" bb-wait-var="allDone" ng-if="allDone" bb-form-data-store ng-controller="PageController">\r\n\r\n  <div id="appointment-booking-form-wrap" class="block">\r\n    <form id="appointment-booking-form" >\r\n\r\n      <div bb-form-data-store ng-controller="ServiceList">\r\n        <div class="input-row selectbox">\r\n          <label>Pick a Service</label>\r\n          <span class="no-border">\r\n            <select id="enquiry-type" ng-model="service" ng-options="s.name for s in bookable_services">\r\n              <option value="">-- pick a service --</option>\r\n            </select>\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-if="bb.company.$has(\'people\') && !bb.item_defaults.person" ng-show="bb.current_item.service" ng-controller="PersonList">\r\n        <div class="input-row selectbox">\r\n          <label>Pick an adviser</label>\r\n          <span class="no-border">\r\n            <select id="enquiry-type" ng-model="person" ng-options="s.name for s in bookable_people">\r\n              <option value="">-- pick any adviser --</option>\r\n            </select>\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-if="bb.company.$has(\'resources\') && !bb.item_defaults.resource" ng-show="bb.current_item.service" ng-controller="ResourceList">\r\n        <div class="input-row selectbox">\r\n          <label>Pick a Resource</label>\r\n          <span class="no-border">\r\n            <select id="enquiry-type" ng-model="resource" ng-options="s.name for s in bookable_resources">\r\n              <option value="">-- pick any resource --</option>\r\n            </select>\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <br />\r\n      <div ng-show="bb.current_item.service">\r\n        <a class="button-colour-a" ng-click="checkReady() && routeReady()" bb-debounce>Next</a>\r\n      </div>\r\n\r\n    </form>\r\n  </div>\r\n</div>'),$templateCache.put("basket.html",'<div bb-basket-list ng-init="checkStepTitle(\'Check Your Basket\')" class="bb-basket">\r\n	<div class="row">\r\n\r\n\r\n		<div class="col-sm-12">\r\n			<div class="bb-subcontent">\r\n\r\n				<h2 class="bb-section-title">Your basket</h2>\r\n				<div class="bb-empty-basket-full-screen" ng-hide="items">\r\n					<h3>There are no items in the basket</h3>\r\n					<p>Please press the add another item button if you wish to add a product or service.</p>\r\n				</div>\r\n				<table class="table table-bordered" ng-show="items">\r\n					<thead>\r\n						<tr>\r\n							<th>Item</th>\r\n							<th>Price</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n					</thead>\r\n					<tbody>\r\n						<tr ng-repeat="item in items" ng-class="{\'last-item\': $last}">\r\n							<td>\r\n								<p>\r\n									{{item.describe()}}\r\n									<br/>\r\n									<small>{{item.date.date | datetime: "h:mma dddd Do MMMM":false}}</small>\r\n									<br/>\r\n									<small>{{item.resource.getAddress() | address_single_line }}</small>\r\n									<br/>\r\n									<small ng-if="item.recipient"> Recipient: {{ item.recipient }} </small>\r\n								</p>\r\n							</td>\r\n							<td class="text-right">\r\n								{{ item.total_price | currency }}\r\n								<div ng-if="item.certificate_paid > 0">\r\n									<small>Certificate Paid: {{ item.certificate_paid | currency }}</small>\r\n								</div>\r\n							</td>\r\n							<td class="text-center">\r\n								<span class="glyphicon glyphicon-trash" aria-hidden="true" ng-click="deleteBasketItem(item)"></span>\r\n							</td>\r\n						</tr>\r\n						<tr ng-if="basket.hasDeal()">\r\n							<th class="text-left">Gift Certificates</th>\r\n							<th>&nbsp;</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n						<tr ng-if="basket.hasDeal()" ng-repeat="deal_code in basket.getDealCodes()" ng-class="{\'last-item\': $last}">\r\n							<td>\r\n								<p>\r\n									{{deal_code.description}}\r\n									<br/> \r\n								</p>\r\n								<p></p>\r\n							</td>\r\n							<td class="text-right">\r\n								{{ deal_code.value | currency }}\r\n							</td>\r\n							<td class="text-center">\r\n								<span class="glyphicon glyphicon-trash" aria-hidden="true" ng-click="removeDeal(deal_code)"></span>\r\n							</td>\r\n						</tr>\r\n\r\n						<tr data-ng-if="basket.hasDeal() || basket.hasCoupon()">\r\n							<th class="text-right">Original Price</th>\r\n							<th class="text-right">{{basket.fullPrice() | currency }}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n						\r\n						<tr data-ng-if="basket.questionPrice()">\r\n							<th class="text-right">Booking Fee</th>\r\n							<th class="text-right">{{basket.questionPrice() | currency}}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n						\r\n						\r\n						<tr data-ng-if="basket.hasDeal()">\r\n							<th class="text-right">Total Gift Certificates</th>\r\n							<th class="text-right">{{basket.totalDeals() | currency }}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n\r\n						<tr data-ng-if="basket.hasDeal()">\r\n							<th class="text-right">Remaining Value on Gift Certificates</th>\r\n							<th class="text-right">{{ basket.totalCertificatePaid() | currency }}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n\r\n						<tr data-ng-if="basket.hasCoupon()">\r\n							<th class="text-right">Coupon Discount</th>\r\n							<th class="text-right">{{(bb.basket.fullPrice() - bb.basket.totalPrice()) | currency}}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n\r\n						<tr data-ng-if="basket.total_price > 0">\r\n							<th class="text-right">Total</th>\r\n							<th class="text-right">{{basket.total_price | currency }}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n						<tr data-ng-if="basket.total_due_price != basket.total_price">\r\n							<th class="text-right">Total Due Now</th>\r\n							<th class="text-right">{{basket.total_due_price | currency }}</th>\r\n							<th>&nbsp;</th>\r\n						</tr>\r\n					</tbody>\r\n				</table>\r\n				<div ng-if="show_wallet">\r\n					<h4> Wallet </h4>\r\n					<div ng-show="client.has_active_wallet">\r\n						<p> Current Wallet Balance: {{client.wallet_amount | icurrency}} </p> <small style="color:#ff1919;"ng-if="client.wallet_amount < basket.total_due_price"> (-{{basket.total_due_price - client.wallet_amount | icurrency }})</small>\r\n						<small ng-if="client.wallet_amount < basket.total_due_price"><i> Oh no! You do not currently have enough money in your wallet account. You can either pay the full amount, or top up to add more money to your wallet. </i></small>\r\n						<small ng-if="client.wallet_amount >= basket.total_due_price"><i> You will have {{(client.wallet_amount - basket.total_price) | icurrency }} left in your wallet after this purchase. </i></small>\r\n					  <button ng-if="client.wallet_amount < basket.total_due_price" type="button" class="btn btn-primary btn-xs" ng-click="topUpWallet()">Top Up</button>\r\n					</div>\r\n      	</div>\r\n\r\n				<div ng-if="bb.company_settings.has_coupons" class="bb-coupon-box">\r\n					<span>Apply a coupon </span>\r\n					<input ng-model="coupon_code"/>\r\n					<button type="button" class="btn btn-primary btn-xs" ng-click="applyCoupon(coupon_code)">Apply</button>\r\n				</div>\r\n\r\n				<div class="bb-coupon-box" ng-if="bb.company_settings.has_vouchers">\r\n					<form class="form-inline">\r\n						<div ng-show="!show_voucher_box">\r\n							<a ng-click="show_voucher_box = true">Have a gift certificate?</a>\r\n						</div>\r\n						<div ng-show="show_voucher_box" class="form-group">\r\n							<label ng-if="!basket.hasDeal()" for="deal">Apply a Gift Certificate:</label>\r\n							<label ng-if="basket.hasDeal()" for="deal">Apply another Gift Certificate:</label>\r\n							<div class=" input-group">\r\n								<input type="text" class="form-control input-sm" id="deal_code" name="deal_code" ng-model="deal_code" placeholder="Enter a voucher code">\r\n								<span class="input-group-btn">\r\n									<button type="button" class="btn btn-primary btn-sm" ng-click="applyDeal(deal_code)">Apply</button>\r\n								</span>\r\n							</div>\r\n						</div>\r\n					</form>\r\n				</div>\r\n\r\n			</div>\r\n		</div>\r\n\r\n		<div class="col-sm-12">\r\n			<div class="bb-step-navigation">\r\n				<div class="row">\r\n					<div class="col-sm-9 col-sm-push-3 text-right">\r\n						<div ng-if="bb.company.$has(\'events\')">\r\n							<button type="button" class="btn btn-primary" ng-click="addAnother(\'event_list\')">Add another item</button>\r\n						</div>\r\n						<div ng-if="bb.company.$has(\'services\')">\r\n							<button type="button" class="btn btn-primary" ng-click="addAnother(\'service_list\')">Add another item</button>\r\n						</div>\r\n						<button type="button" class="btn btn-primary" ng-click="checkout(\'checkout\')">Checkout</button>\r\n					</div>\r\n					<div class="col-sm-3 col-sm-pull-9">\r\n						<button type="button" class="btn btn-default" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1"><span>Back</span></button>\r\n					</div>\r\n				</div>\r\n			</div>	\r\n		</div>\r\n\r\n	</div>\r\n</div>\r\n'),$templateCache.put("basket_wallet.html",'<div bb-wallet-payment="{amount:((bb.basket.total_price - $root.member.wallet_amount) / 100),basket:bb.basket}">\r\n  <div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n  <div ng-hide="loading">\r\n  <div class="bb-head">\r\n    <h3>Make Payment</h3>\r\n  </div>\r\n    <div class="bb-content">\r\n      <div ng-if="error_message" class="alerts">\r\n        <p class="error_message" ng-bind-html="error_message"></p>\r\n      </div>\r\n\r\n      <div ng-form class="form-inline">\r\n        <div ng-show="!showTopUpBox()">\r\n          <button type="button" class="bb-bookings-action" ng-click="(show_topup_box = true);(error_message = false)">Top Up</button>\r\n        </div>\r\n        <div ng-show="showTopUpBox()" class="form-group">\r\n          <label for="amount">Amount:</label>\r\n          <div class=" input-group">\r\n            <input type="number" class="form-control input-sm" id="amount" name="amount" ng-model="amount" placeholder="Enter Top Up Amount">\r\n            <span class="input-group-btn">\r\n              <button type="submit" class="btn btn-primary btn-sm" ng-disabled="!amount && ((amount * 100) < wallet.min_amount)" ng-click="updateWallet(member, amount)">Top Up Wallet</button>\r\n            </span>\r\n          </div>\r\n          <br>\r\n          <small> Minimum top up amount must be greater than {{wallet.min_amount | icurrency }} </small>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div class="bb-payment">\r\n        <div id="bb-payment">\r\n          <iframe id="bb-widget" ng-src="{{wallet_payment_url}}" width="100%"scrolling="no" frameborder="0"></iframe>\r\n        </div>\r\n        <script type="text/javascript">\r\n          iFrameResize([{log:true, checkOrigin:false}],[\'#bb-widget\']);\r\n       </script> \r\n      </div>\r\n\r\n    </div>\r\n    <div class="bb-step-navigation">\r\n      <div class="row">\r\n        <div class="col-sm-6 text-left">\r\n          <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()">Back</button>\r\n        </div>\r\n      </div>\r\n    </div> \r\n\r\n  </div>\r\n</div>'),$templateCache.put("book_waitlist.html",' <div class="confirmation-header">\r\n  <h2 class="confirmation-heading">Your Waitlist bookings</h2>\r\n</div>\r\n\r\n<div ng-show="waitlist_bookings">\r\n<ul class="confirmation-summary" ng-repeat="i in waitlist_bookings">\r\n  <li ng-if="i.id" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Booking Reference:</div>\r\n    <div class="col-sm-9">{{i.id}}</div>\r\n  </li>\r\n  <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Service:</div>\r\n    <div class="col-sm-9">{{i.full_describe}}</div>\r\n  </li>\r\n  <li ng-if="i.describe" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Date/Time:</div>\r\n    <div class="col-sm-9">{{i.describe}}</div>\r\n  </li>\r\n  <li ng-if="i.price" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Price:</div>\r\n    <div class="col-sm-9">{{i.price | currency }}</div>\r\n  </li>\r\n  <li class="row confirmation-summary-item">\r\n  <div class="col-sm-3 pull-right">\r\n    <button type="button" class="btn btn-primary btn-block" ng-click="bookWaitlistItem(i)">Book</button>\r\n  </div>\r\n  </li>\r\n</ul>\r\n<ul class="confirmation-summary">\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.total_price | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total Due Now</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.due_now | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n</ul>\r\n</div>\r\n\r\n<div ng-hide="waitlist_bookings">\r\n <ul class="confirmation-summary">\r\n   <p> Thanks {{purchase.client.first_name }}. You have successully booked onto {{purchase.bookings[0].service_name }}. </p>\r\n</ul>\r\n<ul class="confirmation-summary">\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.total_price | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total Due Now</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.due_now | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n</ul>\r\n\r\n</div>\r\n\r\n<div class="hidden-print">\r\n  <div class="bb-step-navigation">\r\n    <div ng-if="make_payment" class="col-sm-12 bb-checkout-pay-button-div">\r\n      <div payment-button \r\n        value="Pay" \r\n        class="btn btn-primary" \r\n        total="total" \r\n        bb="bb"\r\n        decide-next-page="decideNextPage">\r\n      </div>\r\n    </div>\r\n    <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n    <div bb-booking-export class="bb-booking-export"></div>\r\n    <div class="col-sm-12 pull-left">\r\n      <button type="button" class="btn btn-default" ng-click="$parent.is_waitlist = false"> Back </button>\r\n    </div>\r\n     </div>\r\n</div>'),$templateCache.put("calendar.html",'<div bb-page>\r\n\r\n  <div class="page-summary">\r\n    <p>Select a date and time for your {{bb.current_item.service.name}} appointment.</p>\r\n    <div bb-include="_service_item_aggregate">\r\n    </div>\r\n  </div>\r\n\r\n<!--   <div bb-people></div> -->\r\n\r\n  <div bb-time-ranges class="calendar" ng-init="init({selected_day: today})">\r\n\r\n    <div class="month-header hidden-xs">\r\n      <h2 class="month-heading">{{pretty_month_title(\'MMMM\', \'YYYY\')}}</h2>\r\n    </div>\r\n\r\n    <div class="date-select text-block visible-xs">\r\n      <div class="input-group date-picker">\r\n        <!-- date format: http://docs.angularjs.org/api/ng.filter:date -->\r\n        <input type="text" ng-model="selected_date" class="form-control"\r\n          bb-datepicker-popup="DD/MM/YYYY"\r\n          on-date-change="selectedDateChanged()"\r\n          datepicker-popup="dd/MM/yyyy"\r\n          is-open="opened"\r\n          min-date="today"\r\n          datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n          show-weeks="false"\r\n          show-button-bar="false"\r\n          ng-readonly="false"/>\r\n        <span class="input-group-btn" ng-click="$event.preventDefault();$event.stopPropagation();opened=true">\r\n          <button class="btn btn-default" type="submit" title="Search"><span class="glyphicon glyphicon-calendar"></span></button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n\r\n    <ul class="week row">\r\n\r\n      <li class="day navigation hidden-xs">\r\n        <button type="button" class="btn btn-icon" ng-click="subtract(\'days\', subtract_length)" ng-disabled="!is_subtract_valid || !isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-left"></span>\r\n        </button>\r\n        <span ng-show="!is_subtract_valid || !isLoaded">&nbsp;</span>\r\n      </li>\r\n\r\n      <li class="day" ng-repeat="day in days" ng-class="{\'hidden-xs\': day.hide, \'past\': day.date.isBefore(moment(),\'day\')}">\r\n\r\n        <div class="day-header row">\r\n          <span class="col-xs-2 previous visible-xs">\r\n            <button type="button" class="btn btn-icon" ng-click="subtract(\'days\', 1)" ng-disabled="day.date.isSame(moment(),\'day\') || !isLoaded">\r\n              <span class="glyphicon glyphicon-chevron-left"></span>\r\n            </button>\r\n          </span>\r\n          <h3 class="day-heading col-xs-8 col-sm-12">\r\n            <span class="visible-xs">{{day.date | datetime: "ddd":false}} <strong>{{day.date | datetime: "D":false}} </strong>{{day.date | datetime: "MMM":false}}</span>\r\n            <span class="hidden-xs">{{day.date | datetime: "ddd":false}} <strong>{{day.date | datetime: "D":false}} </strong></span> \r\n          </h3>\r\n          <span class="col-xs-2 next visible-xs">\r\n            <button type="button" class="btn btn-icon" ng-click="add(\'days\', 1)" ng-disabled="!isLoaded">\r\n              <span class="glyphicon glyphicon-chevron-right"></span>\r\n            </button>\r\n          </span>\r\n        </div>\r\n\r\n        <div class="times">\r\n\r\n          <!-- if time list has slots -->\r\n          <div accordion close-others="false">\r\n\r\n            <!-- MORNING TIME RANGE -->\r\n            <div bb-accordian-range-group="{range: [0, 720], slots: day.slots, collaspe_when_time_selected: true}" ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n              <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n                <div accordion-heading>\r\n                  <div class="accordian-header">\r\n                    <span class="period-label">\r\n                      <span ng-show="has_availability && !is_open">+</span>\r\n                      <span ng-show="has_availability && is_open">-</span>\r\n                      Morning\r\n                    </span>\r\n                    <span ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n                    <span class="selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <ul class="time-slots" ng-if="has_availability">\r\n                  <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </li>\r\n                </ul>\r\n\r\n              </div>\r\n            </div>\r\n\r\n            <!-- AFTERNOON TIME RANGE -->\r\n            <div bb-accordian-range-group="{range: [720, 1020], slots: day.slots, collaspe_when_time_selected: true}" ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n              <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n                <div accordion-heading>\r\n                  <div class="accordian-header">\r\n                      <span class="period-label">\r\n                      <span ng-show="has_availability && !is_open">+</span>\r\n                      <span ng-show="has_availability && is_open">-</span>\r\n                      Afternoon\r\n                    </span>\r\n                    <span ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n                    <span class="selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <ul class="time-slots">\r\n                  <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- EVENING TIME RANGE -->\r\n            <div bb-accordian-range-group="{range: [1020, 1440], slots: day.slots, collaspe_when_time_selected: true}" ng-init="setFormDataStoreId($index); setRange(1020, 1440)" class="accordian-group">\r\n              <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n                <div accordion-heading>\r\n                  <div class="accordian-header">\r\n                    <span class="period-label">\r\n                      <span ng-show="has_availability && !is_open">+</span>\r\n                      <span ng-show="has_availability && is_open">-</span>\r\n                      Evening\r\n                    </span>\r\n                    <span ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n                    <span class="selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <ul class="time-slots">\r\n                  <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </li>\r\n\r\n      <li class="day navigation hidden-xs">\r\n        <button type="button" class="btn btn-icon" ng-disabled="!isLoaded" ng-click="add(\'weeks\', 1)">\r\n          <span class="glyphicon glyphicon-chevron-right"></span>\r\n        </button>\r\n      </li>\r\n\r\n    </ul>\r\n\r\n  </div>\r\n\r\n  <div class="bb-step-navigation">\r\n    <div class="row">\r\n      <div class="col-sm-offset-8 col-sm-2 col-sm-push-2 text-right">\r\n        <button type="button" class="btn btn-primary" ng-click="checkReady() && routeReady()" bb-debounce ng-disabled="!bb.current_item.time"> \r\n          <span ng-if="!bb.moving_booking">Continue</span>\r\n          <span ng-if="bb.moving_booking">Move booking</span>\r\n        </button>\r\n      </div>\r\n      <div class="col-sm-2 col-sm-pull-10 text-left">\r\n        <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-if="!bb.moving_booking">Back</button>\r\n      </div>\r\n    </div>\r\n  </div>  \r\n</div>'),$templateCache.put("checkout.html",'<div bb-checkout="{disable_confirmation: true}" class="bb-checkout">\r\n  <div class="row">\r\n    <div class="col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">\r\n      <div class="bb-subcontent">\r\n        <div class="confirmation-header bb-confirmation-border-margin">\r\n          <div ng-show="total && !total.containsWaitlistItems()">\r\n            <h2>Booking Confirmation</h2>\r\n            <p class="bb-confirmation-p-alignment">Thanks {{ total.client.first_name }}. Your booking is now confirmed. We have emailed you the details below.</p>\r\n          </div>\r\n          <div ng-show="total && total.containsWaitlistItems()">\r\n            <h2>Confirmation</h2>\r\n            <p class="bb-confirmation-p-alignment">Thanks {{ total.client.first_name }}. You have successfully made the following bookings. We have you emailed you the details below.</p>\r\n          </div>\r\n          <div class="row hidden-print text-right">\r\n            <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n            <span bb-booking-export class="bb-booking-export"></span>\r\n          </div>\r\n        </div>\r\n\r\n        <div ng-show="total">\r\n          <ul ng-show="total.id" class="confirmation-summary">\r\n            <li class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Booking Reference:</div>\r\n              <div class="col-sm-9">{{total.id}}</div>\r\n            </li>\r\n          </ul>\r\n          <ul class="confirmation-summary" ng-repeat="i in total.items track by $index">\r\n            <li ng-show="i.name" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Name:</div>\r\n              <div class="col-sm-9">{{i.name}}</div>\r\n            </li>\r\n            <li ng-show="i.description" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Description:</div>\r\n              <div class="col-sm-9">{{i.description}}</div>\r\n            </li>\r\n            <li ng-show="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Service:</div>\r\n              <div class="col-sm-9">{{i.full_describe}}</div>\r\n            </li>\r\n            <li ng-show="i.describe" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Date/Time:</div>\r\n              <div class="col-sm-9">{{i.describe}}</div>\r\n            </li>\r\n            <li ng-show="i.price" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Price:</div>\r\n              <div class="col-sm-9">{{i.price | currency }}</div>\r\n            </li>\r\n            <li ng-show="i.due_now != 0" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Due Now:</div>\r\n              <div class="col-sm-9">{{i.due_now | currency }}</div>\r\n            </li>\r\n            <span ng-repeat="prepaid in available_prepaid_bookings">\r\n            <li ng-show="i.due_now > 0" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">PrePaid Booking:</div>\r\n              <div class="col-sm-9">{{prepaid}}</div>\r\n            </li>\r\n            </span>\r\n          </ul>\r\n          <ul ng-show="total.items[0].address.lat" class="confirmation-summary">\r\n            <li class="row confirmation-summary-item">\r\n              <div class="col-sm-12">\r\n                <div bb-address-map="total.items[0].address" ng-if="total.items[0].address.lat" >\r\n                  <ui-gmap-google-map center=\'map.center\' zoom=\'map.zoom\' options="options">\r\n                    <ui-gmap-marker coords="marker.coords" idkey="marker.id">\r\n                    </ui-gmap-marker>\r\n                  </ui-gmap-google-map>\r\n                </div>\r\n              </div>\r\n            </li>\r\n            <li class="row confirmation-summary-item">\r\n              <div class="col-sm-12">\r\n                <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>{{total.items[0].address | address_single_line }}\r\n              </div>\r\n            </li>\r\n          </ul>\r\n          <div ng-if="total.$has(\'new_payment\')" class="col-sm-12 bb-checkout-pay-button-div">\r\n            <div bb-payment-button\r\n              value="Pay" \r\n              class="btn btn-primary" \r\n              total="total" \r\n              bb="bb"\r\n              decide-next-page="decideNextPage">\r\n            </div>\r\n          </div>\r\n          <div bb-custom-confirmation-text class="bb-message">\r\n            <div ng-repeat="msg in messages" ng-bind-html="msg">\r\n            </div>\r\n          </div>\r\n        </div>   \r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n</div>\r\n\r\n<div ng-show="isLoaded" class="powered-by visible-print">\r\n  <p>Bookings powered by <span style="color:#087f94">booking</span><span style="color:#88c66f">bug</p>\r\n  <a href="//www.bookingbug.com" style="text-decoration:none" target="_blank"></a>\r\n</div>\r\n'),$templateCache.put("checkout_event.html",'<div bb-checkout class="event">\r\n\r\n  <div bb-payment class="bb-payment" ng-if="total">\r\n\r\n    <div class="event-header" ng-style="bb.event_details.image.background_css">\r\n      <div class="event-details">\r\n        <h1>{{bb.event_details.name}}</h1>\r\n        <ul class="event-summary-list">\r\n          <li class="date-time">\r\n            <span class="bb-icon icon-calendar"></span>\r\n            <span>{{bb.event_details.datetime.format(\'dddd MMMM Do YYYY\')}} at <span class="event-time">{{bb.event_details.datetime.format(\'h[:]mma\')}}</span></span>\r\n          </li>\r\n          <li class="location" ng-show="bb.event_details.address">\r\n            <span class="bb-icon icon-location"></span>\r\n            <span>{{bb.event_details.address | address_single_line}}</span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-description">\r\n      <div class="panel-body">\r\n        <p>Please enter your payment details to confirm your booking.</p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-tickets">\r\n      <div class="panel-body">\r\n        <h2 class="heading">Place Summary</h2>\r\n        <div ng-form name="ticket_form" class="bb-form" role="form">\r\n          <ul class="ticket-list">\r\n            <li class="header">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6">Type</div>\r\n                <div class="col-sm-3 col-xs-4">Price</div>\r\n                <div class="col-sm-3 col-xs-2">Qty</div>\r\n              </div>\r\n            </li>\r\n            <li ng-repeat="ticket in bb.event_details.tickets">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6">\r\n                  <span>{{ticket.fullName()}}</span>\r\n                </div>\r\n                <div class="col-sm-3 col-xs-4">\r\n                  <span ng-if="ticket.price > 0">{{ticket.price | currency}}</span><span ng-if="ticket.price == 0">Free</span>\r\n                  <small ng-if="ticket.counts_as"><i>(for {{ticket.counts_as}})</i></small>\r\n                </div>\r\n                <div class="col-sm-3 col-xs-2">\r\n                  <span>{{ticket.qty}}</span>\r\n                </div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="bb.basket.questionPrice()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Booking Fee</div>\r\n                <div class="col-sm-3 col-xs-6">{{bb.basket.questionPrice() | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="bb.basket.hasCoupon()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Original Cost</div>\r\n                <div class="col-sm-3 col-xs-6">{{bb.basket.fullPrice() | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="bb.basket.hasCoupon()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Coupon Discount</div>\r\n                <div class="col-sm-3 col-xs-6">{{(bb.basket.fullPrice() - bb.basket.totalPrice()) | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="bb.basket.hasCoupon() || bb.basket.totalPrice()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Total</div>\r\n                <div class="col-sm-3 col-xs-6"><strong>{{bb.basket.totalPrice() | currency}}</strong></div>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-tickets">\r\n      <div class="panel-body">\r\n        <h2 class="heading">Payment Details</h2>\r\n        <div id="bb-payment">\r\n          <iframe id="bb-widget" ng-src="{{url}}" width="100%" height="930px" scrolling="no" frameborder="0"></iframe>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <script type="text/javascript">\r\n      iFrameResize([{log:false, checkOrigin:false}],[\'#bb-widget\']);\r\n    </script> \r\n  </div>\r\n\r\n</div>\r\n'),
$templateCache.put("check_items.html",'<div bb-page ng-init="checkStepTitle(\'Review\')">\r\n  <div bb-item-details>\r\n\r\n    <h1>Review</h1>\r\n\r\n    <div bb-include="_service_item_aggregate">\r\n    </div>\r\n\r\n    <div class="bb-subcontent">\r\n\r\n      <form name="booking_form" role="form" novalidate bb-form class="form-horizontal">\r\n\r\n        <div ng-form name="client_form" class="bb-form" role="form" novalidate>\r\n\r\n          <h2 class="booking-form-header">Your details</h2>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.first_name.$invalid && (client_form.first_name.$dirty || booking_form.submitted)}">\r\n            <label for="first_name" class="control-label col-sm-4">First Name*:</label>\r\n            <div class="col-sm-5">\r\n              <input type="text" name="first_name" id"first_name" required ng-model="client.first_name" class="form-control"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="client_form.first_name.$invalid && booking_form.submitted">\r\n                Please enter your first name\r\n              </div>\r\n            </div> \r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.last_name.$invalid && (client_form.last_name.$dirty|| booking_form.submitted)}">\r\n            <label for="last_name" class="control-label col-sm-4">Last Name*:</label>\r\n            <div class="col-sm-5">\r\n              <input type="text" name="last_name" id="last_name" required ng-model="client.last_name" class="form-control"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="client_form.last_name.$invalid && booking_form.submitted">\r\n                Please enter your last name\r\n              </div>          \r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.email.$invalid && (client_form.email.$dirty|| booking_form.submitted)}">\r\n            <label for="email" class="control-label col-sm-4">E-mail*:</label>\r\n            <div class="col-sm-5">\r\n              <input type="email" name="email" id="email" required ng-model="client.email" class="form-control"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="client_form.email.$invalid && booking_form.submitted">\r\n                Please enter a valid email address\r\n              </div>          \r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.mobile.$invalid && ((client_form.mobile.$dirty && !client_form.mobile.$focused) || booking_form.submitted)}">\r\n            <label for="mobile" class="control-label col-sm-4">Mobile:</label>\r\n            <div class="col-sm-5">\r\n              <input type="text" name="mobile" id="mobile" ng-pattern="validator.getUKMobilePattern(true)" ng-model="client.mobile" class="form-control" bb-focus/>\r\n            </div>\r\n          </div>\r\n\r\n          <div bb-client-details ng-show="client_details.hasQuestions">\r\n\r\n            <div class="form-group" ng-repeat="question in client_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{ \'check\': question.detail_type == \'check\', \'has-error\': client_form[\'q\' + question.id].$invalid && (client_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n              <label ng-hide="question.detail_type == \'check\'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span></label>\r\n              <div ng-show="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n              <div class="col-sm-5">\r\n                <input bb-question="question"/>\r\n              </div>\r\n              <div class="col-sm-offset-4 messages">\r\n                <div class="error-message" ng-show="client_form[\'q\' + question.id].$invalid && ( client_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                  This field is required\r\n                </div>\r\n              </div> \r\n            </div>   \r\n\r\n          </div>\r\n\r\n          <div class="form-group">\r\n            <div class="col-sm-offset-4 col-sm-5">\r\n               <p class="form-control-static">*Required fields</p>\r\n            </div>\r\n          </div>\r\n\r\n\r\n        </div><!--client_form-->\r\n\r\n        <div ng-show="item_details.hasQuestions" ng-form name="booking_questions_form" class="bb-form" role="form" novalidate>\r\n\r\n          <h2 class="booking-form-header">Other information</h2>\r\n\r\n          <div class="form-group" ng-repeat="question in item_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{\'has-error\': booking_questions_form[\'q\' + question.id].$invalid && (booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n            <label for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span></label>\r\n            <div class="col-sm-5">\r\n              <input bb-question="question"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="booking_questions_form[\'q\' + question.id].$invalid && ( booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                This field is required\r\n              </div>\r\n            </div> \r\n          </div>\r\n\r\n        </div><!--booking_questions_form-->\r\n\r\n\r\n        <div class="bb-step-navigation">\r\n          <div class="row">\r\n            <div class="col-sm-9 col-sm-push-3 text-right">\r\n              <button type="submit" class="btn btn-primary pull-right" ng-click="confirm(booking_form) && validator.validateForm(booking_form) && checkReady() && routeReady()">Confirm</button>\r\n            </div>\r\n            <div class="col-sm-3 col-sm-pull-9">\r\n              <button type="button" class="btn btn-default pull-left" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </form><!--booking_form-->\r\n\r\n\r\n    </div>\r\n\r\n\r\n\r\n  </div>\r\n</div>\r\n'),$templateCache.put("check_items_admin.html",'<div bb-item-details ng-init="checkStepTitle(\'Booking Summary\')">\r\n\r\n  <div bb-include="_service_item_aggregate">\r\n  </div>\r\n\r\n  <div class="bb-subcontent">\r\n\r\n    <form name="booking_form" class="form-horizontal" ng-submit="validator.validateForm(booking_form)" role="form" bb-raise-alert-when-invalid>\r\n\r\n      <div bb-custom-booking-text class="bb-message-node">\r\n        <div ng-repeat="msg in messages" ng-bind-html="msg"></div>\r\n      </div>\r\n\r\n      <div ng-show="item_details.hasQuestions" class="question-node">\r\n        <div ng-form="booking_questions_form" role="form" novalidate>\r\n          <h3 class="booking-form-header">Questions</h3>\r\n\r\n          <div ng-repeat="question in item_details.questions" bb-question-line ng-show="question.currentlyShown">\r\n            <div class="form-group" ng-class="{\'has-error\': booking_questions_form[\'q\' + question.id].$invalid && (booking_questions_form[\'q\' + question.id].dirty || booking_form.submitted)}">\r\n              <label bb-question-label="question" class="control-label col-sm-offset-1 col-sm-3" ng-show="question.name" for="{{question.id}}"\r\n              >{{question.name}}<span ng-show="question.required">*</span>:\r\n              </label>\r\n              <div class="col-sm-5">\r\n                <input bb-question="question"/>\r\n                <br/>\r\n                <small ng-show="question.help_text">{{question.help_text}}<hr/></small>\r\n              </div>\r\n              <div class="col-sm-offset-4 messages">\r\n                <div class="error-message" ng-show="question.required.$invalid && booking_form.submitted">\r\n                  This field is required\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="form-group">\r\n            <label class="control-label col-sm-4">&nbsp;</label>\r\n            <div class="col-sm-5">\r\n              <div class="bb-checkbox" ng-if="item">\r\n                <label><input type="checkbox" ng-model="item.settings.send_email_reminder" ng-initial="true">Send me an email reminder</label>\r\n                <label><input type="checkbox" ng-model="item.settings.send_sms_reminder" ng-initial="true">Send me a SMS reminder</label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="question-node">\r\n        <label for="notes">Booking Notes (optional):</label>\r\n        <span>\r\n          <textarea ng-model="item.private_note" name="note" id="note" rows="3" class="form-question form-control"></textarea><br>\r\n         </span>\r\n      </div>\r\n      \r\n    </form>\r\n\r\n  </div>\r\n\r\n  <div class="bb-step-navigation">\r\n    <div class="row">\r\n      <div class="col-sm-9 col-sm-push-3 text-right">\r\n        <button type="submit" class="btn btn-primary pull-right" ng-click="confirm(booking_form)">Book</button>\r\n      </div>\r\n      <div class="col-sm-3 col-sm-pull-9">\r\n        <button type="button" class="btn btn-default pull-left" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n</div>'),$templateCache.put("check_move.html",'<div ng-if="!bb.current_item.move_done">\r\n  <div bb-item-details ng-init="confirm_move()">\r\n</div>\r\n'),$templateCache.put("client.html",'<div bb-client-details ng-init="checkStepTitle(\'Your Details\')">\r\n\r\n  <div bb-include="_service_item_aggregate" ng-if="bb.service">\r\n  </div>\r\n\r\n  <form name="client_form" ng-submit="validator.validateForm(client_form)" class="form-horizontal" role="form" bb-form-resettable bb-form novalidate>\r\n\r\n    <div>\r\n      <h2 ng-if="!isAdmin()" class="booking-form-header"><span ng-if="!isAdmin()">Your details</span></h2>\r\n      <h2 ng-if="isAdmin()" class="booking-form-header"><span ng-if="isAdmin()">Client details</span></h2>\r\n    </div>\r\n    \r\n    <div class="form-group" ng-class="{\'has-error\': client_form.first_name.$invalid && (!client_form.first_name.$pristine || client_form.submitted)}">\r\n      <label bb-question-label="question" for="first_name" class="control-label col-sm-4">First Name:</label>\r\n      <div class="col-sm-5">\r\n        <input type="text" name="first_name" id="first_name" required ng-model="client.first_name" class="form-control" autofocus bb-resettable ng-pattern="validator.alpha" />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="client_form.first_name.$invalid && client_form.submitted">\r\n          Please enter your first name\r\n        </div>\r\n      </div> \r\n    </div>\r\n    <div class="form-group" ng-class="{\'has-error\': client_form.last_name.$invalid && (!client_form.last_name.$pristine || client_form.submitted)}">\r\n      <label bb-question-label="question" class="control-label col-sm-4" for="last_name">Last Name:</label>\r\n      <div class="bb-field col-sm-5">\r\n        <input type="text" name="last_name" id="last_name" required ng-model="client.last_name" class="form-control" bb-resettable ng-pattern="validator.alpha" />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="client_form.last_name.$invalid && client_form.submitted">\r\n          Please enter your last name\r\n        </div>          \r\n      </div>\r\n    </div>\r\n    <div class="form-group" ng-class="{\'has-error\': client_form.email.$invalid && (!client_form.email.$pristine || client_form.submitted)}">\r\n      <label bb-question-label="question" class="control-label col-sm-4" for="email">Email:</label>\r\n      <div class="bb-field col-sm-5">\r\n        <input type="email" name="email" id="email" required ng-model="client.email" class="form-control" bb-resettable />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="client_form.email.$invalid && client_form.submitted">\r\n          Please enter a valid email address\r\n        </div>          \r\n      </div>\r\n    </div>\r\n    <div class="form-group" ng-class="{\'has-error\': (client_form.mobile.$invalid && (!client_form.mobile.$pristine || client_form.submitted)) && (!client_form.mobile.$focused || client_form.mobile.$error.required)}">\r\n      <label bb-question-label="question" class="control-label col-sm-4" for="mobile">Mobile:</label>\r\n      <div class="bb-field col-sm-5">\r\n        <input type="text" name="mobile" id="mobile" ng-model="client.mobile" class="form-control" bb-resettable ng-pattern="validator.getMobilePattern()" />\r\n      </div>\r\n    </div>\r\n    <div ng-show="client_details.hasQuestions">\r\n      <div>\r\n        <h2 class="booking-form-header">Other Information</h2>\r\n      </div>\r\n      <div>\r\n        <div class="form-group" ng-repeat="question in client_details.questions" bb-question-line ng-show="question.currentlyShown" ng-class="{\'has-error\': client_form[\'q\' + question.id].$invalid && (booking_questions_form[\'q\' + question.id].dirty || booking_form.submitted), \'bb-check-space\': (question.detail_type == \'check\')}">\r\n          <label class="control-label col-sm-4" bb-question-label="question" for="{{question.id}}">{{question.name}}<span ng-show="question.required">*</span>:</label>\r\n          <div class="col-sm-5">\r\n            <input bb-question="question" class="form-control"/><br/>\r\n            <small ng-show="question.help_text">{{question.help_text}}</small>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="bb-step-navigation">\r\n      <div class="row">\r\n        <div class="col-sm-9 col-sm-push-3 text-right">\r\n          <button type="submit" class="btn btn-primary" ng-click="validator.validateForm(client_form) && validateClient(client_form)">Continue</button>\r\n        </div>\r\n        <div class="col-sm-3 col-sm-pull-9 text-left">\r\n          <button type="button" class="btn btn-default" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1"><span>Back</span></button>\r\n          <button type="button" class="btn btn-default" ng-click="resetForm()">Clear</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </form>\r\n\r\n</div>\r\n'),$templateCache.put("client_admin.html",'<div bb-admin-booking-clients ng-init="per_page=5000">\r\n  <div tabset>\r\n    <div tab heading="Search for a client">\r\n      <div ng-form="client_search_form" class="form-horizontal">\r\n        <label for="search" class="control-label col-sm-4">Search by Name or URL</label>\r\n        <form ng-submit="getClients(null, searchText)">\r\n          <div class="col-sm-5">\r\n            <div class="input-group">\r\n              <input type="search" name="search" id"search" ng-model="searchText" class="form-control"/>\r\n              <span class="input-group-btn">\r\n                <button type="submit" class="btn btn-primary" bb-debounce>Search</button>\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </form>\r\n         <div class="col-sm-offset-4 messages">\r\n          <div class="error-message" ng-show="search_error">\r\n            Sorry, your search must be more than 3 characters long. Please try again.\r\n          </div>          \r\n         </div>\r\n       </div>\r\n\r\n      <br clear=\'all\'/>\r\n      <div ng-if="clients">\r\n        <h2 class="section-title">Results</h2>\r\n        <table tr-ng-grid="" items="clients" enable-filtering="false" enable-sorting="true" order-by="name" page-items="10" selection-mode="0">\r\n          <thead>\r\n            <tr>\r\n              <th field-name="name" enable-filtering="false" enable-sorting="true"></th>\r\n              <th field-name="email" enable-filtering="false" enable-sorting="true"></th>\r\n              <th field-name="address" enable-filtering="false" enable-sorting="false"></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td field-name="name" ng-bind="gridItem.name"></td>\r\n              <td field-name="email" ng-bind="gridItem.email"></td>\r\n              <td field-name="address" ng-bind="gridItem.addressSingleLine()"></td>\r\n              <td>\r\n                <button class="btn btn-primary btn-block" ng-click="selectClient(gridItem)">Select</button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n       <div class="row step-navigation">\r\n        <div class="col-sm-2 back">\r\n          <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()">Back</button>\r\n        </div>\r\n      </div> \r\n  </div>\r\n  <div tab heading="New client">\r\n    <div bb-include="client"></div>\r\n  </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("company_list.html",'<div bb-companies ng-init="checkStepTitle(\'Select a Company\')">\r\n\r\n  <div class="panel panel-default" ng-repeat="item in companies | orderBy: name">\r\n    <div class="panel-body">\r\n      <!-- add bb-vertical-align-center class below or something similar -->\r\n      <div class="row">\r\n        <div class="col-sm-10">\r\n          <h2 class="panel-title">{{item.name}}</h2>\r\n        </div>\r\n        <div class="col-sm-2">\r\n          <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation" ng-show="bb.current_step > 1">\r\n  <div class="row">\r\n    <div class="col-sm-2">\r\n      <button type="button" class="btn btn-default pull-left" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>'),$templateCache.put("confirmation.html",'<div bb-total ng-init="checkStepTitle(\'Confirmed\')" class="bb-checkout">\r\n  <div class="row">\r\n    <div class="col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">\r\n\r\n      <div class="bb-subcontent">\r\n        <div class="confirmation-header bb-confirmation-border-margin">\r\n          <h2>Booking Confirmation</h2>\r\n          <p class="bb-confirmation-p-alignment">Thanks {{ total.client.first_name }}. Your payment was successful. We have you emailed you the details below.</p>\r\n          <div class="row hidden-print text-right">\r\n            <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n            <div bb-booking-export class="bb-booking-export"></div>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <ul class="confirmation-summary" ng-repeat="i in total.items">\r\n            <li ng-if="i.id" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Booking Reference:</div>\r\n              <div class="col-sm-9">{{i.id}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Service:</div>\r\n              <div class="col-sm-9">{{i.full_describe}}</div>\r\n            </li>\r\n            <li ng-if="i.describe" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Date/Time:</div>\r\n              <div class="col-sm-9">{{i.describe}}</div>\r\n            </li>\r\n            <li ng-if="i.price" class="row confirmation-summary-item">\r\n              <div class="col-sm-3">Price:</div>\r\n              <div class="col-sm-9">{{i.price | currency }}</div>\r\n            </li>\r\n          </ul>\r\n          <ul ng-show="total.items[0].address.lat" class="confirmation-summary">\r\n            <li class="row confirmation-summary-item">\r\n              <div class="col-sm-12">\r\n                <div bb-address-map="total.items[0].address">\r\n                  <ui-gmap-google-map center=\'map.center\' zoom=\'map.zoom\' options="options">\r\n                    <ui-gmap-marker coords="marker.coords" idkey="marker.id">\r\n                    </ui-gmap-marker>\r\n                  </ui-gmap-google-map>\r\n                </div>\r\n              </div>\r\n            </li>\r\n            <li class="row confirmation-summary-item">\r\n              <div class="col-sm-12">\r\n                <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>{{total.items[0].address | address_single_line }}\r\n              </div>\r\n            </li>\r\n          </ul>\r\n\r\n          <div bb-custom-confirmation-text class="bb-message">\r\n            <div ng-repeat="msg in messages" ng-bind-html="msg"></div>\r\n          </div>\r\n\r\n\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n</div>\r\n\r\n<div ng-show="isLoaded" class="powered-by visible-print">\r\n  <p>Bookings powered by <span style="color:#087f94">booking</span><span style="color:#88c66f">bug</p>\r\n  <a href="//www.bookingbug.com" style="text-decoration:none" target="_blank"></a>\r\n</div>\r\n'),$templateCache.put("content_main.html",'<div ng-include="bb_main"\r\n      ng-hide="hide_page"\r\n      onload="initPage()"\r\n      bbContent="null">\r\n</div>\r\n'),$templateCache.put("dash.html",'<h1>Dashboard</h1>\r\n  <div class="dashcontainer" ng-controller="DashboardContainer" style="">\r\n\r\n  <div class="row">\r\n\r\n    <div class="col-md-4">\r\n      <h4>Pick a Location/Service</h4>\r\n\r\n      <div ng-controller="CompanyList" ng-init="init()">\r\n\r\n        <div class="" ng-repeat="comp in companies"  >\r\n          <h3>{{comp.name}}</h3>\r\n\r\n          <div ng-controller="PersonList" ng-init="init(comp)">\r\n\r\n            <a class="" ng-repeat="person in all_people"  style="margin-left:20px;font-size:14px;display:block;cursor:pointer;">\r\n              {{person.name}}\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-show="selectedSlot">\r\n        <div ng-controller="SelectedSlotDetails" class="side_details">\r\n          <div ng-include="showItemView">\r\n          </div>\r\n        </div>\r\n      </div>  \r\n\r\n    </div> \r\n\r\n    <div class="col-md-8">\r\n\r\n      <div ng-controller="CalendarCtrl" ng-init="init()">\r\n\r\n        <div ui-calendar="uiConfig.calendar" ng-model="eventSources" calendar="myCalendar">\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n    <div id="dialog-modal" title="" display:none;>\r\n      \r\n    </div>\r\n  </div>\r\n'),$templateCache.put("day.html",'<div bb-page>\r\n\r\n  <div class="page-summary">\r\n    <p>Select a date and time for your {{bb.current_item.service.name}} appointment.</p>\r\n    <div bb-include="_service_item_aggregate">\r\n    </div>\r\n  </div>\r\n\r\n<!--   <div bb-people></div> -->\r\n\r\n  <div bb-time-ranges class="calendar" ng-init="init({selected_day: today})">\r\n\r\n    <div class="month-header hidden-xs">\r\n      <h2 class="month-heading">{{pretty_month_title(\'MMMM\', \'YYYY\')}}</h2>\r\n    </div>\r\n\r\n    <div class="date-select text-block visible-xs">\r\n      <div class="input-group date-picker">\r\n        <!-- date format: http://docs.angularjs.org/api/ng.filter:date -->\r\n        <input type="text" ng-model="selected_date" class="form-control"\r\n          bb-datepicker-popup="DD/MM/YYYY"\r\n          on-date-change="selectedDateChanged()"\r\n          datepicker-popup="dd/MM/yyyy"\r\n          is-open="opened"\r\n          min-date="today"\r\n          datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n          show-weeks="false"\r\n          show-button-bar="false"\r\n          ng-readonly="false"/>\r\n        <span class="input-group-btn" ng-click="$event.preventDefault();$event.stopPropagation();opened=true">\r\n          <button class="btn btn-default" type="submit" title="Search"><span class="glyphicon glyphicon-calendar"></span></button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n\r\n    <ul class="week row">\r\n\r\n      <li class="day navigation hidden-xs">\r\n        <button type="button" class="btn btn-icon" ng-click="subtract(\'days\', subtract_length)" ng-disabled="!is_subtract_valid || !isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-left"></span>\r\n        </button>\r\n        <span ng-show="!is_subtract_valid || !isLoaded">&nbsp;</span>\r\n      </li>\r\n\r\n      <li class="day" ng-repeat="day in days" ng-class="{\'hidden-xs\': day.hide, \'past\': day.date.isBefore(moment(),\'day\')}">\r\n\r\n        <div class="day-header row">\r\n          <span class="col-xs-2 previous visible-xs">\r\n            <button type="button" class="btn btn-icon" ng-click="subtract(\'days\', 1)" ng-disabled="day.date.isSame(moment(),\'day\') || !isLoaded">\r\n              <span class="glyphicon glyphicon-chevron-left"></span>\r\n            </button>\r\n          </span>\r\n          <h3 class="day-heading col-xs-8 col-sm-12">\r\n            <span class="visible-xs">{{day.date | datetime: "ddd":false}} <strong>{{day.date | datetime: "D":false}} </strong>{{day.date | datetime: "MMM":false}}</span>\r\n            <span class="hidden-xs">{{day.date | datetime: "ddd":false}} <strong>{{day.date | datetime: "D":false}} </strong></span> \r\n          </h3>\r\n          <span class="col-xs-2 next visible-xs">\r\n            <button type="button" class="btn btn-icon" ng-click="add(\'days\', 1)" ng-disabled="!isLoaded">\r\n              <span class="glyphicon glyphicon-chevron-right"></span>\r\n            </button>\r\n          </span>\r\n        </div>\r\n\r\n        <div class="times">\r\n\r\n          <!-- if time list has slots -->\r\n          <div accordion close-others="false">\r\n\r\n            <!-- MORNING TIME RANGE -->\r\n            <div bb-accordian-range-group="{range: [0, 720], slots: day.slots, collaspe_when_time_selected: true}" ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n              <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n                <div accordion-heading>\r\n                  <div class="accordian-header">\r\n                    <span class="period-label">\r\n                      <span ng-show="has_availability && !is_open">+</span>\r\n                      <span ng-show="has_availability && is_open">-</span>\r\n                      Morning\r\n                    </span>\r\n                    <span ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n                    <span class="selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <ul class="time-slots" ng-if="has_availability">\r\n                  <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </li>\r\n                </ul>\r\n\r\n              </div>\r\n            </div>\r\n\r\n            <!-- AFTERNOON TIME RANGE -->\r\n            <div bb-accordian-range-group="{range: [720, 1020], slots: day.slots, collaspe_when_time_selected: true}" ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n              <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n                <div accordion-heading>\r\n                  <div class="accordian-header">\r\n                      <span class="period-label">\r\n                      <span ng-show="has_availability && !is_open">+</span>\r\n                      <span ng-show="has_availability && is_open">-</span>\r\n                      Afternoon\r\n                    </span>\r\n                    <span ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n                    <span class="selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <ul class="time-slots">\r\n                  <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- EVENING TIME RANGE -->\r\n            <div bb-accordian-range-group="{range: [1020, 1440], slots: day.slots, collaspe_when_time_selected: true}" ng-init="setFormDataStoreId($index); setRange(1020, 1440)" class="accordian-group">\r\n              <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n                <div accordion-heading>\r\n                  <div class="accordian-header">\r\n                    <span class="period-label">\r\n                      <span ng-show="has_availability && !is_open">+</span>\r\n                      <span ng-show="has_availability && is_open">-</span>\r\n                      Evening\r\n                    </span>\r\n                    <span ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n                    <span class="selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <ul class="time-slots">\r\n                  <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </li>\r\n\r\n      <li class="day navigation hidden-xs">\r\n        <button type="button" class="btn btn-icon" ng-disabled="!isLoaded" ng-click="add(\'weeks\', 1)">\r\n          <span class="glyphicon glyphicon-chevron-right"></span>\r\n        </button>\r\n      </li>\r\n\r\n    </ul>\r\n\r\n  </div>\r\n\r\n  <div class="bb-step-navigation">\r\n    <div class="row">\r\n      <div class="col-sm-offset-8 col-sm-2 col-sm-push-2 text-right">\r\n        <button type="button" class="btn btn-primary" ng-click="checkReady() && routeReady()" bb-debounce ng-disabled="!bb.current_item.time"> \r\n          <span ng-if="!bb.moving_booking">Continue</span>\r\n          <span ng-if="bb.moving_booking">Move booking</span>\r\n        </button>\r\n      </div>\r\n      <div class="col-sm-2 col-sm-pull-10 text-left">\r\n        <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-if="!bb.moving_booking">Back</button>\r\n      </div>\r\n    </div>\r\n  </div>  \r\n</div>'),$templateCache.put("day_calendar.html",'<div bb-include="_service_item_aggregate">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-month-availability ng-init="checkStepTitle(\'Select a date\')" class="bb-day">\r\n    <div class="bb-calendar-navigation">\r\n      <button type="button" class="btn btn-link pull-left" ng-click="subtract(\'months\',1)" ng-disabled="isPast()">\r\n        <span class="glyphicon glyphicon-chevron-left pull-left" aria-hidden="true">\r\n        </span>\r\n        <span class="hidden-xs">Previous Month\r\n        </span>\r\n      </button>\r\n      <button type="button" class="btn btn-link pull-right" ng-click="add(\'months\',1)">\r\n        <span class="hidden-xs">Next Month\r\n        </span>\r\n        <span class="glyphicon glyphicon-chevron-right pull-right" aria-hidden="true">\r\n        </span>\r\n      </button>\r\n    </div>\r\n    <div>\r\n      <h2 class="bb-section-title text-center hidden-xs">{{format_date(\'MMMM YYYY\')}}\r\n      </h2>\r\n      <h2 class="bb-section-title text-center hidden-sm hidden-md hidden-lg">{{format_date(\'MMM YY\')}}\r\n      </h2>\r\n      <table class="table table-bordered">\r\n        <tr ng-repeat="week in weeks">\r\n          <td ng-repeat="day in week" ng-class="{\'bb-today\': day.date.isSame(moment(),\'day\'), \'bb-go-ok\': day.spaces > 0, \'bb-no-go\': day.date.isBefore(moment(),\'day\') || day.spaces == 0, \'bb-month-highlight\': current_date.isSame(day.date,\'month\') }" ng-click="selectDay(day)">\r\n            <p class="pull-right" class="time-slot {{day.class(month)}}"  ng-class="{\'bb-past\': day.date.isBefore(moment(),\'day\') || day.spaces == 0}">\r\n              {{day.day()}}\r\n            </p> \r\n          </td>\r\n        </tr>  \r\n      </table>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>'),
$templateCache.put("deal_list.html",'<div bb-deals>\r\n  \r\n  <h2 class="deal-list-heading">\r\n    <span> Gift Certificates </span>\r\n  </h2>\r\n\r\n<div ng-if="bb.stacked_items && bb.stacked_items[0].deal">\r\n  <h4> Selected Gift Certificates </h4>\r\n  <table class="table table-bordered">\r\n    <thead>\r\n      <tr>\r\n        <th>Item</th>\r\n        <th>Price</th>\r\n        <th>&nbsp;</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n      <tr ng-repeat="item in bb.stacked_items" ng-class="{\'last-item\': $last}">\r\n        <td>\r\n          <p>\r\n            {{item.deal.name}}\r\n            <br/> \r\n             <form ng-if="!bb.company_settings.no_recipient" name="recipient_form" class="form-horizontal" role="form" bb-form-resettable bb-form novalidate>\r\n              <div ng-hide="recipient_form.submitted && item.recipient">\r\n              <small> Add a Recipient <small>\r\n              <br/>\r\n              <p>\r\n                <label bb-question-label="question" for="recipient_name" class="control-label col-sm-4"> <small> Name: </small> </label> <input type="text" name="recipient_name" id="recipient_name" ng-model="recipient.name" ng-pattern="validator.alpha"/>\r\n                <br/>\r\n              </p>\r\n              <p>\r\n                <label bb-question-label="question" for="recipient_mail" class="control-label col-sm-4"><small> Email: </small> </label> <input type="email" name="recipient_mail" id="recipient_mail" ng-model="recipient.mail"/>\r\n                <br/>\r\n              </p> \r\n              <p>\r\n                <button ng-click="validator.validateForm(recipient_form) && addRecipient(item, recipient)"> Add </button>\r\n                <br/>\r\n              </p>\r\n             <br/>\r\n             <p ng-show="recipient_form.recipient_name.$invalid && recipient_form.submitted" class="error-message"> Please enter the Recipients full name</p>\r\n              <p ng-show="recipient_form.recipient_mail.$invalid && recipient_form.submitted" class="error-message"> Please enter a valid email address</p>\r\n                </div>\r\n              </form>\r\n            <div ng-if="item.recipient">\r\n             <h5>Recipient </h5>\r\n              <p ng-if="item.recipient"> Name: <small> {{ item.recipient }} </small> </p>\r\n              <p ng-if="item.recipient_mail"> Email: <small> {{ item.recipient_mail }} </small> </p>\r\n            </div>\r\n        </p>\r\n        </td>\r\n        <td class="text-right">\r\n          {{ item.deal.price | currency }}\r\n        </td>\r\n        <td class="text-center">\r\n          <span class="glyphicon glyphicon-trash" aria-hidden="true"  ng-click="removeDeal(item)"></span>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<div class="panel panel-default bb-event-card" ng-repeat="deal in deals">\r\n  <div class="panel-body">  \r\n    <div class="row vertical-row-align">\r\n\r\n      <div class="col-sm-9 col-xs-12 deal-details">\r\n        <h3 >{{deal.name}}</h3>\r\n        <ul class="deal-summary-list">\r\n          <li class="deal-description">\r\n            <span>{{ deal.description }}</span>\r\n          </li>\r\n          <li class="price">\r\n            <span class="bb-icon icon-price"></span>\r\n            <span>{{deal.price | currency}}</span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <div class="col-sm-3 deal-select">\r\n        <button type="button" ng-click="selectDeal(deal)" class="btn btn-primary btn-block">\r\n          <span >Buy</span>\r\n        </button>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div ng-if="bb.stacked_items && bb.stacked_items[0].deal">\r\n  <button type="button" class="btn btn-primary btn-block" ng-click="purchaseDeals()"><span>Buy Gift Certificates</span></button>\r\n</div>\r\n<div class="row bb-step-navigation">\r\n  <button type="button" class="btn btn-default" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1"><span>Back</span></button>\r\n</div>\r\n\r\n</div>'),$templateCache.put("duration_list.html",'<div bb-include="_service_item_aggregate">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-durations ng-init="checkStepTitle(\'Select Duration\')" class="bb-duration-list">\r\n    <div class="panel panel-default" ng-repeat="duration in durations">\r\n      <div class="panel-body">\r\n        <div class="row bb-vertical-align-center">\r\n          <div class="col-sm-8 col-xs-6">\r\n            <h2 class="panel-title">{{duration.pretty}}</h2>\r\n            <div ng-if="duration.description">\r\n              {{duration.description}}\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-6">\r\n            <div class="bb-duration-price">\r\n              <span ng-show="duration.price > 0">{{duration.price | currency}}</span>\r\n              <span ng-show="duration.price == 0">Free</span>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-12">\r\n            <button type="button" ng-click="selectDuration(duration)" class="btn btn-primary btn-block">Select</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>'),$templateCache.put("event.html",'<div bb-page>\r\n\r\n  <div bb-event ng-class="{\'has-image\': event.image, \'no-image\': !event.image}">\r\n\r\n    <div class="event-header" ng-style="event.image.background_css">\r\n      <div class="event-details">\r\n        <h1>{{event.chain.name}}</h1>\r\n        <ul class="event-summary-list">\r\n          <li class="date-time">\r\n            <span class="bb-icon icon-calendar"></span>\r\n            <span>{{event.date.format(\'dddd Do MMMM YYYY\')}} at <span class="event-time">{{event.date.format(\'HH:mm\')}}</span></span>\r\n          </li>\r\n          <li class="location" ng-show="event.chain.address">\r\n            <span class="bb-icon icon-location"></span>\r\n            <span>{{event.chain.address | address_single_line}}</span>\r\n          </li>\r\n          <li class="tickets" ng-show="event.tickets && event.getSpacesLeft() > 0">\r\n            <span class="bb-icon icon-ticket"></span>\r\n            <span>{{event.getSpacesLeft()}} ticket<span ng-if="event.getSpacesLeft() > 1">s</span> remaining</span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-description" ng-show="event.chain.description">\r\n      <div class="panel-body">\r\n        <p ng-bind-html="event.chain.description"></p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-tickets">\r\n      <div class="panel-body">\r\n        <h2 class="heading">Tickets</h1>\r\n        <div ng-form name="ticket_form" class="bb-form" role="form">\r\n\r\n          <ul class="ticket-list">\r\n            <li class="header">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6">Type</div>\r\n                <div class="col-sm-3 col-xs-4">Price</div>\r\n                <div class="col-sm-3 col-xs-2">Qty</div>\r\n              </div>\r\n            </li>\r\n            <li ng-repeat="ticket in tickets">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6">\r\n                  <span>{{ticket.fullName() || ticket.name}}</span>\r\n                </div>\r\n                <div class="col-sm-3 col-xs-4">\r\n                  <span ng-if="ticket.price > 0">{{ticket.price | currency}}</span><span ng-if="ticket.price == 0">Free</span>\r\n                  <small ng-if="ticket.counts_as"><i>(for {{ticket.counts_as}})</i></small>\r\n                </div>\r\n                <div class="col-sm-3 col-xs-2">\r\n                  <span ng-if="selected_tickets">{{ticket.qty}}</span>\r\n                  <select ng-if="!selected_tickets" ng-model="ticket.qty" ng-options="n as n for n in ticket.getRange(20)"></select>\r\n                </div>\r\n              </div>\r\n              <div ng-repeat="prepaid in pre_paid_bookings">\r\n                Use pre-paid booking? {{prepaid.remaining}} remaining\r\n                <label class="radio-inline">\r\n                  <input type="radio" ng-model="ticket.pre_paid_booking_id"\r\n                    name="prepaid{{$index}}" id="prepaid{{$index}}yes" ng-value="prepaid.id"> Yes\r\n                </label>\r\n                <label class="radio-inline">\r\n                  <input type="radio" ng-model="ticket.pre_paid_booking_id"\r\n                    name="prepaid{{$index}}" id="prepaid{{$index}}no" ng-value="null"> No\r\n                </label>\r\n              </div>\r\n            </li>\r\n            <li ng-if="bb.basket.questionPrice()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Booking Fee</div>\r\n                <div class="col-sm-3">{{bb.basket.questionPrice() | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="selected_tickets && bb.basket.hasCoupon()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Original Cost</div>\r\n                <div class="col-sm-3 col-xs-6">{{bb.basket.fullPrice() | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="selected_tickets && bb.basket.hasCoupon()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Coupon Discount</div>\r\n                <div class="col-sm-3 col-xs-6">{{(bb.basket.fullPrice() - bb.basket.totalPrice()) | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-if="selected_tickets && (bb.basket.hasCoupon() || bb.basket.totalPrice())">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Total</div>\r\n                <div class="col-sm-3 col-xs-6"><strong>{{bb.basket.totalPrice() | currency}}</strong>\r\n                </div>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n\r\n\r\n          <div class="button-group" ng-if="!selected_tickets">\r\n            <div class="row">\r\n              <div class="col-sm-offset-9 col-sm-3" ng-show="event.getSpacesLeft() > 0">\r\n                <button type="button" class="btn btn-primary pull-right" ng-disabled="event.tickets[0].qty <= 0 " ng-click="selectTickets()">Reserve Ticket<span ng-if="event.tickets[0].qty > 1">s</span></button>\r\n              </div>\r\n              <div class="col-sm-offset-9 col-sm-3" ng-show="event.getSpacesLeft() <= 0 && bb.company.settings.has_waitlists">\r\n                <button type="button" class="btn btn-primary pull-right" ng-disabled="event.tickets[0].qty <= 0 " ng-click="selectTickets()">Join Waitlist</button>\r\n              </div>\r\n            </div>\r\n          </div> \r\n\r\n\r\n          <div ng-if="selected_tickets" bb-basket-list class="button-group row">\r\n            <div class="col-sm-4 col-sm-offset-8">\r\n              <form class="form-inline">\r\n                <div class="form-group">\r\n                  <label for="coupon_code">Apply a coupon:</label>\r\n                  <div class="input-group">\r\n                    <input type="text" class="form-control input-sm" id="coupon_code" name="coupon_code" ng-model="coupon_code" placeholder="Enter a coupon code">\r\n                    <span class="input-group-btn">\r\n                      <button type="button" class="btn btn-primary btn-sm" ng-click="applyCoupon(coupon_code)">Apply</button>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\r\n    <div class="panel panel-default event-client-details" ng-if="selected_tickets">\r\n      <div class="panel-body">\r\n\r\n        <form name="booking_form" class="form-horizontal" role="form" novalidate bb-form>\r\n        \r\n          <div ng-form name="client_form" class="bb-form" role="form" novalidate>\r\n\r\n            <h2 class="booking-form-header">Your details</h2>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.first_name.$invalid && (client_form.first_name.$dirty || booking_form.submitted)}">\r\n              <label for="first_name" class="control-label col-sm-4">First Name:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="first_name" id="first_name" required ng-model="client.first_name" class="form-control"/>\r\n              </div>\r\n              <div class="col-sm-offset-4 messages">\r\n                <div class="error-message" ng-show="client_form.first_name.$invalid && booking_form.submitted">\r\n                  Please enter your first name\r\n                </div>\r\n              </div> \r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.last_name.$invalid && (client_form.last_name.$dirty|| booking_form.submitted)}">\r\n              <label for="last_name" class="control-label col-sm-4">Last Name:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="last_name" id="last_name" required ng-model="client.last_name" class="form-control"/>\r\n              </div>\r\n              <div class="col-sm-offset-4 messages">\r\n                <div class="error-message" ng-show="client_form.last_name.$invalid && booking_form.submitted">\r\n                  Please enter your last name\r\n                </div>          \r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.email.$invalid && (client_form.email.$dirty|| booking_form.submitted)}">\r\n              <label for="email" class="control-label col-sm-4">Email:</label>\r\n              <div class="col-sm-5">\r\n                <input type="email" name="email" id="email" required ng-model="client.email" class="form-control"/>\r\n              </div>\r\n              <div class="col-sm-offset-4 messages">\r\n                <div class="error-message" ng-show="client_form.email.$invalid && booking_form.submitted">\r\n                  Please enter a valid email address\r\n                </div>          \r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.mobile.$invalid && ((client_form.mobile.$dirty && !client_form.mobile.$focused) || booking_form.submitted)}">\r\n              <label for="mobile" class="control-label col-sm-4">Mobile:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="mobile" id="mobile" ng-pattern="validator.getMobilePattern()" ng-model="client.mobile" class="form-control" bb-focus/>\r\n              </div>\r\n            </div>\r\n\r\n            <div bb-client-details ng-show="client_details.hasQuestions">\r\n\r\n              <div class="form-group" ng-repeat="question in client_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{ \'check\': question.detail_type == \'check\', \'has-error\': client_form[\'q\' + question.id].$invalid && (client_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n                <label ng-hide="question.detail_type == \'check\'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span></label>\r\n                <div ng-show="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n                <div class="col-sm-5">\r\n                  <input bb-question="question"/>\r\n                </div>\r\n                <div class="col-sm-offset-4 messages">\r\n                  <div class="error-message" ng-show="client_form[\'q\' + question.id].$invalid && ( client_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                    This field is required\r\n                  </div>\r\n                </div> \r\n              </div>   \r\n\r\n            </div>\r\n\r\n          </div>\r\n\r\n          <div ng-repeat="item in bb.basket.timeItems()" bb-count-ticket-types="bb.basket.timeItems()">\r\n\r\n            <h2 class="booking-form-header">Ticket {{$index + 1}}</h2>\r\n\r\n            <div bb-item-details="item">\r\n              <div ng-form name="booking_questions_form">\r\n                <div class="form-group" ng-class="{\'has-error\': booking_questions_form.first_name.$invalid && (booking_questions_form.first_name.$dirty|| booking_form.submitted)}">\r\n                  <label for="first_name" class="control-label col-sm-4">Attendee {{$index + 1}} First Name:</label>\r\n                  <div class="col-sm-5">\r\n                    <input type="text" name="first_name" id="first_name" required ng-model="item.first_name" class="form-control"/>\r\n                  </div>\r\n                  <div class="col-sm-offset-4 messages">\r\n                    <div class="error-message" ng-show="booking_questions_form.first_name.$invalid && booking_form.submitted">\r\n                      Please enter a first name for this attendee\r\n                    </div>          \r\n                  </div>\r\n                </div>\r\n                <div class="form-group" ng-class="{\'has-error\': booking_questions_form.last_name.$invalid && (booking_questions_form.last_name.$dirty|| booking_form.submitted)}">\r\n                  <label for="last_name" class="control-label col-sm-4">Attendee {{$index + 1}} Last Name:</label>\r\n                  <div class="col-sm-5">\r\n                    <input type="text" name="last_name" id="last_name" required ng-model="item.last_name" class="form-control"/>\r\n                  </div>\r\n                  <div class="col-sm-offset-4 messages">\r\n                    <div class="error-message" ng-show="booking_questions_form.last_name.$invalid && booking_form.submitted">\r\n                      Please enter last name for this attendee\r\n                    </div>          \r\n                  </div>\r\n                </div>\r\n                <div class="form-group" ng-class="{\'has-error\': booking_questions_form.email.$invalid && (booking_questions_form.email.$dirty|| booking_form.submitted)}">\r\n                  <label for="email" class="control-label col-sm-4">Attendee {{$index + 1}} Email:</label>\r\n                  <div class="col-sm-5">\r\n                    <input type="email" name="email" id="email" required ng-model="item.email" class="form-control"/>\r\n                  </div>\r\n                  <div class="col-sm-offset-4 messages">\r\n                    <div class="error-message" ng-show="booking_questions_form.email.$invalid && booking_form.submitted">\r\n                      Please enter a valid email address for this attendee\r\n                    </div>          \r\n                  </div>\r\n                </div>\r\n                <div class="form-group" ng-repeat="question in item_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{\'has-error\': booking_questions_form[\'q\' + question.id].$invalid && (booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n                  <label for="{{question.id}}" class="control-label col-sm-4">{{question.name}}</label>\r\n                  <div class="col-sm-5">\r\n                    <input bb-question="question"/>\r\n                  </div>\r\n                  <div class="col-sm-offset-4 messages">\r\n                    <div class="error-message" ng-show="booking_questions_form[\'q\' + question.id].$invalid && ( booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                      This field is required\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n\r\n          <div class="button-group bordered">\r\n            <div class="row">\r\n              <div class="col-sm-offset-9 col-sm-3" ng-show="event.getSpacesLeft() > 0">\r\n                <button type="submit" class="btn btn-primary pull-right" ng-click="validator.validateForm(booking_form) && checkReady() && routeReady()">Book Ticket<span ng-if="event.tickets[0].qty > 1">s</span></button>\r\n              </div>\r\n              <div class="col-sm-offset-9 col-sm-3" ng-show="event.getSpacesLeft() <= 0 && bb.company.settings.has_waitlists">\r\n                <button type="submit" class="btn btn-primary pull-right" ng-click="validator.validateForm(booking_form) && checkReady() && routeReady()">Confirm</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n        </form>\r\n\r\n      </div>\r\n    </div><!-- selected_tickets -->\r\n\r\n    <div class="panel panel-default">\r\n      <div class="panel-body">\r\n        <div ng-show="event.chain.long_description">\r\n          <h2 class="heading">Event details</h2>\r\n          <p class="event-long-description" ng-bind-html="event.chain.long_description" ng-show="event.chain.long_description"></p>\r\n        </div>\r\n        \r\n        <div bb-custom-booking-text class="bb-custom-booking-text text-block">\r\n          <p ng-repeat="msg in messages" ng-bind-html="msg"></p>\r\n        </div>\r\n\r\n<!--         <div bb-address-map="event.chain.address">\r\n          <div ng-if="event.chain.address" ui-options="mapOptions" class="map-canvas" ng-delayed="ui-map" ng-delayed-value="myMap" ng-delayed-watch="mapReady" ng-delayed-ready="mapLoaded"></div>\r\n          <div ng-repeat="marker in mapMarkers" ui-map-marker="mapMarkers[$index]"></div>\r\n        </div> -->\r\n        <div bb-address-map="event.chain.address">\r\n          <ui-gmap-google-map ng-if="event.chain.address.lat"center=\'map.center\' zoom=\'map.zoom\' options="options">\r\n            <ui-gmap-marker coords="marker.coords" idkey="marker.id">\r\n            </ui-gmap-marker>\r\n          </ui-gmap-google-map>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\r\n    <div class="bb-step-navigation">\r\n      <div class="row">\r\n        <div class="col-sm-6 text-left">\r\n          <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()">Back</button>\r\n<!--           <div class="warning" ng-show="selected_tickets">\r\n            <p>Please note that your tickets will be unreserved if you need to amend your selection.</p>\r\n          </div> -->\r\n        </div>\r\n      </div>\r\n    </div> \r\n\r\n\r\n  </div>\r\n\r\n</div>\r\n'),$templateCache.put("event_group_list.html",'<div bb-event-groups>\r\n\r\n  <div class="panel panel-default" ng-repeat="item in items">\r\n    <div class="panel-body">\r\n      <h2 class="panel-title item-name">{{item.name}}</h2>\r\n      <div class="row">\r\n<!--         <div class="col-sm-2 service-image">\r\n          <img ng-src="{{item.extra.image_url}}" class="img-responsive"/>\r\n        </div> -->\r\n        <div class="col-sm-8 col-xs-9 item-description">\r\n          {{item.description}}\r\n        </div>\r\n        <div class="col-sm-2 col-xs-3 item-price" ng-if="item.price">\r\n          <span class="currency-symbol"></span>{{item.price}}\r\n        </div>\r\n      </div>\r\n      <div class="row">\r\n        <div class="col-sm-2 col-sm-offset-10 service-select">\r\n          <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n\r\n'),$templateCache.put("event_list.html",'<div bb-events="{mode: 2}">\r\n\r\n  <div class="page-header">\r\n    <h1>Events at {{company.name}}</h1>\r\n  </div>\r\n\r\n  <div class="bb-month-picker" bb-month-picker day-data="item_dates">\r\n    <div class="bb-month-nav">\r\n      <button type="button" class="btn btn-icon btn-xl month-prev">\r\n        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> <span class="sr-only">Previous</span>\r\n      </button>\r\n    </div>\r\n    <div class="bb-months">\r\n\r\n      <div bb-slick="[{breakpoint: 920, settings: {slidesToShow: 1}},{breakpoint: 1199, settings: {slidesToShow: 2}}]"></div>\r\n\r\n    </div>\r\n\r\n    <div class="bb-month-nav">\r\n      <button type="button" class="btn btn-icon btn-xl month-next">\r\n        <span class="sr-only">Next</span> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\r\n      </button>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <div class="events" ng-show="items" bb-scroll-to="page:changed" bb-always-scroll>\r\n\r\n    <div class="bb-filters">\r\n\r\n      <div accordion close-others="true">\r\n        <div accordion-group is-open="is_open" ng-class="{\'expanded\': is_open, \'selected\': is_selected}" class="store-body">\r\n\r\n          <div accordion-heading class="filter-header">\r\n            <span>Filter</span>\r\n            <span class="glyphicon glyphicon-filter" aria-hidden="true"></span>\r\n          </div>\r\n\r\n          <form class="form-inline">\r\n\r\n            <div class="form-group">\r\n              <label class="sr-only" for="event_group">Category</label>\r\n              <select class="form-control" name="event_group" id="event_group" ng-model="filters.event_group" ng-options="event_group.name for (id, event_group) in event_groups" ng-change="filterChanged()">\r\n                <option value="">Any Category</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <label class="sr-only" for="date">Date</label>\r\n              <div class="input-group date-picker">\r\n                <!-- date format: http://docs.angularjs.org/api/ng.filter:date" -->\r\n                <input type="text" ng-model="filters.date" class="form-control"\r\n                  bb-datepicker-popup="DD/MM/YYYY"\r\n                  datepicker-popup="dd/MM/yyyy"\r\n                  is-open="opened"\r\n                  min-date="today"\r\n                  on-date-change="filterDateChanged()"\r\n                  datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n                  show-weeks="false"\r\n                  show-button-bar="false"\r\n                  ng-readonly="display.xs"\r\n                  name="date"\r\n                  id="date"\r\n                  placeholder="Any Date"/>\r\n                <span class="input-group-btn" ng-click="$event.preventDefault();$event.stopPropagation();opened=true">\r\n                  <button class="btn btn-default" type="submit" title="Pick date"><span class="glyphicon glyphicon-calendar"></span></button>\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <label class="sr-only" for="price">Price</label>\r\n              <select class="form-control" name="price" id="price" ng-model="filters.price" ng-options="price as (price | currency) for price in price_options" ng-change="filterChanged()">\r\n                <option value="">Any Price</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div class="form-group" ng-repeat="select_filter in dynamic_filters.select" ng-show="has_company_questions">\r\n              <label class="sr-only" for="event_group">{{select_filter.name}}</label>\r\n              <select class="form-control" name="select_filter" id="select_filter" ng-model="dynamic_filters.values[select_filter.name]" ng-options="answer.name for answer in select_filter.question_items" ng-change="filterChanged()">\r\n                <option value="">Any {{select_filter.name}}</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <button type="button" class="btn btn-link" ng-click="filters.hide_sold_out_events =! filters.hide_sold_out_events; filterChanged()">\r\n                <span ng-hide="filters.hide_sold_out_events">Hide Sold Out Events</span>\r\n                <span ng-show="filters.hide_sold_out_events">Show Sold Out Events</span>\r\n              </button>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <button type="button" class="btn btn-link" ng-click="resetFilters()">\r\n                <span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>\r\n                Reset\r\n              </button>\r\n            </div>\r\n\r\n          </form>\r\n\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class="panel panel-default bb-filter-summary">\r\n      <span ng-show="!filter_active">Showing all events</span>\r\n      <span ng-show="filter_active">Showing filtered events</span>    \r\n      <div class="pull-right">\r\n        {{pagination.summary}} Events\r\n      </div>\r\n    </div>\r\n\r\n   <!--  Gift Cert Button (Needs Styling) -->\r\n   <div ng-if="bb.company_settings.has_vouchers">\r\n      <button type="button" ng-click="showPage(\'deal_list\')" class="btn btn-primary btn-block">\r\n        <span>Buy Gift Certificates </span>\r\n      </button>\r\n    </div>\r\n\r\n    <div class="bb-events-list">\r\n      <div class="panel panel-default bb-event-card" ng-repeat="item in filtered_items | startFrom: (pagination.current_page - 1) * pagination.page_size | limitTo: pagination.page_size" ng-show="pagination.num_items > 0">\r\n        <div class="panel-body">  \r\n          <div class="row vertical-row-align">\r\n            <div class="col-sm-10 col-xs-12 event-details">\r\n              <h3>{{item.description}}</h3>\r\n              <ul class="event-summary-list">\r\n                <li class="date-time">\r\n                  <span class="bb-icon icon-calendar"></span>\r\n                  <span>{{item.date.format(\'dddd Do MMMM YYYY\')}} at <span class="event-time">{{item.date.format(\'h[:]mma\')}}</span></span>\r\n                </li>\r\n                <li class="location" ng-show="item.chain.address">\r\n                  <span class="bb-icon icon-location"></span>\r\n                  <span>{{item.chain.address | address_single_line}}</span>\r\n                </li>\r\n                <li class="tickets" ng-show="item.tickets && item.getSpacesLeft() > 0">\r\n                  <span class="bb-icon icon-ticket"></span>\r\n                  <span>{{item.getSpacesLeft()}} ticket<span ng-if="item.getSpacesLeft() > 1">s</span> remaining</span>\r\n                </li>\r\n                <li class="price" ng-show="item.tickets">\r\n                  <span class="bb-icon icon-price"></span>\r\n                  <span ng-show="item.price_range && (item.price_range.from != item.price_range.to)">From {{item.price_range.from | currency}}</span>\r\n                  <span ng-show="item.price_range && (item.price_range.from == item.price_range.to)">{{item.price_range.from | currency}}</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div class="col-sm-2 event-select">\r\n              <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block" ng-disabled="item.getSpacesLeft() == 0 && !bb.company.settings.has_waitlists">\r\n                <span ng-show="item.getSpacesLeft() > 0">Select</span>\r\n                <div ng-show="item.getSpacesLeft() <= 0 && !bb.company.settings.has_waitlists">\r\n                  <span class="status-sold-out">Sold out</span>\r\n                </div>\r\n                <div ng-show="item.getSpacesLeft() <= 0 && bb.company.settings.has_waitlists">\r\n                  <span>Join Waitlist</span>\r\n                </div>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="panel panel-default"ng-show="pagination.num_items == 0">\r\n        <div class="panel-body">\r\n          <p>No events found</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <pagination total-items="pagination.num_items" ng-model="pagination.current_page" items-per-page="pagination.page_size" max-size="pagination.max_size" boundary-links="true" rotate="false" num-pages="pagination.num_pages" ng-show="items" ng-change="pageChanged()"></pagination>\r\n\r\n  </div>\r\n\r\n</div>\r\n'),
$templateCache.put("loader.html","<div class='bb-loader' ng-hide='scopeLoaded'>\r\n  <div id='loading_icon'>\r\n    <div id='wait_graphic'>&nbsp;</div>\r\n  </div>\r\n</div>"),$templateCache.put("main.html",'<div class="header">\r\n\r\n  <div bb-form-data-store></div>\r\n\r\n  <!-- BREADCRUMB ROUTE\r\n  <div bb-breadcrumbs class="breadcrumbs_holder" ng-init="setRoute([\r\n    {page:\'event_list\', title: \'Select an event\'},\r\n    {page:\'event\', title: \'Event\'},\r\n    {page:\'checkout\', title: \'Confirmation\'}\r\n    ])">\r\n\r\n    <ol class="breadcrumb"> \r\n      <li ng-repeat="step in bb.allSteps" ng-class="{\'active\': step.active, \'passed\': step.passed, \'disabled\': isDisabledStep(step)}">\r\n        <button type="button" ng-click="loadStep(step.number)" ng-class="{\'active\': step.active, \'passed\': step.passed}" ng-disabled="isDisabledStep(step)">\r\n          <span class="step-num">{{step.number}}.</span>\r\n          <span class="step-title">{{step.title}}</span>\r\n        </button>\r\n      </li>\r\n    </ol>\r\n  </div> \r\n  -->\r\n\r\n  <!-- PROGRESSBAR\r\n  <div progressbar value="bb.percentage_complete" type="primary"></div>\r\n  -->\r\n\r\n  <!-- STEP INDICATOR\r\n  <div ng-if="bb.current_step" class="step-heading">\r\n    <span ng-if="bb.current_step != 1 && bb.current_step <  bb.allSteps.length" ng-bind="\'Step \' + (bb.current_step - 1) + \' of \' + (bb.allSteps.length - 2)"></span>\r\n    <span ng-if="bb.current_step == bb.allSteps.length" ng-bind="\'Complete\'"></span>\r\n  </div> -->\r\n\r\n  <div class="alerts" bb-scroll-to="alert:raised" bb-always-scroll>\r\n    <div alert ng-repeat="alert in $root.alerts" type="{{alert.type}}" >\r\n     <ul>\r\n       <li ng-bind-html="alert.msg"></li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="content">\r\n\r\n  <div bb-content class="ng-cloak"></div>\r\n  <div bb-display-mode></div>\r\n\r\n  <div bb-loading class="bb-loader" >\r\n    <div id="loading_icon">\r\n      <div id="wait_graphic">&nbsp;</div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="footer">\r\n  <div ng-show="isLoaded" class="powered-by">\r\n    <span>Bookings powered by <a href="http://www.bookingbug.com" style="text-decoration:none" target="_blank"><span style="color:#087f94">booking</span><span style="color:#88c66f">bug</span></a></span>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("main_view_booking.html",'<header>\r\n<!--   <div bb-breadcrumbs class="breadcrumbs_holder" ng-init="setRoute([\r\n      {page:\'purchase\', title: \'Your booking\'}\r\n      ])">\r\n  </div> -->\r\n\r\n  <div class="alerts" bb-scroll-to="alert:raised">\r\n   <div alert ng-repeat="alert in $root.alerts" type="{{alert.type}}">\r\n     <ul>\r\n       <li ng-bind-html="alert.msg"></li>\r\n     </ul>\r\n   </div>\r\n </div>\r\n</header>\r\n<section class="content">\r\n  <div bb-content class="ng-cloak"></div>\r\n  <div bb-loading class="bb-loader" >\r\n    <div id="loading_icon">\r\n      <div id="wait_graphic">&nbsp;</div>\r\n    </div>\r\n  </div>\r\n</section>'),$templateCache.put("map.html",'<div id="map" bb-map class="bb-store-search" ng-init="checkStepTitle(\'Select a company\')">\r\n\r\n  <div class="page-summary">\r\n    <p>Search for a store to begin your booking.</p>\r\n  </div>\r\n\r\n  <div class="panel panel-default">\r\n    <div class="panel-body" >\r\n      <div class="row search-form-wrapper">\r\n        <div class="col-xs-10 col-sm-6 col-sm-offset-3">\r\n          <form role="form" ng-submit="searchAddress({region: \'GB\', componentRestrictions: {\'country\': \'GB\'}, bounds: {sw:{x:\'50.064192\',y:\'-9.711914\'}, ne:{x:\'61.015725\',y:\'3.691406\'}}});">\r\n            <div class="form-group" style="width: 100%;">\r\n              <label class="sr-only" for="search-stores">Search</label>\r\n              <div class="input-group">\r\n                <input type="text" ng-model="address" class="form-control input-lg" id="search-stores" placeholder="Enter a town, city, postcode or store name">\r\n                <span class="input-group-btn">\r\n                  <button class="btn btn-primary btn-lg" type="submit" title="Search"><span class="glyphicon glyphicon-search"></span></button>\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n        <div class="col-xs-2">\r\n          <button type="button" class="btn btn-default btn-lg" title="use current location" ng-click="geolocate()">\r\n            <span class="glyphicon glyphicon-screenshot"></span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-show="loc">\r\n\r\n    <h2 class="company-map-header">{{shownMarkers.length}} results for stores near {{address}}</h2>\r\n\r\n    <div class="company-map row">\r\n\r\n      <div class="bb-map-block col-sm-8 col-sm-push-4">\r\n        <div ng-delayed="ui-map" ng-delayed-value="myMap" ng-delayed-watch="mapReady" ng-delayed-ready="mapLoaded" ui-options="mapOptions" class="map-canvas"></div>\r\n        <div ng-repeat="marker in mapMarkers" ui-map-marker="mapMarkers[$index]" ui-event="{\'map-click\': \'openMarkerInfo(marker)\'}"> </div>\r\n        <div ui-map-info-window="myInfoWindow" class="clearfix">\r\n\r\n          <p><strong>{{currentMarker.company.name}}</strong></p>\r\n          <p ng-bind-html="currentMarker.company.address | address_multi_line"></p>\r\n          <p><strong>Phone:</strong> {{currentMarker.company.address.phone | uk_local_number}}</p>\r\n          <p>\r\n            <span ng-if="currentMarker.company.extra.closing_time"><strong>{{currentMarker.company.extra.closing_time}}</strong></span>\r\n            <span class="distance">{{roundNumberUp(currentMarker.distance,1)}}mi</span>\r\n          </p>\r\n          <button type="button" ng-click="selectItem(currentMarker.company)" class="btn btn-primary" ng-show="currentMarker.company.live">select</button>\r\n\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div class="bb-company-block col-sm-4 col-sm-pull-8" >\r\n\r\n        <div accordion close-others="true">\r\n          <div accordion-group is-open="is_open" ng-class="{\'expanded\': is_open, \'selected\': is_selected}" ng-repeat="marker in shownMarkers" class="store-body" ng-init="is_open = $first">\r\n\r\n            <div accordion-heading class="store-header">\r\n              <span><strong>{{$index+1}}.</strong> {{marker.company.name}}</span>\r\n              <span class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': is_open, \'glyphicon-chevron-right\': !is_open}"></span>\r\n            </div>\r\n\r\n            <ul class="store-details" ng-click="openMarkerInfo(marker)">\r\n              <li ng-bind-html="marker.company.address | address_multi_line"></li>\r\n              <li><strong>Phone:</strong> {{marker.company.address.phone | uk_local_number}}</li>\r\n              <li>\r\n                <span class="distance">{{roundNumberUp(marker.distance,1)}}mi</span>\r\n              </li>\r\n            </ul>\r\n            <button type="button" ng-click="selectItem(marker.company)" class="btn btn-primary pull-right">Select</button>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n \r\n    </div>\r\n  </div>\r\n  <div ng-if="loc"class="bb-step-navigation">\r\n  </div>\r\n</div>\r\n'),$templateCache.put("membership_levels.html",'<div bb-membership-levels>\r\n  <div>\r\n    <h2 class="booking-form-header">Membership Types</h2>\r\n  </div>\r\n  <div>\r\n    <div class="form-group" ng-repeat="level in membership_level">\r\n      <span ng-if="level.name">{{level.name}}</span>\r\n      <button class="btn btn-primary btn-block" ng-click="selectLevel(level)">Select</button>\r\n    </div>\r\n  </div>\r\n</div>'),$templateCache.put("payment.html",'<div bb-payment class="bb-payment" ng-init="checkStepTitle(\'Pay\')">\r\n\r\n  <div id="bb-payment">\r\n    <iframe id="bb-widget" ng-src="{{url}}" width="100%" height="930px" scrolling="no" frameborder="0"></iframe>\r\n  </div>\r\n\r\n</div>\r\n'),$templateCache.put("person_list.html",'<div bb-include="_service_item_aggregate">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-people ng-init="checkStepTitle(\'Select a person\')">\r\n    <div class="panel panel-default" ng-repeat="item in bookable_items">\r\n      <div class="panel-body">\r\n        <div class="row bb-vertical-align-center">\r\n          <div class="col-sm-10">\r\n            <h2 class="panel-title">{{ item.name }}</h2>\r\n            <div class="row">\r\n              <div class="col-sm-2">\r\n                <image ng-src="" class="img-responsive" />\r\n              </div>\r\n              <div class="col-sm-10">\r\n                <!-- Description? -->\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2">\r\n            <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" ng-show="bb.current_step > 1" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>'),$templateCache.put("print_purchase.html",'<% content_for :head do %>\r\n<script src="/assets/widget.js" type="text/javascript"></script>\r\n<link href="/assets/angular/widget/main.css" media="all" rel="stylesheet" type="text/css" />\r\n<link href="/assets/angular/widget/bb_light_theme.css" type="text/css" media="all" rel="stylesheet" />\r\n<% end %>\r\n\r\n<%\r\nscp = {}\r\nif params[:base]\r\n  scp[:page_suffix] = "?base=#{params[:base]}"\r\nend\r\n\r\n%>\r\n\r\n<div bb-widget="<%=scp.to_json%>" >\r\n  <div bb-purchase="{}" class="bb-checkout">\r\n    <div class="container content">\r\n      <div class="row">\r\n        <div class="col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">\r\n\r\n          <div class="confirmation-header bb-confirmation-border-margin">\r\n            <h2>Booking Confirmation Details</h2>\r\n            <p class="bb-confirmation-p-alignment">Thanks. Your booking is now confirmed. We have you emailed you the details below.</p>\r\n            <div class="pull-right hidden-print" >\r\n              <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n              <button type="button" class="btn btn-link" onclick="" popover="<a class=\'image img_outlook\' title=\'Add this booking to an Outlook Calendar\' href=\'http://blinkbrowbar.bookingbug.com/ical/total/UkICc5s-2yzH09PqNzE%3D\'><img alt=\'\' src=\'https://www.bookingbug.com/assets/outlook.png\'></a> <a class=\'image img_ical\' title=\'Add this booking to an iCal Calendar\' href=\'http://blinkbrowbar.bookingbug.com/ical/total/UkICc5s-2yzH09PqNzE%3D\'><img alt=\'\' src=\'https://www.bookingbug.com/assets/ical.png\'></a> <a class=\'image img_gcal\' title=\'Add this booking to Google Calendar\' href=\'http://www.google.com/calendar/event?dates=20150120T120000Z%2F20150120T123000Z&details=&location=Chair&sprop=www.bookingbug.com&text=Booking%3A+Ayurvedic+Eye+Soother+with+Romana+-+Chair+at+Bristol&trp=false&action=TEMPLATE\' target=\'_blank\'><img src=\'https://www.bookingbug.com/assets/gcal.png\' border=\'0\'></a>" popover-placement="bottom"><span class="glyphicon glyphicon-calendar"></span> Export to calendar</button>\r\n            </div>\r\n          </div>\r\n\r\n          <ul class="confirmation-summary" ng-repeat="i in purchase.items">\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Item:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.full_describe}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Date and Time:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.describe}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Quantity:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.quantity}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Booking Reference:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.id}}</div>\r\n            </li>\r\n          </ul>\r\n\r\n          <div ng-repeat="msg in messages" ng-bind-html="msg" class="bb-message">\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n</div>\r\n\r\n<footer>\r\n  <div class="powered-by hidden-print">\r\n    <p>Bookings powered by <span style="color:#087f94">booking</span><span style="color:#88c66f">bug</p>\r\n    <a href="http://www.bookingbug.com" style="text-decoration:none" target="_blank"></a>\r\n  </div>\r\n</footer>\r\n'),$templateCache.put("purchase.html",'<div bb-purchase="{move_route: \'calendar\'}">\r\n\r\n  <div class="bb-checkout">\r\n\r\n    <div class="row">\r\n\r\n      <div class="col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">\r\n\r\n        <div ng-if="purchase && bookings.length == 0">\r\n          <div class="confirmation-header">\r\n            <h2 class="confirmation-heading">Your booking has been cancelled</h2>\r\n          </div>\r\n        </div>\r\n\r\n        <div ng-if="bookings">\r\n          <div ng-show="is_waitlist">\r\n            <div bb-include="book_waitlist"></div>\r\n          </div>\r\n          <div ng-hide="is_waitlist">\r\n            <div class="confirmation-header">\r\n              <h2 class="confirmation-heading">Your {{purchase.bookings[0].service_name}} booking</h2>\r\n              <!-- <p ng-if="bb.current_item.move_done" class="move-done-msg">Your booking has been moved to <strong>{{purchase.bookings[0].datetime | datetime: "h:mma dddd Do MMMM"}}</strong>.</p> -->\r\n              <div class="row hidden-print text-right" >\r\n              <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n              <div bb-booking-export class="bb-booking-export"></div>\r\n              </div>\r\n            </div>\r\n\r\n            <ul class="confirmation-summary bb-checkout-top-border">\r\n              <li class="row confirmation-summary-item">\r\n                <div class="col-xs-3">Name:</div>\r\n                <div class="col-xs-9">{{purchase.client.name}}</div>\r\n              </li>\r\n              <li class="row confirmation-summary-item">\r\n                <div class="col-xs-3">Email:</div>\r\n                <div class="col-xs-9">{{purchase.client.email}}</div>\r\n              </li>\r\n              <li class="row confirmation-summary-item">\r\n                <div class="col-xs-3">Service:</div>\r\n                <div class="col-xs-9">{{purchase.bookings[0].service_name}}</div>\r\n              </li>\r\n              <li class="row confirmation-summary-item">\r\n                <div class="col-xs-3">When:</div>\r\n                <div class="col-xs-9">{{purchase.bookings[0].datetime | datetime: "h:mma dddd Do MMMM":false}}</div>\r\n              </li>\r\n              <li class="row confirmation-summary-item">\r\n                <div class="col-xs-3">Where:</div>\r\n                <div class="col-xs-9">\r\n                  <ul class="address">\r\n                    <li class="address-item">{{bb.company.name}}</li>\r\n                    <li class="address-item">{{bb.company.getAddress() | address_single_line}}</li>\r\n                    <li class="address-item">{{bb.company.getAddress().phone | uk_local_number}}</li>\r\n                  </ul>\r\n                </div>\r\n              </li>\r\n              <li class="row confirmation-summary-item">\r\n                <div class="col-xs-3">Price:</div>\r\n                <div class="col-xs-9">{{purchase.total_price | currency }}</div>\r\n              </li>\r\n            </ul>\r\n\r\n            <div class="payment">\r\n              <div bb-custom-confirmation-text class="text-block-sml bb-message-buffer" ng-show="messages">\r\n                <p ng-repeat="msg in messages" ng-bind-html="msg"></p>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="hidden-print">\r\n              <div class="bb-step-navigation">\r\n                <div class="col-sm-4">\r\n                  <button type="button" class="btn btn-secondary btn-block" ng-click="delete(bookings[0])">Cancel Booking</button>\r\n                </div>\r\n                <div class="col-sm-4">\r\n                  <button type="button" class="btn btn-primary btn-block" ng-click="move(bookings[0], \'\', {use_resource: true})">Move Booking</button>\r\n                </div>\r\n                <div ng-show="waitlist_bookings"class="col-sm-4">\r\n                  <button type="button" class="btn btn-primary btn-block" ng-click="is_waitlist = true">Book Waitlist Items</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n       </div>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n<!--   <div ng-show="bb.moving_booking && !bb.current_item.move_done" bb-scroll-to="booking:move" bb-always-scroll class="move-booking-container hidden-print">\r\n    <hr>\r\n    <h2 ng-hide="purchase && bookings.length == 0">Move your booking</h2>\r\n    <div bb-content></div>\r\n  </div> -->\r\n\r\n</div>'),$templateCache.put("resource_list.html",'<div bb-include="_service_item_aggregate">\r\n</div>\r\n\r\n  <div class="bb-subcontent">\r\n\r\n    <div bb-resources ng-init="checkStepTitle(\'Select a resource\')">\r\n      <div class="panel panel-default" ng-repeat="item in all_resources">\r\n        <div class="panel-body">\r\n          <div class="row bb-vertical-align-center">\r\n            <div class="col-sm-10">\r\n              <h2 class="panel-title">{{ item.name }}</h2>\r\n              <div class="row">\r\n                <div class="col-sm-2">\r\n                  <image ng-src="" class="img-responsive" />\r\n                </div>\r\n                <div class="col-sm-10">\r\n                  <!-- Description? -->\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-sm-2">\r\n              <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row"> \r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div> \r\n</div>'),$templateCache.put("service_list.html",'<div bb-services ng-init="checkStepTitle(\'Select a service\')" class="bb-service-list">\r\n  <div class="bb-subcontent">\r\n\r\n    <div class="bb-filters" ng-show="items">\r\n\r\n      <div accordion close-others="true">\r\n        <div accordion-group is-open="is_open" ng-class="{\'expanded\': is_open, \'selected\': is_selected}" class="store-body">\r\n\r\n          <div accordion-heading class="filter-header">\r\n            <span>Filter</span>\r\n            <span class="glyphicon glyphicon-filter" aria-hidden="true"></span>\r\n          </div>\r\n\r\n          <form class="form-inline">\r\n\r\n            <div ng-if="all_categories"class="form-group">\r\n              <label class="sr-only" >Category</label>\r\n              <select class="form-control" type="text" name="category" id="category" ng-model="filters.category_name" ng-options="item.name for item in all_categories" ng-change="filterChanged()">\r\n                <option  value="">Any category</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <label class="sr-only">Service</label>\r\n              <input class="form-control" type="text" ng-model="filters.service_name" ng-change="filterChanged()" placeholder="service name"/>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <div bb-price-filter></div>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <button type="button" class="btn btn-link" ng-click="resetFilters()">\r\n                <span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>\r\n                Reset\r\n              </button>\r\n            </div>\r\n\r\n          </form>\r\n\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class="panel panel-default" ng-repeat="item in filtered_items">\r\n      <div class="panel-body">\r\n        <div class="row" ng-class="{\'bb-vertical-align-center\': item.extra.image_url || item.description}">\r\n          <div class="col-sm-8 col-xs-6">\r\n            <h2 class="panel-title bb-service-name">{{item.name}}</h2>\r\n            <div class="row">\r\n              <div class="hidden-xs col-sm-2 bb-service-image" ng-if="item.extra.image_url">\r\n                <img ng-src="{{item.extra.image_url}}" class="img-responsive"/>\r\n              </div>\r\n              <div class="hidden-xs col-sm-10 bb-service-description" ng-if="item.description">\r\n                {{item.description}}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-6">\r\n            <div class="bb-service-price">\r\n              <span ng-show="item.price > 0">{{item.price | currency: bb.company.currency_code}}</span>\r\n              <span ng-show="item.price == 0">Free</span>\r\n            </div>\r\n          </div>\r\n          <div class="col-xs-12 hidden-sm hidden-md hidden-lg bbb-service-image" ng-if="item.extra.image_url">\r\n            <img ng-src="{{item.extra.image_url}}" class="img-responsive"/>\r\n          </div>\r\n          <div class="col-xs-12 hidden-sm hidden-md hidden-lg bb-service-description" ng-if="item.description">\r\n            {{item.description}}\r\n          </div>\r\n          <div class="col-sm-2 col-xs-12">\r\n            <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div>\r\n      <div class="panel-body" ng-show="filtered_items && filtered_items.length == 0">\r\n        <div class="col-sm-12 ">\r\n          <div class="bb-service-unavailable">\r\n            <p>\r\n              No services match your filter criteria.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row"> \r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div> \r\n</div>\r\n'),$templateCache.put("survey.html",'<div bb-survey-questions>\r\n \r\n  <div bb-question-setup>\r\n    <div bb-question-id="text_field">\r\n      <div ng-form name="question_form">\r\n        <input type="text" ng-model="question.answer" name="{{\'q\'+question.id}}" id="{{question.id}}" ng-maxlength="250" ng-required="question.currentlyShown && (false || (question.required && !bb.isAdmin))" class="form-question form-control">\r\n      </div>\r\n    </div>\r\n    <div bb-question-id="text_area">\r\n      <div ng-form name="question_form">\r\n        <textarea ng-model="question.answer" name="{{\'q\'+question.id}}" id="{{question.id}}" ng-maxlength="1000" ng-required="question.currentlyShown && (false || (question.required && !bb.isAdmin))" class="form-question form-control"></textarea>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="bb-frame" ng-if="completed" style="margin:10% 3% 10%;">\r\n    <h2 style="text-align:center; margin:10% 3% 10%;"> Thank you for filling out the survey!</h2>\r\n  </div>\r\n\r\n  <div ng-if="purchase" ng-show="bookings[0].survey_questions">\r\n    <div ng-hide="completed">\r\n\r\n      <div class="survey-intro">\r\n      </div>\r\n\r\n\r\n\r\n      <form name="survey_form" class="form-horizontal" role="form" novalidate bb-form>\r\n\r\n        <!--         <h2 class="booking-form-header">Booking Details</h2> -->\r\n\r\n        <ul class="summary-list">\r\n          <li class="row">\r\n            <div class="col-xs-3 col-sm-2 summary-label">Session:</div>\r\n            <div class="col-xs-9 col-sm-10 summary-value"><span class="bold-small">{{bookings[0].service_name}}</span>\r\n            </div>\r\n          </li>\r\n          <li class="row">\r\n            <div class="col-xs-3 col-sm-2 summary-label">Date:</div>\r\n            <div class="col-xs-9 col-sm-10 summary-value">\r\n              <span class="bold-small">{{bookings[0].pretty_date}}</span>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n\r\n        <div ng-show="bookings[0].survey_questions && bookings[0].survey_questions.length > 0">\r\n          <h2 class="booking-form-header">Survey Questions</h2>\r\n\r\n          <div class="form-group" ng-repeat="question in bookings[0].survey_questions" bb-question-line ng-class="{\'check\': question.detail_type == \'check\', \'has-error\': survey_form[\'q\' + question.id].$invalid && (survey_form[\'q\' + question.id].$dirty || survey_form.submitted)}">\r\n            <label ng-if="question.detail_type != \'check\'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-if="question.required" class="text-warning">*</span>:</label>\r\n            <div ng-if="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n            <div class="col-sm-8">\r\n              <input bb-question="question" />\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class="row step-navigation">\r\n          <div class="col-sm-3 col-sm-offset-9">\r\n            <button type="submit" class="btn btn-primary" ng-click="submitSurvey(survey_form)" bb-debounce>Submit Answers</button>\r\n          </div>\r\n        </div>\r\n\r\n      </form>\r\n    </div>\r\n    <h2 ng-if="bookings[0].survey_questions.length < 1">No survey questions for this session.</h2>\r\n\r\n  </div>\r\n  <div bb-loading class="bb-loader">\r\n  <div id="loading_icon">\r\n    <div id="wait_graphic">&nbsp;</div>\r\n  </div>\r\n</div>\r\n</div>\r\n'),$templateCache.put("time.html",'<div bb-include="_service_item_aggregate">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-times ng-init="checkStepTitle(\'Select a time\')" class="bb-time">\r\n\r\n    <div class="bb-calendar-navigation">\r\n      <button type="button" class="btn btn-link pull-left" ng-click="subtract(\'days\',1)">\r\n        <span class="glyphicon glyphicon-chevron-left pull-left" aria-hidden="true"></span>\r\n        <span class="hidden-xs">Previous Day</span>\r\n      </button>\r\n      <button type="button" class="btn btn-link pull-right" ng-click="add(\'days\',1)">\r\n        <span class="glyphicon glyphicon-chevron-right pull-right" aria-hidden="true" ></span>\r\n        <span class="hidden-xs">Next Day</span>\r\n      </button>\r\n    </div>\r\n\r\n    <div>\r\n\r\n      <h2 class="bb-section-title text-center hidden-xs">{{format_date(\'Do MMM YYYY\')}}</h2>\r\n      <h2 class="bb-section-title text-center hidden-sm hidden-md hidden-lg">{{format_date(\'Do MMM\')}}</h2>\r\n\r\n      <div ng-show="!slots || (slots && slots.length == 0)" class="bb-service-unavailable">\r\n        <p>\r\n          No Service Available\r\n        </p>\r\n      </div>\r\n\r\n      <div ng-if="slots">\r\n      \r\n        <div accordion close-others="false">\r\n          <!-- Morning -->\r\n          <div bb-accordian-range-group="{range: [360, 720], slots: slots, collaspe_when_time_selected: true}"ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n            <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n              <div accordion-heading>\r\n                <div class="accordian-header">\r\n                  <span class="period-label">\r\n                    <span ng-show="has_availability && !is_open"\r\n                    >+</span>\r\n                    <span ng-show="has_availability && is_open"\r\n                    >-</span>\r\n                      Morning\r\n                  </span>\r\n                  <p ng-hide="is_selected || (is_open && has_availability)">\r\n                    <small>{{accordian_slots.length}} available</small>\r\n                  </p>\r\n                  <p class="selected-time" ng-show="is_selected && !is_open">\r\n                    <small>{{selected_slot.time_12}}</small>\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <ul class="row" ng-if="has_availability">\r\n                <li ng-if="slot.avail > 0" class="bb-time-slot col-sm-4" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-repeat="slot in accordian_slots">\r\n                  <button type="button" class="btn btn-primary btn-lg btn-block" ng-click="selectSlot(slot)">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </button>\r\n                </li>\r\n              </ul>\r\n\r\n            </div>\r\n          </div>\r\n          <!-- Afternoon -->\r\n          <div bb-accordian-range-group="{range: [720, 1080], slots: slots, collaspe_when_time_selected: true}"ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n            <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n              <div accordion-heading>\r\n                <div class="accordian-header">\r\n                  <span class="period-label">\r\n                    <span ng-show="has_availability && !is_open"\r\n                    >+</span>\r\n                    <span ng-show="has_availability && is_open"\r\n                    >-</span>\r\n                      Afternoon\r\n                  </span>\r\n                  <p ng-hide="is_selected || (is_open && has_availability)">\r\n                    <small>{{accordian_slots.length}} available</small>\r\n                  </p>\r\n                  <p class="selected-time" ng-show="is_selected && !is_open">\r\n                    <small>{{selected_slot.time_12}}</small>\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <ul class="row" ng-if="has_availability">\r\n                <li ng-if="slot.avail > 0" ng-repeat="slot in accordian_slots" class="bb-time-slot col-sm-4" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disable}" >\r\n                  <button type="button" class="btn btn-primary btn-lg btn-block" ng-click="selectSlot(slot)">\r\n                    <span>{{slot.time_12}}</span>\r\n                  </button>\r\n                </li>\r\n              </ul>\r\n\r\n            </div>\r\n          </div> \r\n          <!-- Evening -->\r\n          <div bb-accordian-range-group="{range: [1080, 1200], slots: slots, collaspe_when_time_selected: true}"ng-init="setFormDataStoreId($index)" class="accordian-group">\r\n            <div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}" disabled="disabled">\r\n              <div accordion-heading>\r\n                <div class="accordian-header">\r\n                  <span class="period-label">\r\n                    <span ng-show="has_availability && !is_open"\r\n                    >+</span>\r\n                    <span ng-show="has_availability && is_open"\r\n                    >-</span>\r\n                      Evening\r\n                  </span>\r\n                  <p ng-hide="is_selected || (is_open && has_availability)">\r\n                    <small>{{accordian_slots.length}} available</small>\r\n                  </p>\r\n                  <p class="selected-time" ng-show="is_selected && !is_open">\r\n                    <small>{{selected_slot.time_12}}</small>\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <ul class="row" ng-if="has_availability">\r\n                <li ng-if="slot.avail > 0" ng-repeat="slot in accordian_slots" class="bb-time-slot col-sm-4" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}">\r\n                  <button type="button" class="btn btn-primary btn-lg btn-block" ng-click="selectSlot(slot)">\r\n                    <span >{{slot.time_12}}</span>\r\n                  </button>\r\n                </li>\r\n              </ul>\r\n\r\n            </div>\r\n          </div> \r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n\r\n\r\n<div class="clearfix hidden-xs">\r\n</div>\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n'),
$templateCache.put("_accordian_range_group.html",'<div accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n  <div accordion-heading>\r\n    <div class="accordian-header">\r\n      <span class="period-label">\r\n        <span ng-show="has_availability && !is_open" class="period-label-icon">+</span>\r\n        <span ng-show="has_availability && is_open" class="period-label-icon">-</span>\r\n        Morning\r\n      </span>\r\n      <span class="period-detail" ng-hide="is_selected || (is_open && has_availability)">{{accordian_slots.length}} available</span>\r\n      <span class="period-detail selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_12}}</span>\r\n    </div>\r\n  </div>\r\n\r\n  <ul class="time-slots" ng-if="has_availability">\r\n    <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="highlightSlot(day, slot)" ng-repeat="slot in accordian_slots">\r\n      <span>{{slot.time_12}}</span>\r\n    </li>\r\n  </ul>\r\n\r\n</div>  '),$templateCache.put("_add_recipient.html",'<form name="recipient_form" role="form" bb-form novalidate>\r\n\r\n  <div class="modal-header">\r\n    <button type="button" class="close" ng-click="cancel()">&times;</button>\r\n    <h1 class="modal-title">Recipient</h1>\r\n      Who should we send the gift voucher to?\r\n  </div>\r\n\r\n  <div class="modal-body">\r\n\r\n      <div class="radio">\r\n        <label>\r\n          <input type="radio" ng-model="recipient" ng-value="false" checked>\r\n          Me\r\n        </label>\r\n      </div>\r\n      <div class="radio">\r\n        <label>\r\n          <input type="radio" ng-model="recipient" ng-value="true">\r\n          Someone else\r\n        </label>\r\n      </div> \r\n\r\n      <div ng-if="recipient">\r\n        <div class="form-group" ng-class="{\'has-error\': recipient_form.name.$invalid && (!recipient_form.name.$pristine || recipient_form.submitted)}">\r\n          <label for="name">Name:</label>\r\n          <input type="text" name="name" id="name" required ng-model="item.recipient" class="form-control" autofocus />\r\n          <div class="messages">\r\n            <div class="error-message" ng-show="recipient_form.name.$invalid && recipient_form.submitted">\r\n              Please enter the recipients name\r\n            </div>\r\n          </div> \r\n        </div>\r\n\r\n        <div class="form-group" ng-class="{\'has-error\': recipient_form.email.$invalid && (!recipient_form.email.$pristine || recipient_form.submitted)}">\r\n          <label for="email">Email:</label>\r\n          <input type="email" name="email" id="email" required ng-model="item.recipient_mail" class="form-control" />\r\n          <div class="messages">\r\n            <div class="error-message" ng-show="recipient_form.email.$invalid && recipient_form.submitted">\r\n              Please enter the recipients email address\r\n            </div>\r\n          </div> \r\n        </div>\r\n      </div>\r\n\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-primary" ng-click="addToBasket(recipient_form)">Add to Basket</button>\r\n    <button class="btn btn-secondary" ng-click="cancel()">Cancel</button>\r\n  </div>\r\n</form>'),$templateCache.put("_basket_details.html",'<div bb-basket-list class="modal-content bb-basket-mini"> \r\n\r\n  <div class="modal-header">\r\n    <button type="button" class="close" ng-click="cancel()">&times;</button>\r\n    <h5 class="modal-title">Basket Details</h5>\r\n  </div>\r\n\r\n  <div class="modal-body">\r\n    <p ng-hide="bb.basket.items">No items added to basket yet.</p>\r\n    <table class="table table-bordered" ng-show="bb.basket.items">\r\n      <thead>\r\n        <tr>\r\n          <th>Item</th>\r\n          <th>Appointment</th>\r\n          <th>&nbsp;</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="item in bb.basket.items">\r\n          <td >\r\n            {{ item.service_name }}\r\n          </td>\r\n          <td>\r\n            {{ item.date.date | datetime: "ddd Do MMM":false}} at {{ item.date.date | datetime: "h:mma":false}} for {{ item.duration | time_period }}\r\n          </td>\r\n          <td class="text-center">\r\n            <span class="glyphicon glyphicon-trash" aria-hidden="true" ng-click="deleteBasketItem(item)"></span>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <div class="modal-footer">\r\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\r\n    <button ng-show="bb.basket.items" class="btn btn-primary" ng-click="checkout(\'basket\') && cancel()">Checkout</button>\r\n  </div>\r\n\r\n</div>'),$templateCache.put("_basket_mini.html",'<div class="bb-basket-mini">\r\n  <span class=\'glyphicon glyphicon-shopping-cart pull-right\' ng-class="{\'disabled-cart\': bb.current_page == \'basket\'}" ng-click="showBasketDetails()">\r\n    <span ng-if="basketItemCount" class="badge badge-notify">{{ basketItemCount }}</span>\r\n  </span>\r\n</div>'),$templateCache.put("_breadcrumb.html",'<div class="breadcrumbs-holder" ng-init="setBasicRoute([])">\r\n  <ol class="breadcrumb"> \r\n    <li ng-repeat="step in bb.allSteps" ng-class="{\'active\': step.active, \'passed\': step.passed, \'disabled\': isDisabledStep(step)}">\r\n      <button type="button" ng-click="loadStep(step.number)" ng-class="{\'active\': step.active, \'passed\': step.passed}" ng-disabled="isDisabledStep(step)">\r\n        <span class="step-num">{{step.number}}.</span>\r\n        <span class="step-title">{{step.title}}</span>\r\n      </button>\r\n    </li>\r\n  </ol>\r\n</div>\r\n\r\n\r\n'),$templateCache.put("_breadcrumb_complex.html",'<div class="breadcrumbs" ng-init="setRoute([\r\n  {page:\'service_list\', title: \'Set a Service\'},\r\n  {page:\'person_list\', title: \'Pick a Person\'},\r\n  {page:\'day\', title: \'Select a Date\'}\r\n  ])">\r\n\r\n<!--   <div class="row">\r\n    <tabset>\r\n      <tab ng-repeat="step in allSteps" heading="{{step.title}}" active="step.active" disabled="!step.passed" select="loadStep(step.number)">\r\n      </tab>\r\n    </tabset>\r\n\r\n    <div class="breadcrumbs">\r\n      <span ng-repeat="step in steps">\r\n        <a ng-if="!$last" href="" ng-click="loadStep(step.number)" class="btn default med flat">  {{step.number}}.\r\n        </a>\r\n        <div ng-if="$last" class="step">{{step.number}}. {{step.title}}</div>\r\n      <span>\r\n    </div>\r\n  </div> -->\r\n\r\n  <ol class="breadcrumb"> \r\n    <li ng-repeat="step in bb.allSteps" ng-class="{\'active\': step.active, \'passed\': step.passed, \'disabled\': isDisabledStep(step)}">\r\n      <button type="button" ng-click="loadStep(step.number)" ng-class="{\'active\': step.active, \'passed\': step.passed}" ng-disabled="isDisabledStep(step)">\r\n        <span class="step-num">{{step.number}}.</span>\r\n        <span class="step-title">{{step.title}}</span>\r\n      </button>\r\n    </li>\r\n  </ol>\r\n  \r\n</div>'),$templateCache.put("_cancel_modal.html",'<div class="modal-header">\r\n  <button type="button" class="close" ng-click="cancel()">&times;</button>\r\n  <h1 class="modal-title">Are you sure you want to cancel this booking?</h1>\r\n</div>\r\n\r\n<div class="modal-body">\r\n  \r\n  <ul class="confirmation-summary">\r\n    <li class="row confirmation-summary-item">\r\n      <div class="col-xs-3">Service</div>\r\n      <div class="col-xs-9">{{booking.service_name}}</div>\r\n    </li>\r\n    <li class="row confirmation-summary-item">\r\n      <div class="col-xs-3">When</div>\r\n      <div class="col-xs-9">{{booking.datetime | datetime: "h:mma dddd Do MMMM" : false}}</div>\r\n    </li>\r\n  </ul>\r\n\r\n</div>\r\n\r\n<div class="modal-footer">\r\n  <button class="btn btn-primary" ng-click="confirm_delete()"><span>Cancel Booking</span></button>\r\n  <button class="btn btn-link" ng-click="cancel()">Do not cancel</button>\r\n</div>\r\n'),$templateCache.put("_error_modal.html",'<div class="modal-content">\r\n  <div class="modal-header">\r\n  </div>\r\n  <div class="modal-body text-center">\r\n    <p>{{message}}</p>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button type="button" class="btn btn-primary" ng-click="ok()"><span>OK</span></button>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("_month_picker.html",'<div slick init-onload="true" data="months" slides-to-show="{{slidesToShow}}" current-index="index" infinite="false" prev-arrow=".month-prev" next-arrow=".month-next">\r\n\r\n  <div class="bb-month" ng-repeat="month in months" ng-class="{\'hidden-xs\': month.selected}">\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th colspan="7" class="months">{{month.start_date.format("MMMM")}}</th>\r\n        </tr>\r\n        <tr>\r\n          <th ng-repeat="day in month.weeks[0].days" class="days">{{day.date | datetime: "ddd" : false}}</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="week in month.weeks">\r\n          <td ng-repeat="day in week.days" \r\n            ng-class="{\'available\': day.available, \r\n                       \'selected\': day.selected,\r\n                       \'today\': day.today,\r\n                       \'past\': day.past,\r\n                       \'disabled\': day.disabled\r\n                      }" \r\n              ng-click="showDay(day)" \r\n              ng-disabled="day.disabled || day.past">\r\n            <div class="circle">{{day.date.date()}}</div>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n</div>'),$templateCache.put("_popout_export_booking.html",'<button type="button" class="btn btn-link" popover="{{html}}" popover-placement="bottom"><span class="glyphicon glyphicon-calendar"></span> Export to calendar</button>'),$templateCache.put("_price_filter.html",'<div>\r\n  <label class="sr-only" for="price">Price</label>\r\n  <input name="price" id="price" range-slider min="price_options.min" max="price_options.max" model-min="filters.price.min" model-max="filters.price.max">\r\n  </input>\r\n</div>'),$templateCache.put("_service_item_aggregate.html",'<ul class="bb-summary-list">\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.service.name">\r\n    <div class="bb-summary-label">Service:\r\n    </div>\r\n    <div class="bb-summary-value"><span>{{bb.current_item.service.name}}</span>\r\n    </div>\r\n  </li>\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.resource.name">\r\n    <div class="bb-summary-label">Resource:\r\n    </div>\r\n    <div class="bb-summary-value bb-summary-value"><span>{{bb.current_item.resource.name}}</span>\r\n    </div>\r\n  </li>\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.person.name">\r\n    <div class="bb-summary-label">Person:\r\n    </div>\r\n    <div class="bb-summary-value"><span>{{bb.current_item.person.name}}</span>\r\n    </div>\r\n  </li>\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.service.price">\r\n    <div class="bb-summary-label">Price:\r\n    </div>\r\n    <div class="bb-summary-value"><span>{{bb.current_item.service.price | currency: bb.company.currency_code }}</span>\r\n    </div>\r\n  </li>\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.date.date">\r\n    <div class="bb-summary-label">Date:\r\n    </div>\r\n    <div class="bb-summary-value"><span>{{bb.current_item.date.date | datetime: \'dddd D MMMM\':false}}</span>\r\n    </div>\r\n  </li>\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.time.time">\r\n    <div class="bb-summary-label">Time:\r\n    </div>\r\n    <div class="bb-summary-value"><span>{{bb.current_item.start_datetime() | datetime: \'h.mma\':false }}</span>\r\n    </div>\r\n  </li>\r\n  <li class="bb-confirmation-summary-item" ng-if="bb.current_item.duration">\r\n    <div class="bb-summary-label">Duration:\r\n    </div>\r\n    <div class="bb-summary-value"><span>{{bb.current_item.duration | time_period}}</span>\r\n    </div>\r\n  </li>\r\n</ul>\r\n\r\n\r\n')}]);
!function(){"use strict";function a(a,b,c){"addEventListener"in window?a.addEventListener(b,c,!1):"attachEvent"in window&&a.attachEvent("on"+b,c)}function b(a){return ab+"["+cb+"] "+a}function c(a){_&&"object"==typeof window.console&&console.log(b(a))}function d(a){"object"==typeof window.console&&console.warn(b(a))}function e(){c("Initialising iFrame"),f(),i(),h("background",M),h("padding",P),o(),m(),j(),q(),n(),Z=p(),E("init","Init message from host page")}function f(){function a(a){return"true"===a?!0:!1}var b=Y.substr(bb).split(":");cb=b[0],N=void 0!==b[1]?Number(b[1]):N,Q=void 0!==b[2]?a(b[2]):Q,_=void 0!==b[3]?a(b[3]):_,$=void 0!==b[4]?Number(b[4]):$,db=void 0!==b[5]?a(b[5]):db,K=void 0!==b[6]?a(b[6]):K,O=b[7],W=void 0!==b[8]?b[8]:W,M=b[9],P=b[10],ib=void 0!==b[11]?Number(b[11]):ib,Z.enable=void 0!==b[12]?a(b[12]):!1,fb=b[13]}function g(a,b){return-1!==b.indexOf("-")&&(d("Negative CSS value ignored for "+a),b=""),b}function h(a,b){void 0!==b&&""!==b&&"null"!==b&&(document.body.style[a]=b,c("Body "+a+' set to "'+b+'"'))}function i(){void 0===O&&(O=N+"px"),g("margin",O),h("margin",O)}function j(){document.documentElement.style.height="",document.body.style.height="",c('HTML & body height set to "auto"')}function k(b){function d(c){a(window,c,function(){E(b.eventName,b.eventType)})}b.eventNames&&Array.prototype.map?(b.eventName=b.eventNames[0],b.eventNames.map(d)):d(b.eventName),c("Added event listener: "+b.eventType)}function l(){k({eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),k({eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),k({eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),k({eventType:"Device Orientation Change",eventName:"deviceorientation"}),k({eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),k({eventType:"Window Clicked",eventName:"click"}),"child"===fb&&k({eventType:"IFrame Resized",eventName:"resize"})}function m(){V!==W&&(W in mb||(d(W+" is not a valid option for heightCalculationMethod."),W="bodyScroll"),c('Height calculation method set to "'+W+'"'))}function n(){!0===K?(l(),t()):c("Auto Resize disabled")}function o(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function p(){function b(){return{x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop}}function e(a){var c=a.getBoundingClientRect(),d=b();return{x:parseInt(c.left,10)+parseInt(d.x,10),y:parseInt(c.top,10)+parseInt(d.y,10)}}function f(a){function b(a){var b=e(a);c("Moving to in page link (#"+d+") at x: "+b.x+" y: "+b.y),I(b.y,b.x,"scrollToOffset")}var d=a.split("#")[1]||"",f=decodeURIComponent(d),g=document.getElementById(f)||document.getElementsByName(f)[0];g?b(g):(c("In page link (#"+d+") not found in iFrame, so sending to parent"),I(0,0,"inPageLink","#"+d))}function g(){""!==location.hash&&"#"!==location.hash&&f(location.href)}function h(){function b(b){function c(a){a.preventDefault(),f(this.getAttribute("href"))}"#"!==b.getAttribute("href")&&a(b,"click",c)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),b)}function i(){a(window,"hashchange",g)}function j(){setTimeout(g,S)}function k(){Array.prototype.forEach&&document.querySelectorAll?(c("Setting up location.hash handlers"),h(),i(),j()):d("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return Z.enable?k():c("In page linking not enabled"),{findTarget:f}}function q(){db&&(c("Enable public methods"),window.parentIFrame={close:function(){I(0,0,"close")},getId:function(){return cb},moveToAnchor:function(a){Z.findTarget(a)},reset:function(){H("parentIFrame.reset")},scrollTo:function(a,b){I(b,a,"scrollTo")},scrollToOffset:function(a,b){I(b,a,"scrollToOffset")},sendMessage:function(a,b){I(0,0,"message",JSON.stringify(a),b)},setHeightCalculationMethod:function(a){W=a,m()},setTargetOrigin:function(a){c("Set targetOrigin: "+a),gb=a},size:function(a,b){var c=""+(a?a:"")+(b?","+b:"");F(),E("size","parentIFrame.size("+c+")",a,b)}})}function r(){0!==$&&(c("setInterval: "+$+"ms"),setInterval(function(){E("interval","setInterval: "+$)},Math.abs($)))}function s(b){function d(b){(void 0===b.height||void 0===b.width||0===b.height||0===b.width)&&(c("Attach listerner to "+b.src),a(b,"load",function(){E("imageLoad","Image loaded")}))}b.forEach(function(a){if("attributes"===a.type&&"src"===a.attributeName)d(a.target);else if("childList"===a.type){var b=a.target.querySelectorAll("img");Array.prototype.forEach.call(b,function(a){d(a)})}})}function t(){function a(){var a=document.querySelector("body"),d={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},e=new b(function(a){E("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),s(a)});c("Enable MutationObserver"),e.observe(a,d)}var b=window.MutationObserver||window.WebKitMutationObserver;b?0>$?r():a():(d("MutationObserver not supported in this browser!"),r())}function u(){function a(a){function b(a){var b=/^\d+(px)?$/i;if(b.test(a))return parseInt(a,L);var d=c.style.left,e=c.runtimeStyle.left;return c.runtimeStyle.left=c.currentStyle.left,c.style.left=a||0,a=c.style.pixelLeft,c.style.left=d,c.runtimeStyle.left=e,a}var c=document.body,d=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(d=document.defaultView.getComputedStyle(c,null),d=null!==d?d[a]:0):d=b(c.currentStyle[a]),parseInt(d,L)}return document.body.offsetHeight+a("marginTop")+a("marginBottom")}function v(){return document.body.scrollHeight}function w(){return document.documentElement.offsetHeight}function x(){return document.documentElement.scrollHeight}function y(){for(var a=document.querySelectorAll("body *"),b=a.length,d=0,e=(new Date).getTime(),f=0;b>f;f++)a[f].getBoundingClientRect().bottom>d&&(d=a[f].getBoundingClientRect().bottom);return e=(new Date).getTime()-e,c("Parsed "+b+" HTML elements"),c("LowestElement bottom position calculated in "+e+"ms"),d}function z(){return[u(),v(),w(),x()]}function A(){return Math.max.apply(null,z())}function B(){return Math.min.apply(null,z())}function C(){return Math.max(u(),y())}function D(){return Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)}function E(a,b,d,e){function f(){a in{reset:1,resetPage:1,init:1}||c("Trigger event: "+b)}function g(){T=n,lb=o,I(T,lb,a)}function h(){return jb&&a in R}function i(){function a(a,b){var c=Math.abs(a-b)<=ib;return!c}return n=void 0!==d?d:mb[W](),o=void 0!==e?e:D(),a(T,n)||Q&&a(lb,o)}function j(){return!(a in{init:1,interval:1,size:1})}function k(){return W in eb}function l(){c("No change in size detected")}function m(){j()&&k()?H(b):a in{interval:1}||(f(),l())}var n,o;h()?c("Trigger event cancelled: "+a):i()?(f(),F(),g()):m()}function F(){jb||(jb=!0,c("Trigger event lock on")),clearTimeout(kb),kb=setTimeout(function(){jb=!1,c("Trigger event lock off"),c("--")},S)}function G(a){T=mb[W](),lb=D(),I(T,lb,a)}function H(a){var b=W;W=V,c("Reset trigger event: "+a),F(),G("reset"),W=b}function I(a,b,d,e,f){function g(){void 0===f?f=gb:c("Message targetOrigin: "+f)}function h(){var g=a+":"+b,h=cb+":"+g+":"+d+(void 0!==e?":"+e:"");c("Sending message to host page ("+h+")"),hb.postMessage(ab+h,f)}g(),h()}function J(a){function b(){return ab===(""+a.data).substr(0,bb)}function f(){Y=a.data,hb=a.source,e(),U=!1,setTimeout(function(){X=!1},S)}function g(){X?c("Page reset ignored by init"):(c("Page size reset by host page"),G("resetPage"))}function h(){E("resizeParent","Parent window resized")}function i(){return a.data.split("]")[1]}function j(){return"iFrameResize"in window}function k(){return a.data.split(":")[2]in{"true":1,"false":1}}b()&&(U&&k()?f():"reset"===i()?g():"resize"===i()?h():a.data===Y||j()||d("Unexpected message ("+a.data+")"))}var K=!0,L=10,M="",N=0,O="",P="",Q=!1,R={resize:1,click:1},S=128,T=1,U=!0,V="offset",W=V,X=!0,Y="",Z={},$=32,_=!1,ab="[iFrameSizer]",bb=ab.length,cb="",db=!1,eb={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},fb="parent",gb="*",hb=window.parent,ib=0,jb=!1,kb=null,lb=1,mb={offset:u,bodyOffset:u,bodyScroll:v,documentElementOffset:w,scroll:x,documentElementScroll:x,max:A,min:B,grow:A,lowestElement:C};a(window,"message",J)}();
!function(){"use strict";function a(a,b,c){"addEventListener"in window?a.addEventListener(b,c,!1):"attachEvent"in window&&a.attachEvent("on"+b,c)}function b(){var a,b=["moz","webkit","o","ms"];for(a=0;a<b.length&&!A;a+=1)A=window[b[a]+"RequestAnimationFrame"];A||e(" RequestAnimationFrame not supported")}function c(){var a="Host page";return window.top!==window.self&&(a=window.parentIFrame?window.parentIFrame.getId():"Nested host page"),a}function d(a){return x+"["+c()+"]"+a}function e(a){u&&"object"==typeof window.console&&console.log(d(a))}function f(a){"object"==typeof window.console&&console.warn(d(a))}function g(a){function b(){function a(){k(F),i(),C[G].resizedCallback(F)}g("Height"),g("Width"),l(a,F,"resetPage")}function c(a){var b=a.id;e(" Removing iFrame: "+b),a.parentNode.removeChild(a),C[b].closedCallback(b),delete C[b],e(" --")}function d(){var a=E.substr(y).split(":");return{iframe:document.getElementById(a[0]),id:a[0],height:a[1],width:a[2],type:a[3]}}function g(a){var b=Number(C[G]["max"+a]),c=Number(C[G]["min"+a]),d=a.toLowerCase(),f=Number(F[d]);if(c>b)throw new Error("Value for min"+a+" can not be greater than max"+a);e(" Checking "+d+" is in range "+c+"-"+b),c>f&&(f=c,e(" Set "+d+" to min value")),f>b&&(f=b,e(" Set "+d+" to max value")),F[d]=""+f}function m(){var b=a.origin,c=F.iframe.src.split("/").slice(0,3).join("/");if(C[G].checkOrigin&&(e(" Checking connection is from: "+c),""+b!="null"&&b!==c))throw new Error("Unexpected message received from: "+b+" for "+F.iframe.id+". Message was: "+a.data+". This error can be disabled by adding the checkOrigin: false option.");return!0}function n(){return x===(""+E).substr(0,y)}function o(){var a=F.type in{"true":1,"false":1};return a&&e(" Ignoring init message from meta parent page"),a}function p(a){return E.substr(E.indexOf(":")+w+a)}function q(a){e(" MessageCallback passed: {iframe: "+F.iframe.id+", message: "+a+"}"),C[G].messageCallback({iframe:F.iframe,message:JSON.parse(a)}),e(" --")}function r(){return null===F.iframe?(f(" IFrame ("+F.id+") not found"),!1):!0}function s(a){var b=a.getBoundingClientRect();return h(),{x:parseInt(b.left,10)+parseInt(z.x,10),y:parseInt(b.top,10)+parseInt(z.y,10)}}function v(a){function b(){z=g,A(),e(" --")}function c(){return{x:Number(F.width)+d.x,y:Number(F.height)+d.y}}var d=a?s(F.iframe):{x:0,y:0},g=c();e(" Reposition requested from iFrame (offset x:"+d.x+" y:"+d.y+")"),window.top!==window.self?window.parentIFrame?a?parentIFrame.scrollToOffset(g.x,g.y):parentIFrame.scrollTo(F.width,F.height):f(" Unable to scroll to requested position, window.parentIFrame not found"):b()}function A(){!1!==C[G].scrollCallback(z)&&i()}function B(a){function b(a){var b=s(a);e(" Moving to in page link (#"+c+") at x: "+b.x+" y: "+b.y),z={x:b.x,y:b.y},A(),e(" --")}var c=a.split("#")[1]||"",d=decodeURIComponent(c),f=document.getElementById(d)||document.getElementsByName(d)[0];window.top!==window.self?window.parentIFrame?parentIFrame.moveToAnchor(c):e(" In page link #"+c+" not found and window.parentIFrame not found"):f?b(f):e(" In page link #"+c+" not found")}function D(){switch(F.type){case"close":c(F.iframe);break;case"message":q(p(6));break;case"scrollTo":v(!1);break;case"scrollToOffset":v(!0);break;case"inPageLink":B(p(9));break;case"reset":j(F);break;case"init":b(),C[G].initCallback(F.iframe);break;default:b()}}var E=a.data,F={},G=null;n()&&(F=d(),G=F.id,u=C[G].log,e(" Received: "+E),!o()&&r()&&m()&&(D(),t=!1))}function h(){null===z&&(z={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop},e(" Get page position: "+z.x+","+z.y))}function i(){null!==z&&(window.scrollTo(z.x,z.y),e(" Set page position: "+z.x+","+z.y),z=null)}function j(a){function b(){k(a),m("reset","reset",a.iframe,a.id)}e(" Size reset requested by "+("init"===a.type?"host page":"iFrame")),h(),l(b,a,"init")}function k(a){function b(b){a.iframe.style[b]=a[b]+"px",e(" IFrame ("+c+") "+b+" set to "+a[b]+"px")}var c=a.iframe.id;C[c].sizeHeight&&b("height"),C[c].sizeWidth&&b("width")}function l(a,b,c){c!==b.type&&A?(e(" Requesting animation frame"),A(a)):a()}function m(a,b,c,d){c&&c.contentWindow?(e("["+a+"] Sending msg to iframe ("+b+")"),c.contentWindow.postMessage(x+b,"*")):(f("["+a+"] IFrame not found"),C[d]&&delete C[d])}function n(b){function c(){function a(a){1/0!==C[o][a]&&0!==C[o][a]&&(n.style[a]=C[o][a]+"px",e(" Set "+a+" = "+C[o][a]+"px"))}a("maxHeight"),a("minHeight"),a("maxWidth"),a("minWidth")}function d(a){return""===a&&(n.id=a="iFrameResizer"+s++,u=(b||{}).log,e(" Added missing iframe ID: "+a+" ("+n.src+")")),a}function f(){e(" IFrame scrolling "+(C[o].scrolling?"enabled":"disabled")+" for "+o),n.style.overflow=!1===C[o].scrolling?"hidden":"auto",n.scrolling=!1===C[o].scrolling?"no":"yes"}function g(){("number"==typeof C[o].bodyMargin||"0"===C[o].bodyMargin)&&(C[o].bodyMarginV1=C[o].bodyMargin,C[o].bodyMargin=""+C[o].bodyMargin+"px")}function h(){return o+":"+C[o].bodyMarginV1+":"+C[o].sizeWidth+":"+C[o].log+":"+C[o].interval+":"+C[o].enablePublicMethods+":"+C[o].autoResize+":"+C[o].bodyMargin+":"+C[o].heightCalculationMethod+":"+C[o].bodyBackground+":"+C[o].bodyPadding+":"+C[o].tolerance+":"+C[o].enableInPageLinks+":"+C[o].resizeFrom}function i(b){a(n,"load",function(){var a=t;m("iFrame.onload",b,n),!a&&C[o].heightCalculationMethod in B&&j({iframe:n,height:0,width:0,type:"init"})}),m("init",b,n)}function k(a){if("object"!=typeof a)throw new TypeError("Options is not an object.")}function l(a){a=a||{},C[o]={},k(a);for(var b in E)E.hasOwnProperty(b)&&(C[o][b]=a.hasOwnProperty(b)?a[b]:E[b]);u=C[o].log}var n=this,o=d(n.id);l(b),f(),c(),g(),i(h())}function o(a,b){null===D&&(D=setTimeout(function(){D=null,a()},b))}function p(){o(function(){for(var a in C)"parent"===C[a].resizeFrom&&m("Window resize","resize",document.getElementById(a),a)},66)}function q(){function a(a,b){if(!a.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==a.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+a.tagName+">.");n.call(a,b)}return function(b,c){switch(typeof c){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(c||"iframe"),function(c){a(c,b)});break;case"object":a(c,b);break;default:throw new TypeError("Unexpected data type ("+typeof c+").")}}}function r(a){a.fn.iFrameResize=function(a){return this.filter("iframe").each(function(b,c){n.call(c,a)}).end()}}var s=0,t=!0,u=!1,v="message",w=v.length,x="[iFrameSizer]",y=x.length,z=null,A=window.requestAnimationFrame,B={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},C={},D=null,E={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,enableInPageLinks:!1,enablePublicMethods:!1,heightCalculationMethod:"offset",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,closedCallback:function(){},initCallback:function(){},messageCallback:function(){},resizedCallback:function(){},scrollCallback:function(){return!0}};b(),a(window,"message",g),a(window,"resize",p),window.jQuery&&r(jQuery),"function"==typeof define&&define.amd?define([],q):"object"==typeof module&&"object"==typeof module.exports?module.exports=q():window.iFrameResize=q()}();